<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Martin Schweinberger" />

<meta name="date" content="2022-06-24" />

<title>Multiple Regression in R</title>

<script src="site_libs/header-attrs-2.14/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<script src="site_libs/clipboard-1.7.1/clipboard.min.js"></script>
<link href="site_libs/primer-tooltips-1.4.0/build.css" rel="stylesheet" />
<link href="site_libs/klippy-0.0.0.9500/css/klippy.min.css" rel="stylesheet" />
<script src="site_libs/klippy-0.0.0.9500/js/klippy.min.js"></script>
<link href="site_libs/tabwid-1.0.0/tabwid.css" rel="stylesheet" />
<link rel="stylesheet" href="styles.css" />

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-VSGK4KYDQZ"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-VSGK4KYDQZ');
</script>


<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>





<style type="text/css">
/* for pandoc --citeproc since 2.11 */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">



<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  
  <!-- Added by SKC - LADAL image and thicker top with   -->
  <div class="container-fluid navbar-top" >
    <a href="index.html"> <!-- Make entire top row and text clickable home link  -->
        <div class="row">
            <div class="navbar-brand col-md-12">
              <img src="ladal_icon_cas_tran_white_trimed.png" class="navbar-icon" alt="LADAL"/>
              <span class="navbar-title-note navbar-collapse collapse" >Language Technology and Data Analysis Laboratory</span>
            </div>
        </div>
    </a>
  </div>
  
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <!-- SKC removed  navbar brand -->
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">HOME</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    ABOUT LADAL
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="people.html">People | Collabs</a>
    </li>
    <li>
      <a href="news.html">News</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    EVENTS
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="workshops.html">Workshops</a>
    </li>
    <li>
      <a href="webinars2022.html">LADAL Webinar Series 2022</a>
    </li>
    <li>
      <a href="opening.html">LADAL Webinar Series 2021</a>
    </li>
    <li>
      <a href="atapevents.html">ATAP Events</a>
    </li>
  </ul>
</li>
<li>
  <a href="tutorials.html">TUTORIALS</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    RESOURCES
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="links.html">Links</a>
    </li>
    <li>
      <a href="base.html">Tutorial stylesheet</a>
    </li>
  </ul>
</li>
<li>
  <a href="contact.html">CONTACT</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Multiple Regression in R</h1>
<h4 class="author">Martin Schweinberger</h4>
<h4 class="date">2022-06-24</h4>

</div>


<p><img src="https://slcladal.github.io/images/uq1.jpg" width="100%" /></p>
<div id="introduction" class="section level1 unnumbered">
<h1 class="unnumbered">Introduction</h1>
<p>This tutorial focuses on multiple regression analysis using R.<a
href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a> Regression
models can be divided into fixed- and mixed-effects regression models
(depending on whether the model has a random effect structure or not)
and this tutorial covers multiple fixed-effects linear, logistic,
ordinal, and Poisson regression which differ in that they take different
types of dependent or response variables. The versatility regarding
being able to deal with many different response variables is one of the
reasons why regression analysis is among the most widely used
quantitative methods in the language sciences. Such regression models
are used to assess if and how predictors (variables or interactions
between variables) correlate with a certain response.</p>
<p><a href="https://slcladal.github.io/introreg.html">Check out this
tutorial</a> if you want to know more about the theoretical
underpinnings and the conceptual basis of regression analysis.</p>
<p><img src="https://slcladal.github.io/images/yr_chili.jpg" width="15%" style="float:right; padding:10px" /></p>
<p>This tutorial is aimed at intermediate and advanced users of R with
the aim of showcasing how to perform regression analysis using R. The
aim is not to provide a fully-fledged analysis but rather to show and
exemplify common regression types, model diagnostics, and model fitting
using R.</p>
<br>
<div class="warning"
style="padding:0.1em; background-color:#f2f2f2; color:#51247a">
<span>
<p style="margin-top:1em; text-align:center">
The entire R Notebook for the tutorial can be downloaded <a
href="https://slcladal.github.io/multireg.Rmd"><strong>here</strong></a>.
If you want to render the R Notebook on your machine, i.e. knitting the
document to html or a pdf, you need to make sure that you have R and
RStudio installed and you also need to download the <a
href="https://slcladal.github.io/bibliography.bib"><strong>bibliography
file</strong></a> and store it in the same folder where you store the
Rmd or the Rproj file. <br>
</p>
<p style="margin-left:1em;">
</p>
<p></span></p>
</div>
<p><br></p>
<p><strong>Preparation and session set up</strong></p>
<p>This tutorial is based on R. If you have not installed R or are new
to it, you will find an introduction to and more information how to use
R <a href="https://slcladal.github.io/intror.html">here</a>. For this
tutorials, we need to install certain <em>packages</em> from an R
<em>library</em> so that the scripts shown below are executed without
errors. Before turning to the code below, please install the packages by
running the code below this paragraph. If you have already installed the
packages mentioned below, then you can skip ahead and ignore this
section. To install the necessary packages, simply run the following
code - it may take some time (between 1 and 5 minutes to install all of
the libraries so you do not need to worry if it takes some time).</p>
<pre class="r"><code># install
install.packages(&quot;car&quot;)
install.packages(&quot;emmeans&quot;)
install.packages(&quot;effects&quot;)
install.packages(&quot;flextable&quot;)
install.packages(&quot;ggplot2&quot;)
install.packages(&quot;ggpubr&quot;)
install.packages(&quot;Hmisc&quot;)
install.packages(&quot;knitr&quot;)
install.packages(&quot;lme4&quot;)
install.packages(&quot;MASS&quot;)
install.packages(&quot;mclogit&quot;)
install.packages(&quot;MuMIn&quot;)
install.packages(&quot;nlme&quot;)
install.packages(&quot;ordinal&quot;)
install.packages(&quot;rms&quot;)
install.packages(&quot;robustbase&quot;)
install.packages(&quot;sjPlot&quot;)
install.packages(&quot;stringr&quot;)
install.packages(&quot;tibble&quot;)
install.packages(&quot;dplyr&quot;)
install.packages(&quot;vcd&quot;)
install.packages(&quot;vip&quot;)
install.packages(&quot;see&quot;)
install.packages(&quot;performance&quot;)
install.packages(&quot;report&quot;)
# install klippy for copy-to-clipboard button in code chunks
install.packages(&quot;remotes&quot;)
remotes::install_github(&quot;rlesur/klippy&quot;)</code></pre>
<p>Now that we have installed the packages, we activate them as shown
below.</p>
<pre class="r"><code># set options
options(stringsAsFactors = F)          # no automatic data transformation
options(&quot;scipen&quot; = 100, &quot;digits&quot; = 12) # suppress math annotation
# load packages
library(car)
#library(effects)
#library(emmeans)
library(flextable)
library(ggfortify)
library(ggplot2)
library(ggpubr)
library(Hmisc)
library(MASS)
#library(mclogit)
library(MuMIn)
#library(nlme)
library(ordinal)
library(rms)
#library(robustbase)
library(sjPlot)
library(stringr)
#library(tibble)
library(vcd)
library(vip)
library(performance)
library(report)
library(dplyr)
# activate klippy for copy-to-clipboard button
klippy::klippy()</code></pre>
<script>
  addClassKlippyTo("pre.r, pre.markdown");
  addKlippy('left', 'top', 'auto', '1', 'Copy code', 'Copied!');
</script>
<p>Once you have installed R and RStudio and initiated the session by
executing the code shown above, you are good to go.</p>
<div id="multiple-linear-regression" class="section level2 unnumbered">
<h2 class="unnumbered">Multiple Linear Regression</h2>
<p>In contrast to simple linear regression, which estimates the effect
of a single predictor, multiple linear regression estimates the effect
of various predictor (see the equation below). A multiple linear
regression can thus test the effects of various predictors
simultaneously.</p>
<p><span class="math display">\[\begin{equation}

f_{(x)} = \alpha + \beta_{1}x_{i} + \beta_{2}x_{i+1} + \dots +
\beta_{n}x_{i+n} + \epsilon

\end{equation}\]</span></p>
<p>There exists a wealth of literature focusing on multiple linear
regressions and the concepts it is based on. For instance, there are
<span class="citation">Achen (<a href="#ref-achen1982interpreting"
role="doc-biblioref">1982</a>)</span>, <span class="citation">Bortz (<a
href="#ref-bortz2006statistik" role="doc-biblioref">2006</a>)</span>,
<span class="citation">Crawley (<a href="#ref-crawley2005statistics"
role="doc-biblioref">2005</a>)</span>, <span class="citation">Faraway
(<a href="#ref-faraway2002practical"
role="doc-biblioref">2002</a>)</span>, <span class="citation">Field,
Miles, and Field (<a href="#ref-field2012discovering"
role="doc-biblioref">2012</a>)</span>, <span class="citation">Gries (<a
href="#ref-gries2021statistics" role="doc-biblioref">2021</a>)</span>,
<span class="citation">Levshina (<a href="#ref-levshina2015linguistics"
role="doc-biblioref">2015</a>)</span>, <span class="citation">Winter (<a
href="#ref-winter2019statistics" role="doc-biblioref">2019</a>)</span>
and <span class="citation">Wilcox (<a href="#ref-wilcox2009basic"
role="doc-biblioref">2009</a>)</span> to name just a few. Introductions
to regression modeling in R are <span class="citation">Baayen (<a
href="#ref-baayen2008analyzing" role="doc-biblioref">2008</a>)</span>,
<span class="citation">Crawley (<a href="#ref-crawley2012r"
role="doc-biblioref">2012</a>)</span>, <span class="citation">Gries (<a
href="#ref-gries2021statistics" role="doc-biblioref">2021</a>)</span>,
or <span class="citation">Levshina (<a
href="#ref-levshina2015linguistics"
role="doc-biblioref">2015</a>)</span>.</p>
<p>The model diagnostics we are dealing with here are partly identical
to the diagnostic methods discussed in the section on simple linear
regression. Because of this overlap, diagnostics will only be described
in more detail if they have not been described in the section on simple
linear regression.</p>
<hr />
<div class="warning"
style="padding:0.1em; background-color:#f2f2f2; color:#51247a">
<span>
<p style="margin-top:1em; text-align:center">
<b>EXCURSION</b>
</p>
<p style="margin-left:1em;">
</p>
<p></span></p>
</div>
<div class="question">
<p>`</p>
<details>
<summary>
A note on sample size and power
</summary>
<p>Although there appears to be a general assumption that 25 data points
per variable level are sufficient, this is merely a general rule of
thumb that is actually often incorrect. Such rules of thumb are
inadequate because the required sample size depends on the number of
variables in a given model, the size of the effect, the variance of the
effect, and the desired power - in other words, the minimum necessary
sample size relates to <em>statistical power</em> (see <a
href="https://slcladal.github.io/pwr.html">here</a> for a tutorial on
power). If a model contains many variables, then this requires a larger
sample size than a model which only uses very few predictors and if the
effect that we want to find is small, then this also requires a larger
sample than if the effect we are interested in is large. Finally,
effects that are very robust and do not exhibit substantive variability
require a much smaller sample size compared with effects that are
spurious and vary notably Since the sample size depends on the effect
size and variance as well as the number of variables, there is no
one-size-fits-all answer to what the best sample size is.</p>
Another, slightly better but still incorrect, rule of thumb is that the
more data, the better. This is not correct because models based on many
cases are prone to report almost any effect as significant (although
with a tiny effect size). A discussion about this phenomenon led to a
discussion between Adam Kilgariff and Stefan Gries (see <a
href="https://www.degruyter.com/document/doi/10.1515/cllt.2005.1.2.263/html">here
for Adam’s initial discussion note</a> and see <a
href="https://www.degruyter.com/document/doi/10.1515/cllt.2005.1.2.277/html?lang=de">here
for Stefan’s response</a>) resulting in a wider acknowledgement that
effect sizes are more important than mere p-values. Also, given that
there are procedures that can correct for overfitting, larger data sets
are still preferable to data sets that are simply too small to warrant
reliable results. In conclusion, it remains true that the sample size
depends on the effect under investigation.
</details>
</div>
<p>`</p>
<hr />
<p>Despite there being no ultimate rule of thumb, <span
class="citation">Field, Miles, and Field (<a
href="#ref-field2012discovering" role="doc-biblioref">2012,
273–75</a>)</span>, based on <span class="citation">Green (<a
href="#ref-green1991many" role="doc-biblioref">1991</a>)</span>, provide
data-driven suggestions for the minimal size of data required for
regression models that aim to find medium sized effects (k = number of
predictors; categorical variables with more than two levels should be
transformed into dummy variables):</p>
<ul>
<li><p>If one is merely interested in the overall model fit (something I
have not encountered), then the sample size should be at least 50 + k (k
= number of predictors in model).</p></li>
<li><p>If one is only interested in the effect of specific variables,
then the sample size should be at least 104 + k (k = number of
predictors in model).</p></li>
<li><p>If one is only interested in both model fit and the effect of
specific variables, then the sample size should be at least the higher
value of 50 + k or 104 + k (k = number of predictors in model).</p></li>
</ul>
<p>You will see in the R code below that there is already a function
that tests whether the sample size is sufficient.</p>
<div id="example-gifts-and-availability"
class="section level3 unnumbered">
<h3 class="unnumbered">Example: Gifts and Availability</h3>
<p>The example we will go through here is taken from <span
class="citation">Field, Miles, and Field (<a
href="#ref-field2012discovering" role="doc-biblioref">2012</a>)</span>.
In this example, the research question is if the money that men spend on
presents for women depends on the women’s attractiveness and their
relationship status. To answer this research question, we will implement
a multiple linear regression and start by loading the data and inspect
its structure and properties.</p>
<pre class="r"><code># load data
mlrdata  &lt;- base::readRDS(url(&quot;https://slcladal.github.io/data/mld.rda&quot;, &quot;rb&quot;))</code></pre>
<template id="bcfc4cd4-24dc-47de-adaf-897627898e3c"><style>
.tabwid table{
  border-spacing:0px !important;
  border-collapse:collapse;
  line-height:1;
  margin-left:auto;
  margin-right:auto;
  border-width: 0;
  display: table;
  margin-top: 1.275em;
  margin-bottom: 1.275em;
  border-color: transparent;
}
.tabwid_left table{
  margin-left:0;
}
.tabwid_right table{
  margin-right:0;
}
.tabwid td {
    padding: 0;
}
.tabwid a {
  text-decoration: none;
}
.tabwid thead {
    background-color: transparent;
}
.tabwid tfoot {
    background-color: transparent;
}
.tabwid table tr {
background-color: transparent;
}
</style><div class="tabwid"><style>.cl-9886515c{table-layout:auto;width:75%;}.cl-987c2f56{font-family:'Arial';font-size:12pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-987c2f6a{font-family:'Arial';font-size:12pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-987c572e{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-987c5742{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-987ca0e4{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-987ca0ee{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-987ca0ef{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-987ca0f0{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-987ca0f8{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-987ca0f9{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-987ca102{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-987ca103{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-987ca104{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-987ca105{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-987ca10c{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-987ca116{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table class='cl-9886515c'>
<caption class="Table Caption">
<p>First 15 rows of the mlrdata.</p>
</caption>
<thead><tr style="overflow-wrap:break-word;"><td class="cl-987ca10c"><p class="cl-987c572e"><span class="cl-987c2f56">status</span></p></td><td class="cl-987ca105"><p class="cl-987c572e"><span class="cl-987c2f56">attraction</span></p></td><td class="cl-987ca116"><p class="cl-987c5742"><span class="cl-987c2f56">money</span></p></td></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-987ca0ef"><p class="cl-987c572e"><span class="cl-987c2f6a">Relationship</span></p></td><td class="cl-987ca0e4"><p class="cl-987c572e"><span class="cl-987c2f6a">NotInterested</span></p></td><td class="cl-987ca0ee"><p class="cl-987c5742"><span class="cl-987c2f6a">86.33</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-987ca0f9"><p class="cl-987c572e"><span class="cl-987c2f6a">Relationship</span></p></td><td class="cl-987ca0f0"><p class="cl-987c572e"><span class="cl-987c2f6a">NotInterested</span></p></td><td class="cl-987ca0f8"><p class="cl-987c5742"><span class="cl-987c2f6a">45.58</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-987ca0ef"><p class="cl-987c572e"><span class="cl-987c2f6a">Relationship</span></p></td><td class="cl-987ca0e4"><p class="cl-987c572e"><span class="cl-987c2f6a">NotInterested</span></p></td><td class="cl-987ca0ee"><p class="cl-987c5742"><span class="cl-987c2f6a">68.43</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-987ca0f9"><p class="cl-987c572e"><span class="cl-987c2f6a">Relationship</span></p></td><td class="cl-987ca0f0"><p class="cl-987c572e"><span class="cl-987c2f6a">NotInterested</span></p></td><td class="cl-987ca0f8"><p class="cl-987c5742"><span class="cl-987c2f6a">52.93</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-987ca0ef"><p class="cl-987c572e"><span class="cl-987c2f6a">Relationship</span></p></td><td class="cl-987ca0e4"><p class="cl-987c572e"><span class="cl-987c2f6a">NotInterested</span></p></td><td class="cl-987ca0ee"><p class="cl-987c5742"><span class="cl-987c2f6a">61.86</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-987ca0f9"><p class="cl-987c572e"><span class="cl-987c2f6a">Relationship</span></p></td><td class="cl-987ca0f0"><p class="cl-987c572e"><span class="cl-987c2f6a">NotInterested</span></p></td><td class="cl-987ca0f8"><p class="cl-987c5742"><span class="cl-987c2f6a">48.47</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-987ca0ef"><p class="cl-987c572e"><span class="cl-987c2f6a">Relationship</span></p></td><td class="cl-987ca0e4"><p class="cl-987c572e"><span class="cl-987c2f6a">NotInterested</span></p></td><td class="cl-987ca0ee"><p class="cl-987c5742"><span class="cl-987c2f6a">32.79</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-987ca0f9"><p class="cl-987c572e"><span class="cl-987c2f6a">Relationship</span></p></td><td class="cl-987ca0f0"><p class="cl-987c572e"><span class="cl-987c2f6a">NotInterested</span></p></td><td class="cl-987ca0f8"><p class="cl-987c5742"><span class="cl-987c2f6a">35.91</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-987ca0ef"><p class="cl-987c572e"><span class="cl-987c2f6a">Relationship</span></p></td><td class="cl-987ca0e4"><p class="cl-987c572e"><span class="cl-987c2f6a">NotInterested</span></p></td><td class="cl-987ca0ee"><p class="cl-987c5742"><span class="cl-987c2f6a">30.98</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-987ca0f9"><p class="cl-987c572e"><span class="cl-987c2f6a">Relationship</span></p></td><td class="cl-987ca0f0"><p class="cl-987c572e"><span class="cl-987c2f6a">NotInterested</span></p></td><td class="cl-987ca0f8"><p class="cl-987c5742"><span class="cl-987c2f6a">44.82</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-987ca0ef"><p class="cl-987c572e"><span class="cl-987c2f6a">Relationship</span></p></td><td class="cl-987ca0e4"><p class="cl-987c572e"><span class="cl-987c2f6a">NotInterested</span></p></td><td class="cl-987ca0ee"><p class="cl-987c5742"><span class="cl-987c2f6a">35.05</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-987ca0f9"><p class="cl-987c572e"><span class="cl-987c2f6a">Relationship</span></p></td><td class="cl-987ca0f0"><p class="cl-987c572e"><span class="cl-987c2f6a">NotInterested</span></p></td><td class="cl-987ca0f8"><p class="cl-987c5742"><span class="cl-987c2f6a">64.49</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-987ca0ef"><p class="cl-987c572e"><span class="cl-987c2f6a">Relationship</span></p></td><td class="cl-987ca0e4"><p class="cl-987c572e"><span class="cl-987c2f6a">NotInterested</span></p></td><td class="cl-987ca0ee"><p class="cl-987c5742"><span class="cl-987c2f6a">54.50</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-987ca0f9"><p class="cl-987c572e"><span class="cl-987c2f6a">Relationship</span></p></td><td class="cl-987ca0f0"><p class="cl-987c572e"><span class="cl-987c2f6a">NotInterested</span></p></td><td class="cl-987ca0f8"><p class="cl-987c5742"><span class="cl-987c2f6a">61.48</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-987ca104"><p class="cl-987c572e"><span class="cl-987c2f6a">Relationship</span></p></td><td class="cl-987ca103"><p class="cl-987c572e"><span class="cl-987c2f6a">NotInterested</span></p></td><td class="cl-987ca102"><p class="cl-987c5742"><span class="cl-987c2f6a">55.51</span></p></td></tr></tbody></table></div></template>
<div class="flextable-shadow-host" id="9d5e2412-b5ed-4445-ad19-9520bfdd0b3f"></div>
<script>
var dest = document.getElementById("9d5e2412-b5ed-4445-ad19-9520bfdd0b3f");
var template = document.getElementById("bcfc4cd4-24dc-47de-adaf-897627898e3c");
var caption = template.content.querySelector("caption");
if(caption) {
  caption.style.cssText = "display:block;text-align:center;";
  var newcapt = document.createElement("p");
  newcapt.appendChild(caption)
  dest.parentNode.insertBefore(newcapt, dest.previousSibling);
}
var fantome = dest.attachShadow({mode: 'open'});
var templateContent = template.content;
fantome.appendChild(templateContent);
</script>

<p>The data set consist of three variables stored in three columns. The
first column contains the relationship status of the present giver (in
this study this were men), the second whether the man is interested in
the woman (the present receiver in this study), and the third column
represents the money spend on the present. The data set represents 100
cases and the mean amount of money spend on a present is 88.38 dollars.
In a next step, we visualize the data to get a more detailed impression
of the relationships between variables.</p>
<pre class="r"><code># create plots
p1 &lt;- ggplot(mlrdata, aes(status, money)) +
  geom_boxplot() + 
  theme_bw()
# plot 2
p2 &lt;- ggplot(mlrdata, aes(attraction, money)) +
  geom_boxplot() +
  theme_bw()
# plot 3
p3 &lt;- ggplot(mlrdata, aes(x = money)) +
  geom_histogram(aes(y=..density..)) +            
  theme_bw() +         
  geom_density(alpha=.2, fill = &quot;gray50&quot;) 
# plot 4
p4 &lt;- ggplot(mlrdata, aes(status, money)) +
  geom_boxplot(aes(fill = factor(status))) + 
  scale_fill_manual(values = c(&quot;grey30&quot;, &quot;grey70&quot;)) + 
  facet_wrap(~ attraction) + 
  guides(fill = &quot;none&quot;) +
  theme_bw()
# show plots
vip::grid.arrange(grobs = list(p1, p2, p3, p4), widths = c(1, 1), layout_matrix = rbind(c(1, 2), c(3, 4)))</code></pre>
<p><img src="multireg_files/figure-html/mlr3-1.png" width="672" /></p>
<p>The upper left figure consists of a boxplot which shows how much
money was spent by relationship status. The figure suggests that men
spend more on women if they are not in a relationship. The next figure
shows the relationship between the money spend on presents and whether
or not the men were interested in the women.</p>
<p>The boxplot in the upper right panel suggests that men spend
substantially more on women if the men are interested in them. The next
figure depicts the distribution of the amounts of money spend on the
presents for the women. In addition, the figure indicates the existence
of two outliers (dots in the boxplot)</p>
<p>The histogram in the lower left panel shows that, although the mean
amount of money spent on presents is 88.38 dollars, the distribution
peaks around 50 dollars indicating that on average, men spend about 50
dollars on presents. Finally, we will plot the amount of money spend on
presents against relationship status by attraction in order to check
whether the money spent on presents is affected by an interaction
between attraction and relationship status.</p>
<p>The boxplot in the lower right panel confirms the existence of an
interaction (a non-additive term) as men only spend more money on women
if the men single <em>and</em> they are interested in the women. If men
are not interested in the women, then the relationship has no effect as
they spend an equal amount of money on the women regardless of whether
they are in a relationship or not.</p>
<p>We will now start to implement the regression model. In a first step,
we create two saturated models that contain all possible predictors
(main effects and interactions). The two models are identical but one is
generated with the <code>lm</code> and the other with the
<code>glm</code> function as these functions offer different model
parameters in their output.</p>
<pre class="r"><code>m1.mlr = lm(                      # generate lm regression object
  money ~ 1 + attraction*status,  # def. regression formula (1 = intercept)
  data = mlrdata)                 # def. data
m1.glm = glm(                     # generate glm regression object
  money ~ 1 + attraction*status,  # def. regression formula (1 = intercept)
  family = gaussian,              # def. linkage function
  data = mlrdata)                 # def. data</code></pre>
<p>After generating the saturated models we can now start with the model
fitting. Model fitting refers to a process that aims at find the model
that explains a maximum of variance with a minimum of predictors <span
class="citation">(see <a href="#ref-field2012discovering"
role="doc-biblioref">Field, Miles, and Field 2012, 318</a>)</span>.
Model fitting is therefore based on the <em>principle of parsimony</em>
which is related to Occam’s razor according to which explanations that
require fewer assumptions are more likely to be true.</p>
</div>
<div id="automatic-model-fitting-and-why-you-should-not-use-it"
class="section level3 unnumbered">
<h3 class="unnumbered">Automatic Model Fitting and Why You Should Not
Use It</h3>
<p>In this section, we will use a step-wise step-down procedure that
uses decreases in AIC (<em>Akaike Information Criterion</em>) as the
criterion to minimize the model in a step-wise manner. This procedure
aims at finding the model with the lowest AIC values by evaluating -
step-by-step - whether the removal of a predictor (term) leads to a
lower AIC value.</p>
<p>We use this method here just so that you know it exists and how to
implement it but you should rather avoid using automated model fitting.
The reason for avoiding automated model fitting is that the algorithm
only checks if the AIC has decreased but not if the model is stable or
reliable. Thus, automated model fitting has the problem that you can
never be sure that the way that lead you to the final model is reliable
and that all models were indeed stable. Imagine you want to climb down
from a roof top and you have a ladder. The problem is that you do not
know if and how many steps are broken. This is similar to using
automated model fitting. In other sections, we will explore better
methods to fit models (manual step-wise step-up and step-down
procedures, for example).</p>
<p>The AIC is calculated using the equation below. The lower the AIC
value, the better the balance between explained variance and the number
of predictors. AIC values can and should only be compared for models
that are fit on the same data set with the same (number of) cases
(<em>LL</em> stands for <em>logged likelihood</em> or
<em>LogLikelihood</em> and <em>k</em> represents the number of
predictors in the model (including the intercept); the LL represents a
measure of how good the model fits the data).</p>
<p><span class="math display">\[\begin{equation}
Akaike Information Criterion (AIC) = -2LL + 2k
\end{equation}\]</span></p>
<p>An alternative to the AIC is the BIC (Bayesian Information
Criterion). Both AIC and BIC penalize models for including variables in
a model. The penalty of the BIC is bigger than the penalty of the AIC
and it includes the number of cases in the model (<em>LL</em> stands for
<em>logged likelihood</em> or <em>LogLikelihood</em>, <em>k</em>
represents the number of predictors in the model (including the
intercept), and <em>N</em> represents the number of cases in the
model).</p>
<p><span class="math display">\[\begin{equation}
Bayesian Information Criterion (BIC) = -2LL + 2k * log(N)
\end{equation}\]</span></p>
<p>Interactions are evaluated first and only if all insignificant
interactions have been removed would the procedure start removing
insignificant main effects (that are not part of significant
interactions). Other model fitting procedures (forced entry, step-wise
step up, hierarchical) are discussed during the implementation of other
regression models. We cannot discuss all procedures here as model
fitting is rather complex and a discussion of even the most common
procedures would to lengthy and time consuming at this point. It is
important to note though that there is not perfect model fitting
procedure and automated approaches should be handled with care as they
are likely to ignore violations of model parameters that can be detected
during manual - but time consuming - model fitting procedures. As a
general rule of thumb, it is advisable to fit models as carefully and
deliberately as possible. We will now begin to fit the model.</p>
<pre class="r"><code># automated AIC based model fitting
step(m1.mlr, direction = &quot;both&quot;)</code></pre>
<pre><code>## Start:  AIC=592.52
## money ~ 1 + attraction * status
## 
##                     Df   Sum of Sq         RSS         AIC
## &lt;none&gt;                             34557.56428 592.5211556
## - attraction:status  1 24947.25481 59504.81909 644.8642395</code></pre>
<pre><code>## 
## Call:
## lm(formula = money ~ 1 + attraction * status, data = mlrdata)
## 
## Coefficients:
##                          (Intercept)               attractionNotInterested  
##                              99.1548                              -47.6628  
##                         statusSingle  attractionNotInterested:statusSingle  
##                              57.6928                              -63.1788</code></pre>
<p>The automated model fitting procedure informs us that removing
predictors has not caused a decrease in the AIC. The saturated model is
thus also the final minimal adequate model. We will now inspect the
final minimal model and go over the model report.</p>
<pre class="r"><code>m2.mlr = lm(                       # generate lm regression object
  money ~ (status + attraction)^2, # def. regression formula
  data = mlrdata)                  # def. data
m2.glm = glm(                      # generate glm regression object
  money ~ (status + attraction)^2, # def. regression formula
  family = gaussian,               # def. linkage function
  data = mlrdata)                  # def. data
# inspect final minimal model
summary(m2.mlr)</code></pre>
<pre><code>## 
## Call:
## lm(formula = money ~ (status + attraction)^2, data = mlrdata)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -45.0760 -14.2580   0.4596  11.9315  44.1424 
## 
## Coefficients:
##                                          Estimate   Std. Error  t value
## (Intercept)                           99.15480000   3.79459947 26.13050
## statusSingle                          57.69280000   5.36637403 10.75080
## attractionNotInterested              -47.66280000   5.36637403 -8.88175
## statusSingle:attractionNotInterested -63.17880000   7.58919893 -8.32483
##                                                    Pr(&gt;|t|)    
## (Intercept)                          &lt; 0.000000000000000222 ***
## statusSingle                         &lt; 0.000000000000000222 ***
## attractionNotInterested                 0.00000000000003751 ***
## statusSingle:attractionNotInterested    0.00000000000058085 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 18.9729973 on 96 degrees of freedom
## Multiple R-squared:  0.852041334,    Adjusted R-squared:  0.847417626 
## F-statistic: 184.276619 on 3 and 96 DF,  p-value: &lt; 0.0000000000000002220446</code></pre>
<p>The first element of the report is called <em>Call</em> and it
reports the regression formula of the model. Then, the report provides
the residual distribution (the range, median and quartiles of the
residuals) which allows drawing inferences about the distribution of
differences between observed and expected values. If the residuals are
distributed non-normally, then this is a strong indicator that the model
is unstable and unreliable because mathematical assumptions on which the
model is based are violated.</p>
<p>Next, the model summary reports the most important part: a table with
model statistics of the fixed-effects structure of the model. The table
contains the estimates (coefficients of the predictors), standard
errors, t-values, and the p-values which show whether a predictor
significantly correlates with the dependent variable that the model
investigates.</p>
<p>All main effects (status and attraction) as well as the interaction
between status and attraction is reported as being significantly
correlated with the dependent variable (money). An interaction occurs if
a correlation between the dependent variable and a predictor is affected
by another predictor.</p>
<p>The top most term is called intercept and has a value of 99.15 which
represents the base estimate to which all other estimates refer. To
exemplify what this means, let us consider what the model would predict
that a man would spend on a present if he interested in the woman but he
is also in a relationship. The amount he would spend (based on the model
would be 99.15 dollars (which is the intercept). This means that the
intercept represents the predicted value if all predictors take the base
or reference level. And since being in relationship but being interested
are the case, and because the interaction does not apply, the predicted
value in our example is exactly the intercept (see below).</p>
<pre class="r"><code>#intercept  Single  NotInterested  Single:NotInterested
99.15     + 57.69  + 0           + 0     # 156.8 single + interested</code></pre>
<pre><code>## [1] 156.84</code></pre>
<pre class="r"><code>99.15     + 57.69  - 47.66       - 63.18 # 46.00 single + not interested</code></pre>
<pre><code>## [1] 46</code></pre>
<pre class="r"><code>99.15     - 0      + 0           - 0     # 99.15 relationship + interested</code></pre>
<pre><code>## [1] 99.15</code></pre>
<pre class="r"><code>99.15     - 0      - 47.66       - 0     # 51.49 relationship + not interested</code></pre>
<pre><code>## [1] 51.49</code></pre>
<p>Now, let us consider what a man would spend if he is in a
relationship and he is not attracted to the women. In that case, the
model predicts that the man would spend only 51.49 dollars on a present:
the intercept (99.15) minus 47.66 because the man is not interested (and
no additional subtraction because the interaction does not apply).</p>
<p>We can derive the same results easier using the <code>predict</code>
function.</p>
<pre class="r"><code># make prediction based on the model for original data
prediction &lt;- predict(m2.mlr, newdata = mlrdata)
# inspect predictions
table(round(prediction,2))</code></pre>
<pre><code>## 
##  46.01  51.49  99.15 156.85 
##     25     25     25     25</code></pre>
<p>Below the table of coefficients, the regression summary reports model
statistics that provide information about how well the model performs.
The difference between the values and the values in the coefficients
table is that the model statistics refer to the model as a whole rather
than focusing on individual predictors.</p>
<p>The multiple R<sup>2</sup>-value is a measure of how much variance
the model explains. A multiple R<sup>2</sup>-value of 0 would inform us
that the model does not explain any variance while a value of .852 mean
that the model explains 85.2 percent of the variance. A value of 1 would
inform us that the model explains 100 percent of the variance and that
the predictions of the model match the observed values perfectly.
Multiplying the multiple R<sup>2</sup>-value thus provides the
percentage of explained variance. Models that have a multiple
R<sup>2</sup>-value equal or higher than .05 are deemed substantially
significant <span class="citation">(see <a
href="#ref-szmrecsanyi2006morphosyntactic"
role="doc-biblioref">Szmrecsanyi 2006, 55</a>)</span>. It has been
claimed that models should explain a minimum of 5 percent of variance
but this is problematic as it is not uncommon for models to have very
low explanatory power while still performing significantly and
systematically better than chance. In addition, the total amount of
variance is negligible in cases where one is interested in very weak but
significant effects. It is much more important for model to perform
significantly better than minimal base-line models because if this is
not the case, then the model does not have any predictive and therefore
no explanatory power.</p>
<p>The adjusted R<sup>2</sup>-value considers the amount of explained
variance in light of the number of predictors in the model (it is thus
somewhat similar to the AIC and BIC) and informs about how well the
model would perform if it were applied to the population that the sample
is drawn from. Ideally, the difference between multiple and adjusted
R<sup>2</sup>-value should be very small as this means that the model is
not overfitted. If, however, the difference between multiple and
adjusted R<sup>2</sup>-value is substantial, then this would strongly
suggest that the model is unstable and overfitted to the data while
being inadequate for drawing inferences about the population.
Differences between multiple and adjusted R<sup>2</sup>-values indicate
that the data contains outliers that cause the distribution of the data
on which the model is based to differ from the distributions that the
model mathematically requires to provide reliable estimates. The
difference between multiple and adjusted R<sup>2</sup>-value in our
model is very small (85.2-84.7=.05) and should not cause concern.</p>
<p>Before continuing, we will calculate the confidence intervals of the
coefficients.</p>
<pre class="r"><code># extract confidence intervals of the coefficients
confint(m2.mlr)</code></pre>
<pre><code>##                                               2.5 %         97.5 %
## (Intercept)                           91.6225795890 106.6870204110
## statusSingle                          47.0406317400  68.3449682600
## attractionNotInterested              -58.3149682600 -37.0106317400
## statusSingle:attractionNotInterested -78.2432408219 -48.1143591781</code></pre>
<pre class="r"><code># create and compare baseline- and minimal adequate model
m0.mlr &lt;- lm(money ~1, data = mlrdata)
anova(m0.mlr, m2.mlr)</code></pre>
<pre><code>## Analysis of Variance Table
## 
## Model 1: money ~ 1
## Model 2: money ~ (status + attraction)^2
##   Res.Df          RSS Df   Sum of Sq         F                 Pr(&gt;F)    
## 1     99 233562.28650                                                    
## 2     96  34557.56428  3 199004.7222 184.27662 &lt; 0.000000000000000222 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>Now, we compare the final minimal adequate model to the base-line
model to test whether then final model significantly outperforms the
baseline model.</p>
<pre class="r"><code># compare baseline- and minimal adequate model
Anova(m0.mlr, m2.mlr, type = &quot;III&quot;)</code></pre>
<pre><code>## Anova Table (Type III tests)
## 
## Response: money
##                  Sum Sq Df    F value                 Pr(&gt;F)    
## (Intercept) 781015.8300  1 2169.64133 &lt; 0.000000000000000222 ***
## Residuals    34557.5643 96                                      
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>The comparison between the two model confirms that the minimal
adequate model performs significantly better (makes significantly more
accurate estimates of the outcome variable) compared with the baseline
model.</p>
</div>
<div id="outlier-detection" class="section level3 unnumbered">
<h3 class="unnumbered">Outlier Detection</h3>
<p>After implementing the multiple regression, we now need to look for
outliers and perform the model diagnostics by testing whether removing
data points disproportionately decreases model fit. To begin with, we
generate diagnostic plots.</p>
<pre class="r"><code># generate plots
autoplot(m2.mlr) + 
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank()) +
  theme_bw()</code></pre>
<p><img src="multireg_files/figure-html/mlr11-1.png" width="672" /></p>
<p>The plots do not show severe problems such as funnel shaped patterns
or drastic deviations from the diagonal line in Normal Q-Q plot (have a
look at the explanation of what to look for and how to interpret these
diagnostic plots in the section on simple linear regression) but data
points 52, 64, and 83 are repeatedly indicated as potential
outliers.</p>
<pre class="r"><code># determine a cutoff for data points that have D-values higher than 4/(n-k-1)
cutoff &lt;- 4/((nrow(mlrdata)-length(m2.mlr$coefficients)-2))
# start plotting
par(mfrow = c(1, 2))           # display plots in 3 rows/2 columns
qqPlot(m2.mlr, main=&quot;QQ Plot&quot;) # create qq-plot</code></pre>
<pre><code>## [1] 52 83</code></pre>
<pre class="r"><code>plot(m2.mlr, which=4, cook.levels = cutoff); par(mfrow = c(1, 1))</code></pre>
<p><img src="multireg_files/figure-html/mlr12-1.png" width="672" /></p>
<p>The graphs indicate that data points 52, 64, and 83 may be
problematic. We will therefore statistically evaluate whether these data
points need to be removed. In order to find out which data points
require removal, we extract the influence measure statistics and add
them to out data set.</p>
<pre class="r"><code># extract influence statistics
infl &lt;- influence.measures(m2.mlr)
# add infl. statistics to data
mlrdata &lt;- data.frame(mlrdata, infl[[1]], infl[[2]])
# annotate too influential data points
remove &lt;- apply(infl$is.inf, 1, function(x) {
  ifelse(x == TRUE, return(&quot;remove&quot;), return(&quot;keep&quot;)) } )
# add annotation to data
mlrdata &lt;- data.frame(mlrdata, remove)
# number of rows before removing outliers
nrow(mlrdata)</code></pre>
<pre><code>## [1] 100</code></pre>
<pre class="r"><code># remove outliers
mlrdata &lt;- mlrdata[mlrdata$remove == &quot;keep&quot;, ]
# number of rows after removing outliers
nrow(mlrdata)</code></pre>
<pre><code>## [1] 98</code></pre>
<p>The difference in row in the data set before and after removing data
points indicate that two data points which represented outliers have
been removed.</p>
<div class="warning"
style="padding:0.1em; background-color:#f2f2f2; color:#51247a">
<span>
<p style="margin-top:1em; text-align:center">
<b>NOTE</b><br><br>In general, outliers should not simply be removed
unless there are good reasons for it (this could be that the outliers
represent measurement errors). If a data set contains outliers, one
should rather switch to methods that are better at handling outliers,
e.g. by using weights to account for data points with high leverage. One
alternative would be to switch to a robust regression (see <a
href="https://slcladal.github.io/regression.html#16_Robust_Regression">here</a>).
However, here we show how to proceed by removing outliers as this is a
common, though potentially problematic, method of dealing with outliers.
</p>
<p style="margin-left:1em;">
</p>
<p></span></p>
</div>
<p><br></p>
</div>
<div id="rerun-regression" class="section level3 unnumbered">
<h3 class="unnumbered">Rerun Regression</h3>
<p>As we have decided to remove the outliers which means that we are now
dealing with a different data set, we need to rerun the regression
analysis. As the steps are identical to the regression analysis
performed above, the steps will not be described in greater detail.</p>
<pre class="r"><code># recreate regression models on new data
m0.mlr = lm(money ~ 1, data = mlrdata)
m0.glm = glm(money ~ 1, family = gaussian, data = mlrdata)
m1.mlr = lm(money ~ (status + attraction)^2, data = mlrdata)
m1.glm = glm(money ~ status * attraction, family = gaussian,
             data = mlrdata)
# automated AIC based model fitting
step(m1.mlr, direction = &quot;both&quot;)</code></pre>
<pre><code>## Start:  AIC=570.29
## money ~ (status + attraction)^2
## 
##                     Df   Sum of Sq         RSS         AIC
## &lt;none&gt;                             30411.31714 570.2850562
## - status:attraction  1 21646.86199 52058.17914 620.9646729</code></pre>
<pre><code>## 
## Call:
## lm(formula = money ~ (status + attraction)^2, data = mlrdata)
## 
## Coefficients:
##                          (Intercept)                          statusSingle  
##                           99.1548000                            55.8535333  
##              attractionNotInterested  statusSingle:attractionNotInterested  
##                          -47.6628000                           -59.4613667</code></pre>
<pre class="r"><code># create new final models
m2.mlr = lm(money ~ (status + attraction)^2, data = mlrdata)
m2.glm = glm(money ~ status * attraction, family = gaussian,
             data = mlrdata)
# inspect final minimal model
summary(m2.mlr)</code></pre>
<pre><code>## 
## Call:
## lm(formula = money ~ (status + attraction)^2, data = mlrdata)
## 
## Residuals:
##          Min           1Q       Median           3Q          Max 
## -35.76416667 -13.50520000  -0.98948333  10.59887500  38.77166667 
## 
## Coefficients:
##                                          Estimate   Std. Error  t value
## (Intercept)                           99.15480000   3.59735820 27.56323
## statusSingle                          55.85353333   5.14015367 10.86612
## attractionNotInterested              -47.66280000   5.08743275 -9.36873
## statusSingle:attractionNotInterested -59.46136667   7.26927504 -8.17982
##                                                    Pr(&gt;|t|)    
## (Intercept)                          &lt; 0.000000000000000222 ***
## statusSingle                         &lt; 0.000000000000000222 ***
## attractionNotInterested               0.0000000000000040429 ***
## statusSingle:attractionNotInterested  0.0000000000013375166 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 17.986791 on 94 degrees of freedom
## Multiple R-squared:  0.857375902,    Adjusted R-squared:  0.852824069 
## F-statistic: 188.358387 on 3 and 94 DF,  p-value: &lt; 0.0000000000000002220446</code></pre>
<pre class="r"><code># extract confidence intervals of the coefficients
confint(m2.mlr)</code></pre>
<pre><code>##                                               2.5 %         97.5 %
## (Intercept)                           92.0121609656 106.2974390344
## statusSingle                          45.6476377202  66.0594289465
## attractionNotInterested              -57.7640169936 -37.5615830064
## statusSingle:attractionNotInterested -73.8946826590 -45.0280506744</code></pre>
<pre class="r"><code># compare baseline with final model
anova(m0.mlr, m2.mlr)</code></pre>
<pre><code>## Analysis of Variance Table
## 
## Model 1: money ~ 1
## Model 2: money ~ (status + attraction)^2
##   Res.Df          RSS Df   Sum of Sq         F                 Pr(&gt;F)    
## 1     97 213227.06081                                                    
## 2     94  30411.31714  3 182815.7437 188.35839 &lt; 0.000000000000000222 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<pre class="r"><code># compare baseline with final model
Anova(m0.mlr, m2.mlr, type = &quot;III&quot;)</code></pre>
<pre><code>## Anova Table (Type III tests)
## 
## Response: money
##                  Sum Sq Df    F value                 Pr(&gt;F)    
## (Intercept) 760953.2107  1 2352.07181 &lt; 0.000000000000000222 ***
## Residuals    30411.3171 94                                      
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
</div>
<div id="additional-model-diagnostics"
class="section level3 unnumbered">
<h3 class="unnumbered">Additional Model Diagnostics</h3>
<p>After rerunning the regression analysis on the updated data set, we
again create diagnostic plots in order to check whether there are
potentially problematic data points.</p>
<pre class="r"><code># generate plots
autoplot(m2.mlr) + 
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank()) +
  theme_bw()</code></pre>
<p><img src="multireg_files/figure-html/mlr19-1.png" width="672" /></p>
<pre class="r"><code># determine a cutoff for data points that have
# D-values higher than 4/(n-k-1)
cutoff &lt;- 4/((nrow(mlrdata)-length(m2.mlr$coefficients)-2))
# start plotting
par(mfrow = c(1, 2))           # display plots in 1 row/2 columns
qqPlot(m2.mlr, main=&quot;QQ Plot&quot;) # create qq-plot</code></pre>
<pre><code>## 84 88 
## 82 86</code></pre>
<pre class="r"><code>plot(m2.mlr, which=4, cook.levels = cutoff); par(mfrow = c(1, 1))</code></pre>
<p><img src="multireg_files/figure-html/mlr20-1.png" width="672" /></p>
<p>Although the diagnostic plots indicate that additional points may be
problematic, but these data points deviate substantially less from the
trend than was the case with the data points that have already been
removed. To make sure that retaining the data points that are deemed
potentially problematic by the diagnostic plots, is acceptable, we
extract diagnostic statistics and add them to the data.</p>
<pre class="r"><code># add model diagnostics to the data
mlrdata &lt;- mlrdata %&gt;%
  dplyr::mutate(residuals = resid(m2.mlr),
                standardized.residuals = rstandard(m2.mlr),
                studentized.residuals = rstudent(m2.mlr),
                cooks.distance = cooks.distance(m2.mlr),
                dffit = dffits(m2.mlr),
                leverage = hatvalues(m2.mlr),
                covariance.ratios = covratio(m2.mlr),
                fitted = m2.mlr$fitted.values)</code></pre>
<p>We can now use these diagnostic statistics to create more precise
diagnostic plots.</p>
<pre class="r"><code># plot 5
p5 &lt;- ggplot(mlrdata,
             aes(studentized.residuals)) +
  theme(legend.position = &quot;none&quot;)+
  geom_histogram(aes(y=..density..),
                 binwidth = .2,
                 colour=&quot;black&quot;,
                 fill=&quot;gray90&quot;) +
  labs(x = &quot;Studentized Residual&quot;, y = &quot;Density&quot;) +
  stat_function(fun = dnorm,
                args = list(mean = mean(mlrdata$studentized.residuals, na.rm = TRUE),
                            sd = sd(mlrdata$studentized.residuals, na.rm = TRUE)),
                colour = &quot;red&quot;, size = 1) +
  theme_bw(base_size = 8)
# plot 6
p6 &lt;- ggplot(mlrdata, aes(fitted, studentized.residuals)) +
  geom_point() +
  geom_smooth(method = &quot;lm&quot;, colour = &quot;Red&quot;)+
  theme_bw(base_size = 8)+
  labs(x = &quot;Fitted Values&quot;,
       y = &quot;Studentized Residual&quot;)
# plot 7
p7 &lt;- qplot(sample = mlrdata$studentized.residuals, stat=&quot;qq&quot;) +
  theme_bw(base_size = 8) +
  labs(x = &quot;Theoretical Values&quot;,
       y = &quot;Observed Values&quot;)
vip::grid.arrange(p5, p6, p7, nrow = 1)</code></pre>
<p><img src="multireg_files/figure-html/mlr22-1.png" width="672" /></p>
<p>The new diagnostic plots do not indicate outliers that require
removal. With respect to such data points the following parameters
should be considered:</p>
<ol style="list-style-type: decimal">
<li><p>Data points with standardized residuals &gt; 3.29 should be
removed <span class="citation">(<a href="#ref-field2012discovering"
role="doc-biblioref">Field, Miles, and Field 2012,
269</a>)</span></p></li>
<li><p>If more than 1 percent of data points have standardized residuals
exceeding values &gt; 2.58, then the error rate of the model is
unacceptable <span class="citation">(<a href="#ref-field2012discovering"
role="doc-biblioref">Field, Miles, and Field 2012,
269</a>)</span>.</p></li>
<li><p>If more than 5 percent of data points have standardized residuals
exceeding values &gt; 1.96, then the error rate of the model is
unacceptable <span class="citation">(<a href="#ref-field2012discovering"
role="doc-biblioref">Field, Miles, and Field 2012,
269</a>)</span></p></li>
<li><p>In addition, data points with Cook’s D-values &gt; 1 should be
removed <span class="citation">(<a href="#ref-field2012discovering"
role="doc-biblioref">Field, Miles, and Field 2012,
269</a>)</span></p></li>
<li><p>Also, data points with leverage values higher than <span
class="math inline">\(3(k + 1)/N\)</span> or <span
class="math inline">\(2(k + 1)/N\)</span> (k = Number of predictors, N =
Number of cases in model) should be removed <span class="citation">(<a
href="#ref-field2012discovering" role="doc-biblioref">Field, Miles, and
Field 2012, 270</a>)</span></p></li>
<li><p>There should not be (any) autocorrelation among predictors. This
means that independent variables cannot be correlated with itself (for
instance, because data points come from the same subject). If there is
autocorrelation among predictors, then a Repeated Measures Design or a
(hierarchical) mixed-effects model should be implemented
instead.</p></li>
<li><p>Predictors cannot substantially correlate with each other
(multicollinearity) (see the <a
href="https://slcladal.github.io/regression.html#Multicollinearity">subsection
on (multi-)collinearity</a> in the section of multiple binomial logistic
regression for more details about (multi-)collinearity). If a model
contains predictors that have variance inflation factors (VIF) &gt; 10
the model is unreliable <span class="citation">(<a
href="#ref-myers1990classical" role="doc-biblioref">Myers
1990</a>)</span> and predictors causing such VIFs should be removed.
Indeed, even VIFs of 2.5 can be problematic <span class="citation">(<a
href="#ref-szmrecsanyi2006morphosyntactic"
role="doc-biblioref">Szmrecsanyi 2006, 215</a>)</span> Indeed, <span
class="citation">Zuur, Ieno, and Elphick (<a
href="#ref-zuur2010protocol" role="doc-biblioref">2010</a>)</span>
propose that variables with VIFs exceeding 3 should be removed!</p></li>
</ol>
<div class="warning"
style="padding:0.1em; background-color:#f2f2f2; color:#51247a">
<span>
<p style="margin-top:1em; text-align:center">
<b>NOTE</b><br><br>However, (multi-)collinearity is only an issue if one
is interested in interpreting regression results! If the interpretation
is irrelevant because what is relevant is prediction(!), then it does
not matter if the model contains collinear predictors! See <span
class="citation">Gries (<a href="#ref-gries2021statistics"
role="doc-biblioref">2021</a>)</span> for a more elaborate explanation.
</p>
<p style="margin-left:1em;">
</p>
<p></span></p>
</div>
<p><br></p>
<ol start="8" style="list-style-type: decimal">
<li>The mean value of VIFs should be ~ 1 <span class="citation">(<a
href="#ref-bowerman1990linear" role="doc-biblioref">Bowerman and
O’Connell 1990</a>)</span>.</li>
</ol>
<p>The following code chunk evaluates these criteria.</p>
<pre class="r"><code># 1: optimal = 0
# (listed data points should be removed)
which(mlrdata$standardized.residuals &gt; 3.29)</code></pre>
<pre><code>## named integer(0)</code></pre>
<pre class="r"><code># 2: optimal = 1
# (listed data points should be removed)
stdres_258 &lt;- as.vector(sapply(mlrdata$standardized.residuals, function(x) {
ifelse(sqrt((x^2)) &gt; 2.58, 1, 0) } ))
(sum(stdres_258) / length(stdres_258)) * 100</code></pre>
<pre><code>## [1] 0</code></pre>
<pre class="r"><code># 3: optimal = 5
# (listed data points should be removed)
stdres_196 &lt;- as.vector(sapply(mlrdata$standardized.residuals, function(x) {
ifelse(sqrt((x^2)) &gt; 1.96, 1, 0) } ))
(sum(stdres_196) / length(stdres_196)) * 100</code></pre>
<pre><code>## [1] 6.12244897959</code></pre>
<pre class="r"><code># 4: optimal = 0
# (listed data points should be removed)
which(mlrdata$cooks.distance &gt; 1)</code></pre>
<pre><code>## named integer(0)</code></pre>
<pre class="r"><code># 5: optimal = 0
# (data points should be removed if cooks distance is close to 1)
which(mlrdata$leverage &gt;= (3*mean(mlrdata$leverage)))</code></pre>
<pre><code>## named integer(0)</code></pre>
<pre class="r"><code># 6: checking autocorrelation:
# Durbin-Watson test (optimal: high p-value)
dwt(m2.mlr)</code></pre>
<pre><code>##  lag  Autocorrelation D-W Statistic p-value
##    1 -0.0143324675649  1.9680423527   0.678
##  Alternative hypothesis: rho != 0</code></pre>
<pre class="r"><code># 7: test multicollinearity 1
vif(m2.mlr)</code></pre>
<pre><code>##                         statusSingle              attractionNotInterested 
##                                 2.00                                 1.96 
## statusSingle:attractionNotInterested 
##                                 2.96</code></pre>
<pre class="r"><code># 8: test multicollinearity 2
1/vif(m2.mlr)</code></pre>
<pre><code>##                         statusSingle              attractionNotInterested 
##                       0.500000000000                       0.510204081633 
## statusSingle:attractionNotInterested 
##                       0.337837837838</code></pre>
<pre class="r"><code># 9: mean vif should not exceed 1
mean(vif(m2.mlr))</code></pre>
<pre><code>## [1] 2.30666666667</code></pre>
<p>Except for the mean VIF value (2.307) which should not exceed 1, all
diagnostics are acceptable. We will now test whether the sample size is
sufficient for our model. With respect to the minimal sample size and
based on <span class="citation">Green (<a href="#ref-green1991many"
role="doc-biblioref">1991</a>)</span>, <span class="citation">Field,
Miles, and Field (<a href="#ref-field2012discovering"
role="doc-biblioref">2012, 273–74</a>)</span> offer the following rules
of thumb for an adequate sample size (k = number of predictors;
categorical predictors with more than two levels should be recoded as
dummy variables):</p>
<ul>
<li><p>if you are interested in the overall model: 50 + 8k (k = number
of predictors)</p></li>
<li><p>if you are interested in individual predictors: 104 + k</p></li>
<li><p>if you are interested in both: take the higher value!</p></li>
</ul>
</div>
<div id="evaluation-of-sample-size" class="section level3 unnumbered">
<h3 class="unnumbered">Evaluation of Sample Size</h3>
<p>After performing the diagnostics, we will now test whether the sample
size is adequate and what the values of R would be based on a random
distribution in order to be able to estimate how likely a <span
class="math inline">\(\beta\)</span>-error is given the present sample
size <span class="citation">(see <a href="#ref-field2012discovering"
role="doc-biblioref">Field, Miles, and Field 2012, 274</a>)</span>. Beta
errors (or <span class="math inline">\(\beta\)</span>-errors) refer to
the erroneous assumption that a predictor is not significant (based on
the analysis and given the sample) although it does have an effect in
the population. In other words, <span
class="math inline">\(\beta\)</span>-error means to overlook a
significant effect because of weaknesses of the analysis. The test
statistics ranges between 0 and 1 where lower values are better. If the
values approximate 1, then there is serious concern as the model is not
reliable given the sample size. In such cases, unfortunately, the best
option is to increase the sample size.</p>
<pre class="r"><code># load functions
source(&quot;https://slcladal.github.io/rscripts/SampleSizeMLR.r&quot;)
source(&quot;https://slcladal.github.io/rscripts/ExpR.r&quot;)
# check if sample size is sufficient
smplesz(m2.mlr)</code></pre>
<pre><code>## [1] &quot;Sample too small: please increase your sample by  9  data points&quot;</code></pre>
<pre class="r"><code># check beta-error likelihood
expR(m2.mlr)</code></pre>
<pre><code>## [1] &quot;Based on the sample size expect a false positive correlation of 0.0309 between the predictors and the predicted&quot;</code></pre>
<p>The function <code>smplesz</code> reports that the sample size is
insufficient by 9 data points according to <span class="citation">Green
(<a href="#ref-green1991many" role="doc-biblioref">1991</a>)</span>. The
likelihood of <span class="math inline">\(\beta\)</span>-errors,
however, is very small (0.0309). As a last step, we summarize the
results of the regression analysis.</p>
<pre class="r"><code># tabulate model results
sjPlot::tab_model(m0.glm, m2.glm)</code></pre>
<table style="border-collapse:collapse; border:none;">
<tr>
<th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">
 
</th>
<th colspan="3" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">
money
</th>
<th colspan="3" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">
money
</th>
</tr>
<tr>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">
Predictors
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
Estimates
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
CI
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
p
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
Estimates
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
CI
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  col7">
p
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
(Intercept)
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
88.12
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
78.72 – 97.52
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
<strong>&lt;0.001</strong>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
99.15
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
92.10 – 106.21
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7">
<strong>&lt;0.001</strong>
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
status [Single]
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
55.85
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
45.78 – 65.93
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7">
<strong>&lt;0.001</strong>
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
attraction<br>[NotInterested]
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
-47.66
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
-57.63 – -37.69
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7">
<strong>&lt;0.001</strong>
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
status [Single] *<br>attraction<br>[NotInterested]
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
-59.46
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
-73.71 – -45.21
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7">
<strong>&lt;0.001</strong>
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;">
Observations
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="3">
98
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="3">
98
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
R<sup>2</sup>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">
0.000
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">
0.857
</td>
</tr>
</table>
<hr />
<div class="warning"
style="padding:0.1em; background-color:#f2f2f2; color:#51247a">
<span>
<p style="margin-top:1em; text-align:center">
<b>NOTE</b><br><br>The R<sup>2</sup> values in this report is incorrect!
As we have seen above, and is also shown in the table below, the correct
R<sup>2</sup> values are: multiple R<sup>2</sup> 0.8574, adjusted
R<sup>2</sup> 0.8528.<br>
</p>
<p style="margin-left:1em;">
</p>
<p></span></p>
</div>
<p><br></p>
<p>Additionally, we can inspect the summary of the regression model as
shown below to extract additional information.</p>
<pre class="r"><code>summary(m2.mlr)</code></pre>
<pre><code>## 
## Call:
## lm(formula = money ~ (status + attraction)^2, data = mlrdata)
## 
## Residuals:
##          Min           1Q       Median           3Q          Max 
## -35.76416667 -13.50520000  -0.98948333  10.59887500  38.77166667 
## 
## Coefficients:
##                                          Estimate   Std. Error  t value
## (Intercept)                           99.15480000   3.59735820 27.56323
## statusSingle                          55.85353333   5.14015367 10.86612
## attractionNotInterested              -47.66280000   5.08743275 -9.36873
## statusSingle:attractionNotInterested -59.46136667   7.26927504 -8.17982
##                                                    Pr(&gt;|t|)    
## (Intercept)                          &lt; 0.000000000000000222 ***
## statusSingle                         &lt; 0.000000000000000222 ***
## attractionNotInterested               0.0000000000000040429 ***
## statusSingle:attractionNotInterested  0.0000000000013375166 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 17.986791 on 94 degrees of freedom
## Multiple R-squared:  0.857375902,    Adjusted R-squared:  0.852824069 
## F-statistic: 188.358387 on 3 and 94 DF,  p-value: &lt; 0.0000000000000002220446</code></pre>
<p>Although <span class="citation">Field, Miles, and Field (<a
href="#ref-field2012discovering" role="doc-biblioref">2012</a>)</span>
suggest that the main effects of the predictors involved in the
interaction should not be interpreted, they are interpreted here to
illustrate how the results of a multiple linear regression can be
reported.</p>
<p>We can use the <code>reports</code> package <span
class="citation">(<a href="#ref-report" role="doc-biblioref">Makowski et
al. 2021</a>)</span> to summarize the analysis.</p>
<pre class="r"><code>report::report(m2.mlr)</code></pre>
<pre><code>## We fitted a linear model (estimated using OLS) to predict money with status and attraction (formula: money ~ (status + attraction)^2). The model explains a statistically significant and substantial proportion of variance (R2 = 0.86, F(3, 94) = 188.36, p &lt; .001, adj. R2 = 0.85). The model&#39;s intercept, corresponding to status = Relationship and attraction = Interested, is at 99.15 (95% CI [92.01, 106.30], t(94) = 27.56, p &lt; .001). Within this model:
## 
##   - The effect of status [Single] is statistically significant and positive (beta = 55.85, 95% CI [45.65, 66.06], t(94) = 10.87, p &lt; .001; Std. beta = 1.19, 95% CI [0.97, 1.41])
##   - The effect of attraction [NotInterested] is statistically significant and negative (beta = -47.66, 95% CI [-57.76, -37.56], t(94) = -9.37, p &lt; .001; Std. beta = -1.02, 95% CI [-1.23, -0.80])
##   - The interaction effect of attraction [NotInterested] on status [Single] is statistically significant and negative (beta = -59.46, 95% CI [-73.89, -45.03], t(94) = -8.18, p &lt; .001; Std. beta = -1.27, 95% CI [-1.58, -0.96])
## 
## Standardized parameters were obtained by fitting the model on a standardized version of the dataset. 95% Confidence Intervals (CIs) and p-values were computed using the Wald approximation.</code></pre>
<p>We can use this output to write up a final report:</p>
<p>A multiple linear regression was fitted to the data using an
automated, step-wise, AIC-based (Akaike’s Information Criterion)
procedure. The model fitting arrived at a final minimal model. During
the model diagnostics, two outliers were detected and removed. Further
diagnostics did not find other issues after the removal.</p>
<p>The final minimal adequate regression model is based on 98 data
points and performs highly significantly better than a minimal baseline
model (multiple R<sup>2</sup>: .857, adjusted R<sup>2</sup>: .853,
F-statistic (3, 94): 154.4, AIC: 850.4, BIC: 863.32, p&lt;.001<sup><span
class="math inline">\(***\)</span></sup>). The final minimal adequate
regression model reports <em>attraction</em> and <em>status</em> as
significant main effects. The relationship status of men correlates
highly significantly and positively with the amount of money spend on
the women’s presents (SE: 5.14, t-value: 10.87, p&lt;.001<sup><span
class="math inline">\(***\)</span></sup>). This shows that men spend
156.8 dollars on presents if they are single while they spend 99,15
dollars if they are in a relationship. Whether men are attracted to
women also correlates highly significantly and positively with the money
they spend on women (SE: 5.09, t-values: -9.37, p&lt;.001<sup><span
class="math inline">\(***\)</span></sup>). If men are not interested in
women, they spend 47.66 dollar less on a present for women compared with
women the men are interested in.</p>
<p>Furthermore, the final minimal adequate regression model reports a
highly significant interaction between relationship <em>status</em> and
<em>attraction</em> (SE: 7.27, t-value: -8.18, p&lt;.001<sup><span
class="math inline">\(***\)</span></sup>): If men are single but they
are not interested in a women, a man would spend only 59.46 dollars on a
present compared to all other constellations.</p>
</div>
</div>
<div id="robust-regression" class="section level2 unnumbered">
<h2 class="unnumbered">Robust Regression</h2>
<p>Robust regression represents an alternative to linear regression
models when the data contains outliers that should not be removed. As
such, robust regressions can handle overly influential data points
(outliers) and they allow us to retain outliers rather than removing
them by adding weights <span class="citation">(<a
href="#ref-rousseeuw2005robust" role="doc-biblioref">Rousseeuw and Leroy
2005</a>)</span>. Thus, robust regressions are used when there are
outliers present in the data and we can thus not use traditional models
but we do not have a good reason for removing the outliers.</p>
<blockquote>
<p>Robust regressions allow us to handle overly influential data points
(outliers) by using weights. Thus, robust regressions enable us to
retain all data points.</p>
</blockquote>
<p>We begin by loading a data set (the mlrdata set which have used for
multiple linear regression).</p>
<pre class="r"><code># load data
robustdata  &lt;- base::readRDS(url(&quot;https://slcladal.github.io/data/mld.rda&quot;, &quot;rb&quot;))</code></pre>
<template id="eec94df5-e7b2-4f54-8325-131b3440156d"><style>
.tabwid table{
  border-spacing:0px !important;
  border-collapse:collapse;
  line-height:1;
  margin-left:auto;
  margin-right:auto;
  border-width: 0;
  display: table;
  margin-top: 1.275em;
  margin-bottom: 1.275em;
  border-color: transparent;
}
.tabwid_left table{
  margin-left:0;
}
.tabwid_right table{
  margin-right:0;
}
.tabwid td {
    padding: 0;
}
.tabwid a {
  text-decoration: none;
}
.tabwid thead {
    background-color: transparent;
}
.tabwid tfoot {
    background-color: transparent;
}
.tabwid table tr {
background-color: transparent;
}
</style><div class="tabwid"><style>.cl-9cf02bf0{table-layout:auto;width:75%;}.cl-9ce67786{font-family:'Arial';font-size:12pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-9ce67790{font-family:'Arial';font-size:12pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-9ce68e88{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-9ce68e92{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-9ce6cd6c{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9ce6cd76{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9ce6cd80{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9ce6cd81{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9ce6cd8a{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9ce6cd8b{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9ce6cd94{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9ce6cd9e{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9ce6cd9f{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9ce6cda8{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9ce6cda9{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9ce6cdb2{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table class='cl-9cf02bf0'>
<caption class="Table Caption">
<p>First 15 rows of the robustdata.</p>
</caption>
<thead><tr style="overflow-wrap:break-word;"><td class="cl-9ce6cda9"><p class="cl-9ce68e88"><span class="cl-9ce67786">status</span></p></td><td class="cl-9ce6cda8"><p class="cl-9ce68e88"><span class="cl-9ce67786">attraction</span></p></td><td class="cl-9ce6cdb2"><p class="cl-9ce68e92"><span class="cl-9ce67786">money</span></p></td></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-9ce6cd80"><p class="cl-9ce68e88"><span class="cl-9ce67790">Relationship</span></p></td><td class="cl-9ce6cd6c"><p class="cl-9ce68e88"><span class="cl-9ce67790">NotInterested</span></p></td><td class="cl-9ce6cd76"><p class="cl-9ce68e92"><span class="cl-9ce67790">86.33</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-9ce6cd8b"><p class="cl-9ce68e88"><span class="cl-9ce67790">Relationship</span></p></td><td class="cl-9ce6cd81"><p class="cl-9ce68e88"><span class="cl-9ce67790">NotInterested</span></p></td><td class="cl-9ce6cd8a"><p class="cl-9ce68e92"><span class="cl-9ce67790">45.58</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-9ce6cd80"><p class="cl-9ce68e88"><span class="cl-9ce67790">Relationship</span></p></td><td class="cl-9ce6cd6c"><p class="cl-9ce68e88"><span class="cl-9ce67790">NotInterested</span></p></td><td class="cl-9ce6cd76"><p class="cl-9ce68e92"><span class="cl-9ce67790">68.43</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-9ce6cd8b"><p class="cl-9ce68e88"><span class="cl-9ce67790">Relationship</span></p></td><td class="cl-9ce6cd81"><p class="cl-9ce68e88"><span class="cl-9ce67790">NotInterested</span></p></td><td class="cl-9ce6cd8a"><p class="cl-9ce68e92"><span class="cl-9ce67790">52.93</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-9ce6cd80"><p class="cl-9ce68e88"><span class="cl-9ce67790">Relationship</span></p></td><td class="cl-9ce6cd6c"><p class="cl-9ce68e88"><span class="cl-9ce67790">NotInterested</span></p></td><td class="cl-9ce6cd76"><p class="cl-9ce68e92"><span class="cl-9ce67790">61.86</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-9ce6cd8b"><p class="cl-9ce68e88"><span class="cl-9ce67790">Relationship</span></p></td><td class="cl-9ce6cd81"><p class="cl-9ce68e88"><span class="cl-9ce67790">NotInterested</span></p></td><td class="cl-9ce6cd8a"><p class="cl-9ce68e92"><span class="cl-9ce67790">48.47</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-9ce6cd80"><p class="cl-9ce68e88"><span class="cl-9ce67790">Relationship</span></p></td><td class="cl-9ce6cd6c"><p class="cl-9ce68e88"><span class="cl-9ce67790">NotInterested</span></p></td><td class="cl-9ce6cd76"><p class="cl-9ce68e92"><span class="cl-9ce67790">32.79</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-9ce6cd8b"><p class="cl-9ce68e88"><span class="cl-9ce67790">Relationship</span></p></td><td class="cl-9ce6cd81"><p class="cl-9ce68e88"><span class="cl-9ce67790">NotInterested</span></p></td><td class="cl-9ce6cd8a"><p class="cl-9ce68e92"><span class="cl-9ce67790">35.91</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-9ce6cd80"><p class="cl-9ce68e88"><span class="cl-9ce67790">Relationship</span></p></td><td class="cl-9ce6cd6c"><p class="cl-9ce68e88"><span class="cl-9ce67790">NotInterested</span></p></td><td class="cl-9ce6cd76"><p class="cl-9ce68e92"><span class="cl-9ce67790">30.98</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-9ce6cd8b"><p class="cl-9ce68e88"><span class="cl-9ce67790">Relationship</span></p></td><td class="cl-9ce6cd81"><p class="cl-9ce68e88"><span class="cl-9ce67790">NotInterested</span></p></td><td class="cl-9ce6cd8a"><p class="cl-9ce68e92"><span class="cl-9ce67790">44.82</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-9ce6cd80"><p class="cl-9ce68e88"><span class="cl-9ce67790">Relationship</span></p></td><td class="cl-9ce6cd6c"><p class="cl-9ce68e88"><span class="cl-9ce67790">NotInterested</span></p></td><td class="cl-9ce6cd76"><p class="cl-9ce68e92"><span class="cl-9ce67790">35.05</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-9ce6cd8b"><p class="cl-9ce68e88"><span class="cl-9ce67790">Relationship</span></p></td><td class="cl-9ce6cd81"><p class="cl-9ce68e88"><span class="cl-9ce67790">NotInterested</span></p></td><td class="cl-9ce6cd8a"><p class="cl-9ce68e92"><span class="cl-9ce67790">64.49</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-9ce6cd80"><p class="cl-9ce68e88"><span class="cl-9ce67790">Relationship</span></p></td><td class="cl-9ce6cd6c"><p class="cl-9ce68e88"><span class="cl-9ce67790">NotInterested</span></p></td><td class="cl-9ce6cd76"><p class="cl-9ce68e92"><span class="cl-9ce67790">54.50</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-9ce6cd8b"><p class="cl-9ce68e88"><span class="cl-9ce67790">Relationship</span></p></td><td class="cl-9ce6cd81"><p class="cl-9ce68e88"><span class="cl-9ce67790">NotInterested</span></p></td><td class="cl-9ce6cd8a"><p class="cl-9ce68e92"><span class="cl-9ce67790">61.48</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-9ce6cd9f"><p class="cl-9ce68e88"><span class="cl-9ce67790">Relationship</span></p></td><td class="cl-9ce6cd9e"><p class="cl-9ce68e88"><span class="cl-9ce67790">NotInterested</span></p></td><td class="cl-9ce6cd94"><p class="cl-9ce68e92"><span class="cl-9ce67790">55.51</span></p></td></tr></tbody></table></div></template>
<div class="flextable-shadow-host" id="5889bfc0-48fe-4a8e-84d5-d13736844dc5"></div>
<script>
var dest = document.getElementById("5889bfc0-48fe-4a8e-84d5-d13736844dc5");
var template = document.getElementById("eec94df5-e7b2-4f54-8325-131b3440156d");
var caption = template.content.querySelector("caption");
if(caption) {
  caption.style.cssText = "display:block;text-align:center;";
  var newcapt = document.createElement("p");
  newcapt.appendChild(caption)
  dest.parentNode.insertBefore(newcapt, dest.previousSibling);
}
var fantome = dest.attachShadow({mode: 'open'});
var templateContent = template.content;
fantome.appendChild(templateContent);
</script>

<p>We first fit an ordinary linear model (and although we know from the
section on multiple regression that the interaction between status and
attraction is significant, we will disregard this for now as this will
help to explain the weighing procedure which is the focus of this
section).</p>
<pre class="r"><code># create model
slm &lt;- lm(money ~ status+attraction, data = robustdata)
# inspect model
summary(slm)</code></pre>
<pre><code>## 
## Call:
## lm(formula = money ~ status + attraction, data = robustdata)
## 
## Residuals:
##       Min        1Q    Median        3Q       Max 
## -60.87070 -15.78645  -2.61010  13.88770  59.93710 
## 
## Coefficients:
##                             Estimate   Std. Error   t value
## (Intercept)             114.94950000   4.28993616  26.79515
## statusSingle             26.10340000   4.95359160   5.26959
## attractionNotInterested -79.25220000   4.95359160 -15.99894
##                                       Pr(&gt;|t|)    
## (Intercept)             &lt; 0.000000000000000222 ***
## statusSingle                     0.00000082576 ***
## attractionNotInterested &lt; 0.000000000000000222 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 24.767958 on 97 degrees of freedom
## Multiple R-squared:  0.745229335,    Adjusted R-squared:  0.739976331 
## F-statistic: 141.867286 on 2 and 97 DF,  p-value: &lt; 0.0000000000000002220446</code></pre>
<p>We now check whether the model is well fitted using diagnostic
plots.</p>
<pre class="r"><code># generate plots
autoplot(slm) + 
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank()) </code></pre>
<p><img src="multireg_files/figure-html/rr4-1.png" width="672" /></p>
<p>The diagnostic plots indicate that there are three outliers in the
data (data points 52, 83 and possibly 64). Therefore, we need to
evaluate if the outliers severely affect the fit of the model.</p>
<pre class="r"><code>robustdata[c(52, 64, 83),]</code></pre>
<pre><code>##    status    attraction  money
## 52 Single NotInterested   0.93
## 64 Single NotInterested  84.28
## 83 Single    Interested 200.99</code></pre>
<p>We can now calculate Cook’s distance and standardized residuals check
if the values of the potentially problematic points have unacceptably
high values (-2 &lt; ok &lt; 2).</p>
<pre class="r"><code>CooksDistance &lt;- cooks.distance(slm)
StandardizedResiduals &lt;- stdres(slm)
a &lt;- cbind(robustdata, CooksDistance, StandardizedResiduals)
a[CooksDistance &gt; 4/100, ]</code></pre>
<pre><code>##          status    attraction  money   CooksDistance StandardizedResiduals
## 1  Relationship NotInterested  86.33 0.0444158829857         2.07565427025
## 52       Single NotInterested   0.93 0.0641937458854        -2.49535435377
## 65       Single NotInterested  12.12 0.0427613629698        -2.03662765573
## 67       Single NotInterested  13.28 0.0407877963315        -1.98907421786
## 83       Single    Interested 200.99 0.0622397126545         2.45708203516
## 84       Single    Interested 193.69 0.0480020776213         2.15782333134
## 88       Single    Interested 193.78 0.0481663678409         2.16151282221</code></pre>
<p>We will calculate the absolute value and reorder the table so that it
is easier to check the values.</p>
<pre class="r"><code>AbsoluteStandardizedResiduals &lt;- abs(StandardizedResiduals)
a &lt;- cbind(robustdata, CooksDistance, StandardizedResiduals, AbsoluteStandardizedResiduals)
asorted &lt;- a[order(-AbsoluteStandardizedResiduals), ]
asorted[1:10, ]</code></pre>
<pre><code>##          status    attraction  money   CooksDistance StandardizedResiduals
## 52       Single NotInterested   0.93 0.0641937458854        -2.49535435377
## 83       Single    Interested 200.99 0.0622397126545         2.45708203516
## 88       Single    Interested 193.78 0.0481663678409         2.16151282221
## 84       Single    Interested 193.69 0.0480020776213         2.15782333134
## 1  Relationship NotInterested  86.33 0.0444158829857         2.07565427025
## 65       Single NotInterested  12.12 0.0427613629698        -2.03662765573
## 67       Single NotInterested  13.28 0.0407877963315        -1.98907421786
## 78       Single    Interested 188.76 0.0394313968241         1.95572122040
## 21 Relationship NotInterested  81.90 0.0369837409025         1.89404933081
## 24 Relationship NotInterested  81.56 0.0364414260634         1.88011125419
##    AbsoluteStandardizedResiduals
## 52                 2.49535435377
## 83                 2.45708203516
## 88                 2.16151282221
## 84                 2.15782333134
## 1                  2.07565427025
## 65                 2.03662765573
## 67                 1.98907421786
## 78                 1.95572122040
## 21                 1.89404933081
## 24                 1.88011125419</code></pre>
<p>As Cook’s distance and the standardized residuals do have
unacceptable values, we re-calculate the linear model as a robust
regression and inspect the results</p>
<pre class="r"><code># create robust regression model
rmodel &lt;- robustbase::lmrob(money ~ status + attraction, data = robustdata)
# inspect model
summary(rmodel)</code></pre>
<pre><code>## 
## Call:
## robustbase::lmrob(formula = money ~ status + attraction, data = robustdata)
##  \--&gt; method = &quot;MM&quot;
## Residuals:
##          Min           1Q       Median           3Q          Max 
## -61.14269795 -15.20405790  -1.48712083  14.43502498  62.42342789 
## 
## Coefficients:
##                             Estimate   Std. Error   t value
## (Intercept)             113.18405790   3.89777755  29.03810
## statusSingle             25.38251420   5.08841070   4.98830
## attractionNotInterested -76.49387416   5.06626469 -15.09867
##                                       Pr(&gt;|t|)    
## (Intercept)             &lt; 0.000000000000000222 ***
## statusSingle                      0.0000026725 ***
## attractionNotInterested &lt; 0.000000000000000222 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Robust residual standard error: 22.3497537 
## Multiple R-squared:  0.740716948,    Adjusted R-squared:  0.735370905 
## Convergence in 11 IRWLS iterations
## 
## Robustness weights: 
##  10 weights are ~= 1. The remaining 90 ones are summarized as
##        Min.     1st Qu.      Median        Mean     3rd Qu.        Max. 
## 0.415507240 0.856134411 0.947485772 0.889078662 0.986192099 0.998890516 
## Algorithmic parameters: 
##            tuning.chi                    bb            tuning.psi 
## 1.5476399999999999046 0.5000000000000000000 4.6850610000000001421 
##            refine.tol               rel.tol             scale.tol 
## 0.0000001000000000000 0.0000001000000000000 0.0000000001000000000 
##             solve.tol           eps.outlier                 eps.x 
## 0.0000001000000000000 0.0010000000000000000 0.0000000000018189894 
##     warn.limit.reject     warn.limit.meanrw 
## 0.5000000000000000000 0.5000000000000000000 
##      nResample         max.it       best.r.s       k.fast.s          k.max 
##            500             50              2              1            200 
##    maxit.scale      trace.lev            mts     compute.rd fast.s.large.n 
##            200              0           1000              0           2000 
##                   psi           subsampling                   cov 
##            &quot;bisquare&quot;         &quot;nonsingular&quot;         &quot;.vcov.avar1&quot; 
## compute.outlier.stats 
##                  &quot;SM&quot; 
## seed : int(0)</code></pre>
<p>The output shows that both status and attraction are significant but,
as we have seen above, the effect that really matters is the interaction
between status and attraction.</p>
<p>We will briefly check the weights to understand the process of
weighing better. The idea of weighing is to downgrade data points that
are too influential while not punishing data points that have a good fit
and are thus less influential. This means that the problematic data
points should have lower weights than other data points (the maximum is
1 - so points can only be made “lighter”).</p>
<pre class="r"><code>hweights &lt;- data.frame(status = robustdata$status, resid = rmodel$resid, weight = rmodel$rweights)
hweights2 &lt;- hweights[order(rmodel$rweights), ]
hweights2[1:15, ]</code></pre>
<pre><code>##          status          resid         weight
## 83       Single  62.4234278907 0.415507239583
## 52       Single -61.1426979530 0.434323600371
## 88       Single  55.2134278907 0.521220548648
## 84       Single  55.1234278907 0.522529128470
## 78       Single  50.1934278907 0.593234362562
## 65       Single -49.9526979530 0.596626323855
## 1  Relationship  49.6398162520 0.601024881828
## 67       Single -48.7926979530 0.612874595179
## 21 Relationship  45.2098162520 0.661914514059
## 24 Relationship  44.8698162520 0.666467595392
## 39 Relationship -43.8940579044 0.679427988924
## 79       Single  40.8234278907 0.719104375927
## 58       Single -40.5226979530 0.722893462104
## 89       Single  39.9734278907 0.729767006873
## 95       Single  39.8234278907 0.731633389032</code></pre>
<p>The values of the weights support our assumption that those data
points that were deemed too influential are made <em>lighter</em> as
they now only have weights of 0.415507239583 and 0.434323600371
respectively. This was, however, not the focus of this sections as this
section merely served to introduce the concept of weights and how they
can be used in the context of a robust linear regression.</p>
</div>
<div id="multiple-binomial-logistic-regression"
class="section level2 unnumbered">
<h2 class="unnumbered">Multiple Binomial Logistic Regression</h2>
<p>Logistic regression is a multivariate analysis technique that builds
on and is very similar in terms of its implementation to linear
regression but logistic regressions take dependent variables that
represent nominal rather than numeric scaling <span class="citation">(<a
href="#ref-harrell2015regression" role="doc-biblioref">Harrell Jr
2015</a>)</span>. The difference requires that the linear regression
must be modified in certain ways to avoid producing non-sensical
outcomes. The most fundamental difference between logistic and linear
regressions is that logistic regression work on the probabilities of an
outcome (the likelihood), rather than the outcome itself. In addition,
the likelihoods on which the logistic regression works must be logged
(logarithmized) in order to avoid produce predictions that produce
values greater than 1 (instance occurs) and 0 (instance does not occur).
You can check this by logging the values from -10 to 10 using the
<code>plogis</code> function as shown below.</p>
<pre class="r"><code>round(plogis(-10:10), 5)</code></pre>
<pre><code>##  [1] 0.00005 0.00012 0.00034 0.00091 0.00247 0.00669 0.01799 0.04743 0.11920
## [10] 0.26894 0.50000 0.73106 0.88080 0.95257 0.98201 0.99331 0.99753 0.99909
## [19] 0.99966 0.99988 0.99995</code></pre>
<p>If we visualize these logged values, we get an S-shaped curve which
reflects the logistic function.</p>
<p><img src="multireg_files/figure-html/blm0b-1.png" width="672" /></p>
<p>To understand what this mean, we will use a very simple example. In
this example, we want to see whether the height of men affect their
likelihood of being in a relationship. The data we use represents a data
set consisting of two variables: height and relationship.</p>
<p><img src="multireg_files/figure-html/blm1-1.png" width="672" /></p>
<p>The left panel of the Figure above shows that a linear model would
predict values for the relationship status, which represents a factor (0
= Single and 1 = In a Relationship), that are nonsensical because values
above 1 or below 0 do not make sense. In contrast to a linear
regression, which predicts actual values, such as the frequencies of
prepositions in a certain text, a logistic regression predicts
<em>probabilities</em> of events (for example, being in a relationship)
rather than actual values. The center panel shows the predictions of a
logistic regression and we see that a logistic regression also has an
intercept and a (very steep) slope but that the regression line also
predicts values that are above 1 and below 0. However, when we log the
predicted values we these predicted values are transformed into
probabilities with values between 0 and 1. And the logged regression
line has a S-shape which reflects the logistic function. Furthermore, we
can then find the optimal line (the line with the lowest residual
deviance) by comparing the sum of residuals - just as we did for a
simple linear model and that way, we find the regression line for a
logistic regression.</p>
<div id="example-1-eh-in-kiwi-english"
class="section level3 unnumbered">
<h3 class="unnumbered">Example 1: EH in Kiwi English</h3>
<p>To exemplify how to implement a logistic regression in R <span
class="citation">(see <a href="#ref-agresti1996introduction"
role="doc-biblioref">Agresti 1996</a>; <a
href="#ref-agresti2011categorical" role="doc-biblioref">Agresti and
Kateri 2011</a>)</span> for very good and thorough introductions to this
topic], we will analyze the use of the discourse particle <em>eh</em> in
New Zealand English and test which factors correlate with its
occurrence. The data set represents speech units in a corpus that were
coded for the speaker who uttered a given speech unit, the gender,
ethnicity, and age of that speaker and whether or not the speech unit
contained an <em>eh</em>. To begin with, we clean the current work
space, set option, install and activate relevant packages, load
customized functions, and load the example data set.</p>
<pre class="r"><code># load data
blrdata  &lt;- base::readRDS(url(&quot;https://slcladal.github.io/data/bld.rda&quot;, &quot;rb&quot;))</code></pre>
<template id="c1408f6d-5dfc-4bbb-853f-0102301be444"><style>
.tabwid table{
  border-spacing:0px !important;
  border-collapse:collapse;
  line-height:1;
  margin-left:auto;
  margin-right:auto;
  border-width: 0;
  display: table;
  margin-top: 1.275em;
  margin-bottom: 1.275em;
  border-color: transparent;
}
.tabwid_left table{
  margin-left:0;
}
.tabwid_right table{
  margin-right:0;
}
.tabwid td {
    padding: 0;
}
.tabwid a {
  text-decoration: none;
}
.tabwid thead {
    background-color: transparent;
}
.tabwid tfoot {
    background-color: transparent;
}
.tabwid table tr {
background-color: transparent;
}
</style><div class="tabwid"><style>.cl-9ecca296{table-layout:auto;width:75%;}.cl-9ec16840{font-family:'Arial';font-size:12pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-9ec16854{font-family:'Arial';font-size:12pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-9ec183b6{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-9ec183c0{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-9ec1e068{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9ec1e07c{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9ec1e07d{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9ec1e086{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9ec1e087{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9ec1e088{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9ec1e090{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9ec1e091{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9ec1e092{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9ec1e09a{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9ec1e09b{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9ec1e09c{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table class='cl-9ecca296'>
<caption class="Table Caption">
<p>First 15 rows of the blrdata.</p>
</caption>
<thead><tr style="overflow-wrap:break-word;"><td class="cl-9ec1e09a"><p class="cl-9ec183b6"><span class="cl-9ec16840">ID</span></p></td><td class="cl-9ec1e09b"><p class="cl-9ec183b6"><span class="cl-9ec16840">Gender</span></p></td><td class="cl-9ec1e09b"><p class="cl-9ec183b6"><span class="cl-9ec16840">Age</span></p></td><td class="cl-9ec1e09b"><p class="cl-9ec183b6"><span class="cl-9ec16840">Ethnicity</span></p></td><td class="cl-9ec1e09c"><p class="cl-9ec183c0"><span class="cl-9ec16840">EH</span></p></td></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-9ec1e07d"><p class="cl-9ec183b6"><span class="cl-9ec16854">&lt;S1A-001#M&gt;</span></p></td><td class="cl-9ec1e07c"><p class="cl-9ec183b6"><span class="cl-9ec16854">Men</span></p></td><td class="cl-9ec1e07c"><p class="cl-9ec183b6"><span class="cl-9ec16854">Young</span></p></td><td class="cl-9ec1e07c"><p class="cl-9ec183b6"><span class="cl-9ec16854">Pakeha</span></p></td><td class="cl-9ec1e068"><p class="cl-9ec183c0"><span class="cl-9ec16854">0</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-9ec1e088"><p class="cl-9ec183b6"><span class="cl-9ec16854">&lt;S1A-001#M&gt;</span></p></td><td class="cl-9ec1e086"><p class="cl-9ec183b6"><span class="cl-9ec16854">Men</span></p></td><td class="cl-9ec1e086"><p class="cl-9ec183b6"><span class="cl-9ec16854">Young</span></p></td><td class="cl-9ec1e086"><p class="cl-9ec183b6"><span class="cl-9ec16854">Pakeha</span></p></td><td class="cl-9ec1e087"><p class="cl-9ec183c0"><span class="cl-9ec16854">1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-9ec1e07d"><p class="cl-9ec183b6"><span class="cl-9ec16854">&lt;S1A-001#M&gt;</span></p></td><td class="cl-9ec1e07c"><p class="cl-9ec183b6"><span class="cl-9ec16854">Men</span></p></td><td class="cl-9ec1e07c"><p class="cl-9ec183b6"><span class="cl-9ec16854">Young</span></p></td><td class="cl-9ec1e07c"><p class="cl-9ec183b6"><span class="cl-9ec16854">Pakeha</span></p></td><td class="cl-9ec1e068"><p class="cl-9ec183c0"><span class="cl-9ec16854">0</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-9ec1e088"><p class="cl-9ec183b6"><span class="cl-9ec16854">&lt;S1A-001#M&gt;</span></p></td><td class="cl-9ec1e086"><p class="cl-9ec183b6"><span class="cl-9ec16854">Men</span></p></td><td class="cl-9ec1e086"><p class="cl-9ec183b6"><span class="cl-9ec16854">Young</span></p></td><td class="cl-9ec1e086"><p class="cl-9ec183b6"><span class="cl-9ec16854">Pakeha</span></p></td><td class="cl-9ec1e087"><p class="cl-9ec183c0"><span class="cl-9ec16854">0</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-9ec1e07d"><p class="cl-9ec183b6"><span class="cl-9ec16854">&lt;S1A-001#M&gt;</span></p></td><td class="cl-9ec1e07c"><p class="cl-9ec183b6"><span class="cl-9ec16854">Men</span></p></td><td class="cl-9ec1e07c"><p class="cl-9ec183b6"><span class="cl-9ec16854">Young</span></p></td><td class="cl-9ec1e07c"><p class="cl-9ec183b6"><span class="cl-9ec16854">Pakeha</span></p></td><td class="cl-9ec1e068"><p class="cl-9ec183c0"><span class="cl-9ec16854">1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-9ec1e088"><p class="cl-9ec183b6"><span class="cl-9ec16854">&lt;S1A-001#M&gt;</span></p></td><td class="cl-9ec1e086"><p class="cl-9ec183b6"><span class="cl-9ec16854">Men</span></p></td><td class="cl-9ec1e086"><p class="cl-9ec183b6"><span class="cl-9ec16854">Young</span></p></td><td class="cl-9ec1e086"><p class="cl-9ec183b6"><span class="cl-9ec16854">Pakeha</span></p></td><td class="cl-9ec1e087"><p class="cl-9ec183c0"><span class="cl-9ec16854">1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-9ec1e07d"><p class="cl-9ec183b6"><span class="cl-9ec16854">&lt;S1A-001#M&gt;</span></p></td><td class="cl-9ec1e07c"><p class="cl-9ec183b6"><span class="cl-9ec16854">Men</span></p></td><td class="cl-9ec1e07c"><p class="cl-9ec183b6"><span class="cl-9ec16854">Young</span></p></td><td class="cl-9ec1e07c"><p class="cl-9ec183b6"><span class="cl-9ec16854">Pakeha</span></p></td><td class="cl-9ec1e068"><p class="cl-9ec183c0"><span class="cl-9ec16854">0</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-9ec1e088"><p class="cl-9ec183b6"><span class="cl-9ec16854">&lt;S1A-001#M&gt;</span></p></td><td class="cl-9ec1e086"><p class="cl-9ec183b6"><span class="cl-9ec16854">Men</span></p></td><td class="cl-9ec1e086"><p class="cl-9ec183b6"><span class="cl-9ec16854">Young</span></p></td><td class="cl-9ec1e086"><p class="cl-9ec183b6"><span class="cl-9ec16854">Pakeha</span></p></td><td class="cl-9ec1e087"><p class="cl-9ec183c0"><span class="cl-9ec16854">0</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-9ec1e07d"><p class="cl-9ec183b6"><span class="cl-9ec16854">&lt;S1A-001#M&gt;</span></p></td><td class="cl-9ec1e07c"><p class="cl-9ec183b6"><span class="cl-9ec16854">Men</span></p></td><td class="cl-9ec1e07c"><p class="cl-9ec183b6"><span class="cl-9ec16854">Young</span></p></td><td class="cl-9ec1e07c"><p class="cl-9ec183b6"><span class="cl-9ec16854">Pakeha</span></p></td><td class="cl-9ec1e068"><p class="cl-9ec183c0"><span class="cl-9ec16854">0</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-9ec1e088"><p class="cl-9ec183b6"><span class="cl-9ec16854">&lt;S1A-001#M&gt;</span></p></td><td class="cl-9ec1e086"><p class="cl-9ec183b6"><span class="cl-9ec16854">Men</span></p></td><td class="cl-9ec1e086"><p class="cl-9ec183b6"><span class="cl-9ec16854">Young</span></p></td><td class="cl-9ec1e086"><p class="cl-9ec183b6"><span class="cl-9ec16854">Pakeha</span></p></td><td class="cl-9ec1e087"><p class="cl-9ec183c0"><span class="cl-9ec16854">1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-9ec1e07d"><p class="cl-9ec183b6"><span class="cl-9ec16854">&lt;S1A-001#M&gt;</span></p></td><td class="cl-9ec1e07c"><p class="cl-9ec183b6"><span class="cl-9ec16854">Men</span></p></td><td class="cl-9ec1e07c"><p class="cl-9ec183b6"><span class="cl-9ec16854">Young</span></p></td><td class="cl-9ec1e07c"><p class="cl-9ec183b6"><span class="cl-9ec16854">Pakeha</span></p></td><td class="cl-9ec1e068"><p class="cl-9ec183c0"><span class="cl-9ec16854">0</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-9ec1e088"><p class="cl-9ec183b6"><span class="cl-9ec16854">&lt;S1A-001#M&gt;</span></p></td><td class="cl-9ec1e086"><p class="cl-9ec183b6"><span class="cl-9ec16854">Men</span></p></td><td class="cl-9ec1e086"><p class="cl-9ec183b6"><span class="cl-9ec16854">Young</span></p></td><td class="cl-9ec1e086"><p class="cl-9ec183b6"><span class="cl-9ec16854">Pakeha</span></p></td><td class="cl-9ec1e087"><p class="cl-9ec183c0"><span class="cl-9ec16854">0</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-9ec1e07d"><p class="cl-9ec183b6"><span class="cl-9ec16854">&lt;S1A-001#M&gt;</span></p></td><td class="cl-9ec1e07c"><p class="cl-9ec183b6"><span class="cl-9ec16854">Men</span></p></td><td class="cl-9ec1e07c"><p class="cl-9ec183b6"><span class="cl-9ec16854">Young</span></p></td><td class="cl-9ec1e07c"><p class="cl-9ec183b6"><span class="cl-9ec16854">Pakeha</span></p></td><td class="cl-9ec1e068"><p class="cl-9ec183c0"><span class="cl-9ec16854">1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-9ec1e088"><p class="cl-9ec183b6"><span class="cl-9ec16854">&lt;S1A-001#M&gt;</span></p></td><td class="cl-9ec1e086"><p class="cl-9ec183b6"><span class="cl-9ec16854">Men</span></p></td><td class="cl-9ec1e086"><p class="cl-9ec183b6"><span class="cl-9ec16854">Young</span></p></td><td class="cl-9ec1e086"><p class="cl-9ec183b6"><span class="cl-9ec16854">Pakeha</span></p></td><td class="cl-9ec1e087"><p class="cl-9ec183c0"><span class="cl-9ec16854">1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-9ec1e091"><p class="cl-9ec183b6"><span class="cl-9ec16854">&lt;S1A-001#M&gt;</span></p></td><td class="cl-9ec1e090"><p class="cl-9ec183b6"><span class="cl-9ec16854">Men</span></p></td><td class="cl-9ec1e090"><p class="cl-9ec183b6"><span class="cl-9ec16854">Young</span></p></td><td class="cl-9ec1e090"><p class="cl-9ec183b6"><span class="cl-9ec16854">Pakeha</span></p></td><td class="cl-9ec1e092"><p class="cl-9ec183c0"><span class="cl-9ec16854">0</span></p></td></tr></tbody></table></div></template>
<div class="flextable-shadow-host" id="308103a2-0b5f-4f37-891e-4e1891af7998"></div>
<script>
var dest = document.getElementById("308103a2-0b5f-4f37-891e-4e1891af7998");
var template = document.getElementById("c1408f6d-5dfc-4bbb-853f-0102301be444");
var caption = template.content.querySelector("caption");
if(caption) {
  caption.style.cssText = "display:block;text-align:center;";
  var newcapt = document.createElement("p");
  newcapt.appendChild(caption)
  dest.parentNode.insertBefore(newcapt, dest.previousSibling);
}
var fantome = dest.attachShadow({mode: 'open'});
var templateContent = template.content;
fantome.appendChild(templateContent);
</script>

<p>The summary of the data show that the data set contains 25,821
observations of five variables. The variable <code>ID</code> contains
strings that represent a combination file and speaker of a speech unit.
The second variable represents the gender, the third the age, and the
fourth the ethnicity of speakers. The fifth variable represents whether
or not a speech unit contained the discourse particle <em>eh</em>.</p>
<p>Next, we factorize the variables in our data set. In other words, we
specify that the strings represent variable levels and define new
reference levels because as a default <code>R</code> will use the
variable level which first occurs in alphabet ordering as the reference
level for each variable, we redefine the variable levels for Age and
Ethnicity.</p>
<pre class="r"><code>blrdata &lt;- blrdata %&gt;%
  # factorize variables
  dplyr::mutate(Age = factor(Age),
                Gender = factor(Gender),
                Ethnicity = factor(Ethnicity),
                ID = factor(ID),
                EH = factor(EH)) %&gt;%
  # relevel Age (Reference = Young) and Ethnicity (Reference= Pakeha))
  dplyr::mutate(Age = relevel(Age, &quot;Young&quot;),
                Ethnicity = relevel(Ethnicity, &quot;Pakeha&quot;))</code></pre>
<p>After preparing the data, we will now plot the data to get an
overview of potential relationships between variables.</p>
<pre class="r"><code>blrdata %&gt;%
  dplyr::mutate(EH = ifelse(EH == &quot;0&quot;, 0, 1)) %&gt;%
  ggplot(aes(Age, EH, color = Gender)) +
  facet_wrap(~Ethnicity) +
  stat_summary(fun = mean, geom = &quot;point&quot;) +
  stat_summary(fun.data = mean_cl_boot, geom = &quot;errorbar&quot;, width = 0.2) +
  theme_set(theme_bw(base_size = 10)) +
  theme(legend.position = &quot;top&quot;) +
  labs(x = &quot;&quot;, y = &quot;Observed Probabilty of eh&quot;) +
  scale_color_manual(values = c(&quot;gray20&quot;, &quot;gray70&quot;))</code></pre>
<p><img src="multireg_files/figure-html/blm6-1.png" width="672" /></p>
<p>With respect to main effects, the Figure above indicates that men use
<em>eh</em> more frequently than women, that young speakers use it more
frequently compared with old speakers, and that speakers that are
descendants of European settlers (Pakeha) use <em>eh</em> more
frequently compared with Maori (the native inhabitants of New
Zealand).</p>
<p>The plots in the lower panels do not indicate significant
interactions between use of <em>eh</em> and the Age, Gender, and
Ethnicity of speakers. In a next step, we will start building the
logistic regression model.</p>
</div>
<div id="model-building" class="section level3 unnumbered">
<h3 class="unnumbered">Model Building</h3>
<p>As a first step, we need to define contrasts and use the
<code>datadist</code> function to store aspects of our variables that
can be accessed later when plotting and summarizing the model. Contrasts
define what and how variable levels should be compared and therefore
influences how the results of the regression analysis are presented. In
this case, we use treatment contrasts which are in-built. Treatment
contrasts mean that we assess the significance of levels of a predictor
against a baseline which is the reference level of a predictor. <span
class="citation">Field, Miles, and Field (<a
href="#ref-field2012discovering" role="doc-biblioref">2012,
414–27</a>)</span> and <span class="citation">Gries (<a
href="#ref-gries2021statistics" role="doc-biblioref">2021</a>)</span>
provide very good and accessible explanations of contrasts and how to
manually define contrasts if you would like to know more.</p>
<pre class="r"><code># set contrasts
options(contrasts  =c(&quot;contr.treatment&quot;, &quot;contr.poly&quot;))
# create distance matrix
blrdata.dist &lt;- datadist(blrdata)
# include distance matrix in options
options(datadist = &quot;blrdata.dist&quot;)</code></pre>
<p>Next, we generate a minimal model that predicts the use of
<em>eh</em> solely based on the intercept.</p>
<pre class="r"><code># baseline glm model
m0.glm = glm(EH ~ 1, family = binomial, data = blrdata)</code></pre>
</div>
<div id="model-fitting" class="section level3 unnumbered">
<h3 class="unnumbered">Model fitting</h3>
<p>We will now start with the model fitting procedure. In the present
case, we will use a manual step-wise step-up procedure during which
predictors are added to the model if they significantly improve the
model fit. In addition, we will perform diagnostics as we fit the model
at each step of the model fitting process rather than after the
fitting.</p>
<p>We will test two things in particular: whether the data has
incomplete information or complete separation and if the model suffers
from (multi-)collinearity.</p>
<p>Incomplete information or complete separation means that the data
does not contain all combinations of the predictor or the dependent
variable. This is important because if the data does not contain cases
of all combinations, the model will assume that it has found a perfect
predictor. In such cases the model overestimates the effect of that that
predictor and the results of that model are no longer reliable. For
example, if <em>eh</em> was only used by young speakers in the data, the
model would jump on that fact and say <em>Ha! If there is an old
speaker, that means that that speaker will never ever and under no
circumstances say </em>eh* - I can therefore ignore all other
factors!*</p>
<p>Multicollinearity means that predictors correlate and have shared
variance. This means that whichever predictor is included first will
take all the variance that it can explain and the remaining part of the
variable that is shared will not be attributed to the other predictor.
This may lead to reporting that a factor is not significant because all
of the variance it can explain is already accounted for. However, if the
other predictor were included first, then the original predictor would
be returned as insignificant. This means that- depending on the order in
which predictors are added - the results of the regression can differ
dramatically and the model is therefore not reliable. Multicollinearity
is actually a very common problem and there are various ways to deal
with it but it cannot be ignored (at least in regression analyses).</p>
<p>We will start by adding <em>Age</em> to the minimal adequate
model.</p>
<pre class="r"><code># check incomplete information
ifelse(min(ftable(blrdata$Age, blrdata$EH)) == 0, &quot;not possible&quot;, &quot;possible&quot;)</code></pre>
<pre><code>## [1] &quot;possible&quot;</code></pre>
<pre class="r"><code># add age to the model
m1.glm = glm(EH ~ Age, family = binomial, data = blrdata)
# check multicollinearity (vifs should have values of 3 or lower for main effects)
ifelse(max(vif(m1.glm)) &lt;= 3,  &quot;vifs ok&quot;, &quot;WARNING: high vifs!&quot;) # VIFs ok</code></pre>
<pre><code>## [1] &quot;vifs ok&quot;</code></pre>
<pre class="r"><code># check if adding Age significantly improves model fit
anova(m1.glm, m0.glm, test = &quot;Chi&quot;)</code></pre>
<pre><code>## Analysis of Deviance Table
## 
## Model 1: EH ~ Age
## Model 2: EH ~ 1
##   Resid. Df  Resid. Dev Df     Deviance               Pr(&gt;Chi)    
## 1     25819 32376.86081                                           
## 2     25820 33007.75469 -1 -630.8938871 &lt; 0.000000000000000222 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>As the data does not contain incomplete information, the vif values
are below 3, and adding <em>Age</em> has significantly improved the
model fit (the p-value of the ANOVA is lower than .05). We therefore
proceed with <em>Age</em> included.</p>
<p>We continue by adding <em>Gender</em>. We add a second ANOVA test to
see if including Gender affects the significance of other predictors in
the model. If this were the case - if adding Gender would cause Age to
become insignificant - then we could change the ordering in which we
include predictors into our model.</p>
<pre class="r"><code>ifelse(min(ftable(blrdata$Gender, blrdata$EH)) == 0, &quot;not possible&quot;, &quot;possible&quot;)</code></pre>
<pre><code>## [1] &quot;possible&quot;</code></pre>
<pre class="r"><code>m2.glm &lt;- update(m1.glm, . ~ . +Gender)
ifelse(max(vif(m2.glm)) &lt;= 3,  &quot;vifs ok&quot;, &quot;WARNING: high vifs!&quot;) # VIFs ok</code></pre>
<pre><code>## [1] &quot;vifs ok&quot;</code></pre>
<pre class="r"><code>anova(m2.glm, m1.glm, test = &quot;Chi&quot;)</code></pre>
<pre><code>## Analysis of Deviance Table
## 
## Model 1: EH ~ Age + Gender
## Model 2: EH ~ Age
##   Resid. Df  Resid. Dev Df    Deviance               Pr(&gt;Chi)    
## 1     25818 32139.54089                                          
## 2     25819 32376.86081 -1 -237.319914 &lt; 0.000000000000000222 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<pre class="r"><code>Anova(m2.glm, test = &quot;LR&quot;)</code></pre>
<pre><code>## Analysis of Deviance Table (Type II tests)
## 
## Response: EH
##           LR Chisq Df             Pr(&gt;Chisq)    
## Age    668.6350712  1 &lt; 0.000000000000000222 ***
## Gender 237.3199140  1 &lt; 0.000000000000000222 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>Again, including <em>Gender</em> significantly improves model fit and
the data does not contain incomplete information or complete separation.
Also, including <em>Gender</em> does not affect the significance of
<em>Age</em>. Now, we include <em>Ethnicity</em>.</p>
<pre class="r"><code>ifelse(min(ftable(blrdata$Ethnicity, blrdata$EH)) == 0, &quot;not possible&quot;, &quot;possible&quot;)</code></pre>
<pre><code>## [1] &quot;possible&quot;</code></pre>
<pre class="r"><code>m3.glm &lt;- update(m2.glm, . ~ . +Ethnicity)
ifelse(max(vif(m3.glm)) &lt;= 3,  &quot;vifs ok&quot;, &quot;WARNING: high vifs!&quot;) # VIFs ok</code></pre>
<pre><code>## [1] &quot;vifs ok&quot;</code></pre>
<pre class="r"><code>anova(m3.glm, m2.glm, test = &quot;Chi&quot;)</code></pre>
<pre><code>## Analysis of Deviance Table
## 
## Model 1: EH ~ Age + Gender + Ethnicity
## Model 2: EH ~ Age + Gender
##   Resid. Df  Resid. Dev Df      Deviance Pr(&gt;Chi)
## 1     25817 32139.27988                          
## 2     25818 32139.54089 -1 -0.2610145387  0.60942</code></pre>
<p>Since adding <em>Ethnicity</em> does not significantly improve the
model fit, we do not need to test if its inclusion affects the
significance of other predictors. We continue without <em>Ethnicity</em>
and include the interaction between <em>Age</em> and
<em>Gender</em>.</p>
<pre class="r"><code>ifelse(min(ftable(blrdata$Age, blrdata$Gender, blrdata$EH)) == 0, &quot;not possible&quot;, &quot;possible&quot;)</code></pre>
<pre><code>## [1] &quot;possible&quot;</code></pre>
<pre class="r"><code>m4.glm &lt;- update(m2.glm, . ~ . +Age*Gender)
ifelse(max(vif(m4.glm)) &lt;= 3,  &quot;vifs ok&quot;, &quot;WARNING: high vifs!&quot;) # VIFs ok</code></pre>
<pre><code>## [1] &quot;vifs ok&quot;</code></pre>
<pre class="r"><code>anova(m4.glm, m2.glm, test = &quot;Chi&quot;)</code></pre>
<pre><code>## Analysis of Deviance Table
## 
## Model 1: EH ~ Age + Gender + Age:Gender
## Model 2: EH ~ Age + Gender
##   Resid. Df  Resid. Dev Df     Deviance Pr(&gt;Chi)
## 1     25817 32139.41665                         
## 2     25818 32139.54089 -1 -0.124239923  0.72448</code></pre>
<p>The interaction between <em>Age</em> and <em>Gender</em> is not
significant which means that men and women do not behave differently
with respect to their use of <code>EH</code> as they age. Also, the data
does not contain incomplete information and the model does not suffer
from multicollinearity - the predictors are not collinear. We can now
include if there is a significant interaction between <em>Age</em> and
<em>Ethnicity</em>.</p>
<pre class="r"><code>ifelse(min(ftable(blrdata$Age, blrdata$Ethnicity, blrdata$EH)) == 0, &quot;not possible&quot;, &quot;possible&quot;)</code></pre>
<pre><code>## [1] &quot;possible&quot;</code></pre>
<pre class="r"><code>m5.glm &lt;- update(m2.glm, . ~ . +Age*Ethnicity)
ifelse(max(vif(m5.glm)) &lt;= 3,  &quot;vifs ok&quot;, &quot;WARNING: high vifs!&quot;) # VIFs ok</code></pre>
<pre><code>## [1] &quot;vifs ok&quot;</code></pre>
<pre class="r"><code>anova(m5.glm, m2.glm, test = &quot;Chi&quot;)</code></pre>
<pre><code>## Analysis of Deviance Table
## 
## Model 1: EH ~ Age + Gender + Ethnicity + Age:Ethnicity
## Model 2: EH ~ Age + Gender
##   Resid. Df  Resid. Dev Df     Deviance Pr(&gt;Chi)
## 1     25816 32136.47224                         
## 2     25818 32139.54089 -2 -3.068654514   0.2156</code></pre>
<p>Again, no incomplete information or multicollinearity and no
significant interaction. Now, we test if there exists a significant
interaction between <em>Gender</em> and <em>Ethnicity</em>.</p>
<pre class="r"><code>ifelse(min(ftable(blrdata$Gender, blrdata$Ethnicity, blrdata$EH)) == 0, &quot;not possible&quot;, &quot;possible&quot;)</code></pre>
<pre><code>## [1] &quot;possible&quot;</code></pre>
<pre class="r"><code>m6.glm &lt;- update(m2.glm, . ~ . +Gender*Ethnicity)
ifelse(max(vif(m6.glm)) &lt;= 3,  &quot;vifs ok&quot;, &quot;WARNING: high vifs!&quot;) # VIFs ok</code></pre>
<pre><code>## [1] &quot;vifs ok&quot;</code></pre>
<pre class="r"><code>anova(m6.glm, m2.glm, test = &quot;Chi&quot;)</code></pre>
<pre><code>## Analysis of Deviance Table
## 
## Model 1: EH ~ Age + Gender + Ethnicity + Gender:Ethnicity
## Model 2: EH ~ Age + Gender
##   Resid. Df  Resid. Dev Df      Deviance Pr(&gt;Chi)
## 1     25816 32139.26864                          
## 2     25818 32139.54089 -2 -0.2722521835  0.87273</code></pre>
<p>As the interaction between <em>Gender</em> and <em>Ethnicity</em> is
not significant, we continue without it. In a final step, we include the
three-way interaction between <em>Age</em>, <em>Gender</em>, and
<em>Ethnicity</em>.</p>
<pre class="r"><code>ifelse(min(ftable(blrdata$Age, blrdata$Gender, blrdata$Ethnicity, blrdata$EH)) == 0, &quot;not possible&quot;, &quot;possible&quot;)</code></pre>
<pre><code>## [1] &quot;possible&quot;</code></pre>
<pre class="r"><code>m7.glm &lt;- update(m2.glm, . ~ . +Gender*Ethnicity)
ifelse(max(vif(m7.glm)) &lt;= 3,  &quot;vifs ok&quot;, &quot;WARNING: high vifs!&quot;) # VIFs ok</code></pre>
<pre><code>## [1] &quot;vifs ok&quot;</code></pre>
<pre class="r"><code>anova(m7.glm, m2.glm, test = &quot;Chi&quot;)</code></pre>
<pre><code>## Analysis of Deviance Table
## 
## Model 1: EH ~ Age + Gender + Ethnicity + Gender:Ethnicity
## Model 2: EH ~ Age + Gender
##   Resid. Df  Resid. Dev Df      Deviance Pr(&gt;Chi)
## 1     25816 32139.26864                          
## 2     25818 32139.54089 -2 -0.2722521835  0.87273</code></pre>
<p>We have found our final minimal adequate model because the 3-way
interaction is also insignificant. As we have now arrived at the final
minimal adequate model (m2.glm), we generate a final minimal model using
the lrm function.</p>
<pre class="r"><code>m2.lrm &lt;- lrm(EH ~ Age+Gender, data = blrdata, x = T, y = T, linear.predictors = T)
m2.lrm</code></pre>
<pre><code>## Logistic Regression Model
##  
##  lrm(formula = EH ~ Age + Gender, data = blrdata, x = T, y = T, 
##      linear.predictors = T)
##  
##                         Model Likelihood        Discrimination    Rank Discrim.    
##                               Ratio Test               Indexes          Indexes    
##  Obs         25821    LR chi2     868.21        R2       0.046    C       0.602    
##   0          17114    d.f.             2      R2(2,25821)0.033    Dxy     0.203    
##   1           8707    Pr(&gt; chi2) &lt;0.0001    R2(2,17312.8)0.049    gamma   0.302    
##  max |deriv| 3e-10                              Brier    0.216    tau-a   0.091    
##  
##               Coef    S.E.   Wald Z Pr(&gt;|Z|)
##  Intercept    -0.2324 0.0223 -10.44 &lt;0.0001 
##  Age=Old      -0.8305 0.0335 -24.78 &lt;0.0001 
##  Gender=Women -0.4201 0.0273 -15.42 &lt;0.0001 
## </code></pre>
<pre class="r"><code>anova(m2.lrm)</code></pre>
<pre><code>##                 Wald Statistics          Response: EH 
## 
##  Factor     Chi-Square d.f. P     
##  Age        614.04     1    &lt;.0001
##  Gender     237.65     1    &lt;.0001
##  TOTAL      802.65     2    &lt;.0001</code></pre>
<p>After fitting the model, we validate the model to avoid arriving at a
final minimal model that is overfitted to the data at hand.</p>
</div>
<div id="model-validation" class="section level3 unnumbered">
<h3 class="unnumbered">Model Validation</h3>
<p>To validate a model, you can apply the <code>validate</code> function
and apply it to a saturated model. The output of the
<code>validate</code> function shows how often predictors are retained
if the sample is re-selected with the same size but with placing back
drawn data points. The execution of the function requires some patience
as it is rather computationally expensive and it is, therefore,
commented out below.</p>
<pre class="r"><code># model validation (remove # to activate: output too long for website)
m7.lrm &lt;- lrm(EH ~ (Age+Gender+Ethnicity)^3, data = blrdata, x = T, y = T, linear.predictors = T)
#validate(m7.lrm, bw = T, B = 200)</code></pre>
<p>The <code>validate</code> function shows that retaining two
predictors (Age and Gender) is the best option and thereby confirms our
final minimal adequate model as the best minimal model. In addition, we
check whether we need to include a penalty for data points because they
have too strong of an impact of the model fit. To see whether a penalty
is warranted, we apply the <code>pentrace</code> function to the final
minimal adequate model.</p>
<pre class="r"><code>pentrace(m2.lrm, seq(0, 0.8, by = 0.05)) # determine penalty</code></pre>
<pre><code>## 
## Best penalty:
## 
##  penalty            df
##      0.8 1.99925395138
## 
##  penalty            df           aic           bic         aic.c
##     0.00 2.00000000000 864.213801108 847.895914321 864.213336316
##     0.05 1.99995335085 864.213893816 847.896387637 864.213429042
##     0.10 1.99990670452 864.213985335 847.896859740 864.213520579
##     0.15 1.99986006100 864.214075641 847.897330609 864.213610904
##     0.20 1.99981342030 864.214164764 847.897800270 864.213700044
##     0.25 1.99976678241 864.214252710 847.898268733 864.213788009
##     0.30 1.99972014734 864.214339446 847.898735961 864.213874762
##     0.35 1.99967351509 864.214424993 847.899201978 864.213960327
##     0.40 1.99962688564 864.214509360 847.899666792 864.214044712
##     0.45 1.99958025902 864.214592526 847.900130382 864.214127896
##     0.50 1.99953363520 864.214674504 847.900592761 864.214209892
##     0.55 1.99948701420 864.214755279 847.901053914 864.214290685
##     0.60 1.99944039601 864.214834874 847.901513865 864.214370299
##     0.65 1.99939378063 864.214913276 847.901972599 864.214448719
##     0.70 1.99934716807 864.214990480 847.902430112 864.214525941
##     0.75 1.99930055832 864.215066506 847.902886425 864.214601985
##     0.80 1.99925395138 864.215141352 847.903341534 864.214676849</code></pre>
<p>The values are so similar that a penalty is unnecessary. In a next
step, we rename the final models.</p>
<pre class="r"><code>lr.glm &lt;- m2.glm  # rename final minimal adequate glm model
lr.lrm &lt;- m2.lrm  # rename final minimal adequate lrm model</code></pre>
<p>Now, we calculate a Model Likelihood Ratio Test to check if the final
model performs significantly better than the initial minimal base-line
model. The result of this test is provided as a default if we call a
summary of the lrm object.</p>
<pre class="r"><code>modelChi &lt;- lr.glm$null.deviance - lr.glm$deviance
chidf &lt;- lr.glm$df.null - lr.glm$df.residual
chisq.prob &lt;- 1 - pchisq(modelChi, chidf)
modelChi; chidf; chisq.prob</code></pre>
<pre><code>## [1] 868.21380111</code></pre>
<pre><code>## [1] 2</code></pre>
<pre><code>## [1] 0</code></pre>
<p>The code above provides three values: a <span
class="math inline">\(\chi\)</span><sup>2</sup>, the degrees of freedom,
and a p-value. The p-value is lower than .05 and the results of the
Model Likelihood Ratio Test therefore confirm that the final minimal
adequate model performs significantly better than the initial minimal
base-line model. Another way to extract the model likelihood test
statistics is to use an ANOVA to compare the final minimal adequate
model to the minimal base-line model.</p>
<p>A handier way to get these statistics is by performing an ANOVA on
the final minimal model which, if used this way, is identical to a Model
Likelihood Ratio test.</p>
<pre class="r"><code>anova(m0.glm, lr.glm, test = &quot;Chi&quot;) # Model Likelihood Ratio Test</code></pre>
<pre><code>## Analysis of Deviance Table
## 
## Model 1: EH ~ 1
## Model 2: EH ~ Age + Gender
##   Resid. Df  Resid. Dev Df    Deviance               Pr(&gt;Chi)    
## 1     25820 33007.75469                                          
## 2     25818 32139.54089  2 868.2138011 &lt; 0.000000000000000222 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>In a next step, we calculate pseudo-R<sup>2</sup> values which
represent the amount of residual variance that is explained by the final
minimal adequate model. We cannot use the ordinary R<sup>2</sup> because
the model works on the logged probabilities rather than the values of
the dependent variable.</p>
<pre class="r"><code># calculate pseudo R^2
# number of cases
ncases &lt;- length(fitted(lr.glm))
R2.hl &lt;- modelChi/lr.glm$null.deviance
R.cs &lt;- 1 - exp ((lr.glm$deviance - lr.glm$null.deviance)/ncases)
R.n &lt;- R.cs /( 1- ( exp (-(lr.glm$null.deviance/ ncases))))
# function for extracting pseudo-R^2
logisticPseudoR2s &lt;- function(LogModel) {
  dev &lt;- LogModel$deviance
    nullDev &lt;- LogModel$null.deviance
    modelN &lt;-  length(LogModel$fitted.values)
    R.l &lt;-  1 -  dev / nullDev
    R.cs &lt;- 1- exp ( -(nullDev - dev) / modelN)
    R.n &lt;- R.cs / ( 1 - ( exp (-(nullDev / modelN))))
    cat(&quot;Pseudo R^2 for logistic regression\n&quot;)
    cat(&quot;Hosmer and Lemeshow R^2  &quot;, round(R.l, 3), &quot;\n&quot;)
    cat(&quot;Cox and Snell R^2        &quot;, round(R.cs, 3), &quot;\n&quot;)
    cat(&quot;Nagelkerke R^2           &quot;, round(R.n, 3),    &quot;\n&quot;) }
logisticPseudoR2s(lr.glm)</code></pre>
<pre><code>## Pseudo R^2 for logistic regression
## Hosmer and Lemeshow R^2   0.026 
## Cox and Snell R^2         0.033 
## Nagelkerke R^2            0.046</code></pre>
<p>The low pseudo-R<sup>2</sup> values show that our model has very low
explanatory power. For instance, the value of Hosmer and Lemeshow
R<sup>2</sup> (0.026) “is the proportional reduction in the absolute
value of the log-likelihood measure and as such it is a measure of how
much the badness of fit improves as a result of the inclusion of the
predictor variables” <span class="citation">(<a
href="#ref-field2012discovering" role="doc-biblioref">Field, Miles, and
Field 2012, 317</a>)</span>. In essence, all the pseudo-R<sup>2</sup>
values are measures of how substantive the model is (how much better it
is compared to a baseline model). Next, we extract the confidence
intervals for the coefficients of the model.</p>
<pre class="r"><code># extract the confidence intervals for the coefficients
confint(lr.glm)</code></pre>
<pre><code>##                       2.5 %          97.5 %
## (Intercept) -0.276050866670 -0.188778707810
## AgeOld      -0.896486392278 -0.765095825382
## GenderWomen -0.473530977637 -0.366703827307</code></pre>
<p>Despite having low explanatory and predictive power, the age of
speakers and their gender are significant as the confidence intervals of
the coefficients do not overlap with 0.</p>
</div>
<div id="effect-size" class="section level3 unnumbered">
<h3 class="unnumbered">Effect Size</h3>
<p>In a next step, we compute odds ratios and their confidence
intervals. Odds Ratios represent a common measure of effect size and can
be used to compare effect sizes across models. Odds ratios rang between
0 and infinity. Values of 1 indicate that there is no effect. The
further away the values are from 1, the stronger the effect. If the
values are lower than 1, then the variable level correlates negatively
with the occurrence of the outcome (the probability decreases) while
values above 1 indicate a positive correlation and show that the
variable level causes an increase in the probability of the outcome (the
occurrence of EH).</p>
<pre class="r"><code>exp(lr.glm$coefficients) # odds ratios</code></pre>
<pre><code>##    (Intercept)         AgeOld    GenderWomen 
## 0.792642499264 0.435815384592 0.656972294902</code></pre>
<pre class="r"><code>exp(confint(lr.glm))     # confidence intervals of the odds ratios</code></pre>
<pre><code>## Es wird auf das Profilieren gewartet ...</code></pre>
<pre><code>##                      2.5 %         97.5 %
## (Intercept) 0.758774333456 0.827969709653
## AgeOld      0.408000698619 0.465289342309
## GenderWomen 0.622799290871 0.693014866732</code></pre>
<p>The odds ratios confirm that older speakers use <em>eh</em>
significantly less often compared with younger speakers and that women
use <em>eh</em> less frequently than men as the confidence intervals of
the odds rations do not overlap with 1. In a next step, we calculate the
prediction accuracy of the model.</p>
</div>
<div id="prediction-accuracy" class="section level3 unnumbered">
<h3 class="unnumbered">Prediction Accuracy</h3>
<p>In order to calculate the prediction accuracy of the model, we
generate a variable called <em>Prediction</em> that contains the
predictions of pour model and which we add to the data. Then, we use the
<code>confusionMatrix</code> function from the <code>caret</code>
package <span class="citation">(<a href="#ref-caret"
role="doc-biblioref">Kuhn 2021</a>)</span> to extract the prediction
accuracy.</p>
<pre class="r"><code># create variable with contains the prediction of the model
blrdata &lt;- blrdata %&gt;%
  dplyr::mutate(Prediction = predict(lr.glm, type = &quot;response&quot;),
                Prediction = ifelse(Prediction &gt; .5, 1, 0),
                Prediction = factor(Prediction, levels = c(&quot;0&quot;, &quot;1&quot;)),
                EH = factor(EH, levels = c(&quot;0&quot;, &quot;1&quot;)))
# create a confusion matrix with compares observed against predicted values
caret::confusionMatrix(blrdata$Prediction, blrdata$EH)</code></pre>
<pre><code>## Confusion Matrix and Statistics
## 
##           Reference
## Prediction     0     1
##          0 17114  8707
##          1     0     0
##                                                     
##                Accuracy : 0.66279385                
##                  95% CI : (0.656990096, 0.668560948)
##     No Information Rate : 0.66279385                
##     P-Value [Acc &gt; NIR] : 0.5029107                 
##                                                     
##                   Kappa : 0                         
##                                                     
##  Mcnemar&#39;s Test P-Value : &lt; 0.00000000000000022     
##                                                     
##             Sensitivity : 1.00000000                
##             Specificity : 0.00000000                
##          Pos Pred Value : 0.66279385                
##          Neg Pred Value :        NaN                
##              Prevalence : 0.66279385                
##          Detection Rate : 0.66279385                
##    Detection Prevalence : 1.00000000                
##       Balanced Accuracy : 0.50000000                
##                                                     
##        &#39;Positive&#39; Class : 0                         
## </code></pre>
<p>We can see that out model has never predicted the use of <em>eh</em>
which is common when dealing with rare phenomena. This is expected as
the event s so rare that the probability of it not occurring
substantively outweighs the probability of it occurring. As such, the
prediction accuracy of our model is not significantly better compared to
the prediction accuracy of the baseline model which is the
no-information rate (NIR)) (p = 0.5029).</p>
<p>We can use the <code>plot_model</code> function from the
<code>sjPlot</code> package <span class="citation">(<a
href="#ref-sjPlot" role="doc-biblioref">Lüdecke 2021</a>)</span> to
visualize the effects.</p>
<pre class="r"><code># predicted probability
efp1 &lt;- plot_model(lr.glm, type = &quot;pred&quot;, terms = c(&quot;Age&quot;), axis.lim = c(0, 1)) 
# predicted percentage
efp2 &lt;- plot_model(lr.glm, type = &quot;pred&quot;, terms = c(&quot;Gender&quot;), axis.lim = c(0, 1)) 
grid.arrange(efp1, efp2, nrow = 1)</code></pre>
<p><img src="multireg_files/figure-html/blm27-1.png" width="672" /></p>
<p>And we can also combine the visualization of the effects in a single
plot as shown below.</p>
<pre class="r"><code>sjPlot::plot_model(lr.glm, type = &quot;pred&quot;, terms = c(&quot;Age&quot;, &quot;Gender&quot;), axis.lim = c(0, 1)) +
  theme(legend.position = &quot;top&quot;) +
  labs(x = &quot;&quot;, y = &quot;Predicted Probabilty of eh&quot;, title = &quot;&quot;) +
  scale_color_manual(values = c(&quot;gray20&quot;, &quot;gray70&quot;))</code></pre>
<p><img src="multireg_files/figure-html/blm28-1.png" width="672" /></p>
</div>
<div id="model-diagnostics" class="section level3 unnumbered">
<h3 class="unnumbered">Model Diagnostics</h3>
<p>We are now in a position to perform model diagnostics and test if the
model violates distributional requirements. In a first step, we test for
the existence of multicollinearity.</p>
</div>
<div id="multicollinearity" class="section level3 unnumbered">
<h3 class="unnumbered">Multicollinearity</h3>
<p>Multicollinearity means that predictors in a model can be predicted
by other predictors in the model (this means that they <em>share</em>
variance with other predictors). If this is the case, the model results
are unreliable because the presence of absence of one predictor has
substantive effects on at least one other predictor.</p>
<p>To check whether the final minimal model contains predictors that
correlate with each other, we extract variance inflation factors (VIF).
If a model contains predictors that have variance inflation factors
(VIF) &gt; 10 the model is unreliable <span class="citation">(<a
href="#ref-myers1990classical" role="doc-biblioref">Myers
1990</a>)</span>. <span class="citation">Gries (<a
href="#ref-gries2021statistics" role="doc-biblioref">2021</a>)</span>
shows that a VIF of 10 means that that predictor is explainable
(predictable) from the other predictors in the model with an
R<sup>2</sup> of .9 (a VIF of 5 means that predictor is explainable
(predictable) from the other predictors in the model with an
R<sup>2</sup> of .8).Indeed, predictors with VIF values greater than 4
are usually already problematic but, for large data sets, even VIFs
greater than 2 can lead inflated standard errors (<a
href="http://wiki.bcs.rochester.edu/HlpLab/LSA2013Regression?action=AttachFile&amp;do=view&amp;target=LSA13-Lecture6-CommonIssuesAndSolutions.pdf">Jaeger
2013</a>). Also, VIFs of 2.5 can be problematic <span
class="citation">(<a href="#ref-szmrecsanyi2006morphosyntactic"
role="doc-biblioref">Szmrecsanyi 2006, 215</a>)</span> and <span
class="citation">(<a href="#ref-zuur2010protocol"
role="doc-biblioref">Zuur, Ieno, and Elphick 2010</a>)</span> proposes
that variables with VIFs exceeding 3 should be removed.</p>
<div class="warning"
style="padding:0.1em; background-color:#f2f2f2; color:#51247a">
<span>
<p style="margin-top:1em; text-align:center">
<b>NOTE</b><br><br>However, (multi-)collinearity is only an issue if one
is interested in interpreting regression results! If the interpretation
is irrelevant because what is relevant is prediction(!), then it does
not matter if the model contains collinear predictors! See <span
class="citation">Gries (<a href="#ref-gries2021statistics"
role="doc-biblioref">2021</a>)</span> or the excursion below for a more
elaborate explanation.
</p>
<p style="margin-left:1em;">
</p>
<p></span></p>
</div>
<p><br></p>
<hr />
<div class="warning"
style="padding:0.1em; background-color:#f2f2f2; color:#51247a">
<span>
<p style="margin-top:1em; text-align:center">
<b>EXCURSION</b>
</p>
<p style="margin-left:1em;">
</p>
<p></span></p>
</div>
<div class="question">
<p>`</p>
<p>What is multicollinearity?<br></p>
<details>
<summary>
Answer
</summary>
<p><br></p>
<p>During the workshop on mixed-effects modeling, we talked about
(multi-)collinearity and someone asked if collinearity reflected shared
variance (what I thought) or predictability of variables (what the other
person thought). Both answers are correct! We will see below why…</p>
<hr />
<div class="warning"
style="padding:0.1em; background-color:#f2f2f2; color:#51247a">
<span>
<p style="margin-top:1em; text-align:center">
(Multi-)collinearity reflects the predictability of predictors based on
the values of other predictors!
</p>
</span>
</div>
<hr />
<p>To test this, I generate a data set with 4 independent variables
<code>a</code>, <code>b</code>, <code>c</code>, and <code>d</code> as
well as two potential response variables <code>r1</code> (which is
random) and <code>r2</code> (where the first 50 data points are the same
as in <code>r1</code> but for the second 50 data points I have added a
value of 50 to the data points 51 to 100 from <code>r1</code>). This
means that the predictors <code>a</code> and <code>d</code> should both
strongly correlate with <code>r2</code>.</p>
<pre class="r"><code>  # load packages
  library(dplyr)
  library(rms)
  # create data set
  # responses
  # 100 random numbers
  r1 &lt;- rnorm(100, 50, 10)
  # 50 smaller + 50 larger numbers
  r2 &lt;- c(r1[1:50], r1[51:100] + 50)
  # predictors
  a &lt;- c(rep(&quot;1&quot;, 50), rep (&quot;0&quot;, 50))
  b &lt;- rep(c(rep(&quot;1&quot;, 25), rep (&quot;0&quot;, 25)), 2)
  c &lt;- rep(c(rep(&quot;1&quot;, 10), rep(&quot;0&quot;, 10)), 5)
  d &lt;- c(rep(&quot;1&quot;, 47), rep (&quot;0&quot;, 3), rep (&quot;0&quot;, 47), rep (&quot;1&quot;, 3))
  # create data set
  df &lt;- data.frame(r1, r2, a, b, c, d)</code></pre>
  <template id="b3b2007a-b42c-48e4-a03c-40e0c9918b9d"><style>
  .tabwid table{
    border-spacing:0px !important;
    border-collapse:collapse;
    line-height:1;
    margin-left:auto;
    margin-right:auto;
    border-width: 0;
    display: table;
    margin-top: 1.275em;
    margin-bottom: 1.275em;
    border-color: transparent;
  }
  .tabwid_left table{
    margin-left:0;
  }
  .tabwid_right table{
    margin-right:0;
  }
  .tabwid td {
      padding: 0;
  }
  .tabwid a {
    text-decoration: none;
  }
  .tabwid thead {
      background-color: transparent;
  }
  .tabwid tfoot {
      background-color: transparent;
  }
  .tabwid table tr {
  background-color: transparent;
  }
  </style><div class="tabwid"><style>.cl-a50d547a{table-layout:auto;width:75%;}.cl-a501a80a{font-family:'Arial';font-size:12pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-a501a814{font-family:'Arial';font-size:12pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-a501c75e{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-a501c75f{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-a5020ff2{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-a5020ffc{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-a5021006{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-a5021007{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-a5021008{background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-a5021010{background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-a5021011{background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-a502101a{background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-a502101b{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-a502101c{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-a5021024{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-a5021025{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-a5021026{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-a502102e{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-a502102f{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-a5021038{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table class='cl-a50d547a'>
<caption class="Table Caption">
<p>First 10 rows of the mlrdata.</p>
</caption>
  <thead><tr style="overflow-wrap:break-word;"><td class="cl-a5021038"><p class="cl-a501c75e"><span class="cl-a501a80a">r1</span></p></td><td class="cl-a502102e"><p class="cl-a501c75e"><span class="cl-a501a80a">r2</span></p></td><td class="cl-a5021026"><p class="cl-a501c75f"><span class="cl-a501a80a">a</span></p></td><td class="cl-a5021026"><p class="cl-a501c75f"><span class="cl-a501a80a">b</span></p></td><td class="cl-a5021026"><p class="cl-a501c75f"><span class="cl-a501a80a">c</span></p></td><td class="cl-a502102f"><p class="cl-a501c75f"><span class="cl-a501a80a">d</span></p></td></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-a5020ffc"><p class="cl-a501c75e"><span class="cl-a501a814">55.3805120133</span></p></td><td class="cl-a5020ff2"><p class="cl-a501c75e"><span class="cl-a501a814">55.3805120133</span></p></td><td class="cl-a5021007"><p class="cl-a501c75f"><span class="cl-a501a814">1</span></p></td><td class="cl-a5021007"><p class="cl-a501c75f"><span class="cl-a501a814">1</span></p></td><td class="cl-a5021007"><p class="cl-a501c75f"><span class="cl-a501a814">1</span></p></td><td class="cl-a5021006"><p class="cl-a501c75f"><span class="cl-a501a814">1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-a502101c"><p class="cl-a501c75e"><span class="cl-a501a814">50.5169933942</span></p></td><td class="cl-a5021025"><p class="cl-a501c75e"><span class="cl-a501a814">50.5169933942</span></p></td><td class="cl-a502101b"><p class="cl-a501c75f"><span class="cl-a501a814">1</span></p></td><td class="cl-a502101b"><p class="cl-a501c75f"><span class="cl-a501a814">1</span></p></td><td class="cl-a502101b"><p class="cl-a501c75f"><span class="cl-a501a814">1</span></p></td><td class="cl-a5021024"><p class="cl-a501c75f"><span class="cl-a501a814">1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-a5020ffc"><p class="cl-a501c75e"><span class="cl-a501a814">67.5135734932</span></p></td><td class="cl-a5020ff2"><p class="cl-a501c75e"><span class="cl-a501a814">67.5135734932</span></p></td><td class="cl-a5021007"><p class="cl-a501c75f"><span class="cl-a501a814">1</span></p></td><td class="cl-a5021007"><p class="cl-a501c75f"><span class="cl-a501a814">1</span></p></td><td class="cl-a5021007"><p class="cl-a501c75f"><span class="cl-a501a814">1</span></p></td><td class="cl-a5021006"><p class="cl-a501c75f"><span class="cl-a501a814">1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-a502101c"><p class="cl-a501c75e"><span class="cl-a501a814">60.1733973728</span></p></td><td class="cl-a5021025"><p class="cl-a501c75e"><span class="cl-a501a814">60.1733973728</span></p></td><td class="cl-a502101b"><p class="cl-a501c75f"><span class="cl-a501a814">1</span></p></td><td class="cl-a502101b"><p class="cl-a501c75f"><span class="cl-a501a814">1</span></p></td><td class="cl-a502101b"><p class="cl-a501c75f"><span class="cl-a501a814">1</span></p></td><td class="cl-a5021024"><p class="cl-a501c75f"><span class="cl-a501a814">1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-a5020ffc"><p class="cl-a501c75e"><span class="cl-a501a814">72.3678161278</span></p></td><td class="cl-a5020ff2"><p class="cl-a501c75e"><span class="cl-a501a814">72.3678161278</span></p></td><td class="cl-a5021007"><p class="cl-a501c75f"><span class="cl-a501a814">1</span></p></td><td class="cl-a5021007"><p class="cl-a501c75f"><span class="cl-a501a814">1</span></p></td><td class="cl-a5021007"><p class="cl-a501c75f"><span class="cl-a501a814">1</span></p></td><td class="cl-a5021006"><p class="cl-a501c75f"><span class="cl-a501a814">1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-a502101c"><p class="cl-a501c75e"><span class="cl-a501a814">52.4309002788</span></p></td><td class="cl-a5021025"><p class="cl-a501c75e"><span class="cl-a501a814">52.4309002788</span></p></td><td class="cl-a502101b"><p class="cl-a501c75f"><span class="cl-a501a814">1</span></p></td><td class="cl-a502101b"><p class="cl-a501c75f"><span class="cl-a501a814">1</span></p></td><td class="cl-a502101b"><p class="cl-a501c75f"><span class="cl-a501a814">1</span></p></td><td class="cl-a5021024"><p class="cl-a501c75f"><span class="cl-a501a814">1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-a5020ffc"><p class="cl-a501c75e"><span class="cl-a501a814">55.6904236277</span></p></td><td class="cl-a5020ff2"><p class="cl-a501c75e"><span class="cl-a501a814">55.6904236277</span></p></td><td class="cl-a5021007"><p class="cl-a501c75f"><span class="cl-a501a814">1</span></p></td><td class="cl-a5021007"><p class="cl-a501c75f"><span class="cl-a501a814">1</span></p></td><td class="cl-a5021007"><p class="cl-a501c75f"><span class="cl-a501a814">1</span></p></td><td class="cl-a5021006"><p class="cl-a501c75f"><span class="cl-a501a814">1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-a502101c"><p class="cl-a501c75e"><span class="cl-a501a814">44.2366484882</span></p></td><td class="cl-a5021025"><p class="cl-a501c75e"><span class="cl-a501a814">44.2366484882</span></p></td><td class="cl-a502101b"><p class="cl-a501c75f"><span class="cl-a501a814">1</span></p></td><td class="cl-a502101b"><p class="cl-a501c75f"><span class="cl-a501a814">1</span></p></td><td class="cl-a502101b"><p class="cl-a501c75f"><span class="cl-a501a814">1</span></p></td><td class="cl-a5021024"><p class="cl-a501c75f"><span class="cl-a501a814">1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-a5020ffc"><p class="cl-a501c75e"><span class="cl-a501a814">55.5987335816</span></p></td><td class="cl-a5020ff2"><p class="cl-a501c75e"><span class="cl-a501a814">55.5987335816</span></p></td><td class="cl-a5021007"><p class="cl-a501c75f"><span class="cl-a501a814">1</span></p></td><td class="cl-a5021007"><p class="cl-a501c75f"><span class="cl-a501a814">1</span></p></td><td class="cl-a5021007"><p class="cl-a501c75f"><span class="cl-a501a814">1</span></p></td><td class="cl-a5021006"><p class="cl-a501c75f"><span class="cl-a501a814">1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-a5021010"><p class="cl-a501c75e"><span class="cl-a501a814">58.3120761737</span></p></td><td class="cl-a5021008"><p class="cl-a501c75e"><span class="cl-a501a814">58.3120761737</span></p></td><td class="cl-a5021011"><p class="cl-a501c75f"><span class="cl-a501a814">1</span></p></td><td class="cl-a5021011"><p class="cl-a501c75f"><span class="cl-a501a814">1</span></p></td><td class="cl-a5021011"><p class="cl-a501c75f"><span class="cl-a501a814">1</span></p></td><td class="cl-a502101a"><p class="cl-a501c75f"><span class="cl-a501a814">1</span></p></td></tr></tbody></table></div></template>
  <div class="flextable-shadow-host" id="4a3ffdc2-bc5c-4789-853d-bb8d1fab6673"></div>
  <script>
  var dest = document.getElementById("4a3ffdc2-bc5c-4789-853d-bb8d1fab6673");
  var template = document.getElementById("b3b2007a-b42c-48e4-a03c-40e0c9918b9d");
  var caption = template.content.querySelector("caption");
  if(caption) {
    caption.style.cssText = "display:block;text-align:center;";
    var newcapt = document.createElement("p");
    newcapt.appendChild(caption)
    dest.parentNode.insertBefore(newcapt, dest.previousSibling);
  }
  var fantome = dest.attachShadow({mode: 'open'});
  var templateContent = template.content;
  fantome.appendChild(templateContent);
  </script>
  
<p>Here are the visualizations of r1 and r2</p>
<p><img src="multireg_files/figure-html/data2-1.png" width="672" /><img src="multireg_files/figure-html/data2-2.png" width="672" /></p>
<p><strong>Fit first model</strong></p>
<p>Now, I fit a first model. As the response is random, we do not expect
any of the predictors to have a significant effect and we expect the
R<sup>2</sup> to be rather low.</p>
<pre class="r"><code>  m1 &lt;- lm(r1 ~ a + b + c + d, data = df)
  # inspect model
  summary(m1)</code></pre>
<pre><code>  ## 
  ## Call:
  ## lm(formula = r1 ~ a + b + c + d, data = df)
  ## 
  ## Residuals:
  ##           Min            1Q        Median            3Q           Max 
  ## -25.076373713  -7.774694324   0.933388851   6.630369791  22.021652947 
  ## 
  ## Coefficients:
  ##                 Estimate   Std. Error  t value             Pr(&gt;|t|)    
  ## (Intercept) 46.077236782  2.059313248 22.37505 &lt; 0.0000000000000002 ***
  ## a1           5.957479586  4.593681927  1.29689             0.197812    
  ## b1           5.148440925  2.098541787  2.45334             0.015977 *  
  ## c1          -0.213502165  2.188893729 -0.09754             0.922504    
  ## d1          -5.232737413  4.515342995 -1.15888             0.249410    
  ## ---
  ## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
  ## 
  ## Residual standard error: 10.4927089 on 95 degrees of freedom
  ## Multiple R-squared:  0.075627922,  Adjusted R-squared:  0.0367069924 
  ## F-statistic: 1.94311705 on 4 and 95 DF,  p-value: 0.109586389</code></pre>
<p>We now check for (multi-)collinearity using the <code>vif</code>
function from the <code>rms</code> package <span class="citation">(<a
href="#ref-rms" role="doc-biblioref">Harrell Jr 2021</a>)</span>.
Variables <code>a</code> and <code>d</code> should have high variance
inflation factor values (vif-values) because they overlap very much!</p>
<pre class="r"><code>  # extract vifs
  rms::vif(m1)</code></pre>
<pre><code>  ##            a1            b1            c1            d1 
  ## 4.79166666667 1.00000000000 1.08796296296 4.62962962963</code></pre>
<p>Variables <code>a</code> and <code>d</code> do indeed have high
vif-values.</p>
<p><strong>Fit second model</strong></p>
<p>We now fit a second model to the response which has higher values for
the latter part of the response. Both <code>a</code> and <code>d</code>
strongly correlate with the response. <strong>But</strong> because
<code>a</code> and <code>d</code> are collinear, <code>d</code> should
not be reported as being significant by the model. The R<sup>2</sup> of
the model should be rather high (given the correlation between the
response r2 and <code>a</code> and <code>d</code>).</p>
<pre class="r"><code>  m2 &lt;- lm(r2 ~ a + b + c + d, data = df)
  # inspect model
  summary(m2)</code></pre>
<pre><code>  ## 
  ## Call:
  ## lm(formula = r2 ~ a + b + c + d, data = df)
  ## 
  ## Residuals:
  ##           Min            1Q        Median            3Q           Max 
  ## -25.076373713  -7.774694324   0.933388851   6.630369791  22.021652947 
  ## 
  ## Coefficients:
  ##                  Estimate    Std. Error  t value               Pr(&gt;|t|)    
  ## (Intercept)  96.077236782   2.059313248 46.65499 &lt; 0.000000000000000222 ***
  ## a1          -44.042520414   4.593681927 -9.58763  0.0000000000000012574 ***
  ## b1            5.148440925   2.098541787  2.45334               0.015977 *  
  ## c1           -0.213502165   2.188893729 -0.09754               0.922504    
  ## d1           -5.232737413   4.515342995 -1.15888               0.249410    
  ## ---
  ## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
  ## 
  ## Residual standard error: 10.4927089 on 95 degrees of freedom
  ## Multiple R-squared:  0.851726565,  Adjusted R-squared:  0.845483473 
  ## F-statistic: 136.427041 on 4 and 95 DF,  p-value: &lt; 0.0000000000000002220446</code></pre>
<p>Again, we extract the vif-values.</p>
<pre class="r"><code>  # extract vifs
  rms::vif(m2)</code></pre>
<pre><code>  ##            a1            b1            c1            d1 
  ## 4.79166666667 1.00000000000 1.08796296296 4.62962962963</code></pre>
<p>The vif-values are identical which shows that what matters is if the
variables are predictable. To understand how we arrive at vif-values, we
inspect the model matrix.</p>
<pre class="r"><code>  # inspect model matrix
  mm &lt;- model.matrix(m2)</code></pre>
  <template id="dfdaa2ad-ef11-4aad-b4ce-186975e3b033"><style>
  .tabwid table{
    border-spacing:0px !important;
    border-collapse:collapse;
    line-height:1;
    margin-left:auto;
    margin-right:auto;
    border-width: 0;
    display: table;
    margin-top: 1.275em;
    margin-bottom: 1.275em;
    border-color: transparent;
  }
  .tabwid_left table{
    margin-left:0;
  }
  .tabwid_right table{
    margin-right:0;
  }
  .tabwid td {
      padding: 0;
  }
  .tabwid a {
    text-decoration: none;
  }
  .tabwid thead {
      background-color: transparent;
  }
  .tabwid tfoot {
      background-color: transparent;
  }
  .tabwid table tr {
  background-color: transparent;
  }
  </style><div class="tabwid"><style>.cl-a56c0c86{table-layout:auto;width:75%;}.cl-a55fcf2a{font-family:'Arial';font-size:12pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-a55fcf3e{font-family:'Arial';font-size:12pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-a55fe82a{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-a5603640{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-a5603641{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-a560364a{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-a5603654{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-a5603655{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-a560365e{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-a5603668{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-a5603669{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-a5603672{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-a5603673{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-a560367c{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-a560367d{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table class='cl-a56c0c86'>
<caption class="Table Caption">
<p>First 10 rows of the mlrdata.</p>
</caption>
  <thead><tr style="overflow-wrap:break-word;"><td class="cl-a5603673"><p class="cl-a55fe82a"><span class="cl-a55fcf2a">(Intercept)</span></p></td><td class="cl-a560367c"><p class="cl-a55fe82a"><span class="cl-a55fcf2a">a1</span></p></td><td class="cl-a560367c"><p class="cl-a55fe82a"><span class="cl-a55fcf2a">b1</span></p></td><td class="cl-a560367c"><p class="cl-a55fe82a"><span class="cl-a55fcf2a">c1</span></p></td><td class="cl-a560367d"><p class="cl-a55fe82a"><span class="cl-a55fcf2a">d1</span></p></td></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-a560364a"><p class="cl-a55fe82a"><span class="cl-a55fcf3e">1</span></p></td><td class="cl-a5603640"><p class="cl-a55fe82a"><span class="cl-a55fcf3e">1</span></p></td><td class="cl-a5603640"><p class="cl-a55fe82a"><span class="cl-a55fcf3e">1</span></p></td><td class="cl-a5603640"><p class="cl-a55fe82a"><span class="cl-a55fcf3e">1</span></p></td><td class="cl-a5603641"><p class="cl-a55fe82a"><span class="cl-a55fcf3e">1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-a560365e"><p class="cl-a55fe82a"><span class="cl-a55fcf3e">1</span></p></td><td class="cl-a5603654"><p class="cl-a55fe82a"><span class="cl-a55fcf3e">1</span></p></td><td class="cl-a5603654"><p class="cl-a55fe82a"><span class="cl-a55fcf3e">1</span></p></td><td class="cl-a5603654"><p class="cl-a55fe82a"><span class="cl-a55fcf3e">1</span></p></td><td class="cl-a5603655"><p class="cl-a55fe82a"><span class="cl-a55fcf3e">1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-a560364a"><p class="cl-a55fe82a"><span class="cl-a55fcf3e">1</span></p></td><td class="cl-a5603640"><p class="cl-a55fe82a"><span class="cl-a55fcf3e">1</span></p></td><td class="cl-a5603640"><p class="cl-a55fe82a"><span class="cl-a55fcf3e">1</span></p></td><td class="cl-a5603640"><p class="cl-a55fe82a"><span class="cl-a55fcf3e">1</span></p></td><td class="cl-a5603641"><p class="cl-a55fe82a"><span class="cl-a55fcf3e">1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-a560365e"><p class="cl-a55fe82a"><span class="cl-a55fcf3e">1</span></p></td><td class="cl-a5603654"><p class="cl-a55fe82a"><span class="cl-a55fcf3e">1</span></p></td><td class="cl-a5603654"><p class="cl-a55fe82a"><span class="cl-a55fcf3e">1</span></p></td><td class="cl-a5603654"><p class="cl-a55fe82a"><span class="cl-a55fcf3e">1</span></p></td><td class="cl-a5603655"><p class="cl-a55fe82a"><span class="cl-a55fcf3e">1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-a560364a"><p class="cl-a55fe82a"><span class="cl-a55fcf3e">1</span></p></td><td class="cl-a5603640"><p class="cl-a55fe82a"><span class="cl-a55fcf3e">1</span></p></td><td class="cl-a5603640"><p class="cl-a55fe82a"><span class="cl-a55fcf3e">1</span></p></td><td class="cl-a5603640"><p class="cl-a55fe82a"><span class="cl-a55fcf3e">1</span></p></td><td class="cl-a5603641"><p class="cl-a55fe82a"><span class="cl-a55fcf3e">1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-a560365e"><p class="cl-a55fe82a"><span class="cl-a55fcf3e">1</span></p></td><td class="cl-a5603654"><p class="cl-a55fe82a"><span class="cl-a55fcf3e">1</span></p></td><td class="cl-a5603654"><p class="cl-a55fe82a"><span class="cl-a55fcf3e">1</span></p></td><td class="cl-a5603654"><p class="cl-a55fe82a"><span class="cl-a55fcf3e">1</span></p></td><td class="cl-a5603655"><p class="cl-a55fe82a"><span class="cl-a55fcf3e">1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-a560364a"><p class="cl-a55fe82a"><span class="cl-a55fcf3e">1</span></p></td><td class="cl-a5603640"><p class="cl-a55fe82a"><span class="cl-a55fcf3e">1</span></p></td><td class="cl-a5603640"><p class="cl-a55fe82a"><span class="cl-a55fcf3e">1</span></p></td><td class="cl-a5603640"><p class="cl-a55fe82a"><span class="cl-a55fcf3e">1</span></p></td><td class="cl-a5603641"><p class="cl-a55fe82a"><span class="cl-a55fcf3e">1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-a560365e"><p class="cl-a55fe82a"><span class="cl-a55fcf3e">1</span></p></td><td class="cl-a5603654"><p class="cl-a55fe82a"><span class="cl-a55fcf3e">1</span></p></td><td class="cl-a5603654"><p class="cl-a55fe82a"><span class="cl-a55fcf3e">1</span></p></td><td class="cl-a5603654"><p class="cl-a55fe82a"><span class="cl-a55fcf3e">1</span></p></td><td class="cl-a5603655"><p class="cl-a55fe82a"><span class="cl-a55fcf3e">1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-a560364a"><p class="cl-a55fe82a"><span class="cl-a55fcf3e">1</span></p></td><td class="cl-a5603640"><p class="cl-a55fe82a"><span class="cl-a55fcf3e">1</span></p></td><td class="cl-a5603640"><p class="cl-a55fe82a"><span class="cl-a55fcf3e">1</span></p></td><td class="cl-a5603640"><p class="cl-a55fe82a"><span class="cl-a55fcf3e">1</span></p></td><td class="cl-a5603641"><p class="cl-a55fe82a"><span class="cl-a55fcf3e">1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-a560365e"><p class="cl-a55fe82a"><span class="cl-a55fcf3e">1</span></p></td><td class="cl-a5603654"><p class="cl-a55fe82a"><span class="cl-a55fcf3e">1</span></p></td><td class="cl-a5603654"><p class="cl-a55fe82a"><span class="cl-a55fcf3e">1</span></p></td><td class="cl-a5603654"><p class="cl-a55fe82a"><span class="cl-a55fcf3e">1</span></p></td><td class="cl-a5603655"><p class="cl-a55fe82a"><span class="cl-a55fcf3e">1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-a560364a"><p class="cl-a55fe82a"><span class="cl-a55fcf3e">1</span></p></td><td class="cl-a5603640"><p class="cl-a55fe82a"><span class="cl-a55fcf3e">1</span></p></td><td class="cl-a5603640"><p class="cl-a55fe82a"><span class="cl-a55fcf3e">1</span></p></td><td class="cl-a5603640"><p class="cl-a55fe82a"><span class="cl-a55fcf3e">0</span></p></td><td class="cl-a5603641"><p class="cl-a55fe82a"><span class="cl-a55fcf3e">1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-a560365e"><p class="cl-a55fe82a"><span class="cl-a55fcf3e">1</span></p></td><td class="cl-a5603654"><p class="cl-a55fe82a"><span class="cl-a55fcf3e">1</span></p></td><td class="cl-a5603654"><p class="cl-a55fe82a"><span class="cl-a55fcf3e">1</span></p></td><td class="cl-a5603654"><p class="cl-a55fe82a"><span class="cl-a55fcf3e">0</span></p></td><td class="cl-a5603655"><p class="cl-a55fe82a"><span class="cl-a55fcf3e">1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-a560364a"><p class="cl-a55fe82a"><span class="cl-a55fcf3e">1</span></p></td><td class="cl-a5603640"><p class="cl-a55fe82a"><span class="cl-a55fcf3e">1</span></p></td><td class="cl-a5603640"><p class="cl-a55fe82a"><span class="cl-a55fcf3e">1</span></p></td><td class="cl-a5603640"><p class="cl-a55fe82a"><span class="cl-a55fcf3e">0</span></p></td><td class="cl-a5603641"><p class="cl-a55fe82a"><span class="cl-a55fcf3e">1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-a560365e"><p class="cl-a55fe82a"><span class="cl-a55fcf3e">1</span></p></td><td class="cl-a5603654"><p class="cl-a55fe82a"><span class="cl-a55fcf3e">1</span></p></td><td class="cl-a5603654"><p class="cl-a55fe82a"><span class="cl-a55fcf3e">1</span></p></td><td class="cl-a5603654"><p class="cl-a55fe82a"><span class="cl-a55fcf3e">0</span></p></td><td class="cl-a5603655"><p class="cl-a55fe82a"><span class="cl-a55fcf3e">1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-a5603668"><p class="cl-a55fe82a"><span class="cl-a55fcf3e">1</span></p></td><td class="cl-a5603669"><p class="cl-a55fe82a"><span class="cl-a55fcf3e">1</span></p></td><td class="cl-a5603669"><p class="cl-a55fe82a"><span class="cl-a55fcf3e">1</span></p></td><td class="cl-a5603669"><p class="cl-a55fe82a"><span class="cl-a55fcf3e">0</span></p></td><td class="cl-a5603672"><p class="cl-a55fe82a"><span class="cl-a55fcf3e">1</span></p></td></tr></tbody></table></div></template>
  <div class="flextable-shadow-host" id="537abcec-4385-4ee8-ae59-799584954db8"></div>
  <script>
  var dest = document.getElementById("537abcec-4385-4ee8-ae59-799584954db8");
  var template = document.getElementById("dfdaa2ad-ef11-4aad-b4ce-186975e3b033");
  var caption = template.content.querySelector("caption");
  if(caption) {
    caption.style.cssText = "display:block;text-align:center;";
    var newcapt = document.createElement("p");
    newcapt.appendChild(caption)
    dest.parentNode.insertBefore(newcapt, dest.previousSibling);
  }
  var fantome = dest.attachShadow({mode: 'open'});
  var templateContent = template.content;
  fantome.appendChild(templateContent);
  </script>
  
<p>We now fit a linear model in which we predict <code>d</code> from the
other predictors in the model matrix.</p>
<pre class="r"><code>  mt &lt;- lm(mm[,5] ~ mm[,1:4])
  summary(mt)$r.squared</code></pre>
<pre><code>  ## [1] 0.784</code></pre>
<p>The R<sup>2</sup> shows that the values of <code>d</code> are
explained to 78.4 percent by the values of the other predictors in the
model.</p>
<p>Now, we can write a function <span class="citation">(taken from <a
href="#ref-gries2021statistics" role="doc-biblioref">Gries
2021</a>)</span> that converts this R<sup>2</sup> value</p>
<pre class="r"><code>  R2.to.VIF &lt;- function(some.modelmatrix.r2) {
  return(1/(1-some.modelmatrix.r2)) } 
  R2.to.VIF(0.784)</code></pre>
<pre><code>  ## [1] 4.62962962963</code></pre>
<p>The function outputs the vif-value of <code>d</code>. This shows that
the vif-value of <code>d</code> represents its predictability from the
other predictors in the model matrix which represents the amount of
shared variance between <code>d</code> and the other predictors in the
model.</p>
</details>
</div>
<p>`</p>
<hr />
<p><br></p>
<p>We now extract and check the VIFs of the model.</p>
<pre class="r"><code>vif(lr.glm)</code></pre>
<pre><code>##        AgeOld   GenderWomen 
## 1.00481494539 1.00481494539</code></pre>
<p>In addition, predictors with 1/VIF values <span
class="math inline">\(&lt;\)</span> .1 must be removed (data points with
values above .2 are considered problematic) <span class="citation">(<a
href="#ref-menard1995applied" role="doc-biblioref">Menard
1995</a>)</span> and the mean value of VIFs should be <span
class="math inline">\(~\)</span> 1 <span class="citation">(<a
href="#ref-bowerman1990linear" role="doc-biblioref">Bowerman and
O’Connell 1990</a>)</span>.</p>
<pre class="r"><code>mean(vif(lr.glm))</code></pre>
<pre><code>## [1] 1.00481494539</code></pre>
</div>
<div id="outlier-detection-1" class="section level3 unnumbered">
<h3 class="unnumbered">Outlier detection</h3>
<p>In order to detect potential outliers, we will calculate diagnostic
parameters and add these to our data set.</p>
<pre class="r"><code>infl &lt;- influence.measures(lr.glm) # calculate influence statistics
blrdata &lt;- data.frame(blrdata, infl[[1]], infl[[2]]) # add influence statistics</code></pre>
<p>In a next step, we use these diagnostic parameters to check if there
are data points which should be removed as they unduly affect the model
fit.</p>
</div>
<div id="sample-size" class="section level3 unnumbered">
<h3 class="unnumbered">Sample Size</h3>
<p>We now check whether the sample size is sufficient for our analysis
<span class="citation">(<a href="#ref-green1991many"
role="doc-biblioref">Green 1991</a>)</span>.</p>
<ul>
<li><p>if you are interested in the overall model: 50 + 8k (k = number
of predictors)</p></li>
<li><p>if you are interested in individual predictors: 104 + k</p></li>
<li><p>if you are interested in both: take the higher value!</p></li>
</ul>
<pre class="r"><code># function to evaluate sample size
smplesz &lt;- function(x) {
  ifelse((length(x$fitted) &lt; (104 + ncol(summary(x)$coefficients)-1)) == TRUE,
    return(
      paste(&quot;Sample too small: please increase your sample by &quot;,
      104 + ncol(summary(x)$coefficients)-1 - length(x$fitted),
      &quot; data points&quot;, collapse = &quot;&quot;)),
    return(&quot;Sample size sufficient&quot;)) }
# apply unction to model
smplesz(lr.glm)</code></pre>
<pre><code>## [1] &quot;Sample size sufficient&quot;</code></pre>
<p>According to rule of thumb provided in <span class="citation">Green
(<a href="#ref-green1991many" role="doc-biblioref">1991</a>)</span>, the
sample size is sufficient for our analysis.</p>
</div>
<div id="summarizing-results" class="section level3 unnumbered">
<h3 class="unnumbered">Summarizing Results</h3>
<p>As a final step, we summarize our findings in tabulated form.</p>
<pre class="r"><code>sjPlot::tab_model(lr.glm)</code></pre>
<table style="border-collapse:collapse; border:none;">
<tr>
<th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">
 
</th>
<th colspan="3" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">
EH
</th>
</tr>
<tr>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">
Predictors
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
Odds Ratios
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
CI
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
p
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
(Intercept)
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.79
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.76 – 0.83
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
<strong>&lt;0.001</strong>
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
Age [Old]
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.44
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.41 – 0.47
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
<strong>&lt;0.001</strong>
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
Gender [Women]
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.66
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.62 – 0.69
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
<strong>&lt;0.001</strong>
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;">
Observations
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="3">
25821
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
R<sup>2</sup> Tjur
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">
0.032
</td>
</tr>
</table>
<hr />
<p>A more detailed summary table can be retrieved as follows:</p>
<pre class="r"><code># load function
source(&quot;https://slcladal.github.io/rscripts/blrsummary.r&quot;)
# calculate accuracy 
predict.acc &lt;- caret::confusionMatrix(blrdata$Prediction, blrdata$EH)
predict.acc &lt;- predict.acc[3]$overall[[1]]
# create summary table
blrsummarytb &lt;- blrsummary(lr.glm, lr.lrm, predict.acc) </code></pre>
<template id="825db8bf-689a-4f8a-a7c1-5d5a0c3664da"><style>
.tabwid table{
  border-spacing:0px !important;
  border-collapse:collapse;
  line-height:1;
  margin-left:auto;
  margin-right:auto;
  border-width: 0;
  display: table;
  margin-top: 1.275em;
  margin-bottom: 1.275em;
  border-color: transparent;
}
.tabwid_left table{
  margin-left:0;
}
.tabwid_right table{
  margin-right:0;
}
.tabwid td {
    padding: 0;
}
.tabwid a {
  text-decoration: none;
}
.tabwid thead {
    background-color: transparent;
}
.tabwid tfoot {
    background-color: transparent;
}
.tabwid table tr {
background-color: transparent;
}
</style><div class="tabwid"><style>.cl-a7df0202{table-layout:auto;width:75%;}.cl-a7d4a190{font-family:'Arial';font-size:12pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-a7d4a19a{font-family:'Arial';font-size:12pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-a7d4bd1a{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-a7d531aa{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-a7d531be{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-a7d531bf{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-a7d531c8{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-a7d531d2{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-a7d531dc{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-a7d531dd{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-a7d531e6{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-a7d531e7{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-a7d531e8{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-a7d531f0{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-a7d531f1{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table class='cl-a7df0202'>
<caption class="Table Caption">
<p>Results of the binomial logistic regression analysis.</p>
</caption>
<thead><tr style="overflow-wrap:break-word;"><td class="cl-a7d531f0"><p class="cl-a7d4bd1a"><span class="cl-a7d4a190">Statistics</span></p></td><td class="cl-a7d531e8"><p class="cl-a7d4bd1a"><span class="cl-a7d4a190">Estimate</span></p></td><td class="cl-a7d531e8"><p class="cl-a7d4bd1a"><span class="cl-a7d4a190">VIF</span></p></td><td class="cl-a7d531e8"><p class="cl-a7d4bd1a"><span class="cl-a7d4a190">OddsRatio</span></p></td><td class="cl-a7d531e8"><p class="cl-a7d4bd1a"><span class="cl-a7d4a190">CI(2.5%)</span></p></td><td class="cl-a7d531e8"><p class="cl-a7d4bd1a"><span class="cl-a7d4a190">CI(97.5%)</span></p></td><td class="cl-a7d531e8"><p class="cl-a7d4bd1a"><span class="cl-a7d4a190">Std. Error</span></p></td><td class="cl-a7d531e8"><p class="cl-a7d4bd1a"><span class="cl-a7d4a190">z value</span></p></td><td class="cl-a7d531e8"><p class="cl-a7d4bd1a"><span class="cl-a7d4a190">Pr(&gt;|z|)</span></p></td><td class="cl-a7d531f1"><p class="cl-a7d4bd1a"><span class="cl-a7d4a190">Significance</span></p></td></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-a7d531be"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a">(Intercept)</span></p></td><td class="cl-a7d531aa"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a">-0.23</span></p></td><td class="cl-a7d531aa"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a"></span></p></td><td class="cl-a7d531aa"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a">0.79</span></p></td><td class="cl-a7d531aa"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a">0.76</span></p></td><td class="cl-a7d531aa"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a">0.83</span></p></td><td class="cl-a7d531aa"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a">0.02</span></p></td><td class="cl-a7d531aa"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a">-10.44</span></p></td><td class="cl-a7d531aa"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a">0</span></p></td><td class="cl-a7d531bf"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a">p &lt; .001***</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-a7d531d2"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a">AgeOld</span></p></td><td class="cl-a7d531c8"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a">-0.83</span></p></td><td class="cl-a7d531c8"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a">1</span></p></td><td class="cl-a7d531c8"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a">0.44</span></p></td><td class="cl-a7d531c8"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a">0.41</span></p></td><td class="cl-a7d531c8"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a">0.47</span></p></td><td class="cl-a7d531c8"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a">0.03</span></p></td><td class="cl-a7d531c8"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a">-24.78</span></p></td><td class="cl-a7d531c8"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a">0</span></p></td><td class="cl-a7d531dc"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a">p &lt; .001***</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-a7d531be"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a">GenderWomen</span></p></td><td class="cl-a7d531aa"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a">-0.42</span></p></td><td class="cl-a7d531aa"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a">1</span></p></td><td class="cl-a7d531aa"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a">0.66</span></p></td><td class="cl-a7d531aa"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a">0.62</span></p></td><td class="cl-a7d531aa"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a">0.69</span></p></td><td class="cl-a7d531aa"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a">0.03</span></p></td><td class="cl-a7d531aa"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a">-15.42</span></p></td><td class="cl-a7d531aa"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a">0</span></p></td><td class="cl-a7d531bf"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a">p &lt; .001***</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-a7d531d2"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a">Model statistics</span></p></td><td class="cl-a7d531c8"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a"></span></p></td><td class="cl-a7d531c8"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a"></span></p></td><td class="cl-a7d531c8"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a"></span></p></td><td class="cl-a7d531c8"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a"></span></p></td><td class="cl-a7d531c8"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a"></span></p></td><td class="cl-a7d531c8"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a"></span></p></td><td class="cl-a7d531c8"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a"></span></p></td><td class="cl-a7d531c8"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a"></span></p></td><td class="cl-a7d531dc"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a">Value</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-a7d531be"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a">Number of cases in model</span></p></td><td class="cl-a7d531aa"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a"></span></p></td><td class="cl-a7d531aa"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a"></span></p></td><td class="cl-a7d531aa"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a"></span></p></td><td class="cl-a7d531aa"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a"></span></p></td><td class="cl-a7d531aa"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a"></span></p></td><td class="cl-a7d531aa"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a"></span></p></td><td class="cl-a7d531aa"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a"></span></p></td><td class="cl-a7d531aa"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a"></span></p></td><td class="cl-a7d531bf"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a">25821</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-a7d531d2"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a">Observed misses</span></p></td><td class="cl-a7d531c8"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a"></span></p></td><td class="cl-a7d531c8"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a"></span></p></td><td class="cl-a7d531c8"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a"></span></p></td><td class="cl-a7d531c8"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a"></span></p></td><td class="cl-a7d531c8"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a"></span></p></td><td class="cl-a7d531c8"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a"></span></p></td><td class="cl-a7d531c8"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a"></span></p></td><td class="cl-a7d531c8"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a">0 :</span></p></td><td class="cl-a7d531dc"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a">17114</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-a7d531be"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a">Observed successes</span></p></td><td class="cl-a7d531aa"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a"></span></p></td><td class="cl-a7d531aa"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a"></span></p></td><td class="cl-a7d531aa"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a"></span></p></td><td class="cl-a7d531aa"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a"></span></p></td><td class="cl-a7d531aa"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a"></span></p></td><td class="cl-a7d531aa"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a"></span></p></td><td class="cl-a7d531aa"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a"></span></p></td><td class="cl-a7d531aa"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a">1 :</span></p></td><td class="cl-a7d531bf"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a">8707</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-a7d531d2"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a">Null deviance</span></p></td><td class="cl-a7d531c8"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a"></span></p></td><td class="cl-a7d531c8"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a"></span></p></td><td class="cl-a7d531c8"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a"></span></p></td><td class="cl-a7d531c8"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a"></span></p></td><td class="cl-a7d531c8"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a"></span></p></td><td class="cl-a7d531c8"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a"></span></p></td><td class="cl-a7d531c8"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a"></span></p></td><td class="cl-a7d531c8"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a"></span></p></td><td class="cl-a7d531dc"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a">33007.75</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-a7d531be"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a">Residual deviance</span></p></td><td class="cl-a7d531aa"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a"></span></p></td><td class="cl-a7d531aa"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a"></span></p></td><td class="cl-a7d531aa"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a"></span></p></td><td class="cl-a7d531aa"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a"></span></p></td><td class="cl-a7d531aa"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a"></span></p></td><td class="cl-a7d531aa"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a"></span></p></td><td class="cl-a7d531aa"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a"></span></p></td><td class="cl-a7d531aa"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a"></span></p></td><td class="cl-a7d531bf"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a">32139.54</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-a7d531d2"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a">R2 (Nagelkerke)</span></p></td><td class="cl-a7d531c8"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a"></span></p></td><td class="cl-a7d531c8"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a"></span></p></td><td class="cl-a7d531c8"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a"></span></p></td><td class="cl-a7d531c8"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a"></span></p></td><td class="cl-a7d531c8"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a"></span></p></td><td class="cl-a7d531c8"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a"></span></p></td><td class="cl-a7d531c8"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a"></span></p></td><td class="cl-a7d531c8"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a"></span></p></td><td class="cl-a7d531dc"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a">0.046</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-a7d531be"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a">R2 (Hosmer &amp; Lemeshow)</span></p></td><td class="cl-a7d531aa"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a"></span></p></td><td class="cl-a7d531aa"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a"></span></p></td><td class="cl-a7d531aa"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a"></span></p></td><td class="cl-a7d531aa"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a"></span></p></td><td class="cl-a7d531aa"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a"></span></p></td><td class="cl-a7d531aa"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a"></span></p></td><td class="cl-a7d531aa"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a"></span></p></td><td class="cl-a7d531aa"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a"></span></p></td><td class="cl-a7d531bf"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a">0.026</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-a7d531d2"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a">R2 (Cox &amp; Snell)</span></p></td><td class="cl-a7d531c8"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a"></span></p></td><td class="cl-a7d531c8"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a"></span></p></td><td class="cl-a7d531c8"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a"></span></p></td><td class="cl-a7d531c8"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a"></span></p></td><td class="cl-a7d531c8"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a"></span></p></td><td class="cl-a7d531c8"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a"></span></p></td><td class="cl-a7d531c8"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a"></span></p></td><td class="cl-a7d531c8"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a"></span></p></td><td class="cl-a7d531dc"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a">0.033</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-a7d531be"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a">C</span></p></td><td class="cl-a7d531aa"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a"></span></p></td><td class="cl-a7d531aa"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a"></span></p></td><td class="cl-a7d531aa"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a"></span></p></td><td class="cl-a7d531aa"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a"></span></p></td><td class="cl-a7d531aa"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a"></span></p></td><td class="cl-a7d531aa"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a"></span></p></td><td class="cl-a7d531aa"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a"></span></p></td><td class="cl-a7d531aa"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a"></span></p></td><td class="cl-a7d531bf"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a">0.602</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-a7d531d2"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a">Somers' Dxy</span></p></td><td class="cl-a7d531c8"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a"></span></p></td><td class="cl-a7d531c8"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a"></span></p></td><td class="cl-a7d531c8"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a"></span></p></td><td class="cl-a7d531c8"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a"></span></p></td><td class="cl-a7d531c8"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a"></span></p></td><td class="cl-a7d531c8"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a"></span></p></td><td class="cl-a7d531c8"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a"></span></p></td><td class="cl-a7d531c8"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a"></span></p></td><td class="cl-a7d531dc"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a">0.203</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-a7d531be"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a">AIC</span></p></td><td class="cl-a7d531aa"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a"></span></p></td><td class="cl-a7d531aa"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a"></span></p></td><td class="cl-a7d531aa"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a"></span></p></td><td class="cl-a7d531aa"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a"></span></p></td><td class="cl-a7d531aa"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a"></span></p></td><td class="cl-a7d531aa"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a"></span></p></td><td class="cl-a7d531aa"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a"></span></p></td><td class="cl-a7d531aa"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a"></span></p></td><td class="cl-a7d531bf"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a">32145.54</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-a7d531d2"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a">Prediction accuracy</span></p></td><td class="cl-a7d531c8"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a"></span></p></td><td class="cl-a7d531c8"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a"></span></p></td><td class="cl-a7d531c8"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a"></span></p></td><td class="cl-a7d531c8"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a"></span></p></td><td class="cl-a7d531c8"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a"></span></p></td><td class="cl-a7d531c8"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a"></span></p></td><td class="cl-a7d531c8"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a"></span></p></td><td class="cl-a7d531c8"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a"></span></p></td><td class="cl-a7d531dc"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a">0.66%</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-a7d531e6"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a">Model Likelihood Ratio Test</span></p></td><td class="cl-a7d531dd"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a"></span></p></td><td class="cl-a7d531dd"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a"></span></p></td><td class="cl-a7d531dd"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a"></span></p></td><td class="cl-a7d531dd"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a"></span></p></td><td class="cl-a7d531dd"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a"></span></p></td><td class="cl-a7d531dd"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a">Model L.R.: 868.21</span></p></td><td class="cl-a7d531dd"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a">df: 2</span></p></td><td class="cl-a7d531dd"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a">p-value: 0</span></p></td><td class="cl-a7d531e7"><p class="cl-a7d4bd1a"><span class="cl-a7d4a19a">sig: p &lt; .001***</span></p></td></tr></tbody></table></div></template>
<div class="flextable-shadow-host" id="16798fd2-0f90-4caf-bc83-0ccad7577cf5"></div>
<script>
var dest = document.getElementById("16798fd2-0f90-4caf-bc83-0ccad7577cf5");
var template = document.getElementById("825db8bf-689a-4f8a-a7c1-5d5a0c3664da");
var caption = template.content.querySelector("caption");
if(caption) {
  caption.style.cssText = "display:block;text-align:center;";
  var newcapt = document.createElement("p");
  newcapt.appendChild(caption)
  dest.parentNode.insertBefore(newcapt, dest.previousSibling);
}
var fantome = dest.attachShadow({mode: 'open'});
var templateContent = template.content;
fantome.appendChild(templateContent);
</script>

<p><strong>R<sup>2</sup> (Hosmer &amp; Lemeshow)</strong></p>
<p>Hosmer and Lemeshow’s R<sup>2</sup> “is the proportional reduction in
the absolute value of the log-likelihood measure and as such it is a
measure of how much the badness of fit improves as a result of the
inclusion of the predictor variables. It can vary between 0 (indicating
that the predictors are useless at predicting the outcome variable) and
1 (indicating that the model predicts the outcome variable perfectly)”
<span class="citation">(<a href="#ref-field2012discovering"
role="doc-biblioref">Field, Miles, and Field 2012, 317</a>)</span>.</p>
<p><strong>R<sup>2</sup> (Cox &amp; Snell)</strong></p>
<p>“Cox and Snell’s R<sup>2</sup> (1989) is based on the deviance of the
model (-2LL(new») and the deviance of the baseline model
(-2LL(baseline), and the sample size, n […]. However, this statistic
never reaches its theoretical maximum of 1.</p>
<p><strong>R2 (Nagelkerke)</strong></p>
<p>Since R<sup>2</sup> (Cox &amp; Snell) never reaches its theoretical
maximum of 1, Nagelkerke (1991) suggested Nagelkerke’s R<sup>2</sup>
<span class="citation">(<a href="#ref-field2012discovering"
role="doc-biblioref">Field, Miles, and Field 2012,
317–18</a>)</span>.</p>
<p><strong>Somers’ D<sub>xy</sub></strong></p>
<p>Somers’ D<sub>xy</sub> is a rank correlation between predicted
probabilities and observed responses ranges between 0 (randomness) and 1
(perfect prediction). Somers’ D<sub>xy</sub> should have a value higher
than .5 for the model to be meaningful <span class="citation">(<a
href="#ref-baayen2008analyzing" role="doc-biblioref">Baayen 2008,
204</a>)</span>.</p>
<p><strong>C</strong></p>
<p>C is an index of concordance between the predicted probability and
the observed response. When C takes the value 0.5, the predictions are
random, when it is 1, prediction is perfect. A value above 0.8 indicates
that the model may have some real predictive capacity <span
class="citation">(<a href="#ref-baayen2008analyzing"
role="doc-biblioref">Baayen 2008, 204</a>)</span>.</p>
<p><strong>Akaike information criteria (AIC)</strong></p>
<p>Akaike information criteria (AlC = -2LL + 2k) provide a value that
reflects a ratio between the number of predictors in the model and the
variance that is explained by these predictors. Changes in AIC can serve
as a measure of whether the inclusion of a variable leads to a
significant increase in the amount of variance that is explained by the
model. “You can think of this as the price you pay for something: you
get a better value of R<sup>2</sup>, but you pay a higher price, and was
that higher price worth it? These information criteria help you to
decide. The BIC is the same as the AIC but adjusts the penalty included
in the AlC (i.e., 2k) by the number of cases: BlC = -2LL + 2k x log(n)
in which n is the number of cases in the model” <span
class="citation">(<a href="#ref-field2012discovering"
role="doc-biblioref">Field, Miles, and Field 2012, 318</a>)</span>.</p>
<p>We can use the <code>reports</code> package <span
class="citation">(<a href="#ref-report" role="doc-biblioref">Makowski et
al. 2021</a>)</span> to summarize the analysis.</p>
<pre class="r"><code>report::report(lr.glm)</code></pre>
<pre><code>## We fitted a logistic model (estimated using ML) to predict EH with Age and Gender (formula: EH ~ Age + Gender). The model&#39;s explanatory power is weak (Tjur&#39;s R2 = 0.03). The model&#39;s intercept, corresponding to Age = Young and Gender = Men, is at -0.23 (95% CI [-0.28, -0.19], p &lt; .001). Within this model:
## 
##   - The effect of Age [Old] is statistically significant and negative (beta = -0.83, 95% CI [-0.90, -0.77], p &lt; .001; Std. beta = -0.83, 95% CI [-0.90, -0.77])
##   - The effect of Gender [Women] is statistically significant and negative (beta = -0.42, 95% CI [-0.47, -0.37], p &lt; .001; Std. beta = -0.42, 95% CI [-0.47, -0.37])
## 
## Standardized parameters were obtained by fitting the model on a standardized version of the dataset. 95% Confidence Intervals (CIs) and p-values were computed using</code></pre>
<p>We can use this output to write up a final report:</p>
<p>We fitted a logistic model (estimated using ML) to predict the use of
the utterance-final discourse particle <em>eh</em> with Age and Gender
(formula: EH ~ Age + Gender). The model’s explanatory power is weak
(Tjur’s R<sup>2</sup> = 0.03). The model’s intercept, corresponding to
Age = Young and Gender = Men, is at -0.23 (95% CI [-0.28, -0.19], p &lt;
.001). Within this model:</p>
<ul>
<li><p>The effect of Age [Old] is statistically significant and negative
(beta = -0.83, 95% CI [-0.90, -0.77], p &lt; .001; Std. beta = -0.83,
95% CI [-0.90, -0.77])</p></li>
<li><p>The effect of Gender [Women] is statistically significant and
negative (beta = -0.42, 95% CI [-0.47, -0.37], p &lt; .001; Std. beta =
-0.42, 95% CI [-0.47, -0.37])</p></li>
</ul>
<p>Standardized parameters were obtained by fitting the model on a
standardized version of the dataset. 95% Confidence Intervals (CIs) and
p-values were computed using</p>
</div>
</div>
<div id="ordinal-regression" class="section level2 unnumbered">
<h2 class="unnumbered">Ordinal Regression</h2>
<p>Ordinal regression is very similar to multiple linear regression but
takes an ordinal dependent variable <span class="citation">(<a
href="#ref-agresti2010analysis" role="doc-biblioref">Agresti
2010</a>)</span>. For this reason, ordinal regression is one of the key
methods in analysing Likert data.</p>
<p>To see how an ordinal regression is implemented in R, we load and
inspect the ´ordinaldata´ data set. The data set consists of 400
observations of students that were either educated at this school
(Internal = 1) or not (Internal = 0). Some of the students have been
abroad (Exchange = 1) while other have not (Exchange = 0). In addition,
the data set contains the students’ final score of a language test
(FinalScore) and the dependent variable which the recommendation of a
committee for an additional, very prestigious program. The
recommendation has three levels (<em>very likely</em>, <em>somewhat
likely</em>, and <em>unlikely</em>) and reflects the committees’
assessment of whether the student is likely to succeed in the
program.</p>
<pre class="r"><code># load data
ordata  &lt;- base::readRDS(url(&quot;https://slcladal.github.io/data/ord.rda&quot;, &quot;rb&quot;)) %&gt;%
  dplyr::rename(Recommend = 1, 
              Internal = 2, 
              Exchange = 3, 
              FinalScore = 4) %&gt;%
  dplyr::mutate(FinalScore = round(FinalScore, 2))</code></pre>
<template id="3df68377-b56d-4bce-8ea4-244093bb9b1f"><style>
.tabwid table{
  border-spacing:0px !important;
  border-collapse:collapse;
  line-height:1;
  margin-left:auto;
  margin-right:auto;
  border-width: 0;
  display: table;
  margin-top: 1.275em;
  margin-bottom: 1.275em;
  border-color: transparent;
}
.tabwid_left table{
  margin-left:0;
}
.tabwid_right table{
  margin-right:0;
}
.tabwid td {
    padding: 0;
}
.tabwid a {
  text-decoration: none;
}
.tabwid thead {
    background-color: transparent;
}
.tabwid tfoot {
    background-color: transparent;
}
.tabwid table tr {
background-color: transparent;
}
</style><div class="tabwid"><style>.cl-ac569d54{table-layout:auto;width:75%;}.cl-ac4d369c{font-family:'Arial';font-size:12pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-ac4d36a6{font-family:'Arial';font-size:12pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-ac4d4c68{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-ac4d4c72{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-ac4d9466{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ac4d9470{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ac4d947a{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ac4d947b{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ac4d9484{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ac4d9485{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ac4d948e{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ac4d948f{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ac4d9498{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ac4d94a2{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ac4d94a3{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ac4d94ac{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table class='cl-ac569d54'>
<caption class="Table Caption">
<p>First 15 rows of the ordata.</p>
</caption>
<thead><tr style="overflow-wrap:break-word;"><td class="cl-ac4d94a3"><p class="cl-ac4d4c68"><span class="cl-ac4d369c">Recommend</span></p></td><td class="cl-ac4d94a2"><p class="cl-ac4d4c72"><span class="cl-ac4d369c">Internal</span></p></td><td class="cl-ac4d94a2"><p class="cl-ac4d4c72"><span class="cl-ac4d369c">Exchange</span></p></td><td class="cl-ac4d94ac"><p class="cl-ac4d4c72"><span class="cl-ac4d369c">FinalScore</span></p></td></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-ac4d9470"><p class="cl-ac4d4c68"><span class="cl-ac4d36a6">very likely</span></p></td><td class="cl-ac4d947a"><p class="cl-ac4d4c72"><span class="cl-ac4d36a6">0</span></p></td><td class="cl-ac4d947a"><p class="cl-ac4d4c72"><span class="cl-ac4d36a6">0</span></p></td><td class="cl-ac4d9466"><p class="cl-ac4d4c72"><span class="cl-ac4d36a6">3.26</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-ac4d9484"><p class="cl-ac4d4c68"><span class="cl-ac4d36a6">somewhat likely</span></p></td><td class="cl-ac4d947b"><p class="cl-ac4d4c72"><span class="cl-ac4d36a6">1</span></p></td><td class="cl-ac4d947b"><p class="cl-ac4d4c72"><span class="cl-ac4d36a6">0</span></p></td><td class="cl-ac4d9485"><p class="cl-ac4d4c72"><span class="cl-ac4d36a6">3.21</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-ac4d9470"><p class="cl-ac4d4c68"><span class="cl-ac4d36a6">unlikely</span></p></td><td class="cl-ac4d947a"><p class="cl-ac4d4c72"><span class="cl-ac4d36a6">1</span></p></td><td class="cl-ac4d947a"><p class="cl-ac4d4c72"><span class="cl-ac4d36a6">1</span></p></td><td class="cl-ac4d9466"><p class="cl-ac4d4c72"><span class="cl-ac4d36a6">3.94</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-ac4d9484"><p class="cl-ac4d4c68"><span class="cl-ac4d36a6">somewhat likely</span></p></td><td class="cl-ac4d947b"><p class="cl-ac4d4c72"><span class="cl-ac4d36a6">0</span></p></td><td class="cl-ac4d947b"><p class="cl-ac4d4c72"><span class="cl-ac4d36a6">0</span></p></td><td class="cl-ac4d9485"><p class="cl-ac4d4c72"><span class="cl-ac4d36a6">2.81</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-ac4d9470"><p class="cl-ac4d4c68"><span class="cl-ac4d36a6">somewhat likely</span></p></td><td class="cl-ac4d947a"><p class="cl-ac4d4c72"><span class="cl-ac4d36a6">0</span></p></td><td class="cl-ac4d947a"><p class="cl-ac4d4c72"><span class="cl-ac4d36a6">0</span></p></td><td class="cl-ac4d9466"><p class="cl-ac4d4c72"><span class="cl-ac4d36a6">2.53</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-ac4d9484"><p class="cl-ac4d4c68"><span class="cl-ac4d36a6">unlikely</span></p></td><td class="cl-ac4d947b"><p class="cl-ac4d4c72"><span class="cl-ac4d36a6">0</span></p></td><td class="cl-ac4d947b"><p class="cl-ac4d4c72"><span class="cl-ac4d36a6">1</span></p></td><td class="cl-ac4d9485"><p class="cl-ac4d4c72"><span class="cl-ac4d36a6">2.59</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-ac4d9470"><p class="cl-ac4d4c68"><span class="cl-ac4d36a6">somewhat likely</span></p></td><td class="cl-ac4d947a"><p class="cl-ac4d4c72"><span class="cl-ac4d36a6">0</span></p></td><td class="cl-ac4d947a"><p class="cl-ac4d4c72"><span class="cl-ac4d36a6">0</span></p></td><td class="cl-ac4d9466"><p class="cl-ac4d4c72"><span class="cl-ac4d36a6">2.56</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-ac4d9484"><p class="cl-ac4d4c68"><span class="cl-ac4d36a6">somewhat likely</span></p></td><td class="cl-ac4d947b"><p class="cl-ac4d4c72"><span class="cl-ac4d36a6">0</span></p></td><td class="cl-ac4d947b"><p class="cl-ac4d4c72"><span class="cl-ac4d36a6">0</span></p></td><td class="cl-ac4d9485"><p class="cl-ac4d4c72"><span class="cl-ac4d36a6">2.73</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-ac4d9470"><p class="cl-ac4d4c68"><span class="cl-ac4d36a6">unlikely</span></p></td><td class="cl-ac4d947a"><p class="cl-ac4d4c72"><span class="cl-ac4d36a6">0</span></p></td><td class="cl-ac4d947a"><p class="cl-ac4d4c72"><span class="cl-ac4d36a6">0</span></p></td><td class="cl-ac4d9466"><p class="cl-ac4d4c72"><span class="cl-ac4d36a6">3.00</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-ac4d9484"><p class="cl-ac4d4c68"><span class="cl-ac4d36a6">somewhat likely</span></p></td><td class="cl-ac4d947b"><p class="cl-ac4d4c72"><span class="cl-ac4d36a6">1</span></p></td><td class="cl-ac4d947b"><p class="cl-ac4d4c72"><span class="cl-ac4d36a6">0</span></p></td><td class="cl-ac4d9485"><p class="cl-ac4d4c72"><span class="cl-ac4d36a6">3.50</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-ac4d9470"><p class="cl-ac4d4c68"><span class="cl-ac4d36a6">unlikely</span></p></td><td class="cl-ac4d947a"><p class="cl-ac4d4c72"><span class="cl-ac4d36a6">1</span></p></td><td class="cl-ac4d947a"><p class="cl-ac4d4c72"><span class="cl-ac4d36a6">1</span></p></td><td class="cl-ac4d9466"><p class="cl-ac4d4c72"><span class="cl-ac4d36a6">3.65</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-ac4d9484"><p class="cl-ac4d4c68"><span class="cl-ac4d36a6">somewhat likely</span></p></td><td class="cl-ac4d947b"><p class="cl-ac4d4c72"><span class="cl-ac4d36a6">0</span></p></td><td class="cl-ac4d947b"><p class="cl-ac4d4c72"><span class="cl-ac4d36a6">0</span></p></td><td class="cl-ac4d9485"><p class="cl-ac4d4c72"><span class="cl-ac4d36a6">2.84</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-ac4d9470"><p class="cl-ac4d4c68"><span class="cl-ac4d36a6">very likely</span></p></td><td class="cl-ac4d947a"><p class="cl-ac4d4c72"><span class="cl-ac4d36a6">0</span></p></td><td class="cl-ac4d947a"><p class="cl-ac4d4c72"><span class="cl-ac4d36a6">1</span></p></td><td class="cl-ac4d9466"><p class="cl-ac4d4c72"><span class="cl-ac4d36a6">3.90</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-ac4d9484"><p class="cl-ac4d4c68"><span class="cl-ac4d36a6">somewhat likely</span></p></td><td class="cl-ac4d947b"><p class="cl-ac4d4c72"><span class="cl-ac4d36a6">0</span></p></td><td class="cl-ac4d947b"><p class="cl-ac4d4c72"><span class="cl-ac4d36a6">0</span></p></td><td class="cl-ac4d9485"><p class="cl-ac4d4c72"><span class="cl-ac4d36a6">2.68</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-ac4d9498"><p class="cl-ac4d4c68"><span class="cl-ac4d36a6">unlikely</span></p></td><td class="cl-ac4d948e"><p class="cl-ac4d4c72"><span class="cl-ac4d36a6">1</span></p></td><td class="cl-ac4d948e"><p class="cl-ac4d4c72"><span class="cl-ac4d36a6">0</span></p></td><td class="cl-ac4d948f"><p class="cl-ac4d4c72"><span class="cl-ac4d36a6">3.57</span></p></td></tr></tbody></table></div></template>
<div class="flextable-shadow-host" id="60d1087e-2776-4e0f-a190-cafa6f7f31da"></div>
<script>
var dest = document.getElementById("60d1087e-2776-4e0f-a190-cafa6f7f31da");
var template = document.getElementById("3df68377-b56d-4bce-8ea4-244093bb9b1f");
var caption = template.content.querySelector("caption");
if(caption) {
  caption.style.cssText = "display:block;text-align:center;";
  var newcapt = document.createElement("p");
  newcapt.appendChild(caption)
  dest.parentNode.insertBefore(newcapt, dest.previousSibling);
}
var fantome = dest.attachShadow({mode: 'open'});
var templateContent = template.content;
fantome.appendChild(templateContent);
</script>

<p>In a first step, we need to relevel the ordinal variable to represent
an ordinal factor (or a progression from “unlikely” over “somewhat
likely” to “very likely”. And we will also factorize Internal and
Exchange to make it easier to interpret the output later on.</p>
<pre class="r"><code># relevel data
ordata &lt;- ordata %&gt;%
  dplyr::mutate(Recommend = factor(Recommend, 
                           levels=c(&quot;unlikely&quot;, &quot;somewhat likely&quot;, &quot;very likely&quot;),
                           labels=c(&quot;unlikely&quot;,  &quot;somewhat likely&quot;,  &quot;very likely&quot;))) %&gt;%
  dplyr::mutate(Exchange = ifelse(Exchange == 1, &quot;Exchange&quot;, &quot;NoExchange&quot;)) %&gt;%
  dplyr::mutate(Internal = ifelse(Internal == 1, &quot;Internal&quot;, &quot;External&quot;))</code></pre>
<p>Now that the dependent variable is releveled, we check the
distribution of the variable levels by tabulating the data. To get a
better understanding of the data we create frequency tables across
variables rather than viewing the variables in isolation.</p>
<pre class="r"><code>## three way cross tabs (xtabs) and flatten the table
ftable(xtabs(~ Exchange + Recommend + Internal, data = ordata))</code></pre>
<pre><code>##                            Internal External Internal
## Exchange   Recommend                                 
## Exchange   unlikely                       25        6
##            somewhat likely                12        4
##            very likely                     7        3
## NoExchange unlikely                      175       14
##            somewhat likely                98       26
##            very likely                    20       10</code></pre>
<p>We also check the mean and standard deviation of the final score as
final score is a numeric variable and cannot be tabulated (unless we
convert it to a factor).</p>
<pre class="r"><code>summary(ordata$FinalScore); sd(ordata$FinalScore)</code></pre>
<pre><code>##     Min.  1st Qu.   Median     Mean  3rd Qu.     Max. 
## 1.900000 2.720000 2.990000 2.998925 3.270000 4.000000</code></pre>
<pre><code>## [1] 0.397940933861</code></pre>
<p>The lowest score is 1.9 and the highest score is a 4.0 with a mean of
approximately 3. Finally, we inspect the distributions graphically.</p>
<pre class="r"><code># visualize data
ggplot(ordata, aes(x = Recommend, y = FinalScore)) +
  geom_boxplot(size = .75) +
  geom_jitter(alpha = .5) +
  facet_grid(Exchange ~ Internal, margins = TRUE) +
  theme(axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1))</code></pre>
<p><img src="multireg_files/figure-html/orr6-1.png" width="672" /></p>
<p>We see that we have only few students that have taken part in an
exchange program and there are also only few internal students overall.
With respect to recommendations, only few students are considered to
very likely succeed in the program. We can now start with the modeling
by using the <code>polr</code> function. To make things easier for us,
we will only consider the main effects here as this tutorial only aims
to how to implement an ordinal regression but not how it should be done
in a proper study - then, the model fitting and diagnostic procedures
would have to be performed accurately, of course.</p>
<pre class="r"><code># fit ordered logit model and store results &#39;m&#39;
m &lt;- polr(Recommend ~ Internal + Exchange + FinalScore, data = ordata, Hess=TRUE)
# summarize model
summary(m)</code></pre>
<pre><code>## Call:
## polr(formula = Recommend ~ Internal + Exchange + FinalScore, 
##     data = ordata, Hess = TRUE)
## 
## Coefficients:
##                           Value  Std. Error     t value
## InternalInternal   1.0476639460 0.265789134 3.941710973
## ExchangeNoExchange 0.0586810767 0.297858822 0.197009698
## FinalScore         0.6157435926 0.260631275 2.362508462
## 
## Intercepts:
##                             Value       Std. Error  t value    
## unlikely|somewhat likely    2.261997623 0.882173604 2.564118460
## somewhat likely|very likely 4.357441880 0.904467838 4.817685824
## 
## Residual Deviance: 717.024871356 
## AIC: 727.024871356</code></pre>
<p>The results show that having studied here at this school increases
the chances of receiving a positive recommendation but that having been
on an exchange has a negative but insignificant effect on the
recommendation. The final score also correlates positively with a
positive recommendation but not as much as having studied here.</p>
<pre class="r"><code>## store table
(ctable &lt;- coef(summary(m)))</code></pre>
<pre><code>##                                       Value     Std. Error        t value
## InternalInternal            1.0476639460469 0.265789134041 3.941710972597
## ExchangeNoExchange          0.0586810766831 0.297858821982 0.197009698396
## FinalScore                  0.6157435925546 0.260631274949 2.362508462102
## unlikely|somewhat likely    2.2619976233665 0.882173604268 2.564118459702
## somewhat likely|very likely 4.3574418799106 0.904467837679 4.817685824067</code></pre>
<p>As the regression report does not provide p-values, we have to
calculate them separately (after having calculated them, we add them to
the coefficient table).</p>
<pre class="r"><code>## calculate and store p values
p &lt;- pnorm(abs(ctable[, &quot;t value&quot;]), lower.tail = FALSE) * 2
## combined table
(ctable &lt;- cbind(ctable, &quot;p value&quot; = p))</code></pre>
<pre><code>##                                       Value     Std. Error        t value
## InternalInternal            1.0476639460469 0.265789134041 3.941710972597
## ExchangeNoExchange          0.0586810766831 0.297858821982 0.197009698396
## FinalScore                  0.6157435925546 0.260631274949 2.362508462102
## unlikely|somewhat likely    2.2619976233665 0.882173604268 2.564118459702
## somewhat likely|very likely 4.3574418799106 0.904467837679 4.817685824067
##                                         p value
## InternalInternal            0.00008090242989067
## ExchangeNoExchange          0.84381994829786433
## FinalScore                  0.01815172703315108
## unlikely|somewhat likely    0.01034382345531700
## somewhat likely|very likely 0.00000145232812833</code></pre>
<p>As predicted, Exchange does not have a significant effect but
FinalScore and Internal both correlate significantly with the likelihood
of receiving a positive recommendation.</p>
<pre class="r"><code># extract profiled confidence intervals
ci &lt;- confint(m)
# calculate odds ratios and combine them with profiled CIs
exp(cbind(OR = coef(m), ci))</code></pre>
<pre><code>##                               OR          2.5 %        97.5 %
## InternalInternal   2.85098328212 1.695837799597 4.81711408266
## ExchangeNoExchange 1.06043698872 0.595033205649 1.91977108408
## FinalScore         1.85103250193 1.113625249822 3.09849059342</code></pre>
<p>The odds ratios show that internal students are 2.85 times or 285
percent as likely as non-internal students to receive positive
evaluations and that a 1-point increase in the test score lead to a 1.85
times or 185 percent increase in the chances of receiving a positive
recommendation. The effect of an exchange is slightly negative but, as
we have seen above, not significant.</p>
</div>
<div id="poisson-regression" class="section level2 unnumbered">
<h2 class="unnumbered">Poisson Regression</h2>
<p>This section is based on <a
href="https://stats.idre.ucla.edu/r/dae/poisson-regression/">this
tutorials</a> on how to perform a Poisson regression in R.</p>
<div class="warning"
style="padding:0.1em; background-color:#f2f2f2; color:#51247a">
<span>
<p style="margin-top:1em; text-align:center">
<b>NOTE</b><br><br>Poisson regressions are used to analyze data where
the dependent variable represents counts.
</p>
<p style="margin-left:1em;">
</p>
<p></span></p>
</div>
<p><br></p>
<p>This applied particularly to counts that are based on observations of
something that is measured in set intervals. For instances the number of
pauses in two-minute-long conversations. Poisson regressions are
particularly appealing when dealing with rare events, i.e. when
something only occurs very infrequently. In such cases, normal linear
regressions do not work because the instances that do occur are
automatically considered outliers. Therefore, it is useful to check if
the data conform to a Poisson distribution.</p>
<p>However, the tricky thing about Poisson regressions is that the data
has to conform to the Poisson distribution which is, according to my
experience, rarely the case, unfortunately. The Gaussian Normal
Distribution is very flexible because it is defined by two parameters,
the mean (mu, i.e. <span class="math inline">\(\mu\)</span>) and the
standard deviation (sigma, i.e. <span
class="math inline">\(\sigma\)</span>). This allows the normal
distribution to take very different shapes (for example, very high and
slim (compressed) or very wide and flat). In contrast, the Poisson is
defined by only one parameter (lambda, i.e. <span
class="math inline">\(\lambda\)</span>) which mean that if we have a
mean of 2, then the standard deviation is also 2 (actually we would have
to say that the mean is <span class="math inline">\(\lambda\)</span> and
the standard deviation is also <span
class="math inline">\(\lambda\)</span> or <span
class="math inline">\(\lambda\)</span> = <span
class="math inline">\(\mu\)</span> = <span
class="math inline">\(\sigma\)</span>). This is much trickier for
natural data as this means that the Poisson distribution is very
rigid.</p>
<p><img src="multireg_files/figure-html/pr0-1.png" width="672" /></p>
<p>As we can see, as <span class="math inline">\(\lambda\)</span> takes
on higher values, the distribution becomes wider and flatter - a
compressed distribution with a high mean can therefore not be
Poisson-distributed. We will now start by loading the data.</p>
<pre class="r"><code># load data
poissondata  &lt;- base::readRDS(url(&quot;https://slcladal.github.io/data/prd.rda&quot;, &quot;rb&quot;))</code></pre>
<template id="e98a385d-e70e-4036-8d97-0c82ab9be27e"><style>
.tabwid table{
  border-spacing:0px !important;
  border-collapse:collapse;
  line-height:1;
  margin-left:auto;
  margin-right:auto;
  border-width: 0;
  display: table;
  margin-top: 1.275em;
  margin-bottom: 1.275em;
  border-color: transparent;
}
.tabwid_left table{
  margin-left:0;
}
.tabwid_right table{
  margin-right:0;
}
.tabwid td {
    padding: 0;
}
.tabwid a {
  text-decoration: none;
}
.tabwid thead {
    background-color: transparent;
}
.tabwid tfoot {
    background-color: transparent;
}
.tabwid table tr {
background-color: transparent;
}
</style><div class="tabwid"><style>.cl-ae355b9c{table-layout:auto;width:75%;}.cl-ae2961b6{font-family:'Arial';font-size:12pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-ae2961c0{font-family:'Arial';font-size:12pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-ae2978cc{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-ae2978d6{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-ae29c872{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ae29c87c{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ae29c886{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ae29c887{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ae29c890{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ae29c891{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ae29c89a{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ae29c89b{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ae29c8a4{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ae29c8a5{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ae29c8ae{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ae29c8af{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ae29c8b8{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ae29c8b9{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ae29c8ba{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ae29c8bb{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table class='cl-ae355b9c'>
<caption class="Table Caption">
<p>First 15 rows of the poissondata.</p>
</caption>
<thead><tr style="overflow-wrap:break-word;"><td class="cl-ae29c8bb"><p class="cl-ae2978cc"><span class="cl-ae2961b6">Id</span></p></td><td class="cl-ae29c8b9"><p class="cl-ae2978cc"><span class="cl-ae2961b6">Pauses</span></p></td><td class="cl-ae29c8ba"><p class="cl-ae2978d6"><span class="cl-ae2961b6">Language</span></p></td><td class="cl-ae29c8b8"><p class="cl-ae2978cc"><span class="cl-ae2961b6">Alcohol</span></p></td></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-ae29c886"><p class="cl-ae2978cc"><span class="cl-ae2961c0">45</span></p></td><td class="cl-ae29c887"><p class="cl-ae2978cc"><span class="cl-ae2961c0">0</span></p></td><td class="cl-ae29c872"><p class="cl-ae2978d6"><span class="cl-ae2961c0">German</span></p></td><td class="cl-ae29c87c"><p class="cl-ae2978cc"><span class="cl-ae2961c0">41</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-ae29c891"><p class="cl-ae2978cc"><span class="cl-ae2961c0">108</span></p></td><td class="cl-ae29c890"><p class="cl-ae2978cc"><span class="cl-ae2961c0">0</span></p></td><td class="cl-ae29c89b"><p class="cl-ae2978d6"><span class="cl-ae2961c0">Russian</span></p></td><td class="cl-ae29c89a"><p class="cl-ae2978cc"><span class="cl-ae2961c0">41</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-ae29c886"><p class="cl-ae2978cc"><span class="cl-ae2961c0">15</span></p></td><td class="cl-ae29c887"><p class="cl-ae2978cc"><span class="cl-ae2961c0">0</span></p></td><td class="cl-ae29c872"><p class="cl-ae2978d6"><span class="cl-ae2961c0">German</span></p></td><td class="cl-ae29c87c"><p class="cl-ae2978cc"><span class="cl-ae2961c0">44</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-ae29c891"><p class="cl-ae2978cc"><span class="cl-ae2961c0">67</span></p></td><td class="cl-ae29c890"><p class="cl-ae2978cc"><span class="cl-ae2961c0">0</span></p></td><td class="cl-ae29c89b"><p class="cl-ae2978d6"><span class="cl-ae2961c0">German</span></p></td><td class="cl-ae29c89a"><p class="cl-ae2978cc"><span class="cl-ae2961c0">42</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-ae29c886"><p class="cl-ae2978cc"><span class="cl-ae2961c0">153</span></p></td><td class="cl-ae29c887"><p class="cl-ae2978cc"><span class="cl-ae2961c0">0</span></p></td><td class="cl-ae29c872"><p class="cl-ae2978d6"><span class="cl-ae2961c0">German</span></p></td><td class="cl-ae29c87c"><p class="cl-ae2978cc"><span class="cl-ae2961c0">40</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-ae29c891"><p class="cl-ae2978cc"><span class="cl-ae2961c0">51</span></p></td><td class="cl-ae29c890"><p class="cl-ae2978cc"><span class="cl-ae2961c0">0</span></p></td><td class="cl-ae29c89b"><p class="cl-ae2978d6"><span class="cl-ae2961c0">Russian</span></p></td><td class="cl-ae29c89a"><p class="cl-ae2978cc"><span class="cl-ae2961c0">42</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-ae29c886"><p class="cl-ae2978cc"><span class="cl-ae2961c0">164</span></p></td><td class="cl-ae29c887"><p class="cl-ae2978cc"><span class="cl-ae2961c0">0</span></p></td><td class="cl-ae29c872"><p class="cl-ae2978d6"><span class="cl-ae2961c0">German</span></p></td><td class="cl-ae29c87c"><p class="cl-ae2978cc"><span class="cl-ae2961c0">46</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-ae29c891"><p class="cl-ae2978cc"><span class="cl-ae2961c0">133</span></p></td><td class="cl-ae29c890"><p class="cl-ae2978cc"><span class="cl-ae2961c0">0</span></p></td><td class="cl-ae29c89b"><p class="cl-ae2978d6"><span class="cl-ae2961c0">German</span></p></td><td class="cl-ae29c89a"><p class="cl-ae2978cc"><span class="cl-ae2961c0">40</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-ae29c886"><p class="cl-ae2978cc"><span class="cl-ae2961c0">2</span></p></td><td class="cl-ae29c887"><p class="cl-ae2978cc"><span class="cl-ae2961c0">0</span></p></td><td class="cl-ae29c872"><p class="cl-ae2978d6"><span class="cl-ae2961c0">German</span></p></td><td class="cl-ae29c87c"><p class="cl-ae2978cc"><span class="cl-ae2961c0">33</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-ae29c891"><p class="cl-ae2978cc"><span class="cl-ae2961c0">53</span></p></td><td class="cl-ae29c890"><p class="cl-ae2978cc"><span class="cl-ae2961c0">0</span></p></td><td class="cl-ae29c89b"><p class="cl-ae2978d6"><span class="cl-ae2961c0">German</span></p></td><td class="cl-ae29c89a"><p class="cl-ae2978cc"><span class="cl-ae2961c0">46</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-ae29c886"><p class="cl-ae2978cc"><span class="cl-ae2961c0">1</span></p></td><td class="cl-ae29c887"><p class="cl-ae2978cc"><span class="cl-ae2961c0">0</span></p></td><td class="cl-ae29c872"><p class="cl-ae2978d6"><span class="cl-ae2961c0">German</span></p></td><td class="cl-ae29c87c"><p class="cl-ae2978cc"><span class="cl-ae2961c0">40</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-ae29c891"><p class="cl-ae2978cc"><span class="cl-ae2961c0">128</span></p></td><td class="cl-ae29c890"><p class="cl-ae2978cc"><span class="cl-ae2961c0">0</span></p></td><td class="cl-ae29c89b"><p class="cl-ae2978d6"><span class="cl-ae2961c0">English</span></p></td><td class="cl-ae29c89a"><p class="cl-ae2978cc"><span class="cl-ae2961c0">38</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-ae29c886"><p class="cl-ae2978cc"><span class="cl-ae2961c0">16</span></p></td><td class="cl-ae29c887"><p class="cl-ae2978cc"><span class="cl-ae2961c0">0</span></p></td><td class="cl-ae29c872"><p class="cl-ae2978d6"><span class="cl-ae2961c0">German</span></p></td><td class="cl-ae29c87c"><p class="cl-ae2978cc"><span class="cl-ae2961c0">44</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-ae29c891"><p class="cl-ae2978cc"><span class="cl-ae2961c0">106</span></p></td><td class="cl-ae29c890"><p class="cl-ae2978cc"><span class="cl-ae2961c0">0</span></p></td><td class="cl-ae29c89b"><p class="cl-ae2978d6"><span class="cl-ae2961c0">German</span></p></td><td class="cl-ae29c89a"><p class="cl-ae2978cc"><span class="cl-ae2961c0">37</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-ae29c8a5"><p class="cl-ae2978cc"><span class="cl-ae2961c0">89</span></p></td><td class="cl-ae29c8af"><p class="cl-ae2978cc"><span class="cl-ae2961c0">0</span></p></td><td class="cl-ae29c8a4"><p class="cl-ae2978d6"><span class="cl-ae2961c0">German</span></p></td><td class="cl-ae29c8ae"><p class="cl-ae2978cc"><span class="cl-ae2961c0">40</span></p></td></tr></tbody></table></div></template>
<div class="flextable-shadow-host" id="6b548b6b-5314-45fd-b20e-992bdfeb681e"></div>
<script>
var dest = document.getElementById("6b548b6b-5314-45fd-b20e-992bdfeb681e");
var template = document.getElementById("e98a385d-e70e-4036-8d97-0c82ab9be27e");
var caption = template.content.querySelector("caption");
if(caption) {
  caption.style.cssText = "display:block;text-align:center;";
  var newcapt = document.createElement("p");
  newcapt.appendChild(caption)
  dest.parentNode.insertBefore(newcapt, dest.previousSibling);
}
var fantome = dest.attachShadow({mode: 'open'});
var templateContent = template.content;
fantome.appendChild(templateContent);
</script>

<p>We will clean the data by factorizing Id which is currently
considered a numeric variable rather than a factor.</p>
<pre class="r"><code># process data
poissondata &lt;- poissondata %&gt;%
  mutate(Id = factor(Id, levels = 1:200, labels = 1:200))
# inspect data
str(poissondata)</code></pre>
<pre><code>## &#39;data.frame&#39;:    200 obs. of  4 variables:
##  $ Id      : Factor w/ 200 levels &quot;1&quot;,&quot;2&quot;,&quot;3&quot;,&quot;4&quot;,..: 45 108 15 67 153 51 164 133 2 53 ...
##  $ Pauses  : int  0 0 0 0 0 0 0 0 0 0 ...
##  $ Language: chr  &quot;German&quot; &quot;Russian&quot; &quot;German&quot; &quot;German&quot; ...
##  $ Alcohol : int  41 41 44 42 40 42 46 40 33 46 ...</code></pre>
<p>First, we check if the conditions for a Poisson regression are
met.</p>
<pre class="r"><code># output the results
gf = vcd::goodfit(poissondata$Pauses, 
                  type= &quot;poisson&quot;, 
                  method= &quot;ML&quot;)
# inspect results
summary(gf)</code></pre>
<pre><code>## 
##   Goodness-of-fit test for poisson distribution
## 
##                            X^2 df            P(&gt; X^2)
## Likelihood Ratio 33.0122916717  5 0.00000374234139957</code></pre>
<p>If the p-values is smaller than .05, then data is not Poisson
distributed which means that it differs significantly from a Poisson
distribution and is very likely over-dispersed. We will check the
divergence from a Poisson distribution visually by plotting the observed
counts against the expected counts if the data were Poisson
distributed.</p>
<pre class="r"><code>plot(gf,main=&quot;Count data vs Poisson distribution&quot;)</code></pre>
<p><img src="multireg_files/figure-html/pr5-1.png" width="672" /></p>
<p>Although the goodfit function reported that the data differs
significantly from the Poisson distribution, the fit is rather good. We
can use an additional Levene’s test to check if variance homogeneity is
given.</p>
<div class="warning"
style="padding:0.1em; background-color:#f2f2f2; color:#51247a">
<span>
<p style="margin-top:1em; text-align:center">
<b>NOTE</b><br><br>The use of Levene’s test to check if the model is
heteroscedastic is generally not recommended as it is too lax when
dealing with few observations (because in such cases it does not have
the power to identify heteroscedasticity) while it is too harsh when
dealing with many observations (when heteroscedasticity typically is not
a severe problem).
</p>
<p style="margin-left:1em;">
</p>
<p></span></p>
</div>
<p><br></p>
<pre class="r"><code># check homogeneity
leveneTest(poissondata$Pauses, poissondata$Language, center = mean)</code></pre>
<pre><code>## Levene&#39;s Test for Homogeneity of Variance (center = mean)
##        Df  F value        Pr(&gt;F)    
## group   2 17.15274 0.00000013571 ***
##       197                           
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>The Levene’s test indicates that variance homogeneity is also
violated. Since both the approximation to a Poisson distribution and
variance homogeneity are violated, we should switch either to a
quasi-Poisson model or a negative binomial model. However, as we are
only interested in how to implement a Poisson model here, we continue
despite the fact that this could not be recommended if we were actually
interested in accurate results based on a reliable model.</p>
<p>In a next step, we summarize Progression by inspecting the means and
standard deviations of the individual variable levels.</p>
<pre class="r"><code># extract mean and standard deviation
with(poissondata, tapply(Pauses, Language, function(x) {
  sprintf(&quot;M (SD) = %1.2f (%1.2f)&quot;, mean(x), sd(x))
}))</code></pre>
<pre><code>##                English                 German                Russian 
## &quot;M (SD) = 1.00 (1.28)&quot; &quot;M (SD) = 0.24 (0.52)&quot; &quot;M (SD) = 0.20 (0.40)&quot;</code></pre>
<p>Now, we visualize the data.</p>
<pre class="r"><code># plot data
ggplot(poissondata, aes(Pauses, fill = Language)) +
  geom_histogram(binwidth=.5, position=&quot;dodge&quot;) +
  scale_fill_manual(values=c(&quot;gray30&quot;, &quot;gray50&quot;, &quot;gray70&quot;))</code></pre>
<p><img src="multireg_files/figure-html/pr8-1.png" width="672" /></p>
<pre class="r"><code># calculate Poisson regression
m1.poisson &lt;- glm(Pauses ~ Language + Alcohol, family=&quot;poisson&quot;, data=poissondata)
# inspect model
summary(m1.poisson)</code></pre>
<pre><code>## 
## Call:
## glm(formula = Pauses ~ Language + Alcohol, family = &quot;poisson&quot;, 
##     data = poissondata)
## 
## Deviance Residuals: 
##          Min            1Q        Median            3Q           Max  
## -2.204338080  -0.843641817  -0.510586515   0.255772098   2.679576560  
## 
## Coefficients:
##                      Estimate    Std. Error  z value         Pr(&gt;|z|)    
## (Intercept)     -4.1632652529  0.6628774832 -6.28060 0.00000000033728 ***
## LanguageGerman  -0.7140499158  0.3200148750 -2.23130         0.025661 *  
## LanguageRussian -1.0838591456  0.3582529824 -3.02540         0.002483 ** 
## Alcohol          0.0701523975  0.0105992050  6.61865 0.00000000003625 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for poisson family taken to be 1)
## 
##     Null deviance: 287.6722345  on 199  degrees of freedom
## Residual deviance: 189.4496199  on 196  degrees of freedom
## AIC: 373.5045031
## 
## Number of Fisher Scoring iterations: 6</code></pre>
<p>In addition to the Estimates for the coefficients, we could also
calculate the confidence intervals for the coefficients (LL stands for
lower limit and UL for upper limit in the table below).</p>
<pre class="r"><code># calculate model
cov.m1 &lt;- sandwich::vcovHC(m1.poisson, type=&quot;HC0&quot;)
# extract standard error
std.err &lt;- sqrt(diag(cov.m1))
# extract robust estimates
r.est &lt;- cbind(Estimate= coef(m1.poisson), 
               &quot;Robust SE&quot; = std.err,
               &quot;Pr(&gt;|z|)&quot; = 2 * pnorm(abs(coef(m1.poisson)/std.err),
                                      lower.tail=FALSE),
LL = coef(m1.poisson) - 1.96 * std.err,
UL = coef(m1.poisson) + 1.96 * std.err)
# inspect data
r.est</code></pre>
<pre><code>##                         Estimate       Robust SE                 Pr(&gt;|z|)
## (Intercept)     -4.1632652529178 0.6480942940026 0.0000000001328637743949
## LanguageGerman  -0.7140499157783 0.2986422497410 0.0168031204011183689373
## LanguageRussian -1.0838591456208 0.3210481575684 0.0007354744824167245816
## Alcohol          0.0701523974937 0.0104351647012 0.0000000000178397516955
##                               LL               UL
## (Intercept)     -5.4335300691629 -2.8930004366726
## LanguageGerman  -1.2993887252708 -0.1287111062859
## LanguageRussian -1.7131135344549 -0.4546047567867
## Alcohol          0.0496994746793  0.0906053203082</code></pre>
<p>We can now calculate the p-value of the model.</p>
<pre class="r"><code>with(m1.poisson, cbind(res.deviance = deviance, df = df.residual,
  p = pchisq(deviance, df.residual, lower.tail=FALSE)))</code></pre>
<pre><code>##      res.deviance  df              p
## [1,] 189.44961991 196 0.618227445717</code></pre>
<p>Now, we check, if removing Language leads to a significant decrease
in model fit.</p>
<pre class="r"><code># remove Language from the model
m2.poisson &lt;- update(m1.poisson, . ~ . -Language)
# check if dropping Language causes a significant decrease in model fit
anova(m2.poisson, m1.poisson, test=&quot;Chisq&quot;)</code></pre>
<pre><code>## Analysis of Deviance Table
## 
## Model 1: Pauses ~ Alcohol
## Model 2: Pauses ~ Language + Alcohol
##   Resid. Df  Resid. Dev Df   Deviance   Pr(&gt;Chi)    
## 1       198 204.0213018                             
## 2       196 189.4496199  2 14.5716819 0.00068517 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>We now calculate robust coefficients using the <code>msm</code>
package <span class="citation">(<a href="#ref-msm"
role="doc-biblioref">Jackson 2011</a>)</span>.</p>
<pre class="r"><code># get estimates
s &lt;- msm::deltamethod(list(~ exp(x1), ~ exp(x2), ~ exp(x3), ~ exp(x4)), 
                                                coef(m1.poisson), cov.m1)
# exponentiate old estimates dropping the p values
rexp.est &lt;- exp(r.est[, -3])
# replace SEs with estimates for exponentiated coefficients
rexp.est[, &quot;Robust SE&quot;] &lt;- s
# display results
rexp.est</code></pre>
<pre><code>##                        Estimate       Robust SE               LL
## (Intercept)     0.0155566784084 0.0100821945101 0.00436765044896
## LanguageGerman  0.4896571063601 0.1462322998451 0.27269843575906
## LanguageRussian 0.3382875026084 0.1086065794408 0.18030353649621
## Alcohol         1.0726716412682 0.0111935052470 1.05095521026088
##                              UL
## (Intercept)     0.0554097096208
## LanguageGerman  0.8792279322820
## LanguageRussian 0.6346987787641
## Alcohol         1.0948368101199</code></pre>
<pre class="r"><code># extract predicted values
(s1 &lt;- data.frame(Alcohol = mean(poissondata$Alcohol),
  Language = factor(1:3, levels = 1:3, labels = names(table(poissondata$Language)))))</code></pre>
<pre><code>##   Alcohol Language
## 1  52.645  English
## 2  52.645   German
## 3  52.645  Russian</code></pre>
<pre class="r"><code># show results
predict(m1.poisson, s1, type=&quot;response&quot;, se.fit=TRUE)</code></pre>
<pre><code>## $fit
##              1              2              3 
## 0.624944591447 0.306008560283 0.211410945109 
## 
## $se.fit
##               1               2               3 
## 0.0862811728183 0.0883370633684 0.0705010813453 
## 
## $residual.scale
## [1] 1</code></pre>
<pre class="r"><code>## calculate and store predicted values
poissondata$Predicted &lt;- predict(m1.poisson, type=&quot;response&quot;)
## order by program and then by math
poissondata &lt;- poissondata[with(poissondata, order(Language, Alcohol)), ]</code></pre>
<pre class="r"><code>## create the plot
ggplot(poissondata, aes(x = Alcohol, y = Predicted, colour = Language)) +
  geom_point(aes(y = Pauses), alpha=.5, 
             position=position_jitter(h=.2)) +
  geom_line(size = 1) +
  labs(x = &quot;Alcohol (ml)&quot;, y = &quot;Expected number of pauses&quot;) +
  scale_color_manual(values=c(&quot;gray30&quot;, &quot;gray50&quot;, &quot;gray70&quot;))</code></pre>
<p><img src="multireg_files/figure-html/pr16-1.png" width="672" /></p>
<p>That’s it for this tutorial. We hope that you have enjoyed this
tutorial and learned how to perform regression analysis including model
fitting and model diagnostics as well as reporting regression
results.</p>
</div>
</div>
<div id="citation-session-info" class="section level1 unnumbered">
<h1 class="unnumbered">Citation &amp; Session Info</h1>
<p>Schweinberger, Martin. 2022. <em>Multiple Regression in R</em>.
Brisbane: The University of Queensland. url: <a
href="https://slcladal.github.io/multireg.html"
class="uri">https://slcladal.github.io/multireg.html</a> (Version
2022.06.24).</p>
<pre><code>@manual{schweinberger2022multireg,
  author = {Schweinberger, Martin},
  title = {Multiple Regression in R},
  note = {https://slcladal.github.io/multireg.html},
  year = {2022},
  organization = &quot;The University of Queensland, Australia. School of Languages and Cultures},
  address = {Brisbane},
  edition = {2022.06.24}
}</code></pre>
<pre class="r"><code>sessionInfo()</code></pre>
<pre><code>## R version 4.2.1 RC (2022-06-17 r82510 ucrt)
## Platform: x86_64-w64-mingw32/x64 (64-bit)
## Running under: Windows 10 x64 (build 19043)
## 
## Matrix products: default
## 
## locale:
## [1] LC_COLLATE=German_Germany.utf8  LC_CTYPE=German_Germany.utf8   
## [3] LC_MONETARY=German_Germany.utf8 LC_NUMERIC=C                   
## [5] LC_TIME=German_Germany.utf8    
## 
## attached base packages:
## [1] grid      stats     graphics  grDevices datasets  utils     methods  
## [8] base     
## 
## other attached packages:
##  [1] dplyr_1.0.9        report_0.5.1       performance_0.9.0  vip_0.3.2         
##  [5] vcd_1.4-9          stringr_1.4.0      sjPlot_2.8.10      rms_6.3-0         
##  [9] SparseM_1.81       ordinal_2019.12-10 MuMIn_1.46.0       MASS_7.3-57       
## [13] Hmisc_4.7-0        Formula_1.2-4      survival_3.3-1     lattice_0.20-45   
## [17] ggpubr_0.4.0       ggfortify_0.4.14   ggplot2_3.3.6      flextable_0.7.0   
## [21] car_3.0-13         carData_3.0-5     
## 
## loaded via a namespace (and not attached):
##   [1] uuid_1.1-0           backports_1.4.1      systemfonts_1.0.4   
##   [4] plyr_1.8.7           splines_4.2.1        listenv_0.8.0       
##   [7] TH.data_1.1-1        digest_0.6.29        foreach_1.5.2       
##  [10] htmltools_0.5.2      fansi_1.0.3          magrittr_2.0.3      
##  [13] checkmate_2.1.0      cluster_2.1.3        globals_0.15.0      
##  [16] recipes_0.2.0        gower_1.0.0          modelr_0.1.8        
##  [19] officer_0.4.2        sandwich_3.0-1       hardhat_0.2.0       
##  [22] jpeg_0.1-9           colorspace_2.0-3     xfun_0.30           
##  [25] crayon_1.5.1         jsonlite_1.8.0       lme4_1.1-29         
##  [28] iterators_1.0.14     zoo_1.8-10           glue_1.6.2          
##  [31] gtable_0.3.0         ipred_0.9-12         emmeans_1.7.4-1     
##  [34] MatrixModels_0.5-0   sjstats_0.18.1       sjmisc_2.8.9        
##  [37] future.apply_1.9.0   DEoptimR_1.0-11      abind_1.4-5         
##  [40] scales_1.2.0         mvtnorm_1.1-3        DBI_1.1.2           
##  [43] rstatix_0.7.0        ggeffects_1.1.2      Rcpp_1.0.8.3        
##  [46] xtable_1.8-4         htmlTable_2.4.0      klippy_0.0.0.9500   
##  [49] proxy_0.4-26         foreign_0.8-82       lava_1.6.10         
##  [52] prodlim_2019.11.13   stats4_4.2.1         datawizard_0.4.1    
##  [55] htmlwidgets_1.5.4    RColorBrewer_1.1-3   ellipsis_0.3.2      
##  [58] pkgconfig_2.0.3      farver_2.1.0         nnet_7.3-17         
##  [61] sass_0.4.1           caret_6.0-92         utf8_1.2.2          
##  [64] reshape2_1.4.4       tidyselect_1.1.2     labeling_0.4.2      
##  [67] rlang_1.0.2          effectsize_0.7.0     munsell_0.5.0       
##  [70] tools_4.2.1          cli_3.3.0            generics_0.1.2      
##  [73] sjlabelled_1.2.0     broom_0.8.0          evaluate_0.15       
##  [76] fastmap_1.1.0        yaml_2.3.5           ModelMetrics_1.2.2.2
##  [79] knitr_1.39           zip_2.2.0            robustbase_0.95-0   
##  [82] purrr_0.3.4          future_1.25.0        nlme_3.1-157        
##  [85] quantreg_5.93        xml2_1.3.3           compiler_4.2.1      
##  [88] rstudioapi_0.13      png_0.1-7            e1071_1.7-9         
##  [91] ggsignif_0.6.3       tibble_3.1.7         bslib_0.3.1         
##  [94] stringi_1.7.6        highr_0.9            parameters_0.18.1   
##  [97] gdtools_0.2.4        Matrix_1.4-1         nloptr_2.0.2        
## [100] vctrs_0.4.1          msm_1.6.9            pillar_1.7.0        
## [103] lifecycle_1.0.1      lmtest_0.9-40        jquerylib_0.1.4     
## [106] ucminf_1.1-4         estimability_1.3     data.table_1.14.2   
## [109] cowplot_1.1.1        insight_0.17.1       R6_2.5.1            
## [112] latticeExtra_0.6-29  renv_0.15.4          gridExtra_2.3       
## [115] parallelly_1.31.1    codetools_0.2-18     polspline_1.1.20    
## [118] boot_1.3-28          assertthat_0.2.1     withr_2.5.0         
## [121] multcomp_1.4-19      expm_0.999-6         parallel_4.2.1      
## [124] mgcv_1.8-40          bayestestR_0.12.1    timeDate_3043.102   
## [127] rpart_4.1.16         class_7.3-20         tidyr_1.2.0         
## [130] coda_0.19-4          minqa_1.2.4          rmarkdown_2.14      
## [133] pROC_1.18.0          lubridate_1.8.0      numDeriv_2016.8-1.1 
## [136] base64enc_0.1-3</code></pre>
<hr />
<p><a href="#introduction">Back to top</a></p>
<p><a href="https://slcladal.github.io/index.html">Back to HOME</a></p>
<hr />
</div>
<div id="references" class="section level1 unnumbered">
<h1 class="unnumbered">References</h1>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-achen1982interpreting" class="csl-entry">
Achen, Christopher H. 1982. <em>Interpreting and Using Regression</em>.
Vol. 29. Sage.
</div>
<div id="ref-agresti1996introduction" class="csl-entry">
Agresti, Alan. 1996. <em>An Introduction to Categorical Data
Analysis</em>. Hoboken, NJ: JohnWiley &amp; Sons.
</div>
<div id="ref-agresti2010analysis" class="csl-entry">
———. 2010. <em>Analysis of Ordinal Categorical Data</em>. Vol. 656. John
Wiley &amp; Sons.
</div>
<div id="ref-agresti2011categorical" class="csl-entry">
Agresti, Alan, and Maria Kateri. 2011. <em>Categorical Data
Analysis</em>. Springer.
</div>
<div id="ref-baayen2008analyzing" class="csl-entry">
Baayen, R Harald. 2008. <em>Analyzing Linguistic Data. A Practical
Introduction to Statistics Using r</em>. Cambridge: Cambridge University
press.
</div>
<div id="ref-bortz2006statistik" class="csl-entry">
Bortz, Jürgen. 2006. <em>Statistik: F<span>ü</span>r Human-Und
Sozialwissenschaftler</em>. Springer-Verlag.
</div>
<div id="ref-bowerman1990linear" class="csl-entry">
Bowerman, Bruce L, and Richard T O’Connell. 1990. <em>Linear Statistical
Models: An Applied Approach</em>. Boston: PWS-Kent.
</div>
<div id="ref-crawley2005statistics" class="csl-entry">
Crawley, Michael J. 2005. <em>Statistics: An Introduction Using r.
2005</em>. Chichester, West Sussex: John Wiley &amp; Sons.
</div>
<div id="ref-crawley2012r" class="csl-entry">
———. 2012. <em>The r Book</em>. John Wiley &amp; Sons.
</div>
<div id="ref-faraway2002practical" class="csl-entry">
Faraway, Julian J. 2002. <em>Practical Regression and ANOVA Using
r.</em> University of Bath.
</div>
<div id="ref-field2012discovering" class="csl-entry">
Field, Andy, Jeremy Miles, and Zoe Field. 2012. <em>Discovering
Statistics Using r</em>. Sage.
</div>
<div id="ref-green1991many" class="csl-entry">
Green, Samuel B. 1991. <span>“How Many Subjects Does It Take to Do a
Regression Analysis.”</span> <em>Multivariate Behavioral Research</em>
26 (3): 499–510.
</div>
<div id="ref-gries2021statistics" class="csl-entry">
Gries, Stefan Th. 2021. <em>Statistics for Linguistics Using r: A
Practical Introduction</em>. Berlin &amp; New York: Mouton de Gruyter.
</div>
<div id="ref-harrell2015regression" class="csl-entry">
Harrell Jr, Frank E. 2015. <em>Regression Modeling Strategies: With
Applications to Linear Models, Logistic and Ordinal Regression, and
Survival Analysis</em>. Springer.
</div>
<div id="ref-rms" class="csl-entry">
———. 2021. <em>Rms: Regression Modeling Strategies</em>. <a
href="https://CRAN.R-project.org/package=rms">https://CRAN.R-project.org/package=rms</a>.
</div>
<div id="ref-msm" class="csl-entry">
Jackson, Christopher H. 2011. <span>“Multi-State Models for Panel Data:
The <span class="nocase">msm</span> Package for <span>R</span>.”</span>
<em>Journal of Statistical Software</em> 38 (8): 1–29. <a
href="https://www.jstatsoft.org/v38/i08/">https://www.jstatsoft.org/v38/i08/</a>.
</div>
<div id="ref-caret" class="csl-entry">
Kuhn, Max. 2021. <em>Caret: Classification and Regression Training</em>.
<a
href="https://CRAN.R-project.org/package=caret">https://CRAN.R-project.org/package=caret</a>.
</div>
<div id="ref-levshina2015linguistics" class="csl-entry">
Levshina, Natalia. 2015. <em>How to Do Linguistics with r: Data
Exploration and Statistical Analysis</em>. Amsterdam: John Benjamins
Publishing Company.
</div>
<div id="ref-sjPlot" class="csl-entry">
Lüdecke, Daniel. 2021. <em>sjPlot: Data Visualization for Statistics in
Social Science</em>. <a
href="https://CRAN.R-project.org/package=sjPlot">https://CRAN.R-project.org/package=sjPlot</a>.
</div>
<div id="ref-report" class="csl-entry">
Makowski, Dominique, Mattan S. Ben-Shachar, Indrajeet Patil, and Daniel
Lüdecke. 2021. <span>“Automated Results Reporting as a Practical Tool to
Improve Reproducibility and Methodological Best Practices
Adoption.”</span> <em>CRAN</em>. <a
href="https://github.com/easystats/report">https://github.com/easystats/report</a>.
</div>
<div id="ref-menard1995applied" class="csl-entry">
Menard, Scott. 1995. <em>Applied Logistic Regression Analysis: Sage
University Series on Quantitative Applications in the Social
Sciences</em>. Thousand Oaks, CA: Sage.
</div>
<div id="ref-myers1990classical" class="csl-entry">
Myers, Raymond H. 1990. <em>Classical and Modern Regression with
Applications</em>. Vol. 2. Duxbury Press Belmont, CA.
</div>
<div id="ref-rousseeuw2005robust" class="csl-entry">
Rousseeuw, Peter J, and Annick M Leroy. 2005. <em>Robust Regression and
Outlier Detection</em>. Vol. 589. John wiley &amp; sons.
</div>
<div id="ref-szmrecsanyi2006morphosyntactic" class="csl-entry">
Szmrecsanyi, Benedikt. 2006. <em>Morphosyntactic Persistence in Spoken
English: A Corpus Study at the Intersection of Variationist
Sociolinguistics, Psycholinguistics, and Discourse Analysis</em>. Berlin
&amp; New York: Walter de Gruyter.
</div>
<div id="ref-wilcox2009basic" class="csl-entry">
Wilcox, Rand R. 2009. <em>Basic Statistics: Understanding Conventional
Methods and Modern Insights</em>. Oxford University Press.
</div>
<div id="ref-winter2019statistics" class="csl-entry">
Winter, Bodo. 2019. <em>Statistics for Linguists: An Introduction Using
r</em>. Routledge.
</div>
<div id="ref-zuur2010protocol" class="csl-entry">
Zuur, Alain F., Elena N. Ieno, and Chris S. Elphick. 2010. <span>“A
Protocol for Data Exploration to Avoid Common Statistical
Problems.”</span> <em>Methods in Ecology and Evolution</em> 1 (1): 3–14.
</div>
</div>
</div>
<div class="footnotes footnotes-end-of-document">
<hr />
<ol>
<li id="fn1"><p>I’m extremely grateful to Stefan Thomas Gries who
provided very helpful feedback and pointed out many errors in previous
versions of this tutorial. All remaining errors are, of course, my
own.<a href="#fnref1" class="footnote-back">↩︎</a></p></li>
</ol>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
