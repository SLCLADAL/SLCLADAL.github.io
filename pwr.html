<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Martin Schweinberger" />

<meta name="date" content="2022-05-21" />

<title>Power Analysis in R</title>

<script src="site_libs/header-attrs-2.14/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<script src="site_libs/clipboard-1.7.1/clipboard.min.js"></script>
<link href="site_libs/primer-tooltips-1.4.0/build.css" rel="stylesheet" />
<link href="site_libs/klippy-0.0.0.9500/css/klippy.min.css" rel="stylesheet" />
<script src="site_libs/klippy-0.0.0.9500/js/klippy.min.js"></script>
<link rel="stylesheet" href="styles.css" />

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-VSGK4KYDQZ"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-VSGK4KYDQZ');
</script>


<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>





<style type="text/css">
/* for pandoc --citeproc since 2.11 */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">



<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  
  <!-- Added by SKC - LADAL image and thicker top with   -->
  <div class="container-fluid navbar-top" >
    <a href="index.html"> <!-- Make entire top row and text clickable home link  -->
        <div class="row">
            <div class="navbar-brand col-md-12">
              <img src="ladal_icon_cas_tran_white_trimed.png" class="navbar-icon" alt="LADAL"/>
              <span class="navbar-title-note navbar-collapse collapse" >Language Technology and Data Analysis Laboratory</span>
            </div>
        </div>
    </a>
  </div>
  
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <!-- SKC removed  navbar brand -->
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">HOME</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    ABOUT LADAL
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="people.html">People | Collabs</a>
    </li>
    <li>
      <a href="news.html">News</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    EVENTS
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="workshops.html">Workshops</a>
    </li>
    <li>
      <a href="webinars2022.html">LADAL Webinar Series 2022</a>
    </li>
    <li>
      <a href="opening.html">LADAL Webinar Series 2021</a>
    </li>
  </ul>
</li>
<li>
  <a href="tutorials.html">TUTORIALS</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    RESOURCES
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="links.html">Links</a>
    </li>
    <li>
      <a href="base.html">Tutorial stylesheet</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    CONTACT
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="contact.html">Contact</a>
    </li>
    <li>
      <a href="services.html">Services</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Power Analysis in R</h1>
<h4 class="author">Martin Schweinberger</h4>
<h4 class="date">2022-05-21</h4>

</div>


<p><img src="https://slcladal.github.io/images/uq1.jpg" width="100%" /></p>
<div id="introduction" class="section level1 unnumbered">
<h1 class="unnumbered">Introduction</h1>
<p>This tutorial introduces power analysis using R. Power analysis is a
method primarily used to determine the appropriate sample size for
empirical studies.</p>
<p><img src="https://slcladal.github.io/images/yr_chili.jpg" width="15%" style="float:right; padding:10px" /></p>
<p>This tutorial is aimed at intermediate and advanced users of R with
the aim of showcasing how to perform power analyses for basic
inferential tests using the <code>pwr</code> package <span
class="citation">(<a href="#ref-pwr" role="doc-biblioref">Champely
2020</a>)</span> and for mixed-effect models (generated with the
<code>lme4</code> package) using the <code>simr</code> package <span
class="citation">(<a href="#ref-simr" role="doc-biblioref">Green and
MacLeod 2016b</a>)</span> in R. The aim is not to provide a
fully-fledged analysis but rather to show and exemplify a handy method
for estimating the power of experimental and observational designs and
how to implement this in R.</p>
<div class="warning"
style="padding:0.1em; background-color:#f2f2f2; color:#51247a">
<span>
<p style="margin-top:1em; text-align:center">
The entire R Notebook for the tutorial can be downloaded <a
href="https://slcladal.github.io/pwr.Rmd"><strong>here</strong></a>. If
you want to render the R Notebook on your machine, i.e. knitting the
document to html or a pdf, you need to make sure that you have R and
RStudio installed and you also need to download the <a
href="https://slcladal.github.io/bibliography.bib"><strong>bibliography
file</strong></a> and store it in the same folder where you store the
Rmd file. <br>
</p>
<p style="margin-left:1em;">
</p>
<p></span></p>
</div>
<p><br></p>
<p>The basis for the present tutorial is <span class="citation">Green
and MacLeod (<a href="#ref-green2016simr"
role="doc-biblioref">2016a</a>)</span> (which you can find <a
href="https://besjournals.onlinelibrary.wiley.com/doi/full/10.1111/2041-210X.12504">here</a>).
<span class="citation">Green and MacLeod (<a href="#ref-green2016simr"
role="doc-biblioref">2016a</a>)</span> is a highly recommendable and
thorough tutorial on performing power analysis in R. Recommendable
literature on this topic are, e.g. <span class="citation">Arnold et al.
(<a href="#ref-arnold2011simulation"
role="doc-biblioref">2011</a>)</span> and <span class="citation">Johnson
et al. (<a href="#ref-johnson2015power"
role="doc-biblioref">2015</a>)</span> and <a
href="https://www.journalofcognition.org/articles/10.5334/joc.10/">this
tutorial</a>.</p>
<div id="what-determines-if-you-find-an-effect"
class="section level2 unnumbered">
<h2 class="unnumbered">What determines if you find an effect?</h2>
<p>To explore this issue, let us have a look at some distributions of
samples with varying features sampled from either one or two
distributions.</p>
<p>Let us start with the distribution of two samples (N = 30) sampled
from the same population.</p>
<p><img src="pwr_files/figure-html/displot1-1.png" width="672" /></p>
<p>The means of the samples are very similar and a t-test confirms that
we can assume that the samples are drawn from the same population (as
the p-value is greater than .05).</p>
<p>Let us now draw another two samples (N = 30) but from different
populations where the effect of group is weak (the population difference
is small).</p>
<p><img src="pwr_files/figure-html/weak-1.png" width="672" /></p>
<p>Let us briefly check if the effect size, Cohen’s <em>d</em> of 0.2,
is correct (for this, we increase the sample size dramatically to get
very accurate estimates). If the above effect size is correct (Cohen’s
<em>d</em> = 0.2), then the reported effect size should be 0.2 (or
-0.2). This is so because Cohen’s <em>d</em> represents distances
between group means measured in standard deviations (in our example, the
standard deviation is 10 and the difference between the means is 2,
i.e., 20 percent of a standard deviation; which is equal to a Cohen’s
<em>d</em> value of 0.2). Let’s check the effect size now (we will only
do this for this distribution but you can easily check for yourself that
the effect sizes provided in the plot headers below are correct by
adapting the code chunk below and using the numbers provided in the plot
headers).</p>
<pre class="r"><code># generate two vectors with numbers using the means and sd from above 
# means = 101, 99, sd = 10
num1 &lt;- rnorm(1000000, mean = 101, sd = 10)
num2 &lt;- rnorm(1000000, mean = 99, sd = 10)
# perform t-test
tt &lt;- t.test(num1, num2, alternative = &quot;two.sided&quot;)
# extract effect size
effectsize::effectsize(tt)</code></pre>
<pre><code>## Cohen&#39;s d | 95% CI
## ------------------
## 0.20      |       
## 
## - Estimated using un-pooled SD.</code></pre>
<p>Based on the t-test results in the distribution plot, we assume that
the data represents two samples from the same population (which is
false) because the p-value is higher than .05. This means that the
sample size is insufficient or <em>does not enough power</em> to show
that they are actually from two different populations given the
variability in the data nd the size of the effect (which is weak).</p>
<p>What happens if we increase the effect size to medium? This means
that we again draw two samples from two different populations but the
difference between the populations is a bit larger (group has a medium
effect, Cohen’s <em>d</em> = .5)</p>
<p><img src="pwr_files/figure-html/medium-1.png" width="672" /></p>
<p>Now, lets have a look at at the distribution of two different groups
(group has a strong effect, Cohen’s <em>d</em> = .8)</p>
<p><img src="pwr_files/figure-html/strong-1.png" width="672" /></p>
<p>Now, lets have a look at at the distribution of two different groups
(group has a very strong effect, Cohen’s <em>d</em> = 1.2)</p>
<p><img src="pwr_files/figure-html/vstrong-1.png" width="672" /></p>
<p><strong>If variability and sample size remain constant, larger
effects are easier to detect than smaller effects!</strong></p>
</div>
<div id="sample-size" class="section level2 unnumbered">
<h2 class="unnumbered">Sample size</h2>
<p>And let’s now look at sample size.</p>
<p><img src="pwr_files/figure-html/n30-1.png" width="672" /></p>
<p>Let us now increase the sample size to N = 50.</p>
<p><img src="pwr_files/figure-html/n50-1.png" width="672" /></p>
<p><strong>If variability and effect size remain constant, effects are
easier to detect with increasing sample size!</strong></p>
</div>
<div id="variability" class="section level2 unnumbered">
<h2 class="unnumbered">Variability</h2>
<p>And let’s now look at variability.</p>
<p><img src="pwr_files/figure-html/sd10-1.png" width="672" /></p>
<p>Let’s decrease the variability to sd = 5.</p>
<p><img src="pwr_files/figure-html/sd5-1.png" width="672" /></p>
<p><strong>If the sample and effect size remain constant, effects are
easier to detect with decreasing variability!</strong></p>
<p><strong>In summary</strong>, there are three main factors that
determine if a model finds an effect. The accuracy (i.e., the
probability of finding an effect):</p>
<ul>
<li>the size of the effect (bigger effects are easier to detect)</li>
<li>the variability of the effect (less variability makes it easier to
detect an effect), and</li>
<li>the sample size (the bigger the sample size, the easier it is to
detect an effect);
<ul>
<li>number of subjects/participants</li>
<li>number of items/questions</li>
<li>number of observations per item within subjects/participants</li>
</ul></li>
</ul>
<p>Now, if a) we dealing with a very big effect, then we need only few
participants and few items to accurately find this effect.</p>
<p>Or b) if we dealing with an effect that has low variability (it is
observable for all subjects with the same strength), then we need only
few participants and few items to accurately find this effect.</p>
<p>Before we conduct a study, we should figure out, what sample we need
to detect a small/medium effect with medium variability so that our
model is sufficient to detect this kind of effect. In order to do this,
we would generate a data set that mirrors the kind of data that we
expect to get (with the properties that we expect to get). We can then
fit a model to this data and check if a model would be able to detect
the expected effect. However, because a single model does not tell us
that much (it could simply be luck that it happened to find the effect),
we run many different models on variations of the data and see how many
of them find the effect. As a general rule of thumb, we want a data set
that allows a model to find a medium sized effect with at least an
accuracy of 80 percent <span class="citation">(<a
href="#ref-field2007making" role="doc-biblioref">Field et al.
2007</a>)</span>.</p>
<p>In the following, we will go through how to determine what sample
size we need for an example analysis.</p>
</div>
<div id="preparation-and-session-set-up"
class="section level2 unnumbered">
<h2 class="unnumbered">Preparation and session set up</h2>
<p>This tutorial is based on R. If you have not installed R or are new
to it, you will find an introduction to and more information how to use
R <a href="https://slcladal.github.io/intror.html">here</a>. For this
tutorials, we need to install certain <em>packages</em> into the R
<em>library</em> on your computer so that the scripts shown below are
executed without errors. Before turning to the code below, please
install the packages by running the code below this paragraph. If you
have already installed the packages mentioned below, then you can skip
ahead and ignore this section. To install the necessary packages, simply
run the following code - it may take some time (between 1 and 5 minutes
to install all of the libraries so you do not need to worry if it takes
some time).</p>
<pre class="r"><code># install libraries
install.packages(c(&quot;tidyverse&quot;, &quot;pwr&quot;, &quot;lme4&quot;, &quot;sjPlot&quot;, &quot;simr&quot;, &quot;effectsize&quot;))
install.packages(c(&quot;DT&quot;, &quot;knitr&quot;, &quot;flextable&quot;))
install.packages(&quot;DescTools&quot;)
install.packages(&quot;pacman&quot;)
# install klippy for copy-to-clipboard button in code chunks
install.packages(&quot;remotes&quot;)
remotes::install_github(&quot;rlesur/klippy&quot;)</code></pre>
<p>Now that we have installed the packages, we can activate them as
shown below.</p>
<pre class="r"><code># set options
options(stringsAsFactors = F)         # no automatic conversion of factors
options(&quot;scipen&quot; = 100, &quot;digits&quot; = 4) # suppress math annotation
options(max.print=1000)               # print max 1000 results
# load packages
library(tidyverse)
library(pwr)
library(lme4)
library(sjPlot)
library(simr)
library(effectsize)
library(DT)
library(knitr)
library(flextable)
pacman::p_load_gh(&quot;trinker/entity&quot;)
# activate klippy for copy-to-clipboard button
klippy::klippy()</code></pre>
<script>
  addClassKlippyTo("pre.r, pre.markdown");
  addKlippy('left', 'top', 'auto', '1', 'Copy code', 'Copied!');
</script>
<p>Once you have installed R and RStudio and initiated the session by
executing the code shown above, you are good to go.</p>
</div>
</div>
<div id="basic-power-analysis" class="section level1 unnumbered">
<h1 class="unnumbered">Basic Power Analysis</h1>
<p>Let’s start with a simple power analysis to see how power analyses
work for simpler or basic statistical tests such as t-test, <span
class="math inline">\(\chi\)</span><sup>2</sup>-test, or linear
regression.</p>
<p>The <code>pwr</code> package <span class="citation">(<a
href="#ref-pwr" role="doc-biblioref">Champely 2020</a>)</span>
implements power analysis as outlined by <span class="citation">Cohen
(<a href="#ref-cohen1988statistical"
role="doc-biblioref">1988</a>)</span> and allows to perform power
analyses for the following tests (selection):</p>
<ul>
<li><p>balanced one way ANOVA (<code>pwr.anova.test</code>)</p></li>
<li><p>chi-square test (<code>pwr.chisq.test</code>)</p></li>
<li><p>Correlation (<code>pwr.r.test</code>)</p></li>
<li><p>general linear model (<code>pwr.f2.test</code>)</p></li>
<li><p>paired (one and two sample) t-test
(<code>pwr.t.test</code>)</p></li>
<li><p>two sample t-test with unequal N
(<code>pwr.t2n.test</code>)</p></li>
</ul>
<p>For each of these functions, you enter three of the four parameters
(effect size, sample size, significance level, power) and the fourth is
calculated.</p>
<p>So how does this work? Have a look at the code chunk below.</p>
<div id="one-way-anova" class="section level2 unnumbered">
<h2 class="unnumbered">One-way ANOVA</h2>
<p>Let check how to calculate the necessary sample size for each group
for a one-way ANOVA that compares 5 groups (<code>k</code>) and that has
a power of 0.80 (80 percent), when the effect size is moderate
(<em>f</em> = 0.25) and the significance level is 0.05 (5 percent)..</p>
<pre class="r"><code># load package
library(pwr)
# calculate minimal sample size
pwr.anova.test(k=5,            # 5 groups are compared
               f=.25,          # moderate effect size
               sig.level=.05,  # alpha/sig. level = .05
               power=.8)       # confint./power = .8</code></pre>
<pre><code>## 
##      Balanced one-way analysis of variance power calculation 
## 
##               k = 5
##               n = 39.15
##               f = 0.25
##       sig.level = 0.05
##           power = 0.8
## 
## NOTE: n is number in each group</code></pre>
<p>In this case, the minimum number of participants in each group would
be 40.</p>
<p>Let’s check how we could calculate the power if we had already
collected data (with 30 participants in each group) and we want to
report the power of our analysis (and let us assume that the effect size
was medium).</p>
<pre class="r"><code># calculate minimal sample size
pwr.anova.test(k=5,            # 5 groups are compared
               f=.25,          # moderate effect size
               sig.level=.05,  # alpha/sig. level = .05
               n=30)           # n of participants</code></pre>
<pre><code>## 
##      Balanced one-way analysis of variance power calculation 
## 
##               k = 5
##               n = 30
##               f = 0.25
##       sig.level = 0.05
##           power = 0.6676
## 
## NOTE: n is number in each group</code></pre>
<p>In this case our analysis would only have a power or 66.8 percent.
This means that we would only detect a medium sized effect in 66.7
percent of cases (which is considered insufficient).</p>
</div>
<div id="power-analysis-for-glms" class="section level2 unnumbered">
<h2 class="unnumbered">Power Analysis for GLMs</h2>
<p>When determining the power of a generalized linear model, we need to
provide</p>
<ul>
<li><p>the degrees of freedom for numerator (´u´)</p></li>
<li><p>the degrees of freedom for denominator (<code>v</code>)</p></li>
<li><p>the effect size (the estimate of the intercept and the
slope/estimates of the predictors)</p></li>
<li><p>the level of significance (i.e., the type I error
probability)</p></li>
</ul>
<p>The values of the parameters in the example below are adapted from
the fixed-effects regression example that was used to analyze different
teaching styles (see <a
href="https://slcladal.github.io/regression.html#Example_2:_Teaching_Styles">here</a>).</p>
<p>The effect size used here is <span
class="math inline">\(f^2^\)</span> that has be categorized as follows
<span class="citation">(see <a href="#ref-cohen1988statistical"
role="doc-biblioref">Cohen 1988</a>)</span>: small <span
class="math inline">\(≥\)</span> 0.02, medium <span
class="math inline">\(≥\)</span> 0.15, and large <span
class="math inline">\(≥\)</span> 0.35. So in order to determine if the
data is sufficient to find a weak effect when comparing 2 groups with 30
participants in both groups (df_numerator_: 2-1; df_denominator_: (30-1)
+ (30-1)) and a significance level at <span
class="math inline">\(\alpha\)</span> = .05, we can use the following
code.</p>
<pre class="r"><code># general linear model
pwrglm &lt;- pwr.f2.test(u = 1,
                      v = 58,
                      f2 = .02,
                      sig.level = 0.05)
# inspect results
pwrglm</code></pre>
<pre><code>## 
##      Multiple regression power calculation 
## 
##               u = 1
##               v = 58
##              f2 = 0.02
##       sig.level = 0.05
##           power = 0.1899</code></pre>
<p>The results show that the regression analyses used to evaluate the
effectiveness of different teaching styles only had a power of
0.1899.</p>
</div>
<div id="power-analysis-for-t-tests" class="section level2 unnumbered">
<h2 class="unnumbered">Power Analysis for t-tests</h2>
<p>For t-tests (both paired and 2-sample t-tests), the effect size
measure is Cohen’s <span class="math inline">\(d\)</span> that has be
categorized as follows <span class="citation">(see <a
href="#ref-cohen1988statistical" role="doc-biblioref">Cohen
1988</a>)</span>: small <span class="math inline">\(≥\)</span> 0.2,
medium <span class="math inline">\(≥\)</span> 0.5, and large <span
class="math inline">\(≥\)</span> 0.8.</p>
<p><strong>Paired t-test</strong></p>
<p>So in order to determine if the data is sufficient to find a weak
effect when comparing the pre- and post-test results of a group with 30
participants, evaluating an undirected hypothesis (thus the
<em>two-tailed</em> approach), and a significance level at <span
class="math inline">\(\alpha\)</span> = .05, we can use the following
code.</p>
<pre class="r"><code># paired t-test
pwrpt &lt;- pwr.t.test(d=0.2,
                    n=30,
                    sig.level=0.05,
                    type=&quot;paired&quot;,
                    alternative=&quot;two.sided&quot;)
# inspect
pwrpt</code></pre>
<pre><code>## 
##      Paired t test power calculation 
## 
##               n = 30
##               d = 0.2
##       sig.level = 0.05
##           power = 0.1852
##     alternative = two.sided
## 
## NOTE: n is number of *pairs*</code></pre>
<p>Given the data, a weak effect in this design can only be detected
with a certainty of 0.1852 percent. This means that we would need to
substantively increase the sample size to detect a small effect with
this design.</p>
<p><strong>Two-sample (independent) t-test</strong></p>
<p>The power in a similar scenario but with two different groups (with
25 and 35 subjects) can be determined as follows (in this case we test a
directed hypothesis that checks if the intervention leads to an increase
in the outcome - hence the <em>greater</em> in the
<code>alternative</code> argument):</p>
<pre class="r"><code># independent t-test
pwr2t &lt;- pwr.t2n.test(d=0.2,
                      n1=35,
                      n2 = 25,
                      sig.level=0.05,
                      alternative=&quot;greater&quot;)
# inspect
pwr2t</code></pre>
<pre><code>## 
##      t test power calculation 
## 
##              n1 = 35
##              n2 = 25
##               d = 0.2
##       sig.level = 0.05
##           power = 0.1867
##     alternative = greater</code></pre>
<p>Given the data, a weak effect in this design can only be detected
with a certainty of 0.1867 percent. This means that we would need to
substantively increase the sample size to detect a small effect with
this design.</p>
</div>
<div id="power-analysis-for-chi2-tests"
class="section level2 unnumbered">
<h2 class="unnumbered">Power Analysis for <span
class="math inline">\(\chi\)</span><sup>2</sup>-tests</h2>
<p>Let us now check the power of a <span
class="math inline">\(\chi^2\)</span>^-test. For <span
class="math inline">\(\chi^2\)</span>^-test, the effect size measure
used in the power analysis is <span class="math inline">\(w\)</span>
that has be categorized as follows <span class="citation">(see <a
href="#ref-cohen1988statistical" role="doc-biblioref">Cohen
1988</a>)</span>: small <span class="math inline">\(≥\)</span> 0.1,
medium <span class="math inline">\(≥\)</span> 0.3, and large <span
class="math inline">\(≥\)</span> 0.5. Also, keep in mind that for <span
class="math inline">\(\chi^2\)</span>^-tests, at least 80 percent of
cells need to have values <span class="math inline">\(≥\)</span> 5 and
none of the cells should have expected values smaller than 1 <span
class="citation">(see <a href="#ref-bortz109verteilungsfreie"
role="doc-biblioref">Bortz, Lienert, and Boehnke 1990</a>)</span>.</p>
<pre class="r"><code># x2-test
pwrx2 &lt;- pwr.chisq.test(w=0.2,
                        N = 25, # total number of observations
                        df = 1,
                        sig.level=0.05)
# inspect
pwrx2</code></pre>
<pre><code>## 
##      Chi squared power calculation 
## 
##               w = 0.2
##               N = 25
##              df = 1
##       sig.level = 0.05
##           power = 0.1701
## 
## NOTE: N is the number of observations</code></pre>
<p>Given the data, a weak effect in this design can only be detected
with a certainty of 0.1701 percent. This means that we would need to
substantively increase the sample size to detect a small effect with
this design.</p>
<hr />
<div class="warning"
style="padding:0.1em; background-color:#51247a; color:#f2f2f2">
<span>
<p style="margin-top:1em; text-align:center">
<b>EXERCISE TIME!</b>
</p>
<p style="margin-left:1em;">
</p>
<p></span></p>
</div>
<div class="question">
<p>`</p>
<ol style="list-style-type: decimal">
<li>For the tests above (anova, glm, paired and independent t-test, and
the <span class="math inline">\(\chi^2\)</span>-test), how many
participants would you need to have a power of 80 percent?<br></li>
</ol>
<p>Here are the commands we used to help you:<br></p>
<ul>
<li><p>ANOVA:
<code>pwr.anova.test(k=5, f=.25, sig.level=.05, n=30)</code></p></li>
<li><p>GLM:
<code>pwr.f2.test(u = 1, v = 58, f2 = .02, sig.level = 0.05)</code></p></li>
<li><p>paired t-test:
<code>pwr.t.test(d=0.2, n=30, sig.level=0.05, type="paired", alternative="two.sided")</code></p></li>
<li><p>independent t-test:
<code>pwr.t2n.test(d=0.2,n1=35, n2 = 25, sig.level=0.05, alternative="greater")</code></p></li>
<li><p><span class="math inline">\(\chi^2\)</span>-test:
<code>pwr.chisq.test(w=0.2, N = 25,  df = 1, sig.level=0.05)</code>
<br></p>
<details>
<summary>
<p>Answer</p>
</summary>
<pre class="r"><code>pwr.anova.test(k=5, f=.25, sig.level=.05, p=.8)</code></pre>
<pre><code>## 
##      Balanced one-way analysis of variance power calculation 
## 
##               k = 5
##               n = 39.15
##               f = 0.25
##       sig.level = 0.05
##           power = 0.8
## 
## NOTE: n is number in each group</code></pre>
<pre class="r"><code>pwr.f2.test(u = 1, f2 = .02, sig.level = 0.05, p = .8)</code></pre>
<pre><code>## 
##      Multiple regression power calculation 
## 
##               u = 1
##               v = 392.4
##              f2 = 0.02
##       sig.level = 0.05
##           power = 0.8</code></pre>
<pre class="r"><code>pwr.t.test(d=0.2, p = .8, sig.level=0.05, type=&quot;paired&quot;, alternative=&quot;two.sided&quot;)</code></pre>
<pre><code>## 
##      Paired t test power calculation 
## 
##               n = 198.2
##               d = 0.2
##       sig.level = 0.05
##           power = 0.8
##     alternative = two.sided
## 
## NOTE: n is number of *pairs*</code></pre>
<pre class="r"><code>pwr.t2n.test(d=0.2, n1=310, n2 = 310, sig.level=0.05, alternative=&quot;greater&quot;) # by checking N values</code></pre>
<pre><code>## 
##      t test power calculation 
## 
##              n1 = 310
##              n2 = 310
##               d = 0.2
##       sig.level = 0.05
##           power = 0.8002
##     alternative = greater</code></pre>
<pre class="r"><code>pwr.chisq.test(w=0.2, p = .8,  df = 1, sig.level=0.05)</code></pre>
<pre><code>## 
##      Chi squared power calculation 
## 
##               w = 0.2
##               N = 196.2
##              df = 1
##       sig.level = 0.05
##           power = 0.8
## 
## NOTE: N is the number of observations</code></pre>
</details></li>
</ul>
</div>
<p>`</p>
<hr />
</div>
<div id="excursion-language-is-never-ever-random"
class="section level2 unnumbered">
<h2 class="unnumbered">Excursion: Language is never ever random</h2>
<p>In 2005, Adam <span class="citation">Kilgarriff (<a
href="#ref-kilgarriff2005language" role="doc-biblioref">2005</a>)</span>
made a point that <em>Language is never, ever, ever, random</em>. Here
is part of the abstract:</p>
<blockquote>
<p>Language users never choose words randomly, and language is
essentially non-random. Statistical hypothesis testing uses a null
hypothesis, which posits randomness. Hence, when we look at linguistic
phenomena in corpora, the null hypothesis will never be true. Moreover,
where there is enough data, we shall (almost) always be able to
establish that it is not true. In corpus studies, we frequently do have
enough data, so the fact that a relation between two phenomena is
demonstrably non-random, does not support the inference that it is not
arbitrary. We present experimental evidence of how arbitrary
associations between word frequencies and corpora are systematically
non-random.</p>
</blockquote>
<p>This is a problem because if we are using ever bigger corpora, even
the tiniest of difference will become significant. have a look at the
following example.</p>
<pre class="r"><code># first let us generate some data
freqs1 &lt;- matrix(c(10, 28, 30, 92), byrow = T, ncol = 2)
# inspect data
freqs1</code></pre>
<pre><code>##      [,1] [,2]
## [1,]   10   28
## [2,]   30   92</code></pre>
<p>Now, we perform a simple <span
class="math inline">\(\chi^2\)</span>-test and extract the effect
size.</p>
<pre class="r"><code># x2-test
x21 &lt;- chisq.test(freqs1)
# inspect results
x21</code></pre>
<pre><code>## 
##  Pearson&#39;s Chi-squared test with Yates&#39; continuity correction
## 
## data:  freqs1
## X-squared = 0, df = 1, p-value = 1</code></pre>
<pre class="r"><code># effect size
effectsize::effectsize(x21)</code></pre>
<pre><code>## Cramer&#39;s V |       95% CI
## -------------------------
## 0.02       | [0.00, 1.00]
## 
## - One-sided CIs: upper bound fixed at (1).</code></pre>
<p>the output shows that the difference is not significant and that the
effect size is extremely(!) small.</p>
<p>Now, let us simply increase the sample size by a factor of 1000 and
also perform a <span class="math inline">\(\chi^2\)</span>-test on this
extended data set and extract the effect size.</p>
<pre class="r"><code># 
freqs2 &lt;- matrix(c(10000, 28000, 30000, 92000), byrow = T, ncol = 2)
# first let us generate some data
x22 &lt;- chisq.test(freqs2)
# inspect results
x22</code></pre>
<pre><code>## 
##  Pearson&#39;s Chi-squared test with Yates&#39; continuity correction
## 
## data:  freqs2
## X-squared = 46, df = 1, p-value = 0.00000000001</code></pre>
<pre class="r"><code># effect size
effectsize::effectsize(x22)</code></pre>
<pre><code>## Cramer&#39;s V |       95% CI
## -------------------------
## 0.02       | [0.01, 1.00]
## 
## - One-sided CIs: upper bound fixed at (1).</code></pre>
<p>The output shows that the difference is not significant but that the
effect size has remain the same. For this reason, in a response to
Kilgariff, Stefan <span class="citation">(<a
href="#ref-gries2005kilgariff" role="doc-biblioref">Gries
2005</a>)</span> suggested to always also report effect size in addition
to significance so that the reader has an understanding of whether a
significant effect is meaningful.</p>
<p>This is relevant here because we have focused on the power for
finding small effects as these can be considered the smallest
<em>meaningful</em> effects. However, even tiny effects can be
meaningful under certain circumstances - as such, focusing on small
effects is only a rule of thumb, should be taken with a pinch of salt,
and should be re-evaluated in the context of the study at hand.</p>
</div>
</div>
<div id="advanced-power-analysis" class="section level1 unnumbered">
<h1 class="unnumbered">Advanced Power Analysis</h1>
<p>In this section, we will perform power analyses for mixed-effects
models (both linear and generalized linear mixed models). The basis for
this section is <span class="citation">Green and MacLeod (<a
href="#ref-green2016simr" role="doc-biblioref">2016a</a>)</span> (which
you can find <a
href="https://besjournals.onlinelibrary.wiley.com/doi/full/10.1111/2041-210X.12504">here</a>).
<span class="citation">Green and MacLeod (<a href="#ref-green2016simr"
role="doc-biblioref">2016a</a>)</span> is a highly recommendable and
thorough tutorial on performing power analysis in R. Recommendable
literature on this topic are, e.g. <span class="citation">Arnold et al.
(<a href="#ref-arnold2011simulation"
role="doc-biblioref">2011</a>)</span> and <span class="citation">Johnson
et al. (<a href="#ref-johnson2015power"
role="doc-biblioref">2015</a>)</span> and <a
href="https://www.journalofcognition.org/articles/10.5334/joc.10/">this
tutorial</a>.</p>
<p>Before we conduct a study, we should figure out, what sample we need
to detect a small/medium effect with medium variability so that our
model is sufficient to detect this kind of effect. In order to do this,
we would generate a data set that mirrors the kind of data that we
expect to get (with the properties that we expect to get). We can then
fit a model to this data and check if a model would be able to detect
the expected effect. However, because a single model does not tell us
that much (it could simply be luck that it happened to find the effect),
we run many different models on variations of the data and see how many
of them find the effect. As a general rule of thumb, we want a data set
that allows a model to find a medium sized effect with at least an
accuracy of 80 percent <span class="citation">(<a
href="#ref-field2007making" role="doc-biblioref">Field et al.
2007</a>)</span>.</p>
<p>In the following, we will go through how to determine what sample
size we need for an example analysis.</p>
<div id="using-piloted-data-and-a-lmer"
class="section level2 unnumbered">
<h2 class="unnumbered">Using piloted data and a lmer</h2>
<p>For this analysis, we load an existing data set resulting from a
piloted study that only contains the predictors (not the response
variable).</p>
<pre class="r"><code># load data
regdat  &lt;- base::readRDS(url(&quot;https://slcladal.github.io/data/regdat.rda&quot;, &quot;rb&quot;))
# inspect
head(regdat, 10);str(regdat)</code></pre>
<pre><code>##        ID   Sentence     Group WordOrder SentenceType
## 1  Part01 Sentence01 L1English        V2  NoAdverbial
## 2  Part01 Sentence02 L1English        V3  NoAdverbial
## 3  Part01 Sentence03 L1English        V3  NoAdverbial
## 4  Part01 Sentence04 L1English        V2  NoAdverbial
## 5  Part01 Sentence05 L1English        V2  NoAdverbial
## 6  Part01 Sentence06 L1English        V3  NoAdverbial
## 7  Part01 Sentence07 L1English        V2  NoAdverbial
## 8  Part01 Sentence08 L1English        V3  NoAdverbial
## 9  Part01 Sentence09 L1English        V3  NoAdverbial
## 10 Part01 Sentence10 L1English        V2  NoAdverbial</code></pre>
<pre><code>## &#39;data.frame&#39;:    480 obs. of  5 variables:
##  $ ID          : Factor w/ 20 levels &quot;Part01&quot;,&quot;Part02&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
##  $ Sentence    : Factor w/ 24 levels &quot;Sentence01&quot;,&quot;Sentence02&quot;,..: 1 2 3 4 5 6 7 8 9 10 ...
##  $ Group       : Factor w/ 2 levels &quot;L1English&quot;,&quot;L2English&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ WordOrder   : Factor w/ 2 levels &quot;V2&quot;,&quot;V3&quot;: 1 2 2 1 1 2 1 2 2 1 ...
##  $ SentenceType: Factor w/ 2 levels &quot;NoAdverbial&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...</code></pre>
<p>We inspect the data and check how many levels we have for each
predictor and if the levels are distributed correctly (so that we do not
have incomplete information).</p>
<pre class="r"><code>table(regdat$Group, regdat$WordOrder); </code></pre>
<pre><code>##            
##              V2  V3
##   L1English 120 120
##   L2English 120 120</code></pre>
<pre class="r"><code>table(regdat$Group, regdat$SentenceType); </code></pre>
<pre><code>##            
##             NoAdverbial SentenceAdverbial
##   L1English         120               120
##   L2English         120               120</code></pre>
<pre class="r"><code>table(regdat$ID)</code></pre>
<pre><code>## 
## Part01 Part02 Part03 Part04 Part05 Part06 Part07 Part08 Part09 Part10 Part11 
##     24     24     24     24     24     24     24     24     24     24     24 
## Part12 Part13 Part14 Part15 Part16 Part17 Part18 Part19 Part20 
##     24     24     24     24     24     24     24     24     24</code></pre>
<pre class="r"><code>table(regdat$Sentence)</code></pre>
<pre><code>## 
## Sentence01 Sentence02 Sentence03 Sentence04 Sentence05 Sentence06 Sentence07 
##         20         20         20         20         20         20         20 
## Sentence08 Sentence09 Sentence10 Sentence11 Sentence12 Sentence13 Sentence14 
##         20         20         20         20         20         20         20 
## Sentence15 Sentence16 Sentence17 Sentence18 Sentence19 Sentence20 Sentence21 
##         20         20         20         20         20         20         20 
## Sentence22 Sentence23 Sentence24 
##         20         20         20</code></pre>
<p>We could also add a response variable (but we will do this later when
we deal with post-hoc power analyses).</p>
<div id="generating-the-model" class="section level3 unnumbered">
<h3 class="unnumbered">Generating the model</h3>
<p>We now generate model that has per-defined parameters. We begin by
specifying the parameters by setting effect sizes of the fixed effects
and the intercept, the variability accounted fro by the random effects
and the residuals.</p>
<pre class="r"><code># Intercept + slopes for fixed effects 
# (Intercept + Group, SentenceType, WordOrder, and an interaction between Group * SentenceType)
fixed &lt;- c(.52, .52, .52, .52, .52)
# Random intercepts for Sentence and ID
rand &lt;- list(0.5, 0.1)
# res. variance
res &lt;- 2</code></pre>
<p>We now generate the model and fit it to our data.</p>
<pre class="r"><code>m1 &lt;- makeLmer(y ~ (1|Sentence) + (1|ID) + Group * SentenceType + WordOrder, 
               fixef=fixed, 
               VarCorr=rand, 
               sigma=res, 
               data=regdat)

# inspect
m1</code></pre>
<pre><code>## Linear mixed model fit by REML [&#39;lmerMod&#39;]
## Formula: y ~ (1 | Sentence) + (1 | ID) + Group * SentenceType + WordOrder
##    Data: regdat
## REML criterion at convergence: 2100
## Random effects:
##  Groups   Name        Std.Dev.
##  Sentence (Intercept) 0.707   
##  ID       (Intercept) 0.316   
##  Residual             2.000   
## Number of obs: 480, groups:  Sentence, 24; ID, 20
## Fixed Effects:
##                                  (Intercept)  
##                                         0.52  
##                               GroupL2English  
##                                         0.52  
##                SentenceTypeSentenceAdverbial  
##                                         0.52  
##                                  WordOrderV3  
##                                         0.52  
## GroupL2English:SentenceTypeSentenceAdverbial  
##                                         0.52</code></pre>
<p>Inspect summary table</p>
<pre class="r"><code>sjPlot::tab_model(m1)</code></pre>
<table style="border-collapse:collapse; border:none;">
<tr>
<th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">
 
</th>
<th colspan="3" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">
y
</th>
</tr>
<tr>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">
Predictors
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
Estimates
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
CI
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
p
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
(Intercept)
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.52
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
-0.14 – 1.18
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.124
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
Group [L2English]
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.52
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
-0.06 – 1.10
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.078
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
SentenceType<br>[SentenceAdverbial]
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.52
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
-0.24 – 1.28
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.180
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
WordOrder [V3]
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.52
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
-0.15 – 1.19
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.129
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
Group [L2English] *<br>SentenceType<br>[SentenceAdverbial]
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.52
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
-0.20 – 1.24
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.155
</td>
</tr>
<tr>
<td colspan="4" style="font-weight:bold; text-align:left; padding-top:.8em;">
Random Effects
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
σ<sup>2</sup>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">
4.00
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
τ<sub>00</sub> <sub>Sentence</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">
0.50
</td>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
τ<sub>00</sub> <sub>ID</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">
0.10
</td>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
ICC
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">
0.13
</td>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
N <sub>Sentence</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">
24
</td>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
N <sub>ID</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">
20
</td>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;">
Observations
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="3">
480
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
Marginal R<sup>2</sup> / Conditional R<sup>2</sup>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">
0.078 / 0.198
</td>
</tr>
</table>
<p><strong>The summary table shows that the effects are correct but none
of them are reported as being significant!</strong></p>
</div>
<div id="power-analysis" class="section level3 unnumbered">
<h3 class="unnumbered">Power analysis</h3>
<p>Let us now check if the data is sufficient to detect the main effect
of <code>WordOrder</code>. In the <code>test</code> argument we use
<code>fcompare</code> which allows us to compare a model with that
effect (our <em>m1</em> model) to a model without that effect.
Fortunately, we only need to specify the fixed effects structure.</p>
<pre class="r"><code>sim_wo &lt;- simr::powerSim(m1, 
                        nsim=20,
                        
                        test = fcompare(y ~ Group * SentenceType)) </code></pre>
<pre><code>## Simulating: |                                                                  |Simulating: |===                                                               |Simulating: |======                                                            |Simulating: |=========                                                         |Simulating: |=============                                                     |Simulating: |================                                                  |Simulating: |===================                                               |Simulating: |=======================                                           |Simulating: |==========================                                        |Simulating: |=============================                                     |Simulating: |=================================                                 |Simulating: |====================================                              |Simulating: |=======================================                           |Simulating: |==========================================                        |Simulating: |==============================================                    |Simulating: |=================================================                 |Simulating: |====================================================              |Simulating: |========================================================          |Simulating: |===========================================================       |Simulating: |==============================================================    |Simulating: |==================================================================|</code></pre>
<pre class="r"><code># inspect results
sim_wo</code></pre>
<pre><code>## Power for model comparison, (95% confidence interval):
##       35.00% (15.39, 59.22)
## 
## Test: Likelihood ratio
##       Comparison to y ~ Group * SentenceType + [re]
## 
## Based on 20 simulations, (0 warnings, 0 errors)
## alpha = 0.05, nrow = 480
## 
## Time elapsed: 0 h 0 m 3 s</code></pre>
<p><em>The data is not sufficient and would only detect a weak effect of
<code>WordOrder</code> with 7 percent accuracy!</em></p>
<p>Before we continue to see how to test the power of data to find
interactions, let us briefly think about why I chose 0.52 when we
specified the effect sizes.</p>
</div>
<div id="why-did-i-set-the-estimates-to-0.52"
class="section level3 unnumbered">
<h3 class="unnumbered">Why did I set the estimates to 0.52?</h3>
<p>Let us now inspect the effect sizes and see why I used 0.52 as an
effect size in the model. We need to determine the odds ratios of the
fixed effects and then convert them into Cohen’s <em>d</em> values for
which we have associations between traditional denominations (small,
medium, and large) and effect size values.</p>
<pre class="r"><code># extract fixed effect estimates
estimatesfixedeffects &lt;- fixef(m1)
# convert estimates into odds ratios
exp(estimatesfixedeffects)</code></pre>
<pre><code>##                                  (Intercept) 
##                                        1.682 
##                               GroupL2English 
##                                        1.682 
##                SentenceTypeSentenceAdverbial 
##                                        1.682 
##                                  WordOrderV3 
##                                        1.682 
## GroupL2English:SentenceTypeSentenceAdverbial 
##                                        1.682</code></pre>
<p>We will now check the effect size which can be interpreted according
to <span class="citation">Chen, Cohen, and Chen (<a
href="#ref-chen2010big" role="doc-biblioref">2010</a>; see also <a
href="#ref-cohen1988statistical" role="doc-biblioref">Cohen 1988</a>; <a
href="#ref-perugini2018practical" role="doc-biblioref">Perugini,
Gallucci, and Costantini 2018, 2</a>)</span>.</p>
<ul>
<li><p>small effect (Cohen’s d 0.2, OR = 1.68)</p></li>
<li><p>medium effect (Cohen’s d 0.5, OR = 3.47)</p></li>
<li><p>strong effect (Cohen’s d 0.8, OR = 6.71)</p></li>
</ul>
</div>
<div id="power-analysis-for-interactions"
class="section level3 unnumbered">
<h3 class="unnumbered">Power analysis for interactions</h3>
<p>Let us now check if the data set has enough power to detect a weak
effect for the interaction between <code>Group:SentenceType</code>.</p>
<pre class="r"><code>sim_gst &lt;- simr::powerSim(m1, 
                          nsim=20, 
                          # compare model with interaction to model without interaction
                          test = fcompare(y ~ WordOrder + Group + SentenceType))</code></pre>
<pre><code>## Simulating: |                                                                  |Simulating: |===                                                               |Simulating: |======                                                            |Simulating: |=========                                                         |Simulating: |=============                                                     |Simulating: |================                                                  |Simulating: |===================                                               |Simulating: |=======================                                           |Simulating: |==========================                                        |Simulating: |=============================                                     |Simulating: |=================================                                 |Simulating: |====================================                              |Simulating: |=======================================                           |Simulating: |==========================================                        |Simulating: |==============================================                    |Simulating: |=================================================                 |Simulating: |====================================================              |Simulating: |========================================================          |Simulating: |===========================================================       |Simulating: |==============================================================    |Simulating: |==================================================================|</code></pre>
<pre class="r"><code># inspect
sim_gst</code></pre>
<pre><code>## Power for model comparison, (95% confidence interval):
##       25.00% ( 8.66, 49.10)
## 
## Test: Likelihood ratio
##       Comparison to y ~ WordOrder + Group + SentenceType + [re]
## 
## Based on 20 simulations, (0 warnings, 0 errors)
## alpha = 0.05, nrow = 480
## 
## Time elapsed: 0 h 0 m 3 s</code></pre>
<p><strong>The data is not sufficient to detect a weak effect of
<code>Group:SentenceType</code> with 5 percent accuracy!</strong></p>
<hr />
<div class="warning"
style="padding:0.1em; background-color:#f2f2f2; color:#51247a">
<span>
<p style="margin-top:1em; text-align:center">
<b>NOTE</b><br>Oh no… What can we do?
</p>
<p style="margin-left:1em;">
</p>
<p></span></p>
</div>
<hr />
</div>
</div>
<div id="extending-data" class="section level2 unnumbered">
<h2 class="unnumbered">Extending Data</h2>
<p>We will now extend the data to see what sample size is needed to get
to the 80 percent accuracy threshold. We begin by increasing the number
of sentences from 10 to 30 to see if this would lead to a sufficient
sample size. After increasing the number of sentences, we will extend
the data to see how many participants we would need.</p>
<div id="adding-sentences" class="section level3 unnumbered">
<h3 class="unnumbered">Adding sentences</h3>
<pre class="r"><code>m1_as &lt;- simr::extend(m1,
                      along=&quot;Sentence&quot;, 
                      n=120)
# inspect model
m1_as</code></pre>
<pre><code>## Linear mixed model fit by REML [&#39;lmerMod&#39;]
## Formula: y ~ (1 | Sentence) + (1 | ID) + Group * SentenceType + WordOrder
##    Data: regdat
## REML criterion at convergence: 2100
## Random effects:
##  Groups   Name        Std.Dev.
##  Sentence (Intercept) 0.707   
##  ID       (Intercept) 0.316   
##  Residual             2.000   
## Number of obs: 480, groups:  Sentence, 24; ID, 20
## Fixed Effects:
##                                  (Intercept)  
##                                         0.52  
##                               GroupL2English  
##                                         0.52  
##                SentenceTypeSentenceAdverbial  
##                                         0.52  
##                                  WordOrderV3  
##                                         0.52  
## GroupL2English:SentenceTypeSentenceAdverbial  
##                                         0.52</code></pre>
<p>Check power when using 120 sentences</p>
<pre class="r"><code>sim_m1_as_gst &lt;- powerSim(m1_as, 
                   nsim=20, 
                   test = fcompare(y ~ WordOrder + Group + SentenceType))</code></pre>
<pre><code>## Simulating: |                                                                  |Simulating: |===                                                               |Simulating: |======                                                            |Simulating: |=========                                                         |Simulating: |=============                                                     |Simulating: |================                                                  |Simulating: |===================                                               |Simulating: |=======================                                           |Simulating: |==========================                                        |Simulating: |=============================                                     |Simulating: |=================================                                 |Simulating: |====================================                              |Simulating: |=======================================                           |Simulating: |==========================================                        |Simulating: |==============================================                    |Simulating: |=================================================                 |Simulating: |====================================================              |Simulating: |========================================================          |Simulating: |===========================================================       |Simulating: |==============================================================    |Simulating: |==================================================================|</code></pre>
<pre class="r"><code># inspect
sim_m1_as_gst</code></pre>
<pre><code>## Power for model comparison, (95% confidence interval):
##       90.00% (68.30, 98.77)
## 
## Test: Likelihood ratio
##       Comparison to y ~ WordOrder + Group + SentenceType + [re]
## 
## Based on 20 simulations, (0 warnings, 0 errors)
## alpha = 0.05, nrow = 2400
## 
## Time elapsed: 0 h 0 m 4 s</code></pre>
<p><strong>The data with 120 sentences is sufficient and would detect a
weak effect of <code>Group:SentenceType</code> with 18 percent
accuracy!</strong></p>
<p>Let us now plot a power curve to see where we cross the 80 percent
threshold.</p>
<pre class="r"><code>pcurve_m1_as_gst &lt;- simr::powerCurve(m1_as, 
                               test=fcompare(y ~ WordOrder + Group + SentenceType), 
                               along=&quot;Sentence&quot;,
                               nsim = 20, 
                               breaks=seq(20, 120, 20))
# show plot
plot(pcurve_m1_as_gst)</code></pre>
<p><img src="pwr_files/figure-html/ext04-1.png" width="672" /></p>
<p>Using more items (or in this case sentences) is rather easy but it
can make experiments longer which may lead to participants becoming
tired or annoyed. An alternative would be to use more participants. Let
us thus check how we can determine how many subjects we would need to
reach a power of at least 80 percent.</p>
</div>
<div id="checking-participants" class="section level3 unnumbered">
<h3 class="unnumbered">Checking participants</h3>
<p>What about increasing the number of participants?</p>
<p>We increase the number of participants to 120.</p>
<pre class="r"><code>m1_ap &lt;- simr::extend(m1,
                      along=&quot;ID&quot;, 
                      n=120)
# inspect model
m1_ap</code></pre>
<pre><code>## Linear mixed model fit by REML [&#39;lmerMod&#39;]
## Formula: y ~ (1 | Sentence) + (1 | ID) + Group * SentenceType + WordOrder
##    Data: regdat
## REML criterion at convergence: 2100
## Random effects:
##  Groups   Name        Std.Dev.
##  Sentence (Intercept) 0.707   
##  ID       (Intercept) 0.316   
##  Residual             2.000   
## Number of obs: 480, groups:  Sentence, 24; ID, 20
## Fixed Effects:
##                                  (Intercept)  
##                                         0.52  
##                               GroupL2English  
##                                         0.52  
##                SentenceTypeSentenceAdverbial  
##                                         0.52  
##                                  WordOrderV3  
##                                         0.52  
## GroupL2English:SentenceTypeSentenceAdverbial  
##                                         0.52</code></pre>
<p>Check power when using 120 participants</p>
<pre class="r"><code>sim_m1_ap_gst &lt;- powerSim(m1_ap, 
                   nsim=20, 
                   test = fcompare(y ~ WordOrder + Group + SentenceType))</code></pre>
<pre><code>## Simulating: |                                                                  |Simulating: |===                                                               |Simulating: |======                                                            |Simulating: |=========                                                         |Simulating: |=============                                                     |Simulating: |================                                                  |Simulating: |===================                                               |Simulating: |=======================                                           |Simulating: |==========================                                        |Simulating: |=============================                                     |Simulating: |=================================                                 |Simulating: |====================================                              |Simulating: |=======================================                           |Simulating: |==========================================                        |Simulating: |==============================================                    |Simulating: |=================================================                 |Simulating: |====================================================              |Simulating: |========================================================          |Simulating: |===========================================================       |Simulating: |==============================================================    |Simulating: |==================================================================|</code></pre>
<pre class="r"><code># inspect
sim_m1_ap_gst</code></pre>
<pre><code>## Power for model comparison, (95% confidence interval):
##       80.00% (56.34, 94.27)
## 
## Test: Likelihood ratio
##       Comparison to y ~ WordOrder + Group + SentenceType + [re]
## 
## Based on 20 simulations, (0 warnings, 0 errors)
## alpha = 0.05, nrow = 2880
## 
## Time elapsed: 0 h 0 m 5 s</code></pre>
<p><strong>The data with 120 participants is sufficient and would detect
a weak effect of <code>Group * SentenceType</code> with 16 percent
accuracy</strong></p>
<pre class="r"><code>pcurve_m1_ap_gst &lt;- simr::powerCurve(m1_ap, 
                               test=fcompare(y ~ Group + SentenceType + WordOrder),
                               along = &quot;ID&quot;, 
                               nsim=20)</code></pre>
<pre><code>## Calculating power at 10 sample sizes along ID</code></pre>
<pre><code>## boundary (singular) fit: see help(&#39;isSingular&#39;)
## boundary (singular) fit: see help(&#39;isSingular&#39;)
## boundary (singular) fit: see help(&#39;isSingular&#39;)
## boundary (singular) fit: see help(&#39;isSingular&#39;)
## boundary (singular) fit: see help(&#39;isSingular&#39;)
## boundary (singular) fit: see help(&#39;isSingular&#39;)
## boundary (singular) fit: see help(&#39;isSingular&#39;)
## boundary (singular) fit: see help(&#39;isSingular&#39;)
## boundary (singular) fit: see help(&#39;isSingular&#39;)
## boundary (singular) fit: see help(&#39;isSingular&#39;)
## boundary (singular) fit: see help(&#39;isSingular&#39;)
## boundary (singular) fit: see help(&#39;isSingular&#39;)
## boundary (singular) fit: see help(&#39;isSingular&#39;)
## boundary (singular) fit: see help(&#39;isSingular&#39;)
## boundary (singular) fit: see help(&#39;isSingular&#39;)
## boundary (singular) fit: see help(&#39;isSingular&#39;)
## boundary (singular) fit: see help(&#39;isSingular&#39;)
## boundary (singular) fit: see help(&#39;isSingular&#39;)
## boundary (singular) fit: see help(&#39;isSingular&#39;)
## boundary (singular) fit: see help(&#39;isSingular&#39;)
## boundary (singular) fit: see help(&#39;isSingular&#39;)
## boundary (singular) fit: see help(&#39;isSingular&#39;)
## boundary (singular) fit: see help(&#39;isSingular&#39;)
## boundary (singular) fit: see help(&#39;isSingular&#39;)</code></pre>
<pre class="r"><code># show plot
plot(pcurve_m1_ap_gst)</code></pre>
<p><img src="pwr_files/figure-html/ext17-1.png" width="672" /></p>
</div>
</div>
<div id="generating-data-and-a-glmer" class="section level2 unnumbered">
<h2 class="unnumbered">Generating data and a glmer</h2>
<p>In order to perform a power analysis, we will start by loading the
tidyverse package to process the data and by generating a data that we
will use to determine the power of a regression model.</p>
<p>This simulated data set has</p>
<ul>
<li>200 data points</li>
<li>2 Conditions (Control, Test)</li>
<li>10 Subjects</li>
<li>10 Items</li>
</ul>
<pre class="r"><code># generate data
simdat &lt;- data.frame(
  sub &lt;- rep(paste0(&quot;Sub&quot;, 1:10), each = 20),
  cond &lt;- rep(c(
    rep(&quot;Control&quot;, 10),
    rep(&quot;Test&quot;, 10))
    , 10),
  itm &lt;- as.character(rep(1:10, 20))
) %&gt;%
  dplyr::rename(Subject = 1,
                Condition = 2,
                Item = 3) %&gt;%
  dplyr::mutate_if(is.character, factor)
# inspect
head(simdat, 15)</code></pre>
<pre><code>##    Subject Condition Item
## 1     Sub1   Control    1
## 2     Sub1   Control    2
## 3     Sub1   Control    3
## 4     Sub1   Control    4
## 5     Sub1   Control    5
## 6     Sub1   Control    6
## 7     Sub1   Control    7
## 8     Sub1   Control    8
## 9     Sub1   Control    9
## 10    Sub1   Control   10
## 11    Sub1      Test    1
## 12    Sub1      Test    2
## 13    Sub1      Test    3
## 14    Sub1      Test    4
## 15    Sub1      Test    5</code></pre>
<hr />
<div class="warning"
style="padding:0.1em; background-color:#51247a; color:#f2f2f2">
<span>
<p style="margin-top:1em; text-align:center">
<b>EXERCISE TIME!</b>
</p>
<p style="margin-left:1em;">
</p>
<p></span></p>
</div>
<div class="question">
<p>`</p>
<ol style="list-style-type: decimal">
<li>Can you create a data set with 5 Subjects, 5 Items (each) for 4
Conditions? <br></li>
</ol>
<details>
<summary>
Answer
</summary>
<pre><code>  ##    Subjects Items  Condition
  ## 1  Subject1 Item1 Condition1
  ## 2  Subject1 Item2 Condition1
  ## 3  Subject1 Item3 Condition1
  ## 4  Subject1 Item4 Condition1
  ## 5  Subject1 Item5 Condition1
  ## 6  Subject1 Item1 Condition2
  ## 7  Subject1 Item2 Condition2
  ## 8  Subject1 Item3 Condition2
  ## 9  Subject1 Item4 Condition2
  ## 10 Subject1 Item5 Condition2
  ## 11 Subject1 Item1 Condition3
  ## 12 Subject1 Item2 Condition3
  ## 13 Subject1 Item3 Condition3
  ## 14 Subject1 Item4 Condition3
  ## 15 Subject1 Item5 Condition3
  ## 16 Subject1 Item1 Condition4
  ## 17 Subject1 Item2 Condition4
  ## 18 Subject1 Item3 Condition4
  ## 19 Subject1 Item4 Condition4
  ## 20 Subject1 Item5 Condition4</code></pre>
</details>
</div>
<p>`</p>
<hr />
<div id="generating-the-model-1" class="section level3 unnumbered">
<h3 class="unnumbered">Generating the model</h3>
<p>As before with the lmer, we specify the model parameters - but when
generating glmers, we only need to specify the effects for the fixed
effects and the intercept and define the variability in the random
effects (we do not need to specify the residuals).</p>
<pre class="r"><code># Intercept + slopes for fixed effects 
# (Group, SentenceType, WordOrder, and an interaction between Group * SentenceType)
fixed &lt;- c(.52, .52)
# Random intercepts for Sentence and ID
rand &lt;- list(0.5, 0.1)</code></pre>
<p>We now generate the model and fit it to the data.</p>
<pre class="r"><code>m2 &lt;- simr::makeGlmer(y ~ (1|Subject) + (1|Item) + Condition, 
                      family = &quot;binomial&quot;, 
                      fixef=fixed, 
                      VarCorr=rand, 
                      data=simdat)
# inspect
sjPlot::tab_model(m2)</code></pre>
<table style="border-collapse:collapse; border:none;">
<tr>
<th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">
 
</th>
<th colspan="3" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">
y
</th>
</tr>
<tr>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">
Predictors
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
Odds Ratios
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
CI
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
p
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
(Intercept)
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
1.68
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.89 – 3.17
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.108
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
Condition [Test]
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
1.68
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.94 – 3.02
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.081
</td>
</tr>
<tr>
<td colspan="4" style="font-weight:bold; text-align:left; padding-top:.8em;">
Random Effects
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
σ<sup>2</sup>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">
3.29
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
τ<sub>00</sub> <sub>Subject</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">
0.50
</td>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
τ<sub>00</sub> <sub>Item</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">
0.10
</td>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
ICC
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">
0.15
</td>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
N <sub>Subject</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">
10
</td>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
N <sub>Item</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">
10
</td>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;">
Observations
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="3">
200
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
Marginal R<sup>2</sup> / Conditional R<sup>2</sup>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">
0.017 / 0.169
</td>
</tr>
</table>
<p>Next, we extract power. In this case, we use <code>fixed</code> in
the <code>test</code> argument which allows us to test a specific
predictor.</p>
<pre class="r"><code># set seed for replicability
set.seed(12345)
# perform power analysis for present model
rsim_m2_c &lt;- powerSim(m2, fixed(&quot;ConditionTest&quot;, &quot;z&quot;), 
                      nsim=20)</code></pre>
<pre><code>## Simulating: |                                                                  |Simulating: |===                                                               |Simulating: |======                                                            |Simulating: |=========                                                         |Simulating: |=============                                                     |Simulating: |================                                                  |Simulating: |===================                                               |Simulating: |=======================                                           |Simulating: |==========================                                        |Simulating: |=============================                                     |Simulating: |=================================                                 |Simulating: |====================================                              |Simulating: |=======================================                           |Simulating: |==========================================                        |Simulating: |==============================================                    |Simulating: |=================================================                 |Simulating: |====================================================              |Simulating: |========================================================          |Simulating: |===========================================================       |Simulating: |==============================================================    |Simulating: |==================================================================|</code></pre>
<pre class="r"><code># inspect
rsim_m2_c</code></pre>
<pre><code>## Power for predictor &#39;ConditionTest&#39;, (95% confidence interval):
##       35.00% (15.39, 59.22)
## 
## Test: z-test
##       Effect size for ConditionTest is 0.52
## 
## Based on 20 simulations, (0 warnings, 0 errors)
## alpha = 0.05, nrow = 200
## 
## Time elapsed: 0 h 0 m 3 s</code></pre>
<p><strong>The data is sufficient and would detect a weak effect of
<code>ConditionTest</code> with only 7 percent accuracy</strong></p>
</div>
</div>
<div id="extending-the-data" class="section level2 unnumbered">
<h2 class="unnumbered">Extending the data</h2>
<p>Like before, we can now extend the data to see how many participants
or items we would need to reach the 80 percent confidence threshold.</p>
<div id="adding-items" class="section level3 unnumbered">
<h3 class="unnumbered">Adding Items</h3>
<p>We start of by increasing the number of items from 10 to 40. This
means that our <em>new</em> data/model has the following
characteristics.</p>
<ul>
<li><p>2 Conditions</p></li>
<li><p>10 Subjects</p></li>
<li><p>40 Items (from 10)</p></li>
</ul>
<p>Keep in mind though that when extending the data/model in this way,
each combination occurs only once!</p>
<pre class="r"><code>m2_ai &lt;- simr::extend(m2,
                      along=&quot;Item&quot;, 
                      n=40)</code></pre>
<p>Next, we plot the power curve.</p>
<pre class="r"><code>pcurve_m2_ai_c &lt;- powerCurve(m2_ai, 
                             fixed(&quot;ConditionTest&quot;, &quot;z&quot;), 
                             along = &quot;Item&quot;,
                             nsim = 20,
                             breaks=seq(10, 40, 5))</code></pre>
<pre><code>## Calculating power at 7 sample sizes along Item</code></pre>
<pre><code>## Simulating: |                                                                  |Simulating: |===                                                               |Simulating: |======                                                            |Simulating: |=========                                                         |Simulating: |=============                                                     |Simulating: |================                                                  |Simulating: |===================                                               |Simulating: |=======================                                           |Simulating: |==========================                                        |Simulating: |=============================                                     |Simulating: |=================================                                 |Simulating: |====================================                              |Simulating: |=======================================                           |Simulating: |==========================================                        |Simulating: |==============================================                    |Simulating: |=================================================                 |Simulating: |====================================================              |Simulating: |========================================================          |Simulating: |===========================================================       |Simulating: |==============================================================    |Simulating: |==================================================================|(1/7) (1/7) Simulating: |                                                            |(1/7) Simulating: |===                                                         |(1/7) Simulating: |======                                                      |(1/7) Simulating: |=========                                                   |(1/7) Simulating: |============                                                |</code></pre>
<pre><code>## boundary (singular) fit: see help(&#39;isSingular&#39;)</code></pre>
<pre><code>## (1/7) Simulating: |===============                                             |(1/7) Simulating: |==================                                          |</code></pre>
<pre><code>## boundary (singular) fit: see help(&#39;isSingular&#39;)</code></pre>
<pre><code>## (1/7) Simulating: |=====================                                       |(1/7) Simulating: |========================                                    |(1/7) Simulating: |===========================                                 |</code></pre>
<pre><code>## boundary (singular) fit: see help(&#39;isSingular&#39;)</code></pre>
<pre><code>## (1/7) Simulating: |==============================                              |</code></pre>
<pre><code>## boundary (singular) fit: see help(&#39;isSingular&#39;)</code></pre>
<pre><code>## (1/7) Simulating: |=================================                           |(1/7) Simulating: |====================================                        |(1/7) Simulating: |=======================================                     |</code></pre>
<pre><code>## boundary (singular) fit: see help(&#39;isSingular&#39;)</code></pre>
<pre><code>## (1/7) Simulating: |==========================================                  |(1/7) Simulating: |=============================================               |</code></pre>
<pre><code>## boundary (singular) fit: see help(&#39;isSingular&#39;)</code></pre>
<pre><code>## (1/7) Simulating: |================================================            |</code></pre>
<pre><code>## boundary (singular) fit: see help(&#39;isSingular&#39;)</code></pre>
<pre><code>## (1/7) Simulating: |===================================================         |(1/7) Simulating: |======================================================      |</code></pre>
<pre><code>## boundary (singular) fit: see help(&#39;isSingular&#39;)</code></pre>
<pre><code>## (1/7) Simulating: |=========================================================   |</code></pre>
<pre><code>## boundary (singular) fit: see help(&#39;isSingular&#39;)</code></pre>
<pre><code>## (1/7) Simulating: |============================================================|(1/7) (2/7) (2/7) Simulating: |                                                            |(2/7) Simulating: |===                                                         |(2/7) Simulating: |======                                                      |(2/7) Simulating: |=========                                                   |(2/7) Simulating: |============                                                |</code></pre>
<pre><code>## boundary (singular) fit: see help(&#39;isSingular&#39;)</code></pre>
<pre><code>## (2/7) Simulating: |===============                                             |(2/7) Simulating: |==================                                          |</code></pre>
<pre><code>## boundary (singular) fit: see help(&#39;isSingular&#39;)</code></pre>
<pre><code>## (2/7) Simulating: |=====================                                       |(2/7) Simulating: |========================                                    |(2/7) Simulating: |===========================                                 |</code></pre>
<pre><code>## boundary (singular) fit: see help(&#39;isSingular&#39;)</code></pre>
<pre><code>## (2/7) Simulating: |==============================                              |</code></pre>
<pre><code>## boundary (singular) fit: see help(&#39;isSingular&#39;)</code></pre>
<pre><code>## (2/7) Simulating: |=================================                           |(2/7) Simulating: |====================================                        |</code></pre>
<pre><code>## boundary (singular) fit: see help(&#39;isSingular&#39;)</code></pre>
<pre><code>## (2/7) Simulating: |=======================================                     |</code></pre>
<pre><code>## boundary (singular) fit: see help(&#39;isSingular&#39;)</code></pre>
<pre><code>## (2/7) Simulating: |==========================================                  |(2/7) Simulating: |=============================================               |</code></pre>
<pre><code>## boundary (singular) fit: see help(&#39;isSingular&#39;)</code></pre>
<pre><code>## (2/7) Simulating: |================================================            |(2/7) Simulating: |===================================================         |(2/7) Simulating: |======================================================      |(2/7) Simulating: |=========================================================   |</code></pre>
<pre><code>## boundary (singular) fit: see help(&#39;isSingular&#39;)</code></pre>
<pre><code>## (2/7) Simulating: |============================================================|(2/7) (3/7) (3/7) Simulating: |                                                            |(3/7) Simulating: |===                                                         |(3/7) Simulating: |======                                                      |(3/7) Simulating: |=========                                                   |(3/7) Simulating: |============                                                |</code></pre>
<pre><code>## boundary (singular) fit: see help(&#39;isSingular&#39;)</code></pre>
<pre><code>## (3/7) Simulating: |===============                                             |</code></pre>
<pre><code>## boundary (singular) fit: see help(&#39;isSingular&#39;)</code></pre>
<pre><code>## (3/7) Simulating: |==================                                          |(3/7) Simulating: |=====================                                       |(3/7) Simulating: |========================                                    |(3/7) Simulating: |===========================                                 |(3/7) Simulating: |==============================                              |(3/7) Simulating: |=================================                           |(3/7) Simulating: |====================================                        |(3/7) Simulating: |=======================================                     |</code></pre>
<pre><code>## boundary (singular) fit: see help(&#39;isSingular&#39;)</code></pre>
<pre><code>## (3/7) Simulating: |==========================================                  |(3/7) Simulating: |=============================================               |(3/7) Simulating: |================================================            |(3/7) Simulating: |===================================================         |(3/7) Simulating: |======================================================      |(3/7) Simulating: |=========================================================   |(3/7) Simulating: |============================================================|(3/7) (4/7) (4/7) Simulating: |                                                            |(4/7) Simulating: |===                                                         |(4/7) Simulating: |======                                                      |(4/7) Simulating: |=========                                                   |(4/7) Simulating: |============                                                |</code></pre>
<pre><code>## boundary (singular) fit: see help(&#39;isSingular&#39;)</code></pre>
<pre><code>## (4/7) Simulating: |===============                                             |</code></pre>
<pre><code>## boundary (singular) fit: see help(&#39;isSingular&#39;)</code></pre>
<pre><code>## (4/7) Simulating: |==================                                          |(4/7) Simulating: |=====================                                       |(4/7) Simulating: |========================                                    |(4/7) Simulating: |===========================                                 |(4/7) Simulating: |==============================                              |(4/7) Simulating: |=================================                           |(4/7) Simulating: |====================================                        |(4/7) Simulating: |=======================================                     |(4/7) Simulating: |==========================================                  |(4/7) Simulating: |=============================================               |(4/7) Simulating: |================================================            |(4/7) Simulating: |===================================================         |(4/7) Simulating: |======================================================      |(4/7) Simulating: |=========================================================   |(4/7) Simulating: |============================================================|(4/7) (5/7) (5/7) Simulating: |                                                            |(5/7) Simulating: |===                                                         |(5/7) Simulating: |======                                                      |(5/7) Simulating: |=========                                                   |(5/7) Simulating: |============                                                |</code></pre>
<pre><code>## boundary (singular) fit: see help(&#39;isSingular&#39;)</code></pre>
<pre><code>## (5/7) Simulating: |===============                                             |</code></pre>
<pre><code>## boundary (singular) fit: see help(&#39;isSingular&#39;)</code></pre>
<pre><code>## (5/7) Simulating: |==================                                          |(5/7) Simulating: |=====================                                       |(5/7) Simulating: |========================                                    |(5/7) Simulating: |===========================                                 |(5/7) Simulating: |==============================                              |(5/7) Simulating: |=================================                           |(5/7) Simulating: |====================================                        |(5/7) Simulating: |=======================================                     |(5/7) Simulating: |==========================================                  |(5/7) Simulating: |=============================================               |(5/7) Simulating: |================================================            |(5/7) Simulating: |===================================================         |(5/7) Simulating: |======================================================      |(5/7) Simulating: |=========================================================   |(5/7) Simulating: |============================================================|(5/7) (6/7) (6/7) Simulating: |                                                            |(6/7) Simulating: |===                                                         |(6/7) Simulating: |======                                                      |(6/7) Simulating: |=========                                                   |(6/7) Simulating: |============                                                |</code></pre>
<pre><code>## boundary (singular) fit: see help(&#39;isSingular&#39;)</code></pre>
<pre><code>## (6/7) Simulating: |===============                                             |(6/7) Simulating: |==================                                          |(6/7) Simulating: |=====================                                       |(6/7) Simulating: |========================                                    |(6/7) Simulating: |===========================                                 |(6/7) Simulating: |==============================                              |(6/7) Simulating: |=================================                           |(6/7) Simulating: |====================================                        |(6/7) Simulating: |=======================================                     |(6/7) Simulating: |==========================================                  |(6/7) Simulating: |=============================================               |(6/7) Simulating: |================================================            |(6/7) Simulating: |===================================================         |(6/7) Simulating: |======================================================      |(6/7) Simulating: |=========================================================   |(6/7) Simulating: |============================================================|(6/7) (7/7) (7/7) Simulating: |                                                            |(7/7) Simulating: |===                                                         |(7/7) Simulating: |======                                                      |(7/7) Simulating: |=========                                                   |(7/7) Simulating: |============                                                |(7/7) Simulating: |===============                                             |</code></pre>
<pre><code>## boundary (singular) fit: see help(&#39;isSingular&#39;)</code></pre>
<pre><code>## (7/7) Simulating: |==================                                          |(7/7) Simulating: |=====================                                       |(7/7) Simulating: |========================                                    |(7/7) Simulating: |===========================                                 |(7/7) Simulating: |==============================                              |(7/7) Simulating: |=================================                           |(7/7) Simulating: |====================================                        |(7/7) Simulating: |=======================================                     |(7/7) Simulating: |==========================================                  |(7/7) Simulating: |=============================================               |(7/7) Simulating: |================================================            |(7/7) Simulating: |===================================================         |(7/7) Simulating: |======================================================      |(7/7) Simulating: |=========================================================   |(7/7) Simulating: |============================================================|(7/7) </code></pre>
<pre class="r"><code># show plot
plot(pcurve_m2_ai_c)</code></pre>
<p><img src="pwr_files/figure-html/glmer08-1.png" width="672" /></p>
<p>The power curve shows that we breach the 80 percent threshold with
about 35 items.</p>
</div>
<div id="adding-subjects" class="section level3 unnumbered">
<h3 class="unnumbered">Adding subjects</h3>
<p>An alternative to adding items is, of course, to use more subjects or
participants. We thus continue by increasing the number of participants
from 10 to 40. This means that our <em>new</em> data/model has the
following characteristics.</p>
<ul>
<li><p>2 Conditions</p></li>
<li><p>10 Items</p></li>
<li><p>40 Subjects (from 10)</p></li>
</ul>
<p>Again, keep in mind though that when extending the data/model in this
way, each combination occurs only once!</p>
<pre class="r"><code>m2_as &lt;- simr::extend(m2,
                      along=&quot;Subject&quot;, 
                      n=40)
# inspect model
sjPlot::tab_model(m2_as)</code></pre>
<table style="border-collapse:collapse; border:none;">
<tr>
<th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">
 
</th>
<th colspan="3" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">
y
</th>
</tr>
<tr>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">
Predictors
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
Odds Ratios
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
CI
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
p
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
(Intercept)
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
1.68
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.89 – 3.17
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.108
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
Condition [Test]
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
1.68
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.94 – 3.02
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.081
</td>
</tr>
<tr>
<td colspan="4" style="font-weight:bold; text-align:left; padding-top:.8em;">
Random Effects
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
σ<sup>2</sup>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">
3.29
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
τ<sub>00</sub> <sub>Subject</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">
0.50
</td>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
τ<sub>00</sub> <sub>Item</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">
0.10
</td>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
ICC
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">
0.15
</td>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
N <sub>Subject</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">
10
</td>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
N <sub>Item</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">
10
</td>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;">
Observations
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="3">
200
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
Marginal R<sup>2</sup> / Conditional R<sup>2</sup>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">
0.017 / 0.169
</td>
</tr>
</table>
<p>As before, we plot power curve.</p>
<pre class="r"><code>pcurve_m2_as_c &lt;- powerCurve(m2_as, 
                             fixed(&quot;ConditionTest&quot;, &quot;z&quot;), 
                             along = &quot;Subject&quot;,
                             nsim = 20,
                             breaks=seq(10, 40, 5))</code></pre>
<pre><code>## Calculating power at 7 sample sizes along Subject</code></pre>
<pre><code>## Simulating: |                                                                  |Simulating: |===                                                               |Simulating: |======                                                            |Simulating: |=========                                                         |Simulating: |=============                                                     |Simulating: |================                                                  |Simulating: |===================                                               |Simulating: |=======================                                           |Simulating: |==========================                                        |Simulating: |=============================                                     |Simulating: |=================================                                 |Simulating: |====================================                              |Simulating: |=======================================                           |Simulating: |==========================================                        |Simulating: |==============================================                    |Simulating: |=================================================                 |Simulating: |====================================================              |Simulating: |========================================================          |Simulating: |===========================================================       |Simulating: |==============================================================    |Simulating: |==================================================================|(1/7) (1/7) Simulating: |                                                            |</code></pre>
<pre><code>## boundary (singular) fit: see help(&#39;isSingular&#39;)</code></pre>
<pre><code>## (1/7) Simulating: |===                                                         |(1/7) Simulating: |======                                                      |</code></pre>
<pre><code>## boundary (singular) fit: see help(&#39;isSingular&#39;)</code></pre>
<pre><code>## (1/7) Simulating: |=========                                                   |(1/7) Simulating: |============                                                |</code></pre>
<pre><code>## boundary (singular) fit: see help(&#39;isSingular&#39;)</code></pre>
<pre><code>## (1/7) Simulating: |===============                                             |(1/7) Simulating: |==================                                          |</code></pre>
<pre><code>## boundary (singular) fit: see help(&#39;isSingular&#39;)</code></pre>
<pre><code>## (1/7) Simulating: |=====================                                       |</code></pre>
<pre><code>## boundary (singular) fit: see help(&#39;isSingular&#39;)</code></pre>
<pre><code>## (1/7) Simulating: |========================                                    |</code></pre>
<pre><code>## boundary (singular) fit: see help(&#39;isSingular&#39;)</code></pre>
<pre><code>## (1/7) Simulating: |===========================                                 |(1/7) Simulating: |==============================                              |(1/7) Simulating: |=================================                           |</code></pre>
<pre><code>## boundary (singular) fit: see help(&#39;isSingular&#39;)</code></pre>
<pre><code>## (1/7) Simulating: |====================================                        |</code></pre>
<pre><code>## boundary (singular) fit: see help(&#39;isSingular&#39;)</code></pre>
<pre><code>## (1/7) Simulating: |=======================================                     |(1/7) Simulating: |==========================================                  |(1/7) Simulating: |=============================================               |</code></pre>
<pre><code>## boundary (singular) fit: see help(&#39;isSingular&#39;)</code></pre>
<pre><code>## (1/7) Simulating: |================================================            |(1/7) Simulating: |===================================================         |(1/7) Simulating: |======================================================      |</code></pre>
<pre><code>## boundary (singular) fit: see help(&#39;isSingular&#39;)</code></pre>
<pre><code>## (1/7) Simulating: |=========================================================   |</code></pre>
<pre><code>## boundary (singular) fit: see help(&#39;isSingular&#39;)</code></pre>
<pre><code>## (1/7) Simulating: |============================================================|(1/7) (2/7) (2/7) Simulating: |                                                            |</code></pre>
<pre><code>## boundary (singular) fit: see help(&#39;isSingular&#39;)</code></pre>
<pre><code>## (2/7) Simulating: |===                                                         |(2/7) Simulating: |======                                                      |</code></pre>
<pre><code>## boundary (singular) fit: see help(&#39;isSingular&#39;)</code></pre>
<pre><code>## (2/7) Simulating: |=========                                                   |(2/7) Simulating: |============                                                |</code></pre>
<pre><code>## boundary (singular) fit: see help(&#39;isSingular&#39;)</code></pre>
<pre><code>## (2/7) Simulating: |===============                                             |(2/7) Simulating: |==================                                          |</code></pre>
<pre><code>## boundary (singular) fit: see help(&#39;isSingular&#39;)</code></pre>
<pre><code>## (2/7) Simulating: |=====================                                       |(2/7) Simulating: |========================                                    |(2/7) Simulating: |===========================                                 |(2/7) Simulating: |==============================                              |(2/7) Simulating: |=================================                           |</code></pre>
<pre><code>## boundary (singular) fit: see help(&#39;isSingular&#39;)</code></pre>
<pre><code>## (2/7) Simulating: |====================================                        |</code></pre>
<pre><code>## boundary (singular) fit: see help(&#39;isSingular&#39;)</code></pre>
<pre><code>## (2/7) Simulating: |=======================================                     |(2/7) Simulating: |==========================================                  |(2/7) Simulating: |=============================================               |</code></pre>
<pre><code>## boundary (singular) fit: see help(&#39;isSingular&#39;)</code></pre>
<pre><code>## (2/7) Simulating: |================================================            |(2/7) Simulating: |===================================================         |(2/7) Simulating: |======================================================      |</code></pre>
<pre><code>## boundary (singular) fit: see help(&#39;isSingular&#39;)</code></pre>
<pre><code>## (2/7) Simulating: |=========================================================   |(2/7) Simulating: |============================================================|(2/7) (3/7) (3/7) Simulating: |                                                            |</code></pre>
<pre><code>## boundary (singular) fit: see help(&#39;isSingular&#39;)</code></pre>
<pre><code>## (3/7) Simulating: |===                                                         |(3/7) Simulating: |======                                                      |(3/7) Simulating: |=========                                                   |(3/7) Simulating: |============                                                |(3/7) Simulating: |===============                                             |(3/7) Simulating: |==================                                          |(3/7) Simulating: |=====================                                       |(3/7) Simulating: |========================                                    |(3/7) Simulating: |===========================                                 |(3/7) Simulating: |==============================                              |(3/7) Simulating: |=================================                           |(3/7) Simulating: |====================================                        |(3/7) Simulating: |=======================================                     |(3/7) Simulating: |==========================================                  |(3/7) Simulating: |=============================================               |</code></pre>
<pre><code>## boundary (singular) fit: see help(&#39;isSingular&#39;)</code></pre>
<pre><code>## (3/7) Simulating: |================================================            |(3/7) Simulating: |===================================================         |(3/7) Simulating: |======================================================      |(3/7) Simulating: |=========================================================   |</code></pre>
<pre><code>## boundary (singular) fit: see help(&#39;isSingular&#39;)</code></pre>
<pre><code>## (3/7) Simulating: |============================================================|(3/7) (4/7) (4/7) Simulating: |                                                            |(4/7) Simulating: |===                                                         |(4/7) Simulating: |======                                                      |(4/7) Simulating: |=========                                                   |(4/7) Simulating: |============                                                |(4/7) Simulating: |===============                                             |(4/7) Simulating: |==================                                          |(4/7) Simulating: |=====================                                       |(4/7) Simulating: |========================                                    |(4/7) Simulating: |===========================                                 |(4/7) Simulating: |==============================                              |(4/7) Simulating: |=================================                           |(4/7) Simulating: |====================================                        |(4/7) Simulating: |=======================================                     |(4/7) Simulating: |==========================================                  |(4/7) Simulating: |=============================================               |(4/7) Simulating: |================================================            |(4/7) Simulating: |===================================================         |(4/7) Simulating: |======================================================      |(4/7) Simulating: |=========================================================   |(4/7) Simulating: |============================================================|(4/7) (5/7) (5/7) Simulating: |                                                            |</code></pre>
<pre><code>## boundary (singular) fit: see help(&#39;isSingular&#39;)</code></pre>
<pre><code>## (5/7) Simulating: |===                                                         |(5/7) Simulating: |======                                                      |</code></pre>
<pre><code>## boundary (singular) fit: see help(&#39;isSingular&#39;)</code></pre>
<pre><code>## (5/7) Simulating: |=========                                                   |(5/7) Simulating: |============                                                |(5/7) Simulating: |===============                                             |(5/7) Simulating: |==================                                          |(5/7) Simulating: |=====================                                       |(5/7) Simulating: |========================                                    |(5/7) Simulating: |===========================                                 |(5/7) Simulating: |==============================                              |(5/7) Simulating: |=================================                           |(5/7) Simulating: |====================================                        |(5/7) Simulating: |=======================================                     |(5/7) Simulating: |==========================================                  |(5/7) Simulating: |=============================================               |(5/7) Simulating: |================================================            |(5/7) Simulating: |===================================================         |(5/7) Simulating: |======================================================      |(5/7) Simulating: |=========================================================   |(5/7) Simulating: |============================================================|(5/7) (6/7) (6/7) Simulating: |                                                            |(6/7) Simulating: |===                                                         |(6/7) Simulating: |======                                                      |(6/7) Simulating: |=========                                                   |(6/7) Simulating: |============                                                |(6/7) Simulating: |===============                                             |(6/7) Simulating: |==================                                          |(6/7) Simulating: |=====================                                       |(6/7) Simulating: |========================                                    |(6/7) Simulating: |===========================                                 |(6/7) Simulating: |==============================                              |(6/7) Simulating: |=================================                           |(6/7) Simulating: |====================================                        |(6/7) Simulating: |=======================================                     |(6/7) Simulating: |==========================================                  |(6/7) Simulating: |=============================================               |(6/7) Simulating: |================================================            |(6/7) Simulating: |===================================================         |(6/7) Simulating: |======================================================      |(6/7) Simulating: |=========================================================   |(6/7) Simulating: |============================================================|(6/7) (7/7) (7/7) Simulating: |                                                            |(7/7) Simulating: |===                                                         |(7/7) Simulating: |======                                                      |(7/7) Simulating: |=========                                                   |(7/7) Simulating: |============                                                |(7/7) Simulating: |===============                                             |(7/7) Simulating: |==================                                          |(7/7) Simulating: |=====================                                       |(7/7) Simulating: |========================                                    |(7/7) Simulating: |===========================                                 |(7/7) Simulating: |==============================                              |(7/7) Simulating: |=================================                           |(7/7) Simulating: |====================================                        |(7/7) Simulating: |=======================================                     |(7/7) Simulating: |==========================================                  |(7/7) Simulating: |=============================================               |(7/7) Simulating: |================================================            |(7/7) Simulating: |===================================================         |(7/7) Simulating: |======================================================      |(7/7) Simulating: |=========================================================   |(7/7) Simulating: |============================================================|(7/7) </code></pre>
<pre class="r"><code># show plot
plot(pcurve_m2_as_c)</code></pre>
<p><img src="pwr_files/figure-html/glmer12-1.png" width="672" /></p>
<p>How often does each <em>combination</em> occur?</p>
<p><strong>Only once!</strong></p>
<p>So, what if we increase the number of combinations (this is
particularly important when using a *repeated measures** design)? Below,
we increase the number of <em>configuration</em> from 1 to 10 so that
each item is shown 10 times to the same participant. This means that our
<em>new</em> data/model has the following characteristics.</p>
<ul>
<li><p>2 Conditions</p></li>
<li><p>10 Items</p></li>
<li><p>10 Subjects</p></li>
</ul>
<p>Now each combination of item and subject occurs 10 times!</p>
<pre class="r"><code>m2_asi_c &lt;- extend(m2, 
                   within=&quot;Subject+Item&quot;, 
                   n=10)
# perform power calculation
pcurve_m2_asi_c &lt;- powerCurve(m2_asi_c, 
                              fixed(&quot;ConditionTest&quot;, &quot;z&quot;), 
                              within=&quot;Subject+Item&quot;,
                              nsim = 20,
                              breaks=seq(2, 10, 2))</code></pre>
<pre><code>## Calculating power at 5 sample sizes within Subject+Item</code></pre>
<pre><code>## Simulating: |                                                                  |Simulating: |===                                                               |Simulating: |======                                                            |Simulating: |=========                                                         |Simulating: |=============                                                     |Simulating: |================                                                  |Simulating: |===================                                               |Simulating: |=======================                                           |Simulating: |==========================                                        |Simulating: |=============================                                     |Simulating: |=================================                                 |Simulating: |====================================                              |Simulating: |=======================================                           |Simulating: |==========================================                        |Simulating: |==============================================                    |Simulating: |=================================================                 |Simulating: |====================================================              |Simulating: |========================================================          |Simulating: |===========================================================       |Simulating: |==============================================================    |Simulating: |==================================================================|(1/5) (1/5) Simulating: |                                                            |(1/5) Simulating: |===                                                         |(1/5) Simulating: |======                                                      |(1/5) Simulating: |=========                                                   |(1/5) Simulating: |============                                                |(1/5) Simulating: |===============                                             |(1/5) Simulating: |==================                                          |(1/5) Simulating: |=====================                                       |(1/5) Simulating: |========================                                    |(1/5) Simulating: |===========================                                 |(1/5) Simulating: |==============================                              |(1/5) Simulating: |=================================                           |(1/5) Simulating: |====================================                        |(1/5) Simulating: |=======================================                     |(1/5) Simulating: |==========================================                  |</code></pre>
<pre><code>## boundary (singular) fit: see help(&#39;isSingular&#39;)</code></pre>
<pre><code>## (1/5) Simulating: |=============================================               |</code></pre>
<pre><code>## boundary (singular) fit: see help(&#39;isSingular&#39;)</code></pre>
<pre><code>## (1/5) Simulating: |================================================            |</code></pre>
<pre><code>## boundary (singular) fit: see help(&#39;isSingular&#39;)</code></pre>
<pre><code>## (1/5) Simulating: |===================================================         |</code></pre>
<pre><code>## boundary (singular) fit: see help(&#39;isSingular&#39;)</code></pre>
<pre><code>## (1/5) Simulating: |======================================================      |(1/5) Simulating: |=========================================================   |(1/5) Simulating: |============================================================|(1/5) (2/5) (2/5) Simulating: |                                                            |(2/5) Simulating: |===                                                         |(2/5) Simulating: |======                                                      |(2/5) Simulating: |=========                                                   |</code></pre>
<pre><code>## boundary (singular) fit: see help(&#39;isSingular&#39;)</code></pre>
<pre><code>## (2/5) Simulating: |============                                                |(2/5) Simulating: |===============                                             |(2/5) Simulating: |==================                                          |(2/5) Simulating: |=====================                                       |(2/5) Simulating: |========================                                    |(2/5) Simulating: |===========================                                 |(2/5) Simulating: |==============================                              |(2/5) Simulating: |=================================                           |</code></pre>
<pre><code>## boundary (singular) fit: see help(&#39;isSingular&#39;)</code></pre>
<pre><code>## (2/5) Simulating: |====================================                        |</code></pre>
<pre><code>## boundary (singular) fit: see help(&#39;isSingular&#39;)</code></pre>
<pre><code>## (2/5) Simulating: |=======================================                     |</code></pre>
<pre><code>## boundary (singular) fit: see help(&#39;isSingular&#39;)</code></pre>
<pre><code>## (2/5) Simulating: |==========================================                  |(2/5) Simulating: |=============================================               |(2/5) Simulating: |================================================            |(2/5) Simulating: |===================================================         |</code></pre>
<pre><code>## boundary (singular) fit: see help(&#39;isSingular&#39;)</code></pre>
<pre><code>## (2/5) Simulating: |======================================================      |(2/5) Simulating: |=========================================================   |(2/5) Simulating: |============================================================|(2/5) (3/5) (3/5) Simulating: |                                                            |(3/5) Simulating: |===                                                         |(3/5) Simulating: |======                                                      |(3/5) Simulating: |=========                                                   |(3/5) Simulating: |============                                                |(3/5) Simulating: |===============                                             |(3/5) Simulating: |==================                                          |(3/5) Simulating: |=====================                                       |(3/5) Simulating: |========================                                    |(3/5) Simulating: |===========================                                 |(3/5) Simulating: |==============================                              |(3/5) Simulating: |=================================                           |</code></pre>
<pre><code>## boundary (singular) fit: see help(&#39;isSingular&#39;)</code></pre>
<pre><code>## (3/5) Simulating: |====================================                        |(3/5) Simulating: |=======================================                     |(3/5) Simulating: |==========================================                  |(3/5) Simulating: |=============================================               |(3/5) Simulating: |================================================            |(3/5) Simulating: |===================================================         |</code></pre>
<pre><code>## boundary (singular) fit: see help(&#39;isSingular&#39;)</code></pre>
<pre><code>## (3/5) Simulating: |======================================================      |(3/5) Simulating: |=========================================================   |(3/5) Simulating: |============================================================|(3/5) (4/5) (4/5) Simulating: |                                                            |(4/5) Simulating: |===                                                         |(4/5) Simulating: |======                                                      |(4/5) Simulating: |=========                                                   |(4/5) Simulating: |============                                                |(4/5) Simulating: |===============                                             |(4/5) Simulating: |==================                                          |(4/5) Simulating: |=====================                                       |(4/5) Simulating: |========================                                    |(4/5) Simulating: |===========================                                 |(4/5) Simulating: |==============================                              |(4/5) Simulating: |=================================                           |</code></pre>
<pre><code>## boundary (singular) fit: see help(&#39;isSingular&#39;)</code></pre>
<pre><code>## (4/5) Simulating: |====================================                        |(4/5) Simulating: |=======================================                     |(4/5) Simulating: |==========================================                  |(4/5) Simulating: |=============================================               |(4/5) Simulating: |================================================            |(4/5) Simulating: |===================================================         |</code></pre>
<pre><code>## boundary (singular) fit: see help(&#39;isSingular&#39;)</code></pre>
<pre><code>## (4/5) Simulating: |======================================================      |(4/5) Simulating: |=========================================================   |(4/5) Simulating: |============================================================|(4/5) (5/5) (5/5) Simulating: |                                                            |(5/5) Simulating: |===                                                         |(5/5) Simulating: |======                                                      |(5/5) Simulating: |=========                                                   |(5/5) Simulating: |============                                                |(5/5) Simulating: |===============                                             |(5/5) Simulating: |==================                                          |(5/5) Simulating: |=====================                                       |(5/5) Simulating: |========================                                    |(5/5) Simulating: |===========================                                 |(5/5) Simulating: |==============================                              |(5/5) Simulating: |=================================                           |(5/5) Simulating: |====================================                        |(5/5) Simulating: |=======================================                     |(5/5) Simulating: |==========================================                  |(5/5) Simulating: |=============================================               |(5/5) Simulating: |================================================            |(5/5) Simulating: |===================================================         |(5/5) Simulating: |======================================================      |(5/5) Simulating: |=========================================================   |(5/5) Simulating: |============================================================|(5/5) </code></pre>
<pre class="r"><code># show plot
plot(pcurve_m2_asi_c)</code></pre>
<p><img src="pwr_files/figure-html/glmer14-1.png" width="672" /></p>
<p>If we did this, then even 5 subjects may be enough to reach the 80
percent threshold.</p>
</div>
<div id="adding-subjects-and-items" class="section level3 unnumbered">
<h3 class="unnumbered">Adding subjects and items</h3>
<p>We can also add subjects and items <em>simultaneously</em> to address
questions like <em>How many subjects would I need if I had 30
items?</em>. Hence, we increase both subjects and items from 10 to 30.
This means that our <em>new</em> data/model has the following
characteristics.</p>
<ul>
<li><p>2 Conditions</p></li>
<li><p>30 Items (from 10)</p></li>
<li><p>30 Subjects (from 10)</p></li>
</ul>
<p>In this case, we return to each combination only occurring once.</p>
<pre class="r"><code>m2_as &lt;- simr::extend(m2,
                      along=&quot;Subject&quot;, 
                      n=30)
m2_asi &lt;- simr::extend(m2_as,
                      along=&quot;Item&quot;, 
                      n=30)
# inspect model
sjPlot::tab_model(m2_asi)</code></pre>
<table style="border-collapse:collapse; border:none;">
<tr>
<th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">
 
</th>
<th colspan="3" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">
y
</th>
</tr>
<tr>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">
Predictors
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
Odds Ratios
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
CI
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
p
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
(Intercept)
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
1.68
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.89 – 3.17
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.108
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
Condition [Test]
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
1.68
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.94 – 3.02
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.081
</td>
</tr>
<tr>
<td colspan="4" style="font-weight:bold; text-align:left; padding-top:.8em;">
Random Effects
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
σ<sup>2</sup>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">
3.29
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
τ<sub>00</sub> <sub>Subject</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">
0.50
</td>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
τ<sub>00</sub> <sub>Item</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">
0.10
</td>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
ICC
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">
0.15
</td>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
N <sub>Subject</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">
10
</td>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
N <sub>Item</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">
10
</td>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;">
Observations
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="3">
200
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
Marginal R<sup>2</sup> / Conditional R<sup>2</sup>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">
0.017 / 0.169
</td>
</tr>
</table>
<p>We can now plot power curve to answer the question <em>How many
subjects do you need if you have 30 Items?</em>.</p>
<pre class="r"><code>pcurve_m2_asi_c &lt;- powerCurve(m2_asi, 
                             fixed(&quot;ConditionTest&quot;, &quot;z&quot;), 
                             along = &quot;Subject&quot;, 
                             breaks = seq(5, 30, 5), 
                             nsim = 20)</code></pre>
<pre><code>## Calculating power at 6 sample sizes along Subject</code></pre>
<pre><code>## Simulating: |                                                                  |Simulating: |===                                                               |Simulating: |======                                                            |Simulating: |=========                                                         |Simulating: |=============                                                     |Simulating: |================                                                  |Simulating: |===================                                               |Simulating: |=======================                                           |Simulating: |==========================                                        |Simulating: |=============================                                     |Simulating: |=================================                                 |Simulating: |====================================                              |Simulating: |=======================================                           |Simulating: |==========================================                        |Simulating: |==============================================                    |Simulating: |=================================================                 |Simulating: |====================================================              |Simulating: |========================================================          |Simulating: |===========================================================       |Simulating: |==============================================================    |Simulating: |==================================================================|(1/6) (1/6) Simulating: |                                                            |</code></pre>
<pre><code>## boundary (singular) fit: see help(&#39;isSingular&#39;)</code></pre>
<pre><code>## (1/6) Simulating: |===                                                         |(1/6) Simulating: |======                                                      |(1/6) Simulating: |=========                                                   |(1/6) Simulating: |============                                                |(1/6) Simulating: |===============                                             |(1/6) Simulating: |==================                                          |(1/6) Simulating: |=====================                                       |(1/6) Simulating: |========================                                    |(1/6) Simulating: |===========================                                 |(1/6) Simulating: |==============================                              |(1/6) Simulating: |=================================                           |(1/6) Simulating: |====================================                        |</code></pre>
<pre><code>## boundary (singular) fit: see help(&#39;isSingular&#39;)</code></pre>
<pre><code>## (1/6) Simulating: |=======================================                     |</code></pre>
<pre><code>## boundary (singular) fit: see help(&#39;isSingular&#39;)</code></pre>
<pre><code>## (1/6) Simulating: |==========================================                  |(1/6) Simulating: |=============================================               |(1/6) Simulating: |================================================            |</code></pre>
<pre><code>## boundary (singular) fit: see help(&#39;isSingular&#39;)</code></pre>
<pre><code>## (1/6) Simulating: |===================================================         |</code></pre>
<pre><code>## boundary (singular) fit: see help(&#39;isSingular&#39;)</code></pre>
<pre><code>## (1/6) Simulating: |======================================================      |</code></pre>
<pre><code>## boundary (singular) fit: see help(&#39;isSingular&#39;)</code></pre>
<pre><code>## (1/6) Simulating: |=========================================================   |(1/6) Simulating: |============================================================|(1/6) (2/6) (2/6) Simulating: |                                                            |(2/6) Simulating: |===                                                         |(2/6) Simulating: |======                                                      |(2/6) Simulating: |=========                                                   |</code></pre>
<pre><code>## boundary (singular) fit: see help(&#39;isSingular&#39;)</code></pre>
<pre><code>## (2/6) Simulating: |============                                                |(2/6) Simulating: |===============                                             |(2/6) Simulating: |==================                                          |(2/6) Simulating: |=====================                                       |(2/6) Simulating: |========================                                    |(2/6) Simulating: |===========================                                 |(2/6) Simulating: |==============================                              |(2/6) Simulating: |=================================                           |(2/6) Simulating: |====================================                        |(2/6) Simulating: |=======================================                     |</code></pre>
<pre><code>## boundary (singular) fit: see help(&#39;isSingular&#39;)</code></pre>
<pre><code>## (2/6) Simulating: |==========================================                  |(2/6) Simulating: |=============================================               |(2/6) Simulating: |================================================            |(2/6) Simulating: |===================================================         |</code></pre>
<pre><code>## boundary (singular) fit: see help(&#39;isSingular&#39;)</code></pre>
<pre><code>## (2/6) Simulating: |======================================================      |(2/6) Simulating: |=========================================================   |(2/6) Simulating: |============================================================|(2/6) (3/6) (3/6) Simulating: |                                                            |(3/6) Simulating: |===                                                         |(3/6) Simulating: |======                                                      |(3/6) Simulating: |=========                                                   |(3/6) Simulating: |============                                                |(3/6) Simulating: |===============                                             |(3/6) Simulating: |==================                                          |(3/6) Simulating: |=====================                                       |(3/6) Simulating: |========================                                    |(3/6) Simulating: |===========================                                 |(3/6) Simulating: |==============================                              |(3/6) Simulating: |=================================                           |(3/6) Simulating: |====================================                        |(3/6) Simulating: |=======================================                     |(3/6) Simulating: |==========================================                  |(3/6) Simulating: |=============================================               |(3/6) Simulating: |================================================            |(3/6) Simulating: |===================================================         |(3/6) Simulating: |======================================================      |(3/6) Simulating: |=========================================================   |(3/6) Simulating: |============================================================|(3/6) (4/6) (4/6) Simulating: |                                                            |(4/6) Simulating: |===                                                         |(4/6) Simulating: |======                                                      |(4/6) Simulating: |=========                                                   |(4/6) Simulating: |============                                                |(4/6) Simulating: |===============                                             |(4/6) Simulating: |==================                                          |(4/6) Simulating: |=====================                                       |(4/6) Simulating: |========================                                    |(4/6) Simulating: |===========================                                 |(4/6) Simulating: |==============================                              |(4/6) Simulating: |=================================                           |(4/6) Simulating: |====================================                        |(4/6) Simulating: |=======================================                     |(4/6) Simulating: |==========================================                  |(4/6) Simulating: |=============================================               |(4/6) Simulating: |================================================            |(4/6) Simulating: |===================================================         |(4/6) Simulating: |======================================================      |(4/6) Simulating: |=========================================================   |(4/6) Simulating: |============================================================|(4/6) (5/6) (5/6) Simulating: |                                                            |(5/6) Simulating: |===                                                         |(5/6) Simulating: |======                                                      |(5/6) Simulating: |=========                                                   |(5/6) Simulating: |============                                                |(5/6) Simulating: |===============                                             |(5/6) Simulating: |==================                                          |(5/6) Simulating: |=====================                                       |(5/6) Simulating: |========================                                    |(5/6) Simulating: |===========================                                 |(5/6) Simulating: |==============================                              |(5/6) Simulating: |=================================                           |(5/6) Simulating: |====================================                        |(5/6) Simulating: |=======================================                     |(5/6) Simulating: |==========================================                  |(5/6) Simulating: |=============================================               |(5/6) Simulating: |================================================            |(5/6) Simulating: |===================================================         |(5/6) Simulating: |======================================================      |(5/6) Simulating: |=========================================================   |(5/6) Simulating: |============================================================|(5/6) (6/6) (6/6) Simulating: |                                                            |(6/6) Simulating: |===                                                         |(6/6) Simulating: |======                                                      |(6/6) Simulating: |=========                                                   |(6/6) Simulating: |============                                                |(6/6) Simulating: |===============                                             |(6/6) Simulating: |==================                                          |(6/6) Simulating: |=====================                                       |(6/6) Simulating: |========================                                    |(6/6) Simulating: |===========================                                 |(6/6) Simulating: |==============================                              |(6/6) Simulating: |=================================                           |(6/6) Simulating: |====================================                        |(6/6) Simulating: |=======================================                     |(6/6) Simulating: |==========================================                  |(6/6) Simulating: |=============================================               |(6/6) Simulating: |================================================            |(6/6) Simulating: |===================================================         |(6/6) Simulating: |======================================================      |(6/6) Simulating: |=========================================================   |(6/6) Simulating: |============================================================|(6/6) </code></pre>
<pre class="r"><code># show plot
plot(pcurve_m2_asi_c)</code></pre>
<p><img src="pwr_files/figure-html/glmer18-1.png" width="672" /></p>
<p>We can see that with 30 items, we would need only about 15 subjects
to reach the 80 percent threshold.</p>
<p>We can also check the results in tabular form as shown below.</p>
<p>The results are shown below.</p>
<pre class="r"><code># print results
print(pcurve_m2_asi_c)</code></pre>
<pre><code>## Power for predictor &#39;ConditionTest&#39;, (95% confidence interval),
## by number of levels in Subject:
##       5: 65.00% (40.78, 84.61) - 300 rows
##      10: 95.00% (75.13, 99.87) - 600 rows
##      15: 100.0% (83.16, 100.0) - 900 rows
##      20: 100.0% (83.16, 100.0) - 1200 rows
##      25: 100.0% (83.16, 100.0) - 1500 rows
##      30: 100.0% (83.16, 100.0) - 1800 rows
## 
## Time elapsed: 0 h 0 m 48 s</code></pre>
</div>
</div>
<div id="post-hoc-analyses" class="section level2 unnumbered">
<h2 class="unnumbered">Post-Hoc Analyses</h2>
<hr />
<div class="warning"
style="padding:0.1em; background-color:#f2f2f2; color:#51247a">
<span>
<p style="margin-top:1em; text-align:center">
<b>NOTE</b><br>Power analysis have also been used post-hoc to test if
the sample size of studies was sufficient to detect meaningful effects.
However, such post-hoc power calculations where the target effect size
comes from the data, give misleading results <span class="citation">(<a
href="#ref-hoenig2001abuse" role="doc-biblioref">Hoenig and Heisey
2001</a>; <a href="#ref-perugini2018practical"
role="doc-biblioref">Perugini, Gallucci, and Costantini 2018</a>)</span>
and should thus be treated with extreme care!
</p>
<p style="margin-left:1em;">
</p>
<p></span></p>
</div>
<p><br></p>
<p>We begin by adding a response variable to our data. In this case, we
vary the response variable ti a higher likelihood of obtaining gazes in
the <em>area of interests</em> (AOI) in the test condition.</p>
<pre class="r"><code>simdat2 &lt;- simdat %&gt;%
  dplyr::arrange(Condition) %&gt;%
  dplyr::mutate(
  dep &lt;- c(sample(c(&quot;yes&quot;, &quot;no&quot;), 100, replace = T, prob = c(.5, .5)),
           sample(c(&quot;yes&quot;, &quot;no&quot;), 100, replace = T, prob = c(.7, .3)))
  ) %&gt;%
  dplyr::mutate_if(is.character, factor) %&gt;%
  dplyr::rename(AOI = 4)
# inspect
head(simdat2, 20)</code></pre>
<pre><code>##    Subject Condition Item AOI
## 1     Sub1   Control    1  no
## 2     Sub1   Control    2 yes
## 3     Sub1   Control    3  no
## 4     Sub1   Control    4 yes
## 5     Sub1   Control    5  no
## 6     Sub1   Control    6 yes
## 7     Sub1   Control    7  no
## 8     Sub1   Control    8 yes
## 9     Sub1   Control    9  no
## 10    Sub1   Control   10 yes
## 11    Sub2   Control    1  no
## 12    Sub2   Control    2  no
## 13    Sub2   Control    3 yes
## 14    Sub2   Control    4  no
## 15    Sub2   Control    5  no
## 16    Sub2   Control    6 yes
## 17    Sub2   Control    7  no
## 18    Sub2   Control    8 yes
## 19    Sub2   Control    9 yes
## 20    Sub2   Control   10 yes</code></pre>
<p>Now that we have generated some data, we will fit a model to it and
perform a power analysis on the observed effects.</p>
<p>We will fit a first model to the data. Thus, in a first step, we load
the <code>lme4</code> package to create a model, set a seed (to save the
results and so that the results can be replicated), and then create an
initial mixed-effects model.</p>
<pre class="r"><code># set seed for replicability
set.seed(12345)
# fit model
m3 &lt;- glmer(AOI ~ (1|Subject) +(1|Item) + Condition, 
            family=&quot;binomial&quot;, 
            data=simdat2)
# inspect results
summary(m3)</code></pre>
<pre><code>## Generalized linear mixed model fit by maximum likelihood (Laplace
##   Approximation) [glmerMod]
##  Family: binomial  ( logit )
## Formula: AOI ~ (1 | Subject) + (1 | Item) + Condition
##    Data: simdat2
## 
##      AIC      BIC   logLik deviance df.resid 
##    259.3    272.5   -125.6    251.3      196 
## 
## Scaled residuals: 
##    Min     1Q Median     3Q    Max 
## -1.687 -1.151  0.593  0.869  0.869 
## 
## Random effects:
##  Groups  Name        Variance Std.Dev.
##  Subject (Intercept) 0        0       
##  Item    (Intercept) 0        0       
## Number of obs: 200, groups:  Subject, 10; Item, 10
## 
## Fixed effects:
##               Estimate Std. Error z value Pr(&gt;|z|)  
## (Intercept)      0.282      0.202    1.40    0.163  
## ConditionTest    0.764      0.305    2.51    0.012 *
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Correlation of Fixed Effects:
##             (Intr)
## ConditinTst -0.663
## optimizer (Nelder_Mead) convergence code: 0 (OK)
## boundary (singular) fit: see help(&#39;isSingular&#39;)</code></pre>
<p>We now check the effect sizes of the predictors in the model. We can
do this by displaying the results of the model using the
<code>tab_model</code> function from the <code>sjPlot</code>
package.</p>
<pre class="r"><code># tabulate results
sjPlot::tab_model(m3)</code></pre>
<table style="border-collapse:collapse; border:none;">
<tr>
<th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">
 
</th>
<th colspan="3" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">
AOI
</th>
</tr>
<tr>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">
Predictors
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
Odds Ratios
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
CI
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
p
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
(Intercept)
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
1.33
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.89 – 1.97
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.163
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
Condition [Test]
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
2.15
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
1.18 – 3.90
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
<strong>0.012</strong>
</td>
</tr>
<tr>
<td colspan="4" style="font-weight:bold; text-align:left; padding-top:.8em;">
Random Effects
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
σ<sup>2</sup>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">
3.29
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
τ<sub>00</sub> <sub>Subject</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">
0.00
</td>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
τ<sub>00</sub> <sub>Item</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">
0.00
</td>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
N <sub>Subject</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">
10
</td>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
N <sub>Item</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">
10
</td>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;">
Observations
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="3">
200
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
Marginal R<sup>2</sup> / Conditional R<sup>2</sup>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">
0.043 / NA
</td>
</tr>
</table>
<p>Now, we perform power analysis on an observed effect. This analysis
tells us how likely the model is to find an observed effect given the
data.</p>
<hr />
<div class="warning"
style="padding:0.1em; background-color:#f2f2f2; color:#51247a">
<span>
<p style="margin-top:1em; text-align:center">
<b>NOTE</b><br>We use a very low number of simulations (10) and we use
the default z-test which is suboptimal for small samples <span
class="citation">(<a href="#ref-bolker2009generalized"
role="doc-biblioref">Bolker et al. 2009</a>)</span>. In a proper study,
you should increase the number of simulations (to at least 1000) and you
should use a bootstrapping rather than a z-test <span
class="citation">(cf. <a href="#ref-halekoh2014kenward"
role="doc-biblioref">Halekoh, Højsgaard, et al. 2014</a>)</span>.
</p>
<p style="margin-left:1em;">
</p>
<p></span></p>
</div>
<hr />
<p><em>What is the probability of finding the observed effect given the
data?</em></p>
<pre class="r"><code># set seed for replicability
set.seed(12345)
# perform power analysis for present model
m3_pwr &lt;- powerSim(m3, 
                  fixed(&quot;ConditionTest&quot;, &quot;z&quot;), 
                  nsim=20)
# inspect results
m3_pwr</code></pre>
<p>The results of the power analysis show that, given the data at hand,
the model would have detected the effect of <code>Conidition:Test</code>
with a probability of <code>m3_pwr$x</code> percent. However, and as
stated above, the results of such post-hoc power calculations (where the
target effect size comes from the data) give misleading results <span
class="citation">(<a href="#ref-hoenig2001abuse"
role="doc-biblioref">Hoenig and Heisey 2001</a>)</span> and should thus
be treated with extreme care!</p>
<div id="fixing-effects" class="section level3 unnumbered">
<h3 class="unnumbered">Fixing effects</h3>
<p>We will set the effects that we obtained based on our “observed” data
to check if, given the size of the data, we have enough power to detect
a small effect of <em>Condition</em>. In a first step, we check the
observed effects.</p>
<pre class="r"><code>estimatesfixedeffects &lt;- fixef(m3)
exp(estimatesfixedeffects)</code></pre>
<pre><code>##   (Intercept) ConditionTest 
##         1.326         2.147</code></pre>
<p>We can see that the effect of <em>Condition</em> is rather small
which makes it very hard to detect an effect. We will now change the
size of the effect of ConditionTest to represent a truly <em>small</em>
effect, i.e. on the brink of being noise but being just strong enough to
be considered small. In other words, we will set the effect so that its
odds ratio is exactly 1.68.</p>
<pre class="r"><code># set seed for replicability
set.seed(12345)
# perform power analysis for small effect
fixef(m3)[&quot;ConditionTest&quot;] &lt;- 0.519
estimatesfixedeffects &lt;- fixef(m3)
exp(estimatesfixedeffects)</code></pre>
<pre><code>##   (Intercept) ConditionTest 
##         1.326         1.680</code></pre>
<p><em>What is the probability of finding a weak effect given the
data?</em></p>
<p>We now perform the power analysis.</p>
<pre class="r"><code># set seed for replicability
set.seed(12345)
# perform power analysis for present model
m3_pwr_se &lt;- powerSim(m3, 
                  fixed(&quot;ConditionTest&quot;, &quot;z&quot;), 
                  nsim=20)
# inspect results
m3_pwr_se</code></pre>
<p><strong>The data is not sufficient and would detect a weak effect of
<code>Condition</code> with only 8 percent accuracy</strong></p>
</div>
<div id="power-analysis-of-extended-data"
class="section level3 unnumbered">
<h3 class="unnumbered">Power Analysis of Extended Data</h3>
<p>We will now extend the data to see what sample size is needed to get
to the 80 percent accuracy threshold. We begin by increasing the number
of items from 10 to 30 to see if this would lead to a sufficient sample
size.</p>
<pre class="r"><code># increase sample size
m3_ai &lt;- extend(m3, 
             along=&quot;Item&quot;, 
             n=30)
# perform power simulation
m3_ai_pwr &lt;- powerSim(m3_ai, 
                  fixed(&quot;ConditionTest&quot;, &quot;z&quot;), 
                  nsim=20)
# show results
m3_ai_pwr</code></pre>
<p><strong>The data with 30 Items is sufficient and would detect a weak
effect of <code>Condition</code> with 18 percent accuracy</strong></p>
<p><em>At what number of sentences are the data sufficient to detect an
effect?</em></p>
<pre class="r"><code>pcurve_m3_asi_c &lt;- powerCurve(m3_ai, 
                             fixed(&quot;ConditionTest&quot;, &quot;z&quot;), 
                             along = &quot;Item&quot;, 
                             breaks = seq(5, 30, 5), 
                             nsim = 20)</code></pre>
<pre><code>## Simulating: |                                                                  |Simulating: |===                                                               |Simulating: |======                                                            |Simulating: |=========                                                         |Simulating: |=============                                                     |Simulating: |================                                                  |Simulating: |===================                                               |Simulating: |=======================                                           |Simulating: |==========================                                        |Simulating: |=============================                                     |Simulating: |=================================                                 |Simulating: |====================================                              |Simulating: |=======================================                           |Simulating: |==========================================                        |Simulating: |==============================================                    |Simulating: |=================================================                 |Simulating: |====================================================              |Simulating: |========================================================          |Simulating: |===========================================================       |Simulating: |==============================================================    |Simulating: |==================================================================|(1/6) (1/6) Simulating: |                                                            |(1/6) Simulating: |===                                                         |(1/6) Simulating: |======                                                      |(1/6) Simulating: |=========                                                   |(1/6) Simulating: |============                                                |(1/6) Simulating: |===============                                             |(1/6) Simulating: |==================                                          |(1/6) Simulating: |=====================                                       |(1/6) Simulating: |========================                                    |(1/6) Simulating: |===========================                                 |(1/6) Simulating: |==============================                              |(1/6) Simulating: |=================================                           |(1/6) Simulating: |====================================                        |(1/6) Simulating: |=======================================                     |(1/6) Simulating: |==========================================                  |(1/6) Simulating: |=============================================               |(1/6) Simulating: |================================================            |(1/6) Simulating: |===================================================         |(1/6) Simulating: |======================================================      |(1/6) Simulating: |=========================================================   |(1/6) Simulating: |============================================================|(1/6) (2/6) (2/6) Simulating: |                                                            |(2/6) Simulating: |===                                                         |(2/6) Simulating: |======                                                      |(2/6) Simulating: |=========                                                   |(2/6) Simulating: |============                                                |(2/6) Simulating: |===============                                             |(2/6) Simulating: |==================                                          |(2/6) Simulating: |=====================                                       |(2/6) Simulating: |========================                                    |(2/6) Simulating: |===========================                                 |(2/6) Simulating: |==============================                              |(2/6) Simulating: |=================================                           |(2/6) Simulating: |====================================                        |(2/6) Simulating: |=======================================                     |(2/6) Simulating: |==========================================                  |(2/6) Simulating: |=============================================               |(2/6) Simulating: |================================================            |(2/6) Simulating: |===================================================         |(2/6) Simulating: |======================================================      |(2/6) Simulating: |=========================================================   |(2/6) Simulating: |============================================================|(2/6) (3/6) (3/6) Simulating: |                                                            |(3/6) Simulating: |===                                                         |(3/6) Simulating: |======                                                      |(3/6) Simulating: |=========                                                   |(3/6) Simulating: |============                                                |(3/6) Simulating: |===============                                             |(3/6) Simulating: |==================                                          |(3/6) Simulating: |=====================                                       |(3/6) Simulating: |========================                                    |(3/6) Simulating: |===========================                                 |(3/6) Simulating: |==============================                              |(3/6) Simulating: |=================================                           |(3/6) Simulating: |====================================                        |(3/6) Simulating: |=======================================                     |(3/6) Simulating: |==========================================                  |(3/6) Simulating: |=============================================               |(3/6) Simulating: |================================================            |(3/6) Simulating: |===================================================         |(3/6) Simulating: |======================================================      |(3/6) Simulating: |=========================================================   |(3/6) Simulating: |============================================================|(3/6) (4/6) (4/6) Simulating: |                                                            |(4/6) Simulating: |===                                                         |(4/6) Simulating: |======                                                      |(4/6) Simulating: |=========                                                   |(4/6) Simulating: |============                                                |(4/6) Simulating: |===============                                             |(4/6) Simulating: |==================                                          |(4/6) Simulating: |=====================                                       |(4/6) Simulating: |========================                                    |(4/6) Simulating: |===========================                                 |(4/6) Simulating: |==============================                              |(4/6) Simulating: |=================================                           |(4/6) Simulating: |====================================                        |(4/6) Simulating: |=======================================                     |(4/6) Simulating: |==========================================                  |(4/6) Simulating: |=============================================               |(4/6) Simulating: |================================================            |(4/6) Simulating: |===================================================         |(4/6) Simulating: |======================================================      |(4/6) Simulating: |=========================================================   |(4/6) Simulating: |============================================================|(4/6) (5/6) (5/6) Simulating: |                                                            |(5/6) Simulating: |===                                                         |(5/6) Simulating: |======                                                      |(5/6) Simulating: |=========                                                   |(5/6) Simulating: |============                                                |(5/6) Simulating: |===============                                             |(5/6) Simulating: |==================                                          |(5/6) Simulating: |=====================                                       |(5/6) Simulating: |========================                                    |(5/6) Simulating: |===========================                                 |(5/6) Simulating: |==============================                              |(5/6) Simulating: |=================================                           |(5/6) Simulating: |====================================                        |(5/6) Simulating: |=======================================                     |(5/6) Simulating: |==========================================                  |(5/6) Simulating: |=============================================               |(5/6) Simulating: |================================================            |(5/6) Simulating: |===================================================         |(5/6) Simulating: |======================================================      |(5/6) Simulating: |=========================================================   |(5/6) Simulating: |============================================================|(5/6) (6/6) (6/6) Simulating: |                                                            |(6/6) Simulating: |===                                                         |(6/6) Simulating: |======                                                      |(6/6) Simulating: |=========                                                   |(6/6) Simulating: |============                                                |(6/6) Simulating: |===============                                             |(6/6) Simulating: |==================                                          |(6/6) Simulating: |=====================                                       |(6/6) Simulating: |========================                                    |(6/6) Simulating: |===========================                                 |(6/6) Simulating: |==============================                              |(6/6) Simulating: |=================================                           |(6/6) Simulating: |====================================                        |(6/6) Simulating: |=======================================                     |(6/6) Simulating: |==========================================                  |(6/6) Simulating: |=============================================               |(6/6) Simulating: |================================================            |(6/6) Simulating: |===================================================         |(6/6) Simulating: |======================================================      |(6/6) Simulating: |=========================================================   |(6/6) Simulating: |============================================================|(6/6) </code></pre>
<pre class="r"><code># show plot
plot(pcurve_m3_asi_c)</code></pre>
<p><img src="pwr_files/figure-html/glmer36-1.png" width="672" /></p>
<p>We reach the 80 percent threshold with about 25 subjects.</p>
</div>
</div>
</div>
<div id="resources-and-links" class="section level1 unnumbered">
<h1 class="unnumbered">Resources and Links</h1>
<p>If you want to know more, please have a look/go at the following
resources:</p>
<ul>
<li><p><a
href="https://besjournals.onlinelibrary.wiley.com/doi/full/10.1111/2041-210X.12504">SIMR:
an R package for power analysis of generalized linear mixed models by
simulation</a></p></li>
<li><p><a
href="https://www.r-bloggers.com/2021/05/power-analysis-in-statistics-with-r/">Power
analysis in Statistics with R</a></p></li>
<li><p><a
href="https://humburg.github.io/Power-Analysis/simr_power_analysis.html">Power
Analysis with simr</a></p></li>
<li><p><a
href="https://www.r-bloggers.com/2021/07/parallelizing-simrpowercurve-in-r/">Parallelizing
simr::powercurve() in R</a></p></li>
<li><p><a href="https://slcladal.github.io/pwr.html">Power Analysis in
R</a></p></li>
</ul>
<p>Also check out Jacob Westfall’s website for <a
href="https://jakewestfall.shinyapps.io/crossedpower/">Power Analysis
with Crossed Random Effects</a> based on <span
class="citation">Westfall, Kenny, and Judd (<a
href="#ref-westfall2014power" role="doc-biblioref">2014</a>)</span>.</p>
<p>See <span class="citation">Baayen et al. (<a
href="#ref-baayen2017shadows" role="doc-biblioref">2017</a>)</span> for
power in generalized additive mixed models and why maximal models can be
ill-advised. Also, see <span class="citation">Matuscheka et al. (<a
href="#ref-matuscheka2017balancing"
role="doc-biblioref">2017</a>)</span> for a simulation study on the
detrimental effects of complex random effect structures on power.</p>
</div>
<div id="citation-session-info" class="section level1 unnumbered">
<h1 class="unnumbered">Citation &amp; Session Info</h1>
<p>Schweinberger, Martin. 2022. <em>Power Analysis in R</em>. Brisbane:
The University of Queensland. url: <a
href="https://slcladal.github.io/pwr.html"
class="uri">https://slcladal.github.io/pwr.html</a> (Version
2022.05.21).</p>
<pre><code>@manual{schweinberger2022pwr,
  author = {Schweinberger, Martin},
  title = {Power Analysis in R},
  note = {https://slcladal.github.io/pwr.html},
  year = {2022},
  organization = &quot;The University of Queensland, Australia. School of Languages and Cultures},
  address = {Brisbane},
  edition = {2022.05.21}
}</code></pre>
<pre class="r"><code>sessionInfo()</code></pre>
<pre><code>## R version 4.2.0 (2022-04-22 ucrt)
## Platform: x86_64-w64-mingw32/x64 (64-bit)
## Running under: Windows 10 x64 (build 19043)
## 
## Matrix products: default
## 
## locale:
## [1] LC_COLLATE=German_Germany.utf8  LC_CTYPE=German_Germany.utf8   
## [3] LC_MONETARY=German_Germany.utf8 LC_NUMERIC=C                   
## [5] LC_TIME=German_Germany.utf8    
## 
## attached base packages:
## [1] stats     graphics  grDevices datasets  utils     methods   base     
## 
## other attached packages:
##  [1] entity_0.1.0       flextable_0.7.0    knitr_1.39         DT_0.22           
##  [5] effectsize_0.6.0.1 simr_1.0.6         sjPlot_2.8.10      lme4_1.1-29       
##  [9] Matrix_1.4-1       pwr_1.3-0          DescTools_0.99.45  forcats_0.5.1     
## [13] stringr_1.4.0      dplyr_1.0.9        purrr_0.3.4        readr_2.1.2       
## [17] tidyr_1.2.0        tibble_3.1.7       ggplot2_3.3.6      tidyverse_1.3.1   
## 
## loaded via a namespace (and not attached):
##   [1] TH.data_1.1-1     minqa_1.2.4       colorspace_2.0-3  ellipsis_0.3.2   
##   [5] class_7.3-20      sjlabelled_1.2.0  estimability_1.3  base64enc_0.1-3  
##   [9] parameters_0.17.0 fs_1.5.2          gld_2.6.4         rstudioapi_0.13  
##  [13] proxy_0.4-26      farver_2.1.0      fansi_1.0.3       mvtnorm_1.1-3    
##  [17] lubridate_1.8.0   xml2_1.3.3        codetools_0.2-18  splines_4.2.0    
##  [21] rootSolve_1.8.2.3 sjmisc_2.8.9      jsonlite_1.8.0    nloptr_2.0.1     
##  [25] ggeffects_1.1.2   pbkrtest_0.5.1    binom_1.1-1.1     broom_0.8.0      
##  [29] dbplyr_2.1.1      compiler_4.2.0    httr_1.4.3        sjstats_0.18.1   
##  [33] emmeans_1.7.3     backports_1.4.1   assertthat_0.2.1  fastmap_1.1.0    
##  [37] cli_3.3.0         htmltools_0.5.2   tools_4.2.0       coda_0.19-4      
##  [41] gtable_0.3.0      glue_1.6.2        lmom_2.8          Rcpp_1.0.8.3     
##  [45] carData_3.0-5     cellranger_1.1.0  jquerylib_0.1.4   vctrs_0.4.1      
##  [49] nlme_3.1-157      iterators_1.0.14  insight_0.17.0    xfun_0.30        
##  [53] rvest_1.0.2       lifecycle_1.0.1   pacman_0.5.1      renv_0.15.4      
##  [57] klippy_0.0.0.9500 MASS_7.3-56       zoo_1.8-10        scales_1.2.0     
##  [61] hms_1.1.1         parallel_4.2.0    sandwich_3.0-1    expm_0.999-6     
##  [65] yaml_2.3.5        Exact_3.1         gdtools_0.2.4     sass_0.4.1       
##  [69] stringi_1.7.6     highr_0.9         bayestestR_0.12.1 plotrix_3.8-2    
##  [73] e1071_1.7-9       zip_2.2.0         boot_1.3-28       systemfonts_1.0.4
##  [77] rlang_1.0.2       pkgconfig_2.0.3   evaluate_0.15     lattice_0.20-45  
##  [81] htmlwidgets_1.5.4 labeling_0.4.2    tidyselect_1.1.2  plyr_1.8.7       
##  [85] magrittr_2.0.3    R6_2.5.1          generics_0.1.2    multcomp_1.4-19  
##  [89] RLRsim_3.1-8      DBI_1.1.2         pillar_1.7.0      haven_2.5.0      
##  [93] withr_2.5.0       mgcv_1.8-40       abind_1.4-5       survival_3.3-1   
##  [97] datawizard_0.4.0  performance_0.9.0 car_3.0-13        modelr_0.1.8     
## [101] crayon_1.5.1      uuid_1.1-0        utf8_1.2.2        officer_0.4.2    
## [105] tzdb_0.3.0        rmarkdown_2.14    grid_4.2.0        readxl_1.4.0     
## [109] data.table_1.14.2 reprex_2.0.1      digest_0.6.29     xtable_1.8-4     
## [113] munsell_0.5.0     bslib_0.3.1</code></pre>
<hr />
<p><a href="#introduction">Back to top</a></p>
<p><a href="https://slcladal.github.io/index.html">Back to HOME</a></p>
<hr />
</div>
<div id="references" class="section level1 unnumbered">
<h1 class="unnumbered">References</h1>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-arnold2011simulation" class="csl-entry">
Arnold, Benjamin F, Daniel R Hogan, John M Colford, and Alan E Hubbard.
2011. <span>“Simulation Methods to Estimate Design Power: An Overview
for Applied Research.”</span> <em>BMC Medical Research Methodology</em>
11 (1): 1–10.
</div>
<div id="ref-baayen2017shadows" class="csl-entry">
Baayen, Harald, Shravan Vasishth, Reinhold Kliegl, and Douglas Bates.
2017. <span>“The Cave of Shadows: Addressing the Human Factor with
Generalized Additive Mixed Models.”</span> <em>Journal of Memory and
Language</em> 94: 206–34.
</div>
<div id="ref-bolker2009generalized" class="csl-entry">
Bolker, Benjamin M, Mollie E Brooks, Connie J Clark, Shane W Geange,
John R Poulsen, M Henry H Stevens, and Jada-Simone S White. 2009.
<span>“Generalized Linear Mixed Models: A Practical Guide for Ecology
and Evolution.”</span> <em>Trends in Ecology &amp; Evolution</em> 24
(3): 127–35.
</div>
<div id="ref-bortz109verteilungsfreie" class="csl-entry">
Bortz, J, GA Lienert, and K Boehnke. 1990. <em>Verteilungsfreie Methoden
in Der Biostatistik</em>. Berlin: Springer Verlag.
</div>
<div id="ref-pwr" class="csl-entry">
Champely, Stephane. 2020. <em>Pwr: Basic Functions for Power
Analysis</em>. <a
href="https://CRAN.R-project.org/package=pwr">https://CRAN.R-project.org/package=pwr</a>.
</div>
<div id="ref-chen2010big" class="csl-entry">
Chen, Henian, Patricia Cohen, and Sophie Chen. 2010. <span>“How Big Is a
Big Odds Ratio? Interpreting the Magnitudes of Odds Ratios in
Epidemiological Studies.”</span> <em>Communications in
Statistics–Simulation and Computation<span></span></em> 39 (4): 860–64.
</div>
<div id="ref-cohen1988statistical" class="csl-entry">
Cohen, Jacob. 1988. <em>Statistical Power Analysis for the Behavioral
Sciences</em>. Hillsdale, NJ: Erlbaum.
</div>
<div id="ref-field2007making" class="csl-entry">
Field, Scott A, Patrick J O’Connor, Andrew J Tyre, and Hugh P
Possingham. 2007. <span>“Making Monitoring Meaningful.”</span>
<em>Austral Ecology</em> 32 (5): 485–91.
</div>
<div id="ref-green2016simr" class="csl-entry">
Green, Peter, and Catriona J MacLeod. 2016a. <span>“SIMR: An r Package
for Power Analysis of Generalized Linear Mixed Models by
Simulation.”</span> <em>Methods in Ecology and Evolution</em> 7 (4):
493–98.
</div>
<div id="ref-simr" class="csl-entry">
Green, Peter, and Catriona J. MacLeod. 2016b. <span>“Simr: An r Package
for Power Analysis of Generalised Linear Mixed Models by
Simulation.”</span> <em>Methods in Ecology and Evolution</em> 7 (4):
493–98. <a
href="https://doi.org/10.1111/2041-210X.12504">https://doi.org/10.1111/2041-210X.12504</a>.
</div>
<div id="ref-gries2005kilgariff" class="csl-entry">
Gries, Stefan Th. 2005. <span>“Null-Hypothesis Significance Testing of
Word Frequencies: A Follow-up on Kilgarriff.”</span> <em>Corpus
Linguistics and Linguistic Theory</em> 1 (2): 277–94.
</div>
<div id="ref-halekoh2014kenward" class="csl-entry">
Halekoh, Ulrich, Søren Højsgaard, et al. 2014. <span>“A Kenward-Roger
Approximation and Parametric Bootstrap Methods for Tests in Linear Mixed
Models–the r Package Pbkrtest.”</span> <em>Journal of Statistical
Software</em> 59 (9): 1–30.
</div>
<div id="ref-hoenig2001abuse" class="csl-entry">
Hoenig, John M, and Dennis M Heisey. 2001. <span>“The Abuse of Power:
The Pervasive Fallacy of Power Calculations for Data Analysis.”</span>
<em>The American Statistician</em> 55 (1): 19–24.
</div>
<div id="ref-johnson2015power" class="csl-entry">
Johnson, Paul CD, Sarah JE Barry, Heather M Ferguson, and Pie Müller.
2015. <span>“Power Analysis for Generalized Linear Mixed Models in
Ecology and Evolution.”</span> <em>Methods in Ecology and Evolution</em>
6 (2): 133–42.
</div>
<div id="ref-kilgarriff2005language" class="csl-entry">
Kilgarriff, Adam. 2005. <span>“Language Is Never, Ever, Ever,
Random.”</span> <em>Corpus Linguistics and Linguistic Theory</em> 1 (2):
263–76.
</div>
<div id="ref-matuscheka2017balancing" class="csl-entry">
Matuscheka, Hannes, Reinhold Kliegl, Shravan Vasishth, Harald Baayen,
and Douglas Bates. 2017. <span>“Balancing Type i Error and Power in
Linear Mixed Models.”</span> <em>Journal of Memory and Language</em> 94:
305–15.
</div>
<div id="ref-perugini2018practical" class="csl-entry">
Perugini, Marco, Marcello Gallucci, and Giulio Costantini. 2018.
<span>“A Practical Primer to Power Analysis for Simple Experimental
Designs.”</span> <em>International Review of Social Psychology</em> 31
(1): 1–23.
</div>
<div id="ref-westfall2014power" class="csl-entry">
Westfall, Jacob, David A Kenny, and Charles M Judd. 2014.
<span>“Statistical Power and Optimal Design in Experiments in Which
Samples of Participants Respond to Samples of Stimuli.”</span>
<em>Journal of Experimental Psychology: General</em> 143 (5): 2020–45.
</div>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
