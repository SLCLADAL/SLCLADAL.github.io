---
title: "Chi Square tests"
author: "Martin Schweinberger"
date: "2 Dezember 2018"
output: html_document
---

\subsection{Der Chi Quadrat-Test: Ein praktisches Beispiel}
In diesem Beispiel geht es um die Frage, ob sich Sprecher der US-Amerikanischen Varietät (AmE) und der Britischen Varietät (BrE) des Englischen in Ihrer Wahl von synonymen Heckenausdrücken (hedges) unterscheiden. Untersucht wird dabei die Verwendung der Heckenausdrücke \textit{sort of} und \textit{kind of}. Zunächst Formulieren wir die H_{1} und die H_{0}. Die Alternativ- oder Testhypothese H_{1} lautet demnach
\textquote{Sprecher von AmE und BrE unterscheiden sich in der Verwendung von \textit{sort of} und \textit{kind of}}, während die Nullhypothese (H_{0}) lautet \textquote{Sprecher von AmE und BrE unterscheiden sich nicht in der Verwendung von \textit{sort of} und \textit{kind of}}.

Bei Nullhypothese drückt typischerweise aus, dass kein Zusammenhang zwischen abhängiger und unabhängiger Variable besteht.

Wann können wir davon ausgehen, dass die Nullhypothese (H_{0}) nicht stimmt (d.h. sie gilt in der Grundgesamtheit nicht)?

Um die Frage zu beantworten benötigen wir die Angabe über die Irrtumswahrscheinlichkeit (probability of error), die die Wahrscheinlichkeit angibt, dass die Nullhypothese gilt. Vorher legen wir den Wert fest, ab dem wir die Nullhypothese ablehnen (Signifikanzniveau). In unserem Fall werden wir ein Signifikanzniveau von 5\% annehmen. In anderen Worten bedeutet dies, dass wenn die Irrtumswahrscheinlichkeit kleiner als 5\% ist (p$<$.05), dann lehnen wir die Nullhypothese ab und werden davon ausgehen, dass ein statistisch signifikanter Zusammenhang zwischen den Variablen (Varietät und Heckenausdruck) besteht.

Nehmen wir an, dass wir folgende Häufigkeiten in einer Stichprobe beobachtet haben:

\begin{table}[H]
\begin{minipage}{\textwidth}
\begin{center}
\begin{footnotesize}
\begin{tabular}{l | c | c | }
\hline
& \textbf{BrE} & \textbf{AmE} \\
\hline
\textbf{kindof} & 181 & 177 \\
\textbf{sortof} & 655 & 67 \\
\hline
\end{tabular}
\end{footnotesize}
\caption{Beobachtete Häufigkeiten von \textit{sort of} und \textit{kind of} in BrE und AmE}
\label{tab:beobachtet}
\end{center}
\end{minipage}
\end{table}

Um den $\chi$^{2}-Test rechnen zu können, müssen nun die Zeilen- und Spaltensummen errechnet werden.

\begin{table}[H]
\begin{minipage}{\textwidth}
\begin{center}
\begin{footnotesize}
\begin{tabular}{l | c | c | c |}
\hline
& \textbf{BrE} & \textbf{AmE} & Zeilensumme \\
\hline
\textbf{kindof} & 181 & 177 & 358 \\
\textbf{sortof} & 655 & 67 & 722 \\
\hline
Spaltensumme & 836 & 244 & 1080 \\
\hline
\end{tabular}
\end{footnotesize}
\caption{Beobachtete Häufigkeiten mit Spalten- und Zeilensummen von \textit{sort of} und \textit{kind of} in BrE und AmE}
\label{tab:summen}
\end{center}
\end{minipage}
\end{table}

Im nächsten Schritt werden die Erwartungswerte berechnet, d.h. es wird berechnet welchen Wert wir für jede Zelle erwarten würden, wenn gar kein Zusammenhang zwischen den Variablen bestünde. Auf jede Zelle wird daher folgende Formel angewandt:

\begin{equation}
\frac{Spaltensumme*Zeilensumme}{Gesamtsumme}
\label{eq:erw}
\end{equation}

Es ergibt sich für unser Beispiel für die Zelle [+]BrE [+]kindof:

\begin{equation}
\frac{836*358}{1080} = \frac{299288}{1080} = 277.1185
\label{eq:erw2}
\end{equation}

Für die Gesamttabelle ergibt sich:

\begin{table}[H]
\begin{minipage}{\textwidth}
\begin{center}
\begin{footnotesize}
\begin{tabular}{l | c | c | c |}
\hline
& \textbf{BrE} & \textbf{AmE} & Zeilensumme \\
\hline
\textbf{kindof} & 277.1185 & 80.88148 & 358 \\
\textbf{sortof} & 558.8815 & 163.11852 & 722 \\
\hline
Spaltensumme & 836 & 244 & 1080 \\
\hline
\end{tabular}
\end{footnotesize}
\caption{Erwartete Werte von \textit{sort of} und \textit{kind of} in BrE und AmE}
\label{tab:4erwartet}
\end{center}
\end{minipage}
\end{table}

Im nächsten Schritt wird der Beitrag jeder Zelle zum Gesamt $\chi$^{2} ($\chi$^{2} contribution) ermittelt. Auf jede Zelle wird demnach folgende Formel angewendet:

\begin{equation}
\frac{(beobachteter Wert – erwarteter Wert)^{2}}{erwarteter Wert}
\label{eq:chi}
\end{equation}

Es ergibt sich für unser Beispiel für die Zelle [+]BrE [+]kindof:

\begin{equation}
\frac{(181 – 277.1185)^{2}}{277.1185} = \frac{-96.1185^{2}}{277.1185} = \frac{9238.766}{277.1185} = 33.33868
\label{eq:chi}
\end{equation}

Für die Gesamttabelle ergibt sich:

\begin{table}[H]
\begin{minipage}{\textwidth}
\begin{center}
\begin{footnotesize}
\begin{tabular}{l | c | c | c |}
\hline
& \textbf{BrE} & \textbf{AmE} & Zeilensumme \\
\hline
\textbf{kindof} & 33.33869 & 114.22602 & 147.5647 \\
\textbf{sortof} & 16.53082 & 56.63839 & 73.16921 \\
\hline
Spaltensumme & 49.86951 & 170.8644 & \textbf{220.7339} \\
\hline
\end{tabular}
\end{footnotesize}
\caption{X2-Werte von \textit{sort of} und \textit{kind of} in BrE und AmE}
\label{tab:x2}
\end{center}
\end{minipage}
\end{table}

Die Gesamtsumme der Beträge ($\chi$^{2}-Wert) beträgt in unserem Beispiel 220.7339. Um zu sehen, ob dieser Wert signifikant ist oder nicht müssen nun die Freiheitsgrade berechnet werden (degrees of freedom). Die Freiheitsgrade lassen sich mit Formel (\ref{eq:df}) berechnen.
\begin{equation}
DF = (Anzahl Zeilen -1) * (Anzahl Spalten – 1) = (2-1) * (2-1) = 1 * 1 = 1
\label{eq:df}
\end{equation}
Im letzten Schritt wird nun der errechnete $\chi$^{2}-Wert mit dem kritischen $\chi$^{2}-Wert verglichen. Welcher kritischen $\chi$^{2}-Wert bei den vorliegenden Daten gilt hängt von der Anzahl der Freiheitsgrade ab. Da wir bereits berechnet haben, dass es sich in unserem Beispiel um einen Freiheitsgrad handelt, ist nur die erste Zeile von Tabelle \ref{tab:kritx} relevant.

\begin{table}[H]
\begin{minipage}{\textwidth}
\begin{center}
\begin{footnotesize}
\begin{tabular}{l | c | c | c |}
\hline
DF & \textbf{p$<$.05} & \textbf{p$<$.01} & \textbf{p$<$.001} \\
\hline
1 & 3.84 & 6.64 & 10.83 \\
2 & 5.99 & 9.21 & 13.82 \\
3 & 7.82 & 11.35 & 16.27 \\
4 & 9.49 & 13.28 & 18.47 \\
5 & 11.07 & 15.09 & 20.52 \\
\hline
\end{tabular}
\end{footnotesize}
\caption{Kritische X2-Werte bei 1 bis 5 Freiheitsgraden}
\label{tab:kritx}
\end{center}
\end{minipage}
\end{table}

Da unser errechneter $\chi$^{2}-Wert weit über dem Wert des kritischen Wertes liegt, können wir die H_{0} verwerfen und sagen, dass ein statistisch signifikanter Zusammenhang zwischen der Varietät des Englischen und der Verwendung der Heckenausdrücke \textit{sort of} und \textit{kind of} besteht. Bevor wir allerdings die Ergebnisse zusammenfassen, werden wir zusätzlich die Effektstärke berechnen.

\subsubsection{Effektstärke berechnen}
Effektstärken sind deshalb wichtig, da Zusammenhänge zwar statistisch signifikant sein können, der Einfluss der abhängigen auf die unabhängige Variable allerdings auch sehr schwach sein kann. Die Effektstärke ist demnach ein Maß dafür, wie stark der Zusammenhang zwischen abhängiger und unabhängiger Variable ist.

Das Effektstärkemaß, das bei $\chi$^{2}-Tests verwendet wird ist entweder der $\phi$-Koeffizient (phi-Koeffizient) oder Cramer's $\phi$ (Cramer's phi), das verwendet wird, wenn man es mit mehr als vier Tabellenfeldern rechnet. Der $\phi$-Koeffizient lässt sich nach Formel \ref{eq:phi} berechnen (N = Stichprobengröße).

\begin{equation}
\phi = \sqrt{\frac{\chi^{2}}{N}}
\label{eq:phi}
\end{equation}

Es ergibt sich für uns:

\begin{equation}
\phi = \sqrt{\frac{220.7339}{1080}} = \sqrt{0.2043832} = 0.4520876
\label{eq:phi2}
\end{equation}

Der Wert von $\phi$ liegt zwischen 0 (kein Zusammenhang) und 1 (perfekter Zusammenhang). Für die Einteilung in schwache, moderate und starke Effekte kann man der Einteilung für $\omega$ (kleines Omega) folgen, sodass man bei Werten von .1 von schwacher, um einen Wert bei 0.3 von moderater und ab .5 von einer starken Effektstärke sprechen kann \citep[266]{buehner2009statistik}. Wir haben es in diesem Beispiel also mit einem mittleren Effekt oder Zusammenhang zu tun.

\subsubsection{Der Chi-Quadrat-Test in R}
Bevor wir dazu kommen, wie die Ergebnisse zusammengefasst werden, werden wir im Folgenden den $\chi$^{2}-Test in \verb!R! rechnen. Zusätzlich zu den Schritten, die wir oben durchlaufen sind, werden wir die Daten graphisch darstellen.

Im ersten Schritt laden wir die Daten ein:
\begin{lstlisting}
# einlesen der daten
mydata <- read.table("http://martinschweinberger.de/docs/data/dt001.txt", header = F, sep = "\t", quote = "", comment.char = "")
# betiteln
colnames(mydata) <- c("BrE", "AmE")
rownames(mydata) <- c("kindof", "sortof")
# daten betrachten
mydata
\end{lstlisting}

Nun stellen wir die Daten graphisch dar.
\begin{lstlisting}
# daten visualisieren
par(mfrow=c(1, 2)) # zwei plots in zwei spalten in einem fenster
assocplot(as.matrix(mydata))
mosaicplot(mydata, shade = TRUE, type = "pearson", main = "")
par(mfrow=c(1, 1)) # herstellen der original parameter
# ein plot pro fenster
\end{lstlisting}

\begin{figure}[H]
\centering
\includegraphics[width=.8\textwidth]{images/chi1.png}\\[.25cm]
\caption{Visualisierung von \textit{sort of} und \textit{kind of} in BrE und AmE}
\label{fig:chi1}
\end{figure}

Die Farbe des Mosaikplots (rechts) deutet auf einen signifikanten Unterschied hin. Auch der Assoziationsplot (links) deutet dies an indem die Verteilung der Balken in den beiden Panels gespiegelt ist. Im nächsten Schritt werden wir direkt den Test durchführen.
\begin{lstlisting}
# testen
chisq.results <- chisq.test(mydata, corr = F)
# ergebnis ebtrachten
chisq.results
\end{lstlisting}

Wir sehen, dass die Ergebnisse, die \verb!R! uns berichtet dieselben sind, wie die, die wir vorher ausgerechnet haben. Im nächsten Schritt werden wir die Effektstärke berechnen.
\begin{lstlisting}
# effektstaerke berechnen
phi.coefficient = sqrt(chisq.results$statistic / sum(mydata) * (min(dim(mydata))-1))
# ergebnis ebtrachten
phi.coefficient
\end{lstlisting}

Nach der Visualisierung der Daten, dem Testen und der Berechnung der Effektstärke können wir nun dazu übergehen uns damit zu beschäftigen, wie unsere Ergebnisse zusammengefasst werden sollten.

\subsubsection{Zusammenfassung der Ergebnisse}
Man kann das Ergebnis unseres Beispiels wie folgt zusammenfassen: Ein $\chi$^{2}-Test bestätigt einen hoch signifikanten Zusammenhang mittlerer Stärke zwischen der Varietät des Englischen und der Verwendung der Heckenausdrücke \textit{sort of} und \textit{kind of} ($\chi$^{2} = 220.73, df = 1, p $<$ .001***, $\phi$ = .452).

\subsection{Anmerkungen zum Chi-Quadrat-Test}
Bei $\chi$^{2}-Tests müssen mindestens 80\% der Zellen Erwartungswerte $\ge$ 5 sein, höchstens 20\% der erwarteten Werte dürfen $<$ 5 sein \citep[vgl.][98]{bortz1990verteilungsfreie} und kein Erwartungswert sollte einen Wert $<$ 1 haben \citep[vgl.][136]{bortz1990verteilungsfreie}, da sonst die Schätzung, die auf der $\chi$^{2}-Verteilung beruht, zu ungenau wird \citep{cochran1954somemethods}. Ist diese Bedingung verletzt, so sollte man \textit{Fisher's Exact Test} rechnen, der zwar sehr viel aufwendiger ist, was die Rechenleistung betrifft, aber dafür auch auf sehr kleine Stichproben angewandt werden kann. Beim Fisher's Exact Test werden die Wahrscheinlichkeiten für alle möglichen Ausgänge berechnet und dann errechnet, wie hoch die summierte Wahrscheinlichkeit ist, dass das beobachtete oder ein noch extremeres Ergebnis zustande kommen ist. Ist die summierte Wahrscheinlichkeit kleiner als 5\%, dann ist Ihr Ergebnis signifikant.

Eine andere Alternative bei kleinen Stichproben bildet die Möglichkeit eine Yates-Korrektur bei dem $\chi$^{2}-Test durchzuführen, die wir in Sektion \ref{yates} besprechen werden.

\subsection*{Aufgaben}
\begin{enumerate}
\item Sie sind interessiert daran, ob junge oder alte Sprecher häufiger sprachlich auf sich selbst verweisen, da Sie die Hypothese haben, dass -- im Gegensatz zur weitläufig gängigen Ansicht -- ältere Menschen eher narzisstisch sind als jüngere Menschen. Sie extrahieren aus einem Korpus folgende Verteilung.

\begin{table}[H]
\begin{minipage}{\textwidth}
\begin{center}
\begin{footnotesize}
\begin{tabular}{l | c | c | c |}
\hline
& \textbf{1SGPN} & \textbf{PN ohne 1SG} & Zeilensumme \\
\hline
\textbf{Jung} & 61 & 43 & 104 \\
\textbf{Alt} & 42 & 36 & 78 \\
\hline
Spaltensumme & 103 & 79 & 182 \\
\hline
\end{tabular}
\end{footnotesize}
\caption{Beobachtete Häufigkeiten mit Spalten- und Zeilensummen von erste Person Singular Pronomen und Pronomen mit anderer Person und Numerus}
\label{tab:aufgabechi}
\end{center}
\end{minipage}
\end{table}
Rechnen Sie nun einen $\chi$^{2}-Test und fassen Sie Ihre Ergebnisse korrekt zusammen.

\item Sie sind nun daran interessiert, ob junge Männer oder junge Frauen häufiger das Wort \textit{whatever} verwenden, da Sie davon ausgehen, dass entgegen einiger früherer Beobachtungen junge Männer häufiger \textit{whatever} nutzen als junge Frauen. Sie extrahieren aus einem Korpus folgende Verteilung.

\begin{table}[H]
\begin{minipage}{\textwidth}
\begin{center}
\begin{footnotesize}
\begin{tabular}{l | c | c | c |}
\hline
& \textbf{YoungMales} & \textbf{YoungFemales} & Zeilensumme \\
\hline
\textbf{whatever} & 17 & 55 & 71 \\
\textbf{other words} & 345,128 & 916,552 & 1,261,680 \\
\hline
Spaltensumme & 345,145 & 916,607 & 1,261,752 \\
\hline
\end{tabular}
\end{footnotesize}
\caption{Beobachtete Häufigkeiten mit Spalten- und Zeilensummen des Wortes \textit{whatever} gebraucht von männlichen und weiblichen Sprechern.}
\label{tab:aufgabechi2}
\end{center}
\end{minipage}
\end{table}
Rechnen Sie nun einen $\chi$^{2}-Test und fassen Sie Ihre Ergebnisse korrekt zusammen.

\item Suchen Sie sich einen Partner und diskutieren das Verhältnis von Signifikanzwert und Effektstärke. Suchen Sie sich nun einen anderen Partner und sprechen Sie über potentielle Probleme, die entstehen, wenn man die Häufigkeit von Wörtern gegenüber allen anderen Wörtern testet.
\end{enumerate}

\subsubsection{Alternative Chi-Quadrat-Tests}
Im Folgenden werden einige Fälle besprochen, bei denen die Anwendung des herkömmlichen (Pearson's) $\chi$^{2}-Test inkorrekt oder problematisch wäre.

\subsubsection{Die Yates-Korrektur bei Chi-Quadrat-Tests}\label{yates}
Die Yates-Korrektur wird in Fällen angewendet, bei denen der Stichprobenumfang relativ gering ist \citep[60$>$N$>$15,vgl.][91]{bortz1990verteilungsfreie}. Der Unterschied zum herkömmlichen Pearson's) $\chi$^{2}-Test besteht dabei darin, dass die $\chi$^{2}-Werte anstatt nach Formel (\ref{eq:chi}) nach Formel (\ref{eq:chiyates}) berechnet werden.

\begin{equation}
\frac{(|beobachteter Wert – erwarteter Wert|-0.5)^{2}}{erwarteter Wert}
\label{eq:chiyates}
\end{equation}

Damit würde sich für unser Beispiel anstatt Tabelle ({\ref{tab:x2}) die folgende Tabelle (\ref{tab:x2yates}) führen. Es ist hierbei zu bedenken, dass in unserem Fall keine Yates-Korrektur angebracht wäre, da unsere Stichprobe den Wert von 60 Fällen stark überschreitet.

\begin{table}[H]
\begin{minipage}{\textwidth}
\begin{center}
\begin{footnotesize}
\begin{tabular}{l | c | c | c |}
\hline
& \textbf{BrE} & \textbf{AmE} & Zeilensumme \\
\hline
\textbf{kind of} & 32.9927 & 113.0407 & 146.0335 \\
\textbf{sort of} & 16.3593 & 56.0507 & 72.4100 \\
\hline
Spaltensumme & 49.3520 & 169.0914 & \textbf{218.4434} \\
\hline
\end{tabular}
\end{footnotesize}
\caption{Korrigierte $\chi$2-Werte von \textit{sort of} und \textit{kind of} in BrE und AmE}
\label{tab:x2yates}
\end{center}
\end{minipage}
\end{table}

Es zeigt sich, dass die Yates-Korrektur zu einem etwas geringerem $\chi$^{2}-Wert führt und sie somit zu konservativeren Ergebnissen führt, als es nach Pearson der Fall wäre.

\subsubsection{Chi-Quadrat-Tests bei Einzelvergleichen innerhalb von 2*k-Tabellen}
Obwohl der $\chi$^{2}-Test weit verbreitet ist und insgesamt sehr robust ist, wird er doch häufig falsch verwendet. Dies geschieht insbesondere dann, wenn man den Test auf Tabellen anwendet, die mehr als zwei Spalten oder Zeilen haben. Es ist sehr wichtig festzuhalten, dass man für Untersuchungen, in denen man Teiltabellen auf Signifikanz testen möchte nicht den gewöhnlichen $\chi$^{2}-Test, sondern abgewandelte Varianten nutzen muss. Im Folgenden sollen zwei Beispiele darstellen, wie man in solchen Fällen vorgehen sollte.

Im ersten Fall handelt es sich um eine Tabelle mit 2 Spalten aber mehreren Zeilen, einer sogenannten 2*k-Tabelle. Um zu testen, ob eine der Ausprägungen in den Zeilen signifikant häufiger ist als eine andere sollte man die Formel, die von \citep[126--127]{bortz1990verteilungsfreie} dargelegt wird, implementieren.

In diesem Beispiel geht es darum, ob weiche Röntgenstrahlen sich von harten Röntgenstrahlen im Hinblick auf das Erreichen bzw. Nicht-Erreichen des Mitosestadiums bei Heuschreckenneuroblasten unterscheiden. Die zugrundeliegende Datentabelle sieht wie folgt aus.

\begin{table}[H]
\begin{minipage}{\textwidth}
\begin{center}
\begin{footnotesize}
\begin{tabular}{l | c | c | c |}
\hline
& \textbf{Mitose nicht erreicht} & \textbf{Mitose erreicht} & \textbf{Summe} \\
\hline
Röntgen weich & 21 & 14 & 35 \\
Röntgen hart & 18 & 13 & 31 \\
$\beta$-Strahlen & 24 & 12 & 36 \\
Licht & 13 & 30 & 43 \\
\hline
Summe & 76 & 69 & 145 \\
\hline
\end{tabular}
\end{footnotesize}
\caption{Datentabelle aus \citep[126]{bortz1990verteilungsfreie}}
\label{tab:2byk}
\end{center}
\end{minipage}
\end{table}

Würde man einen einfachen $\chi$^{2}-Test rechnen, so würde man unterschlagen, dass die Daten in Zusammenhang mit anderen Daten erhoben wurden und somit nicht unabhängig sind. Wir werden zunächst einen einfachen (falschen) $\chi$^{2}-Test rechnen, um dann die korrekte Variante zu berechnen, und die Ergebnisse zu vergleichen.

\begin{lstlisting}
source("http://martinschweinberger.de/docs/scripts/x2.2k.r")
# daten generieren
chitb2 <- matrix(c(21, 14, 18, 13, 24, 12, 13, 30), byrow = T, nrow = 4)
colnames(chitb2) <- c("erreicht", "nichterreicht")
rownames(chitb2) <- c("rweich", "rhart", "beta", "licht")
# teiltabelle extrahieren
chitb3 <- matrix(c(21, 14, 18, 13), byrow = T, nrow = 2)
colnames(chitb3) <- c("erreicht", "nichterreicht")
rownames(chitb3) <- c("rweich", "rhart")
# einfacher x2-test
chisq.test(chitb3, corr = F)

x2.2k(chitb2, 1, 2)
\end{lstlisting}

Hier die Ergebnisse in tabellarischer Form.
\begin{table}[H]
\begin{minipage}{\textwidth}
\begin{center}
\begin{footnotesize}
\begin{tabular}{l c c }
\hline
& \textbf{$\chi$^{2}-Test} & \textbf{$\chi$^{2}-Test bei 2*k-Tabellen} \\
\hline
$\chi$^{2}-Wert & 0.0255 & 0.025 \\
p-Wert & 0.8732 & 0.8744 \\
\hline
\end{tabular}
\end{footnotesize}
\caption{Datentabelle aus \citep[126]{bortz1990verteilungsfreie}}
\label{tab:2byk}
\end{center}
\end{minipage}
\end{table}

Wie sich zeigt, kommen zwar beide Tests zu den gleichen Ergebnissen, jedoch unterscheiden sich die Resultate minimal.
Dies ist nicht immer der Fall, da die Ergebnisse stark variieren können!

\subsubsection{Chi-Quadrat-Tests bei Einzelvergleichen innerhalb von z*k-Tabellen}\label{chi2zk}
Eine weitere Anwendung, bei der der $\chi$^{2}-Test häufig inkorrekter Weise verwendet wird, ist das Testen von Teilen von Tabellen mit mehr als zwei Zeilen und mehr als zwei Spalten, d.h. z*k-Tabellen (z: Zeile, k: Kolumne). Ein Beispiel wird in \citep{gries2014frequency} besprochen, der auch das \verb!R!-Skript für die korrekte Version des $\chi$^{2}-Test erstellt hat.

Laden wir zuerst die Daten, die in dem Beispiel von \citep[9]{gries2014frequency} besprochen werden, in dem es darum geht, ob sich nicht nur Register und EMOTION-Metaphern unterscheiden, sondern auch darum, ob sich gesprochene Konversationen von Fiktion im Gebrach von EMOTION IST LICHT und EMOTION IST EINE NATURKRAFT unterscheiden.
\begin{lstlisting}
x <- matrix(c(8, 31, 44, 36, 5, 14, 25, 38, 4, 22, 17, 12, 8, 11, 16, 24), ncol=4)
attr(x, "dimnames")<-list(Register=c("acad", "spoken", "fiction", "new"),
Metaphor = c("Heated fluid", "Light", "NatForce", "Other"))
\end{lstlisting}

Es ergibt sich aus diesen Daten Tabelle (\ref{tab:chisub}).

\begin{table}[H]
\begin{minipage}{\textwidth}
\begin{center}
\begin{footnotesize}
\begin{tabular}{l cccc }
\hline
& \multicolumn{4}{c}{Metaphor} \\
Register & Heated fluid & Light & NatForce & Other \\
\hline
acad & 8 & 5 & 4 & 8 \\
spoken & 31 & 14 & 22 & 11 \\
fiction & 44 & 25 & 17 & 16 \\
new & 36 & 38 & 12 & 24 \\
\hline
\end{tabular}
\end{footnotesize}
\caption{Datentabelle aus \citet[9]{gries2014frequency}}
\label{tab:chisub}
\end{center}
\end{minipage}
\end{table}

Würden wir einen normalen (hier inkorrekten) $\chi$^{2}-Test verwenden, so würde sich ergeben, dass sich gesprochene Konversationen nicht signifikant von Fiktion im Gebrach von EMOTION IST LICHT und EMOTION IST EINE NATURKRAFT unterscheiden ($\chi$^{2}=3.3016, df=1, p$=$.069, $\phi$ = .2057).
\begin{lstlisting}
subtable <- matrix(c(14, 25, 22, 17), ncol=2)
chisq.results <- chisq.test(subtable, correct=FALSE) # WRONG!
phi.coefficient = sqrt(chisq.results$statistic / sum(subtable) * (min(dim(subtable))-1))
chisq.results
phi.coefficient
\end{lstlisting}

Die korrekte Analyse berücksichtigt hierbei, dass es sich um eine Untertabelle handelt, die nicht unabhängig von der Gesamttabelle ist. Dies bedeutet, dass die korrekte Analyse die gesamte Anzahl der Fälle, sowie die Gesamtzeilen- und Gesamtspaltensummen zu berücksichtigen sind \citep[vgl.][144--148]{bortz1990verteilungsfreie}.

Um die korrekte Analyse durchführen zu können, muss die Analyse von Funktion von \citep[144--148]{bortz1990verteilungsfreie} implementiert oder direkt die Funktion von Gries eingelesen und auf die Teiltabelle angewandt werden.

\begin{lstlisting}
source("http://martinschweinberger.de/docs/scripts/sub.table.r") # funktion zur analyse von untertabellen
results <- sub.table(x, 2:3, 2:3, out="short")
results
\end{lstlisting}

Die letzte Zeile des Outputs informiert uns, dass der Unterschied tatsächlich signifikant ist ($\chi$^{2}=3.864, df=1, p$=$.049*).

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
summary(cars)
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
