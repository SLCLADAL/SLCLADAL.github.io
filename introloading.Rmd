---
title: "Loading and Exporting Data"
author: "UQ SLC Digital Team"
date: "`r format(Sys.time(), '%Y-%m-%d')`"
output:
  bookdown::html_document2: default
bibliography: bibliography.bib
link-citations: yes
---
```{r uq1, echo=F, fig.cap="", message=FALSE, warning=FALSE, out.width='100%'}
knitr::include_graphics("images/uq1.jpg")
```

# Edit data with R

In the following, we will briefly discuss how to import data into "R" and then export results from "R".

## Setting the workspace

It makes sense to set the "Workspace" at the beginning of each session, meaning that you specify the path to a folder that serves as the default location, so you just have to specify which object you want to save or load from the folder without This workspace is individually different and needs to be determined and specified by the user himself In the current case, we specify the folder that contains the materials for this book, for example, my own location even if you need to adjust this path to match your computer, I'll let "R" show the path to the workspace. 


```{r echo=T, eval = F, message=FALSE, warning=FALSE}
# Setting workspace
#setwd("D:\\StatisticsForLinguists")
# show workspace
getwd ()
```

From now on, we no longer need to specify the entire path to the files, just the name of the object we want to load.

## Importing Data

This book is not an introduction to "R", i. we will go through only the most necessary orders. You need these commands to import data, export data, or perform statistical tests. We will first look at the command you use to import data. You import data into "R" so that "R" will then have this data available and you can edit it in "R". The easiest way is to interactively import the data, i. "R" opens a navigation window and you search for the data in this window. To interactively open a tap-stop-separated .txt file, you need to enter the following command in R: 

```{r echo=T, message=FALSE, warning=FALSE}
#mydata <- read.table(choose.files(), header = T, sep = "\t", quote = "", comment.char = "")
```

The command (or the function to be precise) contains a number of arguments, which we should briefly discuss here. To get help on functions, enter the command "? Package name" in "R" (of course, the name of the function must be used instead of the sequence "package name"). Now to our function: First we define an object, "mydata", to which we assign the result of the function "read.table" with the sequence "<-". Now we define the function "read.table". This function requires the following arguments: choose.files (), header, sep, quote, and comment.char. "choose.files()" says "R" that we are interactively navigating the file with a browser. "choose.files()" can also be replaced by the exact path to the file (e.g., "D:\\03-MyProjects\\03RorLinguists / testdata1.txt ""). In this case, "R" reads the file directly from the specified source. If the direct path is specified then double backslashes instead of simple backslashes or forwardslashes for directories, but simple forwardslashes for individual files must be set. The header argument is needed to indicate whether the table has headings or not. If the data has headings, set "header = T".

The sep argument is very important because it indicates how the data points in the driven file are separated. In most cases, the data points will be tab separated, but there are also comma-separated files (.csv).

The "\t" indicates that the data points are tab-separated, whereas "sep =" "" would indicate that the data points are separated by spaces and "sep =", "" would indicate that the data points passed through Commas are separated. The argument "quote" informs "R" that certain characters delineate quotes. The argument "comment.char" informs "R" that certain characters are not to be read as normal characters, but are programming comments.

To read spreadsheets directly from Microsoft Excel, you must first install and enable the xlsx package. To install this package enter the command "install.package (" xlsx ")" and press "Enter"). The package "xlsx" is activated by the command "library (xlsx)".

```{r echo=T, eval = F, message=FALSE, warning=FALSE}
install.package("xlsx")
library(xlsx)
# define path to data
path <- "data/testdata1.xlsx"
# load data
mydataxlsx <- read.xlsx(path, 1)
#mydataxlsx <- read.xlsx(choose.files(), 1)
```

To look at the loaded data, give the names of the object containing the data. In our case we called the object "mydata". So enter "mydata" into the "R" GUI and "R" will show you the loaded data. With "str (mydata)" "R" shows you the structure of your data record. The command "head (mydata)" outputs the first six lines or elements of a data object.

## Exporting data

The following is about how data from "R" can be stored on your computer. The most common way to save a tab-separated .txt file on your machine is write.table. This function needs the following arguments: The first argument "file" is the object to be saved. "file" does not have to be written out, but should be mentioned first. The second argument "path" is the indication where "R" should save the file. Since we set the workspace, we only have to tell "R" which name we want to give to the object to be stored. Again, the argument does not have to be named. The following arguments, sep, col.names, and row.names, are the delimiter (either tab, comma, or space), and whether there are rows or column names in the object.

```{r echo=T, eval = F, message=FALSE, warning=FALSE}
# define path to data
outpath <- "data/data01.txt"
# save data to pc
write.table (file = mydata, path = outpath, sep = "\t", col.names = TRUE, row.names = F, quote = F)
```

To save data directly as a Microsoft Excel file you must first activate the package "xlsx" and then apply the "write.xlsx" command:

```{r echo=T, eval = F, message=FALSE, warning=FALSE}
library (xlsx)
write.xlsx (mydata, "data/testdata.xlsx")
```


