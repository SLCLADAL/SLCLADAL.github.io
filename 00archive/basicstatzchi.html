<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="UQ SLC Digital Team" />

<meta name="date" content="2020-04-15" />

<title>The Chi-Square Family of Tests with R</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">LADAL</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-play-circle"></span>
     
    Basics
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">Basics</li>
    <li>
      <a href="introcomputer.html">General Tips on Computering</a>
    </li>
    <li class="divider"></li>
    <li>
      <a href="introquant.html">Introduction To Quantitative Reasoning</a>
    </li>
    <li>
      <a href="basicquant.html">Basic Concepts In Quantitative Reasoning</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-gear"></span>
     
    Data Processing
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">Data Processing</li>
    <li>
      <a href="intror.html">Basics: Getting started with R</a>
    </li>
    <li>
      <a href="introloading.html">Loading and saving data</a>
    </li>
    <li>
      <a href="stringprocessing.html">String processing</a>
    </li>
    <li>
      <a href="regularexpressions.html">Regular expressions</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-bar-chart"></span>
     
    Visualization
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">Visualization</li>
    <li>
      <a href="basicgraphs.html">Visualizing Data with R</a>
    </li>
    <li>
      <a href="maps.html">Geo-Spatial Data Visualization in R</a>
    </li>
    <li>
      <a href="motion.html">Motion Charts in R</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-eye"></span>
     
    Statistics
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">Statistics</li>
    <li>
      <a href="descriptivestatz.html">Descriptive Statistics</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">Basic Interential Statistics</li>
    <li>
      <a href="basicstatz.html">Basic Inferential Tests</a>
    </li>
    <li>
      <a href="basicstatzchi.html">The Chi-Square Family</a>
    </li>
    <li>
      <a href="basicstatzregression.html">Simple Linear Regression</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">Advanced Interential Statistics</li>
    <li>
      <a href="fixedregressions.html">Fixed-Effects Regression Models</a>
    </li>
    <li>
      <a href="mixedregressions.html">Mixed-Effects Regression Models</a>
    </li>
    <li>
      <a href="advancedstatztrees.html">Tree-Based Models</a>
    </li>
    <li>
      <a href="groupingstatz.html">Classification</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-bars"></span>
     
    Text Analytics
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="textanalysis.html">Text Analysis and Distant Reading</a>
    </li>
    <li>
      <a href="webcrawling.html">Web Crawling</a>
    </li>
    <li>
      <a href="basicnetwork.html">Network Analysis</a>
    </li>
    <li>
      <a href="collocations.html">Co-occurrence and Collocation Analysis</a>
    </li>
    <li>
      <a href="topicmodels.html">Topic Modeling</a>
    </li>
    <li>
      <a href="classification.html">Classification</a>
    </li>
    <li>
      <a href="tagging.html">Tagging and Parsing</a>
    </li>
    <li>
      <a href="corplingr.html">Corpus Linguistics</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="about.html">
    <span class="fa fa-info"></span>
     
    Contact
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">The Chi-Square Family of Tests with R</h1>
<h4 class="author">UQ SLC Digital Team</h4>
<h4 class="date">2020-04-15</h4>

</div>


<p><img src="images/uq1.jpg" width="100%" /></p>
<div id="introduction" class="section level1">
<h1><span class="header-section-number">1</span> Introduction</h1>
<p>This tutorial introduces the <span class="math inline">\(\chi\)</span><sup>2</sup> family of tests. The entire code for the sections below can be downloaded <a href="https://slcladal.github.io/rscripts/basicstatzchirscript.r">here</a>.</p>
<p><strong>Preparation and session set up</strong></p>
<p>As all visualizations in this tutorial rely on R, it is necessary to install R and RStudio. If these programs (or, in the case of R, environments) are not already installed on your machine, please search for them in your favorite search engine and add the term “download”. Open any of the first few links and follow the installation instructions (they are easy to follow, do not require any specifications, and are pretty much self-explanatory).</p>
<p>In addition, certain <em>packages</em> need to be installed from an R <em>library</em> so that the scripts shown below are executed without errors. Before turning to the code below, please install the packages by running the code below this paragraph. If you have already installed the packages mentioned below, then you can skip ahead ignore this section. To install the necessary packages, simply run the following code - it may take some time (between 1 and 5 minutes to install all of the packages so you do not need to worry if it takes some time).</p>
<pre class="r"><code># clean current workspace
rm(list=ls(all=T))
# set options
options(stringsAsFactors = F)
# install libraries
install.packages(c(&quot;stringr&quot;, &quot;cfa&quot;, &quot;dplyr&quot;))</code></pre>
<p>Once you have installed R, R-Studio, and have also initiated the session by executing the code shown above, you are good to go.</p>
</div>
<div id="pearsonss-chi-square-test" class="section level1">
<h1><span class="header-section-number">2</span> (Pearsons’s) Chi-Square Test</h1>
<p>This tutorial focuses on the most frequently used statistical test in linguistics: the <span class="math inline">\(\chi\)</span><sup>2</sup> test (or Pearsons’s chi-square test, chi-squared test, or chi-square test). We will use a simple, practical example to explore how this test works. In this example, we will test whether speakers of American English (AmE) and speakers of British English (BrE) differ in their use of the near-synonyms <em>sort of</em> and <em>kind of</em> as in “<em>He’s sort of stupid</em>” and “<em>He’s kind of stupid</em>”. As a first step, we formulate the hypothesis that we want to test (H<sub>1</sub>) and its Nullhypothesis (H<sub>0</sub>). The Alternative- or Test Hypothesis reads:</p>
<p>H<sub>1</sub>: Speakers of AmE and BrE differ with respect to their preference for <em>sort of</em> und <em>kind of</em>.</p>
<p>while the Null Hypothesis (H<sub>0</sub>) states</p>
<p>H<sub>0</sub>: Speakers of AmE and BrE do not differ with respect to their preference for <em>sort of</em> und <em>kind of</em>.</p>
<p>The H<sub>0</sub> claims the non-existence of something (which is the more conservative position) and in our example the non-existence of a correlation between variety of English and the use of <em>sort of</em> und <em>kind of</em>. The question now arises what has to be the case in order to reject the H<sub>0</sub> in favour of the H<sub>1</sub>.</p>
<p>To answer this question, we require information about the probability of error, i.e. the probability that the H<sub>0</sub> does indeed hold for the entire population. Before performing the chi-square test, we follow the convention that the required significance level is 5 percent. In other words, we will reject the H<sub>0</sub> if the likelihood for the H<span class="math inline">\(_{0}\)</span> being true is less than 5 percent given the distribution of the data. In that case, i.e. in case that the likelihood for the H<sub>0</sub> being true is less than 5 percent, we consider the result of the chi-square test as statistically significant. This means that the observed distribution makes it very unlikely that there is no correlation between the variety of English and the use of <em>sort of</em> and <em>kind of</em>.</p>
<p>Let us now assume that we have performed a search for <em>sort of</em> and <em>kind of</em> in two corpora representing American and British English and that we have obtained the following frequencies:</p>
<table>
<caption>Observed frequencies of <em>sort of</em> and <em>kind of</em> in American and British English</caption>
<thead>
<tr class="header">
<th></th>
<th align="right">BrE</th>
<th align="right">AmE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>kindof</td>
<td align="right">181</td>
<td align="right">655</td>
</tr>
<tr class="even">
<td>sortof</td>
<td align="right">177</td>
<td align="right">67</td>
</tr>
</tbody>
</table>
<p>In a first step, we now have to calculate the row and column sums of our table.</p>
<table>
<caption>Observed frequencies of <em>sort of</em> and <em>kind of</em> in American and British English with row and column totals</caption>
<thead>
<tr class="header">
<th></th>
<th align="right">BrE</th>
<th align="right">AmE</th>
<th align="right">Total</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>kindof</td>
<td align="right">181</td>
<td align="right">655</td>
<td align="right">836</td>
</tr>
<tr class="even">
<td>sortof</td>
<td align="right">177</td>
<td align="right">67</td>
<td align="right">244</td>
</tr>
<tr class="odd">
<td>Total</td>
<td align="right">358</td>
<td align="right">722</td>
<td align="right">1080</td>
</tr>
</tbody>
</table>
<p>Next, we calculate, the values that would have expected if there was no correlation between variety of English and the use of <em>sort of</em> and <em>kind of</em>. In order to get these “expected” frequencies, we apply the equation below to all cells in our table.</p>
<p><span class="math inline">\(\frac{Column total*Row total}{Overall total}\)</span></p>
<p>In our example this means that for the cell with [+]BrE [+]kindof we get:</p>
<p><span class="math inline">\(\frac{836*358}{1080} = \frac{299288}{1080} = 277.1185\)</span></p>
<p>For the entire table this means we get the following expected values:</p>
<table>
<caption>Expected frequencies of <em>sort of</em> and <em>kind of</em> in American and British English with row and column totals</caption>
<thead>
<tr class="header">
<th></th>
<th align="right">BrE</th>
<th align="right">AmE</th>
<th align="right">Total</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>kindof</td>
<td align="right">277.11850</td>
<td align="right">558.8815</td>
<td align="right">836</td>
</tr>
<tr class="even">
<td>sortof</td>
<td align="right">80.88148</td>
<td align="right">163.1185</td>
<td align="right">244</td>
</tr>
<tr class="odd">
<td>Total</td>
<td align="right">358.00000</td>
<td align="right">722.0000</td>
<td align="right">1080</td>
</tr>
</tbody>
</table>
<p>In a next step, we calculate the contribution of each cell to the overall <span class="math inline">\(\chi\)</span><sup>2</sup> value (<span class="math inline">\(\chi\)</span><sup>2</sup> contribution). To get <span class="math inline">\(\chi\)</span><sup>2</sup> contribution for each cell, we apply the equation below to each cell.</p>
<p><span class="math inline">\(\frac{(observed – expected)^{2}}{expected}\)</span></p>
<p>In our example this means that for the cell with [+]BrE [+]kindof we get:</p>
<p><span class="math inline">\(\frac{(181 – 277.1185)^{2}}{277.1185} = \frac{-96.1185^{2}}{277.1185} = \frac{9238.766}{277.1185} = 33.33868\)</span></p>
<p>For the entire table this means we get the following <span class="math inline">\(\chi^{2}\)</span> values:</p>
<table>
<caption>Chi values of <em>sort of</em> and <em>kind of</em> in American and British English with row and column totals</caption>
<thead>
<tr class="header">
<th></th>
<th align="right">BrE</th>
<th align="right">AmE</th>
<th align="right">Total</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>kindof</td>
<td align="right">33.33869</td>
<td align="right">16.53082</td>
<td align="right">49.86951</td>
</tr>
<tr class="even">
<td>sortof</td>
<td align="right">114.22602</td>
<td align="right">56.63839</td>
<td align="right">170.86440</td>
</tr>
<tr class="odd">
<td>Total</td>
<td align="right">147.56470</td>
<td align="right">73.16921</td>
<td align="right">220.73390</td>
</tr>
</tbody>
</table>
<p>The sum of <span class="math inline">\(\chi\)</span><sup>2</sup> contributions in our example is 220.7339. To see if this value is statistically significant, we need to calculate the degrees of freedom because the <span class="math inline">\(\chi\)</span> distribution differs across degrees of freedom. Degrees of freedom are calculated according to the equation below.</p>
<p><span class="math inline">\(DF = (rows -1) * (columns – 1) = (2-1) * (2-1) = 1 * 1 = 1\)</span></p>
<p>In a last step, we check whether the <span class="math inline">\(\chi\)</span><sup>2</sup> value that we have calculated is higher than a critical value (in which case the correlation in our table is significant). Degrees of freedom are relevant here because the critical values are dependent upon the degrees of freedom: the more degrees of freedom, the higher the critical value, i.e. the harder it is to breach the level of significance.</p>
<p>Since there is only 1 degree of freedom in our case, we need to consider only the first column in the table of critical values below.</p>
<table>
<caption>Critical chi values for 1 to 5 degrees of freedom</caption>
<thead>
<tr class="header">
<th align="right">DF</th>
<th align="right">p&lt;.05</th>
<th align="right">p&lt;.01</th>
<th align="right">p&lt;.001</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">3.84</td>
<td align="right">6.64</td>
<td align="right">10.83</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">5.99</td>
<td align="right">9.21</td>
<td align="right">13.82</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="right">7.82</td>
<td align="right">11.35</td>
<td align="right">16.27</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="right">9.49</td>
<td align="right">13.28</td>
<td align="right">18.47</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="right">11.07</td>
<td align="right">15.09</td>
<td align="right">20.52</td>
</tr>
</tbody>
</table>
<p>Since the <span class="math inline">\(\chi\)</span><sup>2</sup> value that we have calculated is much higher than the critical value provided for p&lt;.05, we can reject the H<sub>0</sub> and may now claim that speakers of AmE and BrE differ with respect to their preference for <em>sort of</em> und <em>kind of</em>.</p>
<p>Before we summarize the results, we will calculate the effect size which is a measure for how strong the correlations are.</p>
<div id="effect-sizes-in-chi-square" class="section level2">
<h2><span class="header-section-number">2.1</span> Effect Sizes in Chi-Square</h2>
<p>Effect sizes are important because they correlations may be highly significant but the effect between variables can be extremely weak. The effect size is therefore a measure how strong the correlation or the explanatory and predictive power between variables is.</p>
<p>The effect size measure for <span class="math inline">\(\chi\)</span><sup>2</sup> tests can be either the <span class="math inline">\(\phi\)</span>-coefficient (phi-coefficient) or Cramer’s <span class="math inline">\(\phi\)</span> (Cramer’s phi). The <span class="math inline">\(\phi\)</span>-coefficient is used when dealing with 2x2 tables while Cramer’s <span class="math inline">\(\phi\)</span> is used when dealing with tables with more than 4 cells. The <span class="math inline">\(\phi\)</span> coefficient can be calculated by using the equation below (N = overall sample size).</p>
<p><span class="math inline">\(\phi = \sqrt{\frac{\chi^{2}}{N}}\)</span></p>
<p>In our case, this means:</p>
<p><span class="math inline">\(\phi = \sqrt{\frac{220.7339}{1080}} = \sqrt{0.2043832} = 0.4520876\)</span></p>
<p>The <span class="math inline">\(\phi\)</span> coefficient varies between 0 (no effect) and 1 (perfect correlation). For the division into weak, moderate and strong effects one can follow the division for <span class="math inline">\(\omega\)</span> (small omega), so that with values beginning with .1 represent weak, values between 0.3 and .5 represent moderate and values above .5 represent strong effects <span class="citation">(Bühner and Ziegler <a href="#ref-buehner2009statistik" role="doc-biblioref">2009</a>, 266)</span>. So, in this example we are dealing with a medium-sized effect/correlation.</p>
</div>
<div id="chi-square-in-r" class="section level2">
<h2><span class="header-section-number">2.2</span> Chi-Square in R</h2>
<p>Before we summarize the results, we will see how to perform a chi-square test in <code>R</code>. In addition to what we have done above, we will also visualize the data. To begin with, we will have a look at the data set (which is the same data we have used above).</p>
<pre class="r"><code>chidata              # inspect data</code></pre>
<pre><code>##        BrE AmE
## kindof 181 655
## sortof 177  67</code></pre>
<p>We will now visualize the data with an association. Bars above the dashed line indicate that a feature combination occurs more frequently than expected by chance. The width of the bars indicates the frequency of the feature combination.</p>
<p><img src="basicstatzchi_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<p>The fact that the bars are distributed complimentarily (top left red and below bar; top right black above bar; bottom left black above bar; bottom right red below bar) indicates that the use of “sort of” and “kind of” differs across AmE and BrE. We will check whether the mosaic plot confirms this impression.</p>
<pre class="r"><code>mosaicplot(chidata, shade = TRUE, type = &quot;pearson&quot;, main = &quot;&quot;)  # mosaic plot</code></pre>
<p><img src="basicstatzchi_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<p>The colour contrasts in the mosaic plot substantiate the impression that the two varieties of English differ significantly. To ascertain whether the differences are statistically significant, we can now apply the chi-square test.</p>
<pre class="r"><code>chisq.test(chidata, corr = F)  # perform chi square test</code></pre>
<pre><code>## 
##  Pearson&#39;s Chi-squared test
## 
## data:  chidata
## X-squared = 220.73, df = 1, p-value &lt; 2.2e-16</code></pre>
<p>The results reported by <code>R</code> are identical to the results we derived by hand and confirm that BrE and AmE differ significantly in their use of “sort of” and “kind of”. In a next step, we calculate the effect size.</p>
<pre class="r"><code># calculate effect size
sqrt(chisq.test(chidata, corr = F)$statistic / sum(chidata) * (min(dim(chidata))-1))</code></pre>
<pre><code>## X-squared 
## 0.4520877</code></pre>
<p>The phi coefficient of .45 shows that variety of English correlates moderately with the use of “sort of” and “kind of”. We will now summarize the results.</p>
</div>
<div id="summarizing-chi-square-results" class="section level2">
<h2><span class="header-section-number">2.3</span> Summarizing Chi-Square Results</h2>
<p>The results of our analysis can be summarised as follows: A <span class="math inline">\(\chi\)</span><sup>2</sup>-test confirms a highly significant correlation of moderate size between the variety of English and the use of the near-synonymous hedges <em>sort of</em> and <em>kind of</em> (<span class="math inline">\(\chi\)</span><sup>2</sup> = 220.73, df = 1, p &lt; .001***, <span class="math inline">\(\phi\)</span> = .452).</p>
</div>
<div id="requirements-of-chi-square" class="section level2">
<h2><span class="header-section-number">2.4</span> Requirements of Chi-Square</h2>
<p>Chi-square tests depend on certain requirements that, if violated, negatively affect the reliability of the results of the test. To provide reliable results, 80 percent of cells in a table to which the chi-square test is applied have to have expected values of 5 or higher and at most 20 percent of expected values can be smaller than 5 <span class="citation">(see Bortz, Lienert, and Boehnke <a href="#ref-bortz1990verteilungsfreie" role="doc-biblioref">1990</a>, 98)</span>. In addition, none of the expected values can be smaller than 1 <span class="citation">(see Bortz, Lienert, and Boehnke <a href="#ref-bortz1990verteilungsfreie" role="doc-biblioref">1990</a>, 136)</span> because then, the estimation, which relies on the <span class="math inline">\(\chi\)</span><sup>2</sup>-distribution, becomes too imprecise to allow meaningful inferences <span class="citation">(Cochran <a href="#ref-cochran1954somemethods" role="doc-biblioref">1954</a>)</span>.</p>
<p>If these requirements are violated, then the <em>Fisher’s Exact Test</em> is more reliable and offers the additional advantage that these tests can also be applied to data that represent very small sample sizes. When applying the Fisher’s Exact Test, the probabilities for all possible outcomes are calculated and the summed probability for the observed or more extreme results are determined. If this sum of probabilities exceeds five percent, then the result is deemed statistically significant.</p>
</div>
<div id="chi-square-exercises" class="section level2">
<h2><span class="header-section-number">2.5</span> Chi-Square Exercises</h2>
<ol style="list-style-type: decimal">
<li>Imagine you are interested in whether older or younger speakers tend to refer to themselves linguistically. The underlying hypothesis is that - contrary to common belief - older people are more narcissistic compared with younger people. Given this research question, perform a chi-square test and summarize the results on the data below.</li>
</ol>
<table>
<caption>Table adapted from Gries (2014: 9)</caption>
<thead>
<tr class="header">
<th></th>
<th align="left">1SGPN</th>
<th align="left">PN without 1SG</th>
<th align="left">Total</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Young</td>
<td align="left">61</td>
<td align="left">43</td>
<td align="left">104</td>
</tr>
<tr class="even">
<td>Old</td>
<td align="left">42</td>
<td align="left">36</td>
<td align="left">78</td>
</tr>
<tr class="odd">
<td>Total</td>
<td align="left">103</td>
<td align="left">79</td>
<td align="left">182</td>
</tr>
</tbody>
</table>
<ol start="2" style="list-style-type: decimal">
<li>Imagine you are interested in whether young men or young women exhibit a preference for the word <em>whatever</em> because you have made the unsystematic, anecdotal observation that young men use this word more frequently than young women. Given this research question, perform a chi-square test and summarize the results on the data below.</li>
</ol>
<table class="table table-striped" style="">
<caption>
Observed frequency with row- and column totals for the use of <em>whatever</em> by male and female speakers.
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
YoungMales
</th>
<th style="text-align:left;">
YoungFemales
</th>
<th style="text-align:left;">
Total
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
whatever
</td>
<td style="text-align:left;">
17
</td>
<td style="text-align:left;">
55
</td>
<td style="text-align:left;">
71
</td>
</tr>
<tr>
<td style="text-align:left;">
other words
</td>
<td style="text-align:left;">
345128
</td>
<td style="text-align:left;">
916552
</td>
<td style="text-align:left;">
1261680
</td>
</tr>
<tr>
<td style="text-align:left;">
Total
</td>
<td style="text-align:left;">
345145
</td>
<td style="text-align:left;">
916607
</td>
<td style="text-align:left;">
1261752
</td>
</tr>
</tbody>
</table>
<ol start="3" style="list-style-type: decimal">
<li>Find a partner and discuss the relationship between significance and effect size. Then, go and find another partner and discuss problems that may arise when testing the frequency of certain words compared with the overall frequency of words in a corpus.</li>
</ol>
</div>
</div>
<div id="extensions-of-chi-square" class="section level1">
<h1><span class="header-section-number">3</span> Extensions of Chi-Square</h1>
<p>In the following, we will have a look at tests and methods that can be used if the requirements for ordinary (Pearson’s) chi-square tests are violated and their use would be inappropriate</p>
<div id="the-yates-correction" class="section level2">
<h2><span class="header-section-number">3.1</span> The Yates-Correction</h2>
<p>If all requirements for ordinary chi-square tests are acceptable and only the sample size is the issue, then applying a so-called <em>Yates-correction</em> may be appropriate. This type of correction is applied in cases where the overall sample size lies in-between 60 and 15 cases (<span class="citation">(Bortz, Lienert, and Boehnke <a href="#ref-bortz1990verteilungsfreie" role="doc-biblioref">1990</a>)</span> 91). The difference between the ordinary chi-square and a Yates-corrected chi-square lies in the fact that the Yates-corrected chi-square is calculated according to the equation below.</p>
<p><span class="math inline">\(\frac{(|observed – expected|-0.5)^{2}}{expected}\)</span></p>
<p>According to this formula, we would get the values shown below rather than the values tabulated above. It is important to note here that this is only a demonstration because a Yates-Correction would actually be inappropriate as our sample size exceeds 60 cases.</p>
<table>
<caption>
Corrected chi-square values for sort of and kind of in BrE and AmE
</caption>
<thead>
<tr>
<th style="text-align:left;">
Variant
</th>
<th style="text-align:left;">
BrE
</th>
<th style="text-align:left;">
AmE
</th>
<th style="text-align:left;">
Total
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
kind of
</td>
<td style="text-align:left;">
32.9927
</td>
<td style="text-align:left;">
113.0407
</td>
<td style="text-align:left;">
146.0335
</td>
</tr>
<tr>
<td style="text-align:left;">
sort of
</td>
<td style="text-align:left;">
16.3593
</td>
<td style="text-align:left;">
56.0507
</td>
<td style="text-align:left;">
72.41
</td>
</tr>
<tr>
<td style="text-align:left;">
Total
</td>
<td style="text-align:left;">
49.352
</td>
<td style="text-align:left;">
169.0914
</td>
<td style="text-align:left;">
218.4434
</td>
</tr>
</tbody>
</table>
<p>If the Yates-correction were applied, then this results in a slightly lower <span class="math inline">\(\chi\)</span><sup>2</sup>-value and thus in more conservative results compared with the traditional test according to Pearson.</p>
</div>
<div id="chi-square-within-2k-tables" class="section level2">
<h2><span class="header-section-number">3.2</span> Chi-Square within 2*k Tables</h2>
<p>Although the <span class="math inline">\(\chi\)</span><sup>2</sup>-test is widely used, it is often used inappropriately. This is especially the case when chi-square tests are applied to data representing tables with more than two rows and more than two columns. It is important to note that applying the common Pearson’s’ chi-square test to sub-tables of a larger table is inappropriate because, in such cases, a modified variant of Pearson’s’ chi-square test is warranted. We will go through two examples that represent different scenarios where we are dealing with subsamples of larger tables and a modified version of the <span class="math inline">\(\chi\)</span><sup>2</sup>-test should be used rather than Pearson’s’ chi-square.</p>
<p>In this first example, we are dealing with a table consisting of two columns and multiple rows, a so-called 2*k table (two-by-k table). In order to test if a feature combination, that is represented by a row in the 2*k table, is significantly more common compared with other feature combinations, we need to implement the <span class="math inline">\(\chi\)</span><sup>2</sup>-equation from <span class="citation">(Bortz, Lienert, and Boehnke <a href="#ref-bortz1990verteilungsfreie" role="doc-biblioref">1990</a>, 126–27)</span>.</p>
<p>In this example, we want to find out whether soft and hard X-rays differ in their effect on grasshopper larva. The question is whether the larva reach or do not reach a certain life cycle depending on whether they are exposed to soft X-rays, hard X-rays, light, or beta rays. The data for this example is provided below.</p>
<table>
<caption>
Data adapted from Bortz (1990: 126)
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
Mitosis not reached
</th>
<th style="text-align:left;">
Mitosis reached
</th>
<th style="text-align:left;">
Total
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
X-ray soft
</td>
<td style="text-align:left;">
21
</td>
<td style="text-align:left;">
14
</td>
<td style="text-align:left;">
35
</td>
</tr>
<tr>
<td style="text-align:left;">
X-ray hard
</td>
<td style="text-align:left;">
18
</td>
<td style="text-align:left;">
13
</td>
<td style="text-align:left;">
31
</td>
</tr>
<tr>
<td style="text-align:left;">
Beta-rays
</td>
<td style="text-align:left;">
24
</td>
<td style="text-align:left;">
12
</td>
<td style="text-align:left;">
36
</td>
</tr>
<tr>
<td style="text-align:left;">
Light
</td>
<td style="text-align:left;">
13
</td>
<td style="text-align:left;">
30
</td>
<td style="text-align:left;">
43
</td>
</tr>
<tr>
<td style="text-align:left;">
Total
</td>
<td style="text-align:left;">
76
</td>
<td style="text-align:left;">
69
</td>
<td style="text-align:left;">
145
</td>
</tr>
</tbody>
</table>
<p>If we would apply an ordinary chi-square test, we would ignore that all data were collected together and using only a subsample would ignore the data set of which the subsample is part of. In other words, the subsample is not independent from the other data (as it represents a subsection of the whole data set). However, for exemplary reasons, we will apply an ordinary chi-square test first and then compare its results to results provided by the correct version of the chi-square test. In a first step, we create a table with all the data.</p>
<pre class="r"><code># create tdata
wholetable &lt;- matrix(c(21, 14, 18, 13, 24, 12, 13, 30), byrow = T, nrow = 4)
colnames(wholetable) &lt;- c(&quot;reached&quot;, &quot;notreached&quot;)           # add column names
rownames(wholetable) &lt;- c(&quot;rsoft&quot;, &quot;rhard&quot;, &quot;beta&quot;, &quot;light&quot;) # add row names
wholetable                                                   # inspect data</code></pre>
<pre><code>##       reached notreached
## rsoft      21         14
## rhard      18         13
## beta       24         12
## light      13         30</code></pre>
<p>Now, we extract the subsample from the data.</p>
<pre class="r"><code>subtable &lt;- wholetable[1:2,] # extract subtable
subtable                     # inspect subtable</code></pre>
<pre><code>##       reached notreached
## rsoft      21         14
## rhard      18         13</code></pre>
<p>Next, we apply the ordinary chi-square test to the subsample.</p>
<pre class="r"><code># simple x2-test
chisq.test(subtable, corr = F)</code></pre>
<pre><code>## 
##  Pearson&#39;s Chi-squared test
## 
## data:  subtable
## X-squared = 0.025476, df = 1, p-value = 0.8732</code></pre>
<p>Finally, we perform the correct chi-square test.</p>
<pre class="r"><code># load function for correct chi-square
source(&quot;https://slcladal.github.io/rscripts/x2.2k.r&quot;) 
x2.2k(wholetable, 1, 2)</code></pre>
<pre><code>## $Description
## [1] &quot;rsoft  against  rhard  by  reached  vs  notreached&quot;
## 
## $`Chi-Squared`
## [1] 0.025
## 
## $df
## [1] 1
## 
## $`p-value`
## [1] 0.8744
## 
## $Phi
## [1] 0.013
## 
## $Report
## [1] &quot;Conclusion: the null hypothesis cannot be rejected! Results are not significant!&quot;</code></pre>
<p>Below is a table comparing the results of the two chi-square tests.</p>
<table>
<caption>
Table adapted from Bortz (1990: 126)
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
chi-square
</th>
<th style="text-align:left;">
chi-square in 2*k-tables
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
chi-squared
</td>
<td style="text-align:left;">
0.0255
</td>
<td style="text-align:left;">
0.025
</td>
</tr>
<tr>
<td style="text-align:left;">
p-value
</td>
<td style="text-align:left;">
0.8732
</td>
<td style="text-align:left;">
0.8744
</td>
</tr>
</tbody>
</table>
<p>The comparison shows that, in this example, the results of the two tests are very similar but this may not always be the case.</p>
</div>
<div id="chi-square-within-zk-tables" class="section level2">
<h2><span class="header-section-number">3.3</span> Chi-Square within z*k Tables</h2>
<p>Another application in which the <span class="math inline">\(\chi\)</span><sup>2</sup> test is often applied incorrectly is when ordinary Parsons’s <span class="math inline">\(\chi\)</span><sup>2</sup> tests are used to test portions of tables with more than two rows and more than two columns, that is z*k tables (z: row, k: column). An example is discussed by <span class="citation">Gries (<a href="#ref-gries2014frequency" role="doc-biblioref">2014</a>)</span> who also wrote the <code>R</code> Script for the correct version of the <span class="math inline">\(\chi\)</span><sup>2</sup> test.</p>
<p>Let’s first load the data discussed in the example of <span class="citation">Gries (<a href="#ref-gries2014frequency" role="doc-biblioref">2014</a>)</span> 9. The example deals with metaphors across registers. Based on a larger table, a <span class="math inline">\(\chi\)</span><sup>2</sup> confirmed that registers differ with respect to the frequency of EMOTION metaphors. The more refined question is whether the use of the metaphors EMOTION IS LIGHT and EMOTION IS A FORCE OF NATURE differs between spoken conversation and fiction.</p>
<pre class="r"><code># create table
wholetable &lt;- matrix(c(8, 31, 44, 36, 5, 14, 25, 38, 4, 22, 17, 12, 8, 11, 16, 24), ncol=4)
attr(wholetable, &quot;dimnames&quot;)&lt;-list(Register=c(&quot;acad&quot;, &quot;spoken&quot;, &quot;fiction&quot;, &quot;new&quot;),
Metaphor = c(&quot;Heated fluid&quot;, &quot;Light&quot;, &quot;NatForce&quot;, &quot;Other&quot;))</code></pre>
<p>Based on the table above, we can extract the following subtable.</p>
<table>
<caption>
Table adapted from Gries (2014: 9)
</caption>
<thead>
<tr>
<th style="text-align:left;">
Register
</th>
<th style="text-align:left;">
Heated fluid
</th>
<th style="text-align:left;">
Light
</th>
<th style="text-align:left;">
NatForce
</th>
<th style="text-align:left;">
Other
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
acad
</td>
<td style="text-align:left;">
8
</td>
<td style="text-align:left;">
5
</td>
<td style="text-align:left;">
4
</td>
<td style="text-align:left;">
8
</td>
</tr>
<tr>
<td style="text-align:left;">
spoken
</td>
<td style="text-align:left;">
31
</td>
<td style="text-align:left;">
14
</td>
<td style="text-align:left;">
22
</td>
<td style="text-align:left;">
11
</td>
</tr>
<tr>
<td style="text-align:left;">
fiction
</td>
<td style="text-align:left;">
44
</td>
<td style="text-align:left;">
25
</td>
<td style="text-align:left;">
17
</td>
<td style="text-align:left;">
16
</td>
</tr>
<tr>
<td style="text-align:left;">
new
</td>
<td style="text-align:left;">
36
</td>
<td style="text-align:left;">
38
</td>
<td style="text-align:left;">
12
</td>
<td style="text-align:left;">
24
</td>
</tr>
</tbody>
</table>
<p>If we used an ordinary Pearson’s <span class="math inline">\(\chi\)</span><sup>2</sup> test (the use of which would be inappropriate here), it would reveal that spoken conversations do not differ significantly from fiction in their use of EMOTION IS LIGHT and EMOTION IS A FORCE OF NATURE (<span class="math inline">\(\chi\)</span><sup>2</sup>=3.3016, df=1, p=.069, <span class="math inline">\(\phi\)</span>=.2057).</p>
<pre class="r"><code># create table
subtable &lt;- matrix(c(14, 25, 22, 17), ncol=2)
chisq.results &lt;- chisq.test(subtable, correct=FALSE) # WRONG!
phi.coefficient = sqrt(chisq.results$statistic / sum(subtable) * (min(dim(subtable))-1))
chisq.results</code></pre>
<pre><code>## 
##  Pearson&#39;s Chi-squared test
## 
## data:  subtable
## X-squared = 3.3016, df = 1, p-value = 0.06921</code></pre>
<pre class="r"><code>phi.coefficient</code></pre>
<pre><code>## X-squared 
## 0.2057378</code></pre>
<p>The correct analysis takes into account that it is a subtable that is not independent of the overall table. This means that the correct analysis should take into account the total number of cases, as well as the row and column totals [vgl.@bortz1990verteilungsfreie 144-148].</p>
<p>In order to perform the correct analysis, we must either implement the equation proposed in <span class="citation">Bortz, Lienert, and Boehnke (<a href="#ref-bortz1990verteilungsfreie" role="doc-biblioref">1990</a>)</span> 144-148 or read in the function written by <span class="citation">Gries (<a href="#ref-gries2014frequency" role="doc-biblioref">2014</a>)</span> and apply it to the subtable.</p>
<pre class="r"><code># load function for chi square test for subtables
source(&quot;https://slcladal.github.io/rscripts/sub.table.r&quot;) 
# apply test
results &lt;- sub.table(wholetable, 2:3, 2:3, out=&quot;short&quot;)
# inspect results
results</code></pre>
<pre><code>## $`Whole table`
##          Metaphor
## Register  Heated fluid Light NatForce Other Sum
##   acad               8     5        4     8  25
##   spoken            31    14       22    11  78
##   fiction           44    25       17    16 102
##   new               36    38       12    24 110
##   Sum              119    82       55    59 315
## 
## $`Sub-table`
##          Metaphor
## Register  Light NatForce Sum
##   spoken     14       22  36
##   fiction    25       17  42
##   Sum        39       39  78
## 
## $`Chi-square tests`
##                                   Chi-square Df    p-value
## Cells of sub-table to whole table  7.2682190  3 0.06382273
## Rows (within sub-table)            0.2526975  1 0.61518204
## Columns (within sub-table)         3.1519956  1 0.07583417
## Contingency (within sub-table)     3.8635259  1 0.04934652</code></pre>
<p>The results show that the difference is, in fact, statistically significant (<span class="math inline">\(\chi^{2}\)</span>=3.864, df=1, p=.049*).</p>
</div>
<div id="configural-frequency-analysis-cfa" class="section level2">
<h2><span class="header-section-number">3.4</span> Configural Frequency Analysis (CFA)</h2>
<pre class="r"><code># load library
library(cfa)
# load data
cfadata &lt;- read.delim(&quot;https://slcladal.github.io/data/cfadata.txt&quot;, 
                      header = T, sep = &quot;\t&quot;)
# inspect data
head(cfadata)</code></pre>
<pre><code>##    Variety Age Gender   Class Frequency
## 1 American Old    Man  Middle         7
## 2  British Old  Woman  Middle         9
## 3  British Old    Man  Middle         6
## 4 American Old  Woman Working         2
## 5 American Old    Man  Middle         5
## 6  British Old    Man  Middle         8</code></pre>
<p>In a next step, we define the configurations and separate them from the counts.</p>
<pre class="r"><code># load library
library(dplyr)
# define configurations
configs &lt;- cfadata %&gt;%
  select(Variety, Age, Gender, Class)
# define counts
counts &lt;- cfadata$Frequency</code></pre>
<p>Now that configurations and counts are separated, we can perform the configural frequency analysis.</p>
<pre class="r"><code># perform cfa
cfa(configs,counts) </code></pre>
<pre><code>## 
## *** Analysis of configuration frequencies (CFA) ***
## 
##                           label   n   expected            Q       chisq
## 1  American Old   Man   Working   9  17.269530 0.0074991397 3.959871781
## 2  American Young Man   Middle   20  13.322419 0.0060338993 3.346996519
## 3  British  Old   Woman Working  33  24.277715 0.0079603059 3.133665860
## 4  British  Young Woman Middle   12  18.728819 0.0061100471 2.417504403
## 5  American Young Woman Middle   10   6.362422 0.0032663933 2.079707490
## 6  British  Old   Man   Working  59  50.835658 0.0076361897 1.311214959
## 7  British  Young Man   Middle   44  39.216698 0.0044257736 0.583424432
## 8  American Old   Woman Middle   81  76.497023 0.0043152503 0.265066491
## 9  British  Old   Woman Middle  218 225.181379 0.0080255135 0.229025170
## 10 American Old   Man   Middle  156 160.178850 0.0043537801 0.109020569
## 11 American Old   Woman Working   8   8.247454 0.0002225797 0.007424506
## 12 British  Old   Man   Middle  470 471.512390 0.0023321805 0.004851037
##       p.chisq sig.chisq          z        p.z sig.z
## 1  0.04659725     FALSE -2.1267203 0.98327834 FALSE
## 2  0.06732776     FALSE  1.7026500 0.04431680 FALSE
## 3  0.07669111     FALSE  1.6871254 0.04578962 FALSE
## 4  0.11998594     FALSE -1.6845116 0.95395858 FALSE
## 5  0.14926878     FALSE  1.2474422 0.10611771 FALSE
## 6  0.25217480     FALSE  1.1002146 0.13561931 FALSE
## 7  0.44497317     FALSE  0.6962784 0.24312726 FALSE
## 8  0.60666058     FALSE  0.4741578 0.31769368 FALSE
## 9  0.63224759     FALSE -0.5726832 0.71657040 FALSE
## 10 0.74126197     FALSE -0.3993470 0.65518123 FALSE
## 11 0.93133480     FALSE -0.2612337 0.60304386 FALSE
## 12 0.94447273     FALSE -0.1217934 0.54846869 FALSE
## 
## 
## Summary statistics:
## 
## Total Chi squared         =  17.44777 
## Total degrees of freedom  =  11 
## p                         =  2.9531e-05 
## Sum of counts             =  1120 
## 
## Levels:
## 
## Variety     Age  Gender   Class 
##       2       2       2       2</code></pre>
</div>
<div id="hierarchical-configural-frequency-analysis-hcfa" class="section level2">
<h2><span class="header-section-number">3.5</span> Hierarchical Configural Frequency Analysis (HCFA)</h2>
<pre class="r"><code># load library
library(cfa)
# load data
cfadata &lt;- read.delim(&quot;https://slcladal.github.io/data/cfadata.txt&quot;, 
                      header = T, sep = &quot;\t&quot;)
# inspect data
head(cfadata)</code></pre>
<pre><code>##    Variety Age Gender   Class Frequency
## 1 American Old    Man  Middle         7
## 2  British Old  Woman  Middle         9
## 3  British Old    Man  Middle         6
## 4 American Old  Woman Working         2
## 5 American Old    Man  Middle         5
## 6  British Old    Man  Middle         8</code></pre>
<p>In a next step, we define the configurations and separate them from the counts.</p>
<pre class="r"><code># load library
library(dplyr)
# define configurations
configs &lt;- cfadata %&gt;%
  select(Variety, Age, Gender, Class)
# define counts
counts &lt;- cfadata$Frequency</code></pre>
<p>Now that configurations and counts are separated, we can perform the hierarchical configural frequency analysis.</p>
<pre class="r"><code># perform cfa
hcfa(configs,counts) </code></pre>
<pre><code>## 
## *** Hierarchical CFA ***
## 
##                      Overall chi squared df          p order
## Variety Age Class              12.218696  4 0.01579696     3
## Variety Gender Class            8.773578  4 0.06701496     3
## Variety Age Gender              7.974102  4 0.09253149     3
## Variety Class                   6.078225  1 0.01368582     2
## Variety Class                   6.078225  1 0.01368582     2
## Age Gender Class                5.164357  4 0.27084537     3
## Variety Age                     4.466643  1 0.03456284     2
## Variety Age                     4.466643  1 0.03456284     2
## Age Gender                      1.934543  1 0.16426233     2
## Age Gender                      1.934543  1 0.16426233     2
## Age Class                       1.673538  1 0.19578534     2
## Age Class                       1.673538  1 0.19578534     2
## Gender Class                    1.546666  1 0.21362833     2
## Gender Class                    1.546666  1 0.21362833     2
## Variety Gender                  1.120155  1 0.28988518     2
## Variety Gender                  1.120155  1 0.28988518     2</code></pre>
<p>According to the HCFA, only a single configuration (Variety : Age : Class) is significant (X2 = 12.21, p = .016).</p>
</div>
</div>
<div id="how-to-cite-this-tutorial" class="section level1 unnumbered">
<h1>How to cite this tutorial</h1>
<p>Schweinberger, Martin. 2020. <em>The Chi-Square Family of Tests with R</em>. Brisbane: The University of Queensland. url: <a href="https://slcladal.github.io/basicstatzchi.html" class="uri">https://slcladal.github.io/basicstatzchi.html</a>.</p>
</div>
<div id="references" class="section level1 unnumbered">
<h1>References</h1>
<div id="refs" class="references">
<div id="ref-bortz1990verteilungsfreie">
<p>Bortz, J, GA Lienert, and K Boehnke. 1990. <em>Verteilungsfreie Methoden in Der Biostatistik</em>. Berlin: Springer Verlag.</p>
</div>
<div id="ref-buehner2009statistik">
<p>Bühner, Markus, and Matthias Ziegler. 2009. <em>Statistik Für Psychologen Und Sozialwissenschaftler</em>. München: Pearson Studium.</p>
</div>
<div id="ref-cochran1954somemethods">
<p>Cochran, W. G. 1954. “Some Methods for Strengthening the Common <span class="math inline">\(\chi\)</span>^2tests.” <em>Biometrics</em> 10: 417–51.</p>
</div>
<div id="ref-gries2014frequency">
<p>Gries, Stefan Thomas. 2014. “Frequency Tables: Tests, Effect Sizes, and Explorations.” In <em>Polysemy and Synonymy: Corpus Methods and Applications in Cognitive Linguistics.</em>, edited by Dylan Glynn and Justyna Robinson, 365–89. Amsterdam: John Benjamins.</p>
</div>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
