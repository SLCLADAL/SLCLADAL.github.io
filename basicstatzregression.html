<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />


<meta name="author" content="UQ SLC Digital Team" />

<meta name="date" content="2019-07-25" />

<title>Simple Linear Regression</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-5.0.13/css/fa-svg-with-js.css" rel="stylesheet" />
<script src="site_libs/font-awesome-5.0.13/js/fontawesome-all.min.js"></script>
<script src="site_libs/font-awesome-5.0.13/js/fa-v4-shims.min.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>


</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}

.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->




<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}


.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
  padding-left: 25px;
  text-indent: 0;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>

<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">LADAL</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-play-circle"></span>
     
    Basics
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">Basics</li>
    <li>
      <a href="introquant.html">Introduction To Quantitative Reasoning</a>
    </li>
    <li>
      <a href="basicquant.html">Basic Concepts In Quantitative Reasoning</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">Research Designs</li>
    <li>
      <a href="researchdesigns.html">Overview</a>
    </li>
    <li>
      <a href="corpling.html">Corpus Linguistics</a>
    </li>
    <li>
      <a href="experiments.html">Experimental Designs</a>
    </li>
    <li>
      <a href="acoustic.html">Acoustic Analysis</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">Data Collection</li>
    <li>
      <a href="introdatacollection.html">Introduction</a>
    </li>
    <li>
      <a href="questionnaires.html">Questionnaires and Surveys</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-gear"></span>
     
    Data Processing
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">Data Processing</li>
    <li>
      <a href="intror.html">Basics: Getting started with R</a>
    </li>
    <li>
      <a href="introloading.html">Loading and saving data</a>
    </li>
    <li>
      <a href="stringprocessing.html">String processing</a>
    </li>
    <li>
      <a href="regularexpressions.html">Regular expressions</a>
    </li>
    <li>
      <a href="introtables.html">Tabulating data</a>
    </li>
    <li class="divider"></li>
    <li>
      <a href="dataprocessingexcel.html">Data Processing with Excel</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-bar-chart"></span>
     
    Visualization
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">Visualization</li>
    <li>
      <a href="basicgraphs.html">Basic Visualization with R</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-eye"></span>
     
    Statistics
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">Statistics</li>
    <li>
      <a href="descriptivestatz.html">Descriptive Statistics</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">Basic Interential Statistics</li>
    <li>
      <a href="basicstatz.html">Basic Inferential Tests</a>
    </li>
    <li>
      <a href="basicstatzchi.html">The Chi-Square Family</a>
    </li>
    <li>
      <a href="basicstatzregression.html">Simple Linear Regression</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">Advanced Interential Statistics</li>
    <li>
      <a href="fixedregressions.html">Fixed-Effects Regression Models</a>
    </li>
    <li>
      <a href="mixedregressions.html">Mixed-Effects Regression Models</a>
    </li>
    <li>
      <a href="advancedstatztrees.html">Tree-Based Models</a>
    </li>
    <li>
      <a href="groupingstatz.html">Classification</a>
    </li>
    <li>
      <a href="collostructions.html">Collostructional Analysis</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-bars"></span>
     
    Text Analysis/Corpus Linguistics
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">Text Analysis</li>
    <li>
      <a href="textanalysis.html">Introduction</a>
    </li>
    <li>
      <a href="webcrawling.html">Web Crawling</a>
    </li>
    <li>
      <a href="network.html">Network Analysis</a>
    </li>
    <li>
      <a href="topicmodels.html">Topic Modeling</a>
    </li>
    <li>
      <a href="classification.html">Classification</a>
    </li>
    <li>
      <a href="tagging.html">Tagging and Parsing</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">Corpus Linguistics</li>
    <li>
      <a href="corplingr.html">Corpus Linguistics in R</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="about.html">
    <span class="fa fa-info"></span>
     
    Contact
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Simple Linear Regression</h1>
<h4 class="author"><em>UQ SLC Digital Team</em></h4>
<h4 class="date"><em>2019-07-25</em></h4>

</div>


<p><img src="images/uq1.jpg" width="100%" /></p>
<div id="introduction" class="section level1">
<h1><span class="header-section-number">1</span> Introduction</h1>
<p>This tutorial introduces linear regressions with “R”. The entire code for the sections below can be downloaded <a href="https://slcladal.github.io/rscripts/basicstatzchirscript.r">here</a>.</p>
</div>
<div id="preparation" class="section level1">
<h1><span class="header-section-number">2</span> Preparation</h1>
<p>As all caluculations and visualizations in this tutorial rely on “R”, it is necessary to install “R”, “RStudio”, and “Tinn-R”. If these programms (or, in the case of “R”, environments) are not installed yet, please search for them in your favorite search engine and add the term “download”. Open any of the first few links and follow the installation instructions (they are easy to follow, do not require any specifications, and are pretty much self-explanatory).</p>
<p>In addition, certain “libraries” need to be installed so that the scripts shown below are executed without errors. Before turning to the code below, please install the libraries needed for running the code below. If you have already installed the libraries mentioned below, then you can skip ahead ignore this section. To install the necessary libraries, simply run the following code - it may take some time (between 1 and 5 minutes to install all of the libraries so you do not need to worry if it takes some time).</p>
<pre class="r"><code># clean current workspace
rm(list=ls(all=T))
# set options
options(stringsAsFactors = F)
# install libraries
install.packages(c(&quot;calibrate&quot;, &quot;car&quot;, &quot;ggplot2&quot;, &quot;QuantPsyc&quot;))</code></pre>
<p>Once you have installed “R”, “R-Studio”, “Tinn-R”, and have also initiated the session by executing the code shown above, you are good to go.</p>
</div>
<div id="simple-linear-regression" class="section level1">
<h1><span class="header-section-number">3</span> Simple Linear Regression</h1>
<p>This section focuses on a very widely used statistical method which is called regression. Regressions are used when we try to understand how independent variables correlate with a dependent or outcome variable. So, if you want to investigate how certain criteria affect an outcome, then a regression is the way to go. We will have a look at two simple examples to understand what the concepts underlying a regression mean and how a regression works. After that, we will turn to a more complex case and we will implement a multiple linear regression. The <code>R</code>-Code, that we will use, is based on <span class="citation">(A. Field, Miles, and Field <a href="#ref-field2012discovering">2012</a>)</span>.</p>
<div id="introduction-1" class="section level2">
<h2><span class="header-section-number">3.1</span> Introduction</h2>
<p>Although the basic logic underlying regressions is identical to the conceptual underpinnings of analysis of variance (ANOVA), a related method, sociolinguistists have traditionally favoured regression analysis in their studies while ANOVAs have been the method of choice in psycholinguistics. The preference for either method is grounded in historical happenstances and the culture of these subdisciplines rather than in methodological reasoning.</p>
<p>A minor difference between regressions and ANOVA lies in the fact that regressions are based on the <span class="math inline">\(t\)</span>-distribution while ANOVAs use the <span class="math inline">\(F\)</span>-distribution (however, the <span class="math inline">\(F\)</span>-value is merely t<sup>2</sup>). Both <span class="math inline">\(t\)</span>- and <span class="math inline">\(F\)</span>-values report on the ratio between explained and unexplained variance.</p>
<p>The idea behind regression analysis is expressed formally in <a href="#eq:slm">equation</a> and can best be described graphically: Imagine drawing a line through points in a scatterplot (Grafik  left panel).</p>
<p><span class="math inline">\(f_{(x)} = \alpha + \beta_{1}x_{i} + \epsilon\)</span> {#eq:slm}</p>
<p>Regressions aim to find that line which has the minimal summed distance between points and the line (Figure  centre panel). Technically speaking, the aim of a regression is to find the line with the minimal deviance or the line with the minimal sum of residuals (variance) (Figure  right panel). This means that the sum of the length of the lines between the points and the lines should be minimal. The slope of the line is called <em>coefficient</em> and the point where the line crosses the y-axis is called the <em>intercept</em>.</p>
<p><img src="basicstatzregression_files/figure-html/slr1-1.png" width="672" /></p>
<p>A word about standard errors (SE) is in order here because most commonly used statistics programs will provide SE values when reporting regression models. The SE is a measure that tells us how much the coefficients were to vary if the same regression were applied to many samples from the same population. A relatively small SE value therefore indicates that the coefficients will remain very stable if the same regression model is fitted to many different samples with identical parameters. In contrast, a large SE tells you that the model is volatile and not very stable or reliable as the coefficients vary substantially if the model is applied to many samples.</p>
</div>
</div>
<div id="example-1-preposition-use-across-real-time" class="section level1">
<h1><span class="header-section-number">4</span> Example 1: Preposition Use across Real-Time</h1>
<p>We will now turn to our first example. In this example, we will investigate whether the frequency of prepositions has changed from Middle English to Late Modern English. The reasoning behind this example is that Old English was highly synthetic compared with Present-Day English which comparatively analytic. In other words, while Old English speakers used case to indicate syntactic relations, speakers of Present-Day English use word order and prepositions to indicate syntactic relationships. This means that the loss of case had to be compensated by different strategies and maybe these strategies continued to develop and increase in frequency even after the change from synthetic to analytic had been mostly accomplished. And this prolonged change in compensatory strategies is what this example will focus on.</p>
<p>The analysis is based on data extracted from the <em>Penn Corpora of Historical English</em> (see <a href="http://www.ling.upenn.edu/hist-corpora/" class="uri">http://www.ling.upenn.edu/hist-corpora/</a>), that consists of 603 texts written between 1125 and 1900. In preparation of this example, all elements that were part-of-speech tagged as prepositions were extracted from the PennCorpora.</p>
<p>Then, the relative frequencies (per 1,000 words) of prepositions per text were calculated. This frequency of prepositions per 1,000 words represents our dependent variable. In a next step, the date when each letter had been written was extracted. The resulting two vectors were combined into a table which thus contained for each text, when it was written (independent variable) and its relative frequency of prepositions (dependent or outcome variable).</p>
<p>A regression analysis will follow the steps described below: 1. Extraction and processing of the data 2. Data visualization 3. Applying the regression analysis to the data 4. Diagnosing the regression model and checking whether or not basic model assumptions have been violated.</p>
<p>In a first step, we load the libraries and functions.</p>
<pre class="r"><code># load libraries
library(car)                   # activate car package
library(ggplot2)               # activate ggplot2 package
library(QuantPsyc)             # activate QuantPsyc package
source(&quot;rscripts/multiplot_ggplot2.r&quot;) # load multiplot function
source(&quot;rscripts/slr.summary.tb.r&quot;)    # load regression summary function</code></pre>
<p>After preparing our session, we can now load and inspect the data to get a first impression of its properties.</p>
<pre class="r"><code>slrdata &lt;- read.delim(&quot;data/slrdata.txt&quot;, header = TRUE) # load data
attach(slrdata)                                          # attach data
slrdata &lt;- as.data.frame(cbind(datems, pptw))  # remove superfluous columns
colnames(slrdata) &lt;- c(&quot;year&quot;, &quot;prep.ptw&quot;)     # add column names
slrdata &lt;- slrdata[!is.na(slrdata$year) == T,] # remove NAs from data
str(slrdata)                                   # inspect structure of the data</code></pre>
<pre><code>## &#39;data.frame&#39;:    603 obs. of  2 variables:
##  $ year    : num  1736 1711 1808 1878 1743 ...
##  $ prep.ptw: num  166 140 131 151 146 ...</code></pre>
<table>
<caption>First six lines of the data set.</caption>
<thead>
<tr class="header">
<th align="right">year</th>
<th align="right">prep.ptw</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1736</td>
<td align="right">166.01</td>
</tr>
<tr class="even">
<td align="right">1711</td>
<td align="right">139.86</td>
</tr>
<tr class="odd">
<td align="right">1808</td>
<td align="right">130.78</td>
</tr>
<tr class="even">
<td align="right">1878</td>
<td align="right">151.29</td>
</tr>
<tr class="odd">
<td align="right">1743</td>
<td align="right">145.72</td>
</tr>
<tr class="even">
<td align="right">1807</td>
<td align="right">152.59</td>
</tr>
</tbody>
</table>
<p>Inspecting the data is very important because it can happen that a data set may not load completely or that variables which should be numeric have been converted in character variables. If unchecked, then such hidden data issues could go unnoticed and cause much trouble once you realize that the data you have been working with is different from what you had in mind.</p>
<p>We will now plot the data to get a more thorough impression of the structure of the data.</p>
<pre class="r"><code>ggplot(slrdata, aes(year, prep.ptw)) +
  geom_point() +
  theme_bw() +
  labs(x = &quot;Year&quot;) +
  labs(y = &quot;Prepositions per 1,000 words&quot;) +
  geom_smooth()</code></pre>
<p><img src="basicstatzregression_files/figure-html/slr5-1.png" width="672" /></p>
<pre class="r"><code>ggplot(slrdata, aes(year, prep.ptw)) +
  geom_point() +
  theme_bw() +
  labs(x = &quot;Year&quot;) +
  labs(y = &quot;Prepositions per 1,000 words&quot;) +
  geom_smooth(method = &quot;lm&quot;) # with linear model smoothing!</code></pre>
<p><img src="basicstatzregression_files/figure-html/slr6-1.png" width="672" /></p>
<p>Before beginning with the regression analysis, we will scale the year. We scale by subtracting each value from the mean of year. This can be useful when dealing with numeric variables because if we did not scale year, we would get estimated values for year 0 (a year when English did not even exist yet). If a variable is scaled, the regression provides estimates of the model refer to the mean of that numeric variable. In other words, scaling can eb very helpful, especially with respect to the interpretation of the results that regression models report.</p>
<pre class="r"><code>slrdata$prep.ptw &lt;- slrdata$prep.ptw - mean(slrdata$prep.ptw) # scaling date</code></pre>
<p>We will now begin the regression analysis by generating a first regression model. Once the regression model is generated, we will inspect its results and check if certain mathematical assumptions have been violated or whether the data contains outliers. diagnostic plots.</p>
<pre class="r"><code># create initial model
prep.lm &lt;- lm(prep.ptw ~ year, data = slrdata)
# inspect results
summary(prep.lm)</code></pre>
<pre><code>## 
## Call:
## lm(formula = prep.ptw ~ year, data = slrdata)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -66.842 -13.523   1.183  14.086  65.117 
## 
## Coefficients:
##               Estimate Std. Error t value Pr(&gt;|t|)  
## (Intercept) -27.723706  10.863978  -2.552   0.0110 *
## year          0.017128   0.006691   2.560   0.0107 *
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 21.11 on 601 degrees of freedom
## Multiple R-squared:  0.01079,    Adjusted R-squared:  0.00914 
## F-statistic: 6.553 on 1 and 601 DF,  p-value: 0.01071</code></pre>
<pre class="r"><code># plot model: 3 plots per row in one window
par(mfrow = c(1, 3))
plot(resid(prep.lm))
plot(rstandard(prep.lm))
plot(rstudent(prep.lm))</code></pre>
<p><img src="basicstatzregression_files/figure-html/slr8-1.png" width="672" /></p>
<pre class="r"><code>par(mfrow = c(1, 1)) # restore default parameters</code></pre>
<p>The left graph shows the residuals of the model (i.e., the differences between the observed and the values predicted by the regression model). The problem with this plot is that the residuals are not standardized and so they cannot be compared to the residuals of other models. To remedy this deficiency, residuals are normalized by dividing the residuals by their standard deviation. Then, the normalized residuals can be plotted against the observed values (centre panel). In this way, not only are standardized residuals obtained, but the values of the residuals are transformed into z-values, and one can use the z-distribution to find problematic data points. There are three rules of thumb regarding finding problematic data points through standardized residuals <span class="citation">(A. Field, Miles, and Field <a href="#ref-field2012discovering">2012</a>, 268–69)</span>:</p>
<ul>
<li>Points with values higher than 3.29 should be removed from the data.</li>
<li>If more than 1% of the data points have values higher than 2.58, then the error rate of our model is too high.</li>
<li>If more than 5% of the data points have values greater than 1.96, then the error rate of our model is too high.</li>
</ul>
<p>The right panel shows the * studentized residuals* (adjusted predicted values: each data point is divided by the standard error of the residuals). In this way, it is possible to use Student’s t-distribution to diagnose our model.</p>
<p>Adjusted predicted values are residuals of a special kind: the model is calculated without a data point and then used to predict this data point. The difference between the observed data point and its predicted value is then called the adjusted predicted value. In summary, studentized residuals are very useful because they allow us to identify influential data points.</p>
<p>The plots show that there are two potentially problematic data points (the top-most and bottom-most point). These two points are clearly different from the other data points and may therefore be outliers. We will test later if these points need to be removed.</p>
<p>We will now generate more diagnostic plots.</p>
<pre class="r"><code>par(mfrow = c(2, 2)) # plot window: 2 plots/row, 2 plots/column
plot(prep.lm)        # generate diagnostic plots</code></pre>
<p><img src="basicstatzregression_files/figure-html/slr9-1.png" width="672" /></p>
<pre class="r"><code>par(mfrow = c(1, 1)) # restore normal plot window</code></pre>
<p>The diagnostic plots are very positive and we will go through why this is so for each panel. The graph in the upper left panel is useful for finding outliers or for determining the correlation between residuals and predicted values: when a trend becomes visible in the line or points (e.g., a rising trend or a zigzag line), then this would indicate that the model would be problematic (in such cases, it can help to remove data points that are too influential (outliers)).</p>
<p>The graphic in the upper right panel indicates whether the residuals are normally distributed (which is desirable) or whether the residuals do not follow a normal distribution. If the points lie on the line, the residuals follow a normal distribution. For example, if the points are not on the line at the top and bottom, it shows that the model does not predict small and large values well and that it therefore does not have a good fit.</p>
<p>The graphic in the lower left panel provides information about <em>homoscedasticity</em>. Homoscedasticity means that the variance of the residuals remains constant and does not correlate with any independent variable. In unproblematic cases, the graphic shows a flat line. If there is a trend in the line, we are dealing with heteroscedasticity, that is, a correlation between independent variables and the residuals, which is very problematic for regressions.</p>
<p>The graph in the lower right panel shows problematic influential data points that disproportionately affect the regression (this would be problematic). If such influential data points are present, they should be either weighted (one could generate a robust rather than a simple linear regression) or they must be removed. The graph displays Cook’s distance, which shows how the regression changes when a model without this data point is calculated. The cook distance thus shows the influence a data point has on the regression as a whole. Data points that have a Cook’s distance value greater than 1 are problematic <span class="citation">(A. Field, Miles, and Field <a href="#ref-field2012discovering">2012</a>, 269)</span>.</p>
<p>The so-called leverage is also a measure that indicates how strongly a data point affects the accuracy of the regression. Leverage values range between 0 (no influence) and 1 (strong influence: suboptimal!). To test whether a specific data point has a high leverage value, we calculate a cut-off point that indicates whether the leverage is too strong or still acceptable. The following two formulas are used for this:</p>
<span class="math display">\[\begin{equation}

\frac{3(k + 1)}{n}

\end{equation}\]</span>
<p>or</p>
<span class="math display">\[\begin{equation}

\frac{2(k + 1)}{n}

\end{equation}\]</span>
<p>We will look more closely at leverage in the context of multiple linear regression and will therefore end the current analysis by summarizing the results of the regression analysis in a table.</p>
<pre class="r"><code>slrtb &lt;- slr.summary(prep.lm)  # tabulate results
library(knitr)                 # activate library for tabulating
kable(slrtb, caption = &quot;Results of a simple linear regression analysis.&quot;)</code></pre>
<table>
<caption>Results of a simple linear regression analysis.</caption>
<thead>
<tr class="header">
<th></th>
<th align="left">Estimate</th>
<th align="left">Std. Beta</th>
<th align="left">Pearson’s r</th>
<th align="left">Std. Error</th>
<th align="left">t value</th>
<th align="left">Pr(&gt;|t|)</th>
<th align="left">P-value sig.</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>(Intercept)</td>
<td align="left">-27.72</td>
<td align="left"></td>
<td align="left"></td>
<td align="left">10.86</td>
<td align="left">-2.55</td>
<td align="left">0.011</td>
<td align="left">p &lt; .05*</td>
</tr>
<tr class="even">
<td>year</td>
<td align="left">0.02</td>
<td align="left">0.1039</td>
<td align="left">0.1</td>
<td align="left">0.01</td>
<td align="left">2.56</td>
<td align="left">0.0107</td>
<td align="left">p &lt; .05*</td>
</tr>
<tr class="odd">
<td>Model statistics</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left">Value</td>
</tr>
<tr class="even">
<td>Number of cases in model</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left">603</td>
</tr>
<tr class="odd">
<td>Residual standard error on 601 DF</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left">21.11</td>
</tr>
<tr class="even">
<td>Multiple R-squared</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left">0.0108</td>
</tr>
<tr class="odd">
<td>Adjusted R-squared</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left">0.0091</td>
</tr>
<tr class="even">
<td>F-statistic (1, 601)</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left">6.55</td>
</tr>
<tr class="odd">
<td>Model p-value</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left">0.0107</td>
</tr>
</tbody>
</table>
<p>Typically, the results of regression analyses are presented in such tables as they include all important measures of model quality and significance, as well as the magnitude of the effects. In addition, the results of simple linear regressions should be summarized in writing. An example of how the results of a regression analysis can be written up is provided below.</p>
<p>A simple linear regression has been fitted to the data. A visual assessment of the model diagnostic graphics did not indicate any problematic data points (outliers) or disproportionately influential data points and pointed to a good model fit. The final linear regression model is based on 603 data points and correlates highly significantly with the data (R<sup>2</sup>: 0.0108, F-statistic (1, 601): 6,553, p-value: 0.0107*) and confirms a significant and positive correlation between the year in which the text was written and the relative frequency of prepositions (coefficient: .02, standardized <span class="math inline">\(\beta\)</span>: 0.1039, SE: 0.01, t-value: 2.560, p-value:. 0107*).</p>
</div>
<div id="example-2-teaching-styles" class="section level1">
<h1><span class="header-section-number">5</span> Example 2: Teaching Styles</h1>
<p>In the previous example, we dealt with two numeric variables, while the following example deals with a categorical independent variable and a numeric dependent variable. The ability for regressions to handle very different types of variables makes regressions a widely used and robust method of analysis.</p>
<p>In this example, we are dealing with two groups of students that have been randomly assigned to groups which are exposed to different teaching methods. Both groups undergo a language learning test after the lesson with a maximum score of 20 points.</p>
<p>The students of the first group (group A) have reached the following scores:</p>
<ul>
<li>Group A: 15, 12, 11, 18, 15, 15, 9, 19, 14, 13, 11, 12, 18, 15, 16, 14, 16, 17, 15, 17, 13, 14, 13, 15, 17, 19, 17, 18, 16, 14 (mean: 14,93)</li>
</ul>
<p>The students of the second group (group B) have reached the following scores:</p>
<ul>
<li>Group B: 11, 16, 14, 18, 6, 8, 9, 14, 12, 12, 10, 15, 12, 9, 13, 16, 17, 12, 8, 7, 15, 5, 14, 13, 13, 12, 11, 13, 11, 7 (mean: 11,77)</li>
</ul>
<p>Our question is whether group A has performed significantly better than group B which would indicate that the teaching method to which group A was exposed works better than the teaching method to which group B was exposed.</p>
<p>Let’s move on to implementing the regression in “R”. As in the previous example, we start by activating libraries and loading functions.</p>
<pre class="r"><code># load libraries
library(car)                   # activate car package
library(ggplot2)               # activate ggplot2 package
library(QuantPsyc)             # activate QuantPsyc package
source(&quot;rscripts/multiplot_ggplot2.r&quot;) # load multiplot function
source(&quot;rscripts/slr.summary.tb.r&quot;)    # load regression summary function</code></pre>
<p>After the necessary specifications have been carried out, we generate the data set and inspect its structure.</p>
<pre class="r"><code># load data
slrdata2 &lt;- read.delim(&quot;D:\\Uni\\UQ\\LADAL\\SLCLADAL.github.io\\data/slrdata2.txt&quot;, sep = &quot;\t&quot;, header = T)
# inspect data
head(slrdata2); str(slrdata2)</code></pre>
<pre><code>##   Group Score
## 1     A    15
## 2     A    12
## 3     A    11
## 4     A    18
## 5     A    15
## 6     A    15</code></pre>
<pre><code>## &#39;data.frame&#39;:    60 obs. of  2 variables:
##  $ Group: Factor w/ 2 levels &quot;A&quot;,&quot;B&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ Score: int  15 12 11 18 15 15 9 19 14 13 ...</code></pre>
<p>Now, we graphically display the data. In this case, a boxplot represents a good way to visualize the data.</p>
<pre class="r"><code>boxplot(Score ~ Group,               # create box plot
data = slrdata2,                     # the data we want to display
main = &quot;&quot;,                           # empty title
ylab = &quot;Score&quot;,                      # y-axis label
ylim = c(0, 20),                     # y-axis rage
xlab = c(&quot;Group&quot;),                   # x-axis albel
notch = T,                           # show notches 
col = c(&quot;lightgreen&quot;, &quot;lightblue&quot;))  # define colours
text(1:2,                            # add text
c(4.0, 4.0),                         # y-axis position
cex = 0.85,                          # font size
labels = paste(&quot;mean\n&quot;,
c(round(as.vector(by(slrdata2$Score, slrdata2$Group, mean))[1], 2),
round(as.vector(by(slrdata2$Score, slrdata2$Group, mean))[2], 2),
sep = &quot;&quot;)))
rug(jitter(slrdata2$Score),
side=4)
box()</code></pre>
<div class="figure">
<img src="basicstatzregression_files/figure-html/slr13-1.png" alt="Darstellung der Sprachtestdaten" width="672" />
<p class="caption">
Darstellung der Sprachtestdaten
</p>
</div>
<p>The data indicate that group A did significantly better than group B. We will test this impression by generating the regression model and creating the model diagnostic graphics in the next step.</p>
<pre class="r"><code>sprtest.lm &lt;- lm(Score ~ Group, data = slrdata2) # generate regression model
summary(sprtest.lm)                                 # inspect results</code></pre>
<pre><code>## 
## Call:
## lm(formula = Score ~ Group, data = slrdata2)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -6.767 -1.933  0.150  2.067  6.233 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  14.9333     0.5346  27.935  &lt; 2e-16 ***
## GroupB       -3.1667     0.7560  -4.189 9.67e-05 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 2.928 on 58 degrees of freedom
## Multiple R-squared:  0.2322, Adjusted R-squared:  0.219 
## F-statistic: 17.55 on 1 and 58 DF,  p-value: 9.669e-05</code></pre>
<pre class="r"><code>par(mfrow = c(1, 3))        # plot window: 1 plot/row, 3 plots/column
plot(resid(sprtest.lm))     # generate diagnostic plot
plot(rstandard(sprtest.lm)) # generate diagnostic plot
plot(rstudent(sprtest.lm))  # generate diagnostic plot</code></pre>
<p><img src="basicstatzregression_files/figure-html/slr15-1.png" width="672" /></p>
<pre class="r"><code>par(mfrow = c(1, 1))        # restore normal plot window</code></pre>

<p>The graphics do not indicate outliers or other issues, so we can continue with more diagnostic graphics.</p>
<pre class="r"><code>par(mfrow = c(2, 2)) # generate a plot window with 2x2 panels
plot(sprtest.lm)     # generate diagnostic plots</code></pre>
<p><img src="basicstatzregression_files/figure-html/slr16-1.png" width="672" /></p>
<pre class="r"><code>par(mfrow = c(1, 1)) # restore normal plot window</code></pre>

<p>These graphics also show no problems. In this case, the data can be summarized in the next step.</p>
<pre class="r"><code># tabulate results
slrtb2 &lt;- slr.summary(sprtest.lm)
library(knitr)
kable(slrtb2, caption = &quot;Results of a simple linear regression analysis.&quot;)</code></pre>
<table>
<caption>Results of a simple linear regression analysis.</caption>
<thead>
<tr class="header">
<th></th>
<th align="left">Estimate</th>
<th align="left">Std. Beta</th>
<th align="left">Pearson’s r</th>
<th align="left">Std. Error</th>
<th align="left">t value</th>
<th align="left">Pr(&gt;|t|)</th>
<th align="left">P-value sig.</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>(Intercept)</td>
<td align="left">14.93</td>
<td align="left"></td>
<td align="left"></td>
<td align="left">0.53</td>
<td align="left">27.94</td>
<td align="left">0</td>
<td align="left">p &lt; .001***</td>
</tr>
<tr class="even">
<td>GroupB</td>
<td align="left">-3.17</td>
<td align="left">-0.4819</td>
<td align="left">0.48</td>
<td align="left">0.76</td>
<td align="left">-4.19</td>
<td align="left">1e-04</td>
<td align="left">p &lt; .001***</td>
</tr>
<tr class="odd">
<td>Model statistics</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left">Value</td>
</tr>
<tr class="even">
<td>Number of cases in model</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left">60</td>
</tr>
<tr class="odd">
<td>Residual standard error on 58 DF</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left">2.93</td>
</tr>
<tr class="even">
<td>Multiple R-squared</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left">0.2322</td>
</tr>
<tr class="odd">
<td>Adjusted R-squared</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left">0.219</td>
</tr>
<tr class="even">
<td>F-statistic (1, 58)</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left">17.55</td>
</tr>
<tr class="odd">
<td>Model p-value</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left">1e-04</td>
</tr>
</tbody>
</table>
<p>The results of this second simple linear regressions can be summarized as follows:</p>
<p>A simple linear regression was fitted to the data. A visual assessment of the model diagnostic graphics did not indicate any problematic data points (outliers) or disproportionately influential data points and pointed to a good model fit. The final linear regression model is based on 60 data points and correlates highly significantly with the data (R<sup>2</sup>: 0.2322, F statistic (1, 58): 2.93, p-value &lt;. 001***) and confirms that group A scored significantly better on the language learning test than group B (coefficient: -3.17, standardized <span class="math inline">\(\beta\)</span>: -0.4819, SE: 0.48, t-value: -4.19, p-value &lt;. 001 ***).</p>
<blockquote>
<p>Exercise Time!</p>
<p>Load the data set called mblrdata by executing the following command in R:</p>
</blockquote>
<pre class="r"><code>slrdata3 &lt;- read.delim(&quot;data/mlrdata.txt&quot;, header = TRUE) # load data
attach(slrdata3)                                 # attach data
slrdata3$attraction &lt;- NULL                      # remove superfluous columns
str(slrdata3)                                    # inspect structure of the data</code></pre>
<pre><code>## &#39;data.frame&#39;:    100 obs. of  2 variables:
##  $ status: Factor w/ 2 levels &quot;Relationship&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
##  $ money : num  86.3 45.6 68.4 52.9 61.9 ...</code></pre>
<blockquote>
<p>Perform a regression analysis that analyses if the money spend on a present for someone (money) depends on the receiver’s relationship status (status).</p>
</blockquote>
</div>
<div id="references" class="section level1 unnumbered">
<h1>References</h1>
<div id="refs" class="references">
<div id="ref-field2012discovering">
<p>Field, Andy, Jeremy Miles, and Zoe Field. 2012. <em>Discovering Statistics Using R</em>. Sage.</p>
</div>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
