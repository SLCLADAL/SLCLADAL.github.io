<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Martin Schweinberger" />

<meta name="date" content="2020-09-29" />

<title>Concordancing with R</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet" />

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">LADAL</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="people.html">OUR PEOPLE</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    NEWS
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="news.html">News &amp; Announcements</a>
    </li>
    <li>
      <a href="conferences.html">Events &amp; Presentations</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    DATA SCIENCE BASICS
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">Introduction to Data Science</li>
    <li>
      <a href="introcomputer.html">Working with Computers: Tips and Tricks</a>
    </li>
    <li>
      <a href="reproducibility.html">Data Management, Version Control, and Reproducibility</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">Quantitative Research</li>
    <li>
      <a href="introquant.html">Introduction to Quantitative Reasoning</a>
    </li>
    <li>
      <a href="basicquant.html">Basic Concepts in Quantitative Research</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">Introduction to R</li>
    <li>
      <a href="IntroR_workshop.html">Getting started</a>
    </li>
    <li>
      <a href="stringprocessing.html">String Processing</a>
    </li>
    <li>
      <a href="regularexpressions.html">Regular Expressions</a>
    </li>
    <li>
      <a href="introtables.html">Working with Tables</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    TUTORIALS
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">Data Visualization</li>
    <li>
      <a href="introviz.html">Introduction to Data Viz</a>
    </li>
    <li>
      <a href="basicgraphs.html">Common Visualization Types</a>
    </li>
    <li>
      <a href="basicgraphs.html">Advanced Visualization Methods</a>
    </li>
    <li>
      <a href="maps.html">Displaying Geo-Spatial Data</a>
    </li>
    <li>
      <a href="motion.html">Interactive Charts</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">Statistics</li>
    <li>
      <a href="descriptivestatz.html">Descriptive Statistics</a>
    </li>
    <li>
      <a href="basicstatz.html">Basic Inferential Statistics</a>
    </li>
    <li>
      <a href="regression.html">Regression Analysis</a>
    </li>
    <li>
      <a href="advancedstatztrees.html">Tree-Based Models</a>
    </li>
    <li>
      <a href="groupingstatz.html">Cluster and Correspondence Analysis</a>
    </li>
    <li>
      <a href="svm.html">Semantic Vector Space Models</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">Text Analytics</li>
    <li>
      <a href="textanalysis.html">Text Analysis and Distant Reading</a>
    </li>
    <li>
      <a href="kwics.html">Concordancing (keywords-in-context)</a>
    </li>
    <li>
      <a href="basicnetwork.html">Network Analysis</a>
    </li>
    <li>
      <a href="collocations.html">Co-occurrence and Collocation Analysis</a>
    </li>
    <li>
      <a href="topicmodels.html">Topic Modeling</a>
    </li>
    <li>
      <a href="sentiment.html">Sentiment Analysis</a>
    </li>
    <li>
      <a href="tagging.html">Tagging and Parsing</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    FOCUS &amp; CASE STUDIES
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="lex.html">Lexicography with R: Generating Dictionaries</a>
    </li>
    <li>
      <a href="surveys.html">Questionnaires and Surveys: Analyses with R</a>
    </li>
    <li>
      <a href="corplingr.html">Corpus Linguistics with R: Swearing in Irish English</a>
    </li>
    <li>
      <a href="convertpdf2txt.html">Converting PDFs to txt</a>
    </li>
    <li>
      <a href="webcrawling.html">Web Crawling using R</a>
    </li>
    <li>
      <a href="vc.html">Creating Vowel Charts with Praat and R</a>
    </li>
  </ul>
</li>
<li>
  <a href="services.html">SERVICES &amp; CONTACT</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Concordancing with R</h1>
<h4 class="author">Martin Schweinberger</h4>
<h4 class="date">2020-09-29</h4>

</div>


<p><img src="images/uq1.jpg" width="100%" /></p>
<div id="introduction" class="section level1 unnumbered">
<h1>Introduction</h1>
<p>This tutorial introduces how to extract concordances and keyword-in-context (KWIC) displays with R. The entire R-markdown document for the tutorial can be downloaded <a href="https://slcladal.github.io/kwics.Rmd">here</a>.</p>
<p>In the language sciences, concordancing refers to the extraction of words from a given text or texts <span class="citation">(Lindquist <a href="#ref-lindquist2009corpus" role="doc-biblioref">2009</a>, 5)</span>. Commonly, concordances are displayed in the form of keyword-in-context displays (KWICs) where the search term is shown in context, i.e. with preceding and following words. Concordancing are central to analyses of text and they often represents the first step in more sophisticated analyses of language data <span class="citation">(Stefanowitsch <a href="#ref-stafanowitsch2020corpus" role="doc-biblioref">2020</a>)</span>. The play such a key role in the language sciences because concordances are extremely valuable for understanding how a word or phrase is used, how often it is used, and in which contexts is used. As concordances allow us to analyze the context in which a word or phrase occurs and provide frequency information about word use, they also enable us to analyze collocations or the collocational profiles of words and phrases <span class="citation">(Stefanowitsch <a href="#ref-stafanowitsch2020corpus" role="doc-biblioref">2020</a>, 50–51)</span>. Finally, concordances can also be used to extract examples and it is a very common procedure.</p>
<div class="figure">
<img src="images/AntConcConcordance.png" alt="\label{fig:Fig1} Concordances in AntConc." width="70%" style="float:left; padding:5px" />
<p class="caption">
 Concordances in AntConc.
</p>
</div>
<p>There are various very good software packages that can be used to create concordances - both for offline use (e.g. <a href="https://www.laurenceanthony.net/software/antconc/"><em>AntConc</em></a> <span class="citation">(Anthony <a href="#ref-anthony2004antconc" role="doc-biblioref">2004</a>)</span>, <a href="https://www.sketchengine.eu/"><em>SketchEngine</em></a><span class="citation">(Kilgarriff et al. <a href="#ref-kilgarriff2004itri" role="doc-biblioref">2004</a>)</span>, <a href="https://www.monoconc.com/"><em>MONOCONC</em></a><span class="citation">(Barlow <a href="#ref-barlow1999monoconc" role="doc-biblioref">1999</a>)</span>, and <a href="https://paraconc.com/"><em>ParaConc</em></a>)<span class="citation">(Barlow <a href="#ref-barlow2002paraconc" role="doc-biblioref">2002</a>)</span> and online use (see e.g. <a href="https://lextutor.ca/conc/">here</a>).</p>
<p>In addition, many corpora that are available such as the <a href="https://corpus.byu.edu/overview.asp">BYU corpora</a> can be accessed via a web interface that have in-built concordancing functions.</p>
<div class="figure">
<img src="images/KwicCocaLanguage.png" alt="\label{fig:Fig2} Online concordances extracted from the COCA corpus that is part of the BYU corpora." width="80%" style="float:right; padding:5px" />
<p class="caption">
 Online concordances extracted from the COCA corpus that is part of the BYU corpora.
</p>
</div>
<p>While these packages are very user-friendly, offer various additional functionalities, and almost everyone who is engaged in analyzing language has used concordance software, they all suffer from shortcomings that render R a viable alternative. Such issues include that these applications</p>
<ul>
<li><p>are black boxes that researchers do not have full control over or do not know what is going on within the software</p></li>
<li><p>they are not open source</p></li>
<li><p>they hinder replication because the replications is more time consuming compared to analyses based on Notebooks.</p></li>
<li><p>they are commonly not free-of charge or have other restrictions on use (a notable exception is <em>AntConc</em>)</p></li>
</ul>
<p>R represents an alternative to ready-made concordancing applications because it:</p>
<ul>
<li><p>is extremely flexible and enables researchers to perform their entire analysis in a single environment</p></li>
<li><p>allows full transparency and documentation as analyses can be based on Notebooks</p></li>
<li><p>offer version control measures (this means that the specific versions of the involved software are traceable)</p></li>
<li><p>makes research more replicable as entire analyses can be reproduced by simply running the Notebooks that the research is based on</p></li>
</ul>
<p>Especially the aspect that R enables full transparency and replicability is relevant given the ongoing <em>Replication Crisis</em> <span class="citation">(Yong, <a href="#ref-atlantic2018psychology" role="doc-biblioref">n.d.</a>; Aschwanden, <a href="#ref-fivethirtyeight2018replication" role="doc-biblioref">n.d.</a>; Diener and Biswas-Diener <a href="#ref-noba2019replication" role="doc-biblioref">2019</a>; Velasco, <a href="#ref-physorg2018replication" role="doc-biblioref">n.d.</a>; McRae, <a href="#ref-sciencealert2018replication" role="doc-biblioref">n.d.</a>)</span>. The Replication Crisis is a ongoing methodological crisis primarily affecting parts of the social and life sciences beginning in the early 2010s <span class="citation">(see also Fanelli <a href="#ref-fanelli2009fraud" role="doc-biblioref">2009</a>)</span>. Replication is important so that other researchers, or the public for that matter, can see or, indeed, reproduce, exactly what you have done. Fortunately, R allows you to document your entire workflow as you can store everything you do in what is called a script or a notebook (in fact, this document was originally a R notebook). If someone is then interested in how you conducted your analysis, you can simply share this notebook or the script you have written with that person.</p>
<div id="preparation-and-session-set-up" class="section level2 unnumbered">
<h2>Preparation and session set up</h2>
<p>This tutorial is based on R. If you have not installed R or are new to it, you will find an introduction to and more information how to use R <a href="https://slcladal.github.io/IntroR_workshop.html">here</a>. For this tutorials, we need to install certain <em>packages</em> from an R <em>library</em> so that the scripts shown below are executed without errors. Before turning to the code below, please install the packages by running the code below this paragraph. If you have already installed the packages mentioned below, then you can skip ahead ignore this section. To install the necessary packages, simply run the following code - it may take some time (between 1 and 5 minutes to install all of the libraries so you do not need to worry if it takes some time).</p>
<pre class="r"><code># clean current workspace
rm(list=ls(all=T))
# set options
options(stringsAsFactors = F)         # no automatic data transformation
options(&quot;scipen&quot; = 100, &quot;digits&quot; = 4) # suppress math annotation
# install libraries
install.packages(c(&quot;quanteda&quot;, &quot;dplyr&quot;, &quot;stringr&quot;, &quot;knitr&quot;, &quot;kableExtra&quot;, &quot;gutenbergr&quot;))</code></pre>
<p>Once you have installed R-Studio and initiated the session by executing the code shown above, you are good to go.</p>
</div>
<div id="loading-and-processing-textual-data" class="section level2 unnumbered">
<h2>Loading and processing textual data</h2>
<p>Before creating concordances or kwics, we load the necessary packages from the R library which will help to download, process, and display the data as well as create the concordances.</p>
<pre class="r"><code># activate packages
library(quanteda)
library(dplyr)
library(stringr)
library(knitr)
library(kableExtra)
library(gutenbergr)</code></pre>
<p>For this tutorial, we will use Charles Darwin’s <em>On the Origin of Species by means of Natural Selection</em> which we download from the <a href="https://www.gutenberg.org/">Project Gutenberg</a> archive <span class="citation">(see Stroube <a href="#ref-stroube2003literary" role="doc-biblioref">2003</a>)</span>. Thus, Darwin’s <em>Origin of Species</em> forms the basis of our analysis. You can use the code below to download this text into R (but you have to have access to the internet to do so).</p>
<pre class="r"><code>origin &lt;- gutenberg_works(gutenberg_id == &quot;1228&quot;) %&gt;%
  gutenberg_download(meta_fields = &quot;gutenberg_id&quot;)</code></pre>
<pre><code>## Determining mirror for Project Gutenberg from http://www.gutenberg.org/robot/harvest</code></pre>
<pre><code>## Using mirror http://aleph.gutenberg.org</code></pre>
<pre class="r"><code># inspect data
kable(head(origin), caption = &quot;First 6 rows of the text&quot;) %&gt;%
  kable_styling(bootstrap_options = &quot;striped&quot;, full_width = T, position = &quot;left&quot;)</code></pre>
<table class="table table-striped" style="">
<caption>
First 6 rows of the text
</caption>
<thead>
<tr>
<th style="text-align:right;">
gutenberg_id
</th>
<th style="text-align:left;">
text
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
1228
</td>
<td style="text-align:left;">
ON THE ORIGIN OF SPECIES.
</td>
</tr>
<tr>
<td style="text-align:right;">
1228
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:right;">
1228
</td>
<td style="text-align:left;">
OR THE PRESERVATION OF FAVOURED RACES IN THE STRUGGLE FOR LIFE.
</td>
</tr>
<tr>
<td style="text-align:right;">
1228
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:right;">
1228
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:right;">
1228
</td>
<td style="text-align:left;">
By Charles Darwin, M.A.,
</td>
</tr>
</tbody>
</table>
<p>The table above shows that Darwin’s <em>Origin of Species</em> requires formatting so that we can use it. Therefore, we collapse it into a single object (or text) and remove superfluous white spaces.</p>
<pre class="r"><code>origin &lt;- origin$text %&gt;%
  paste0(collapse = &quot; &quot;) %&gt;%
  str_squish()
str(origin)</code></pre>
<pre><code>##  chr &quot;ON THE ORIGIN OF SPECIES. OR THE PRESERVATION OF FAVOURED RACES IN THE STRUGGLE FOR LIFE. By Charles Darwin, M.&quot;| __truncated__</code></pre>
<p>The result confirms that the entire text is now combined into a single character object.</p>
</div>
<div id="creating-simple-concordances" class="section level2 unnumbered">
<h2>Creating simple concordances</h2>
<p>Now that we have loaded the data, we can easily extract concordances using the <code>kwic</code> function from the <code>quanteda</code> package. The <code>kwic</code> function takes the text (<code>x</code>) and the search pattern (<code>pattern</code>) as it main arguments but it also allows the specification of the context window, i.e. how many words/elements are show to the left and right of the key word (we will go over this later on).</p>
<pre class="r"><code>kwic_natural &lt;- kwic(x = origin, pattern = &quot;selection&quot;)
# inspect data
kable(head(kwic_natural), caption = &quot;First 6 concordances for the keyword *natural*.&quot;) %&gt;%
  kable_styling(bootstrap_options = &quot;striped&quot;, full_width = T, position = &quot;left&quot;)</code></pre>
<table class="table table-striped" style="">
<caption>
First 6 concordances for the keyword <em>natural</em>.
</caption>
<thead>
<tr>
<th style="text-align:left;">
docname
</th>
<th style="text-align:right;">
from
</th>
<th style="text-align:right;">
to
</th>
<th style="text-align:left;">
pre
</th>
<th style="text-align:left;">
keyword
</th>
<th style="text-align:left;">
post
</th>
<th style="text-align:left;">
pattern
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
text1
</td>
<td style="text-align:right;">
269
</td>
<td style="text-align:right;">
269
</td>
<td style="text-align:left;">
and Origin . Principle of
</td>
<td style="text-align:left;">
Selection
</td>
<td style="text-align:left;">
anciently followed , its Effects
</td>
<td style="text-align:left;">
selection
</td>
</tr>
<tr>
<td style="text-align:left;">
text1
</td>
<td style="text-align:right;">
279
</td>
<td style="text-align:right;">
279
</td>
<td style="text-align:left;">
Effects . Methodical and Unconscious
</td>
<td style="text-align:left;">
Selection
</td>
<td style="text-align:left;">
. Unknown Origin of our
</td>
<td style="text-align:left;">
selection
</td>
</tr>
<tr>
<td style="text-align:left;">
text1
</td>
<td style="text-align:right;">
294
</td>
<td style="text-align:right;">
294
</td>
<td style="text-align:left;">
favourable to Man’s power of
</td>
<td style="text-align:left;">
Selection
</td>
<td style="text-align:left;">
. CHAPTER 2 . VARIATION
</td>
<td style="text-align:left;">
selection
</td>
</tr>
<tr>
<td style="text-align:left;">
text1
</td>
<td style="text-align:right;">
380
</td>
<td style="text-align:right;">
380
</td>
<td style="text-align:left;">
EXISTENCE . Bears on natural
</td>
<td style="text-align:left;">
selection
</td>
<td style="text-align:left;">
. The term used in
</td>
<td style="text-align:left;">
selection
</td>
</tr>
<tr>
<td style="text-align:left;">
text1
</td>
<td style="text-align:right;">
474
</td>
<td style="text-align:right;">
474
</td>
<td style="text-align:left;">
. CHAPTER 4 . NATURAL
</td>
<td style="text-align:left;">
SELECTION
</td>
<td style="text-align:left;">
. Natural Selection : its
</td>
<td style="text-align:left;">
selection
</td>
</tr>
<tr>
<td style="text-align:left;">
text1
</td>
<td style="text-align:right;">
477
</td>
<td style="text-align:right;">
477
</td>
<td style="text-align:left;">
. NATURAL SELECTION . Natural
</td>
<td style="text-align:left;">
Selection
</td>
<td style="text-align:left;">
: its power compared with
</td>
<td style="text-align:left;">
selection
</td>
</tr>
</tbody>
</table>
<p>We can easily extract the frequency of the search term (<em>selection</em>) using the <code>nrow</code> or the <code>length</code> functions which provide the number of rows of a tables (<code>nrow</code>) or the length of a vector (<code>length</code>).</p>
<pre class="r"><code>nrow(kwic_natural)</code></pre>
<pre><code>## [1] 414</code></pre>
<pre class="r"><code>length(kwic_natural$keyword)</code></pre>
<pre><code>## [1] 414</code></pre>
<p>The results show that there are 414 instances of the search term (<em>selection</em>) but we can also find out how often different variants (lower case versus upper case) of the search term were found using the <code>table</code> function. This is especially useful when searches involve many different search terms (while it is, admittedly, less useful in the present example).</p>
<pre class="r"><code>table(kwic_natural$keyword)</code></pre>
<pre><code>## 
## selection Selection SELECTION 
##       369        39         6</code></pre>
<p>To get a better understanding of the use of a word, it is often useful to extract more context. This is easily done by increasing size of the context window. To do this, we specify the <code>window</code> argument of the <code>kwic</code> function. In the example below, we set the context window size to 10 words/elements rather than using the default (which is 5 word/elements).</p>
<pre class="r"><code>kwic_natural_longer &lt;- kwic(x = origin, pattern = &quot;selection&quot;, window = 10)
# inspect data
kable(head(kwic_natural_longer), 
      caption = &quot;First 6 concordances for the keyword *natural* with an extended context (10 elements).&quot;) %&gt;%
  kable_styling(bootstrap_options = &quot;striped&quot;, full_width = T, position = &quot;left&quot;)</code></pre>
<table class="table table-striped" style="">
<caption>
First 6 concordances for the keyword <em>natural</em> with an extended context (10 elements).
</caption>
<thead>
<tr>
<th style="text-align:left;">
docname
</th>
<th style="text-align:right;">
from
</th>
<th style="text-align:right;">
to
</th>
<th style="text-align:left;">
pre
</th>
<th style="text-align:left;">
keyword
</th>
<th style="text-align:left;">
post
</th>
<th style="text-align:left;">
pattern
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
text1
</td>
<td style="text-align:right;">
269
</td>
<td style="text-align:right;">
269
</td>
<td style="text-align:left;">
Domestic Pigeons , their Differences and Origin . Principle of
</td>
<td style="text-align:left;">
Selection
</td>
<td style="text-align:left;">
anciently followed , its Effects . Methodical and Unconscious Selection
</td>
<td style="text-align:left;">
selection
</td>
</tr>
<tr>
<td style="text-align:left;">
text1
</td>
<td style="text-align:right;">
279
</td>
<td style="text-align:right;">
279
</td>
<td style="text-align:left;">
Selection anciently followed , its Effects . Methodical and Unconscious
</td>
<td style="text-align:left;">
Selection
</td>
<td style="text-align:left;">
. Unknown Origin of our Domestic Productions . Circumstances favourable
</td>
<td style="text-align:left;">
selection
</td>
</tr>
<tr>
<td style="text-align:left;">
text1
</td>
<td style="text-align:right;">
294
</td>
<td style="text-align:right;">
294
</td>
<td style="text-align:left;">
our Domestic Productions . Circumstances favourable to Man’s power of
</td>
<td style="text-align:left;">
Selection
</td>
<td style="text-align:left;">
. CHAPTER 2 . VARIATION UNDER NATURE . Variability .
</td>
<td style="text-align:left;">
selection
</td>
</tr>
<tr>
<td style="text-align:left;">
text1
</td>
<td style="text-align:right;">
380
</td>
<td style="text-align:right;">
380
</td>
<td style="text-align:left;">
CHAPTER 3 . STRUGGLE FOR EXISTENCE . Bears on natural
</td>
<td style="text-align:left;">
selection
</td>
<td style="text-align:left;">
. The term used in a wide sense . Geometrical
</td>
<td style="text-align:left;">
selection
</td>
</tr>
<tr>
<td style="text-align:left;">
text1
</td>
<td style="text-align:right;">
474
</td>
<td style="text-align:right;">
474
</td>
<td style="text-align:left;">
most important of all relations . CHAPTER 4 . NATURAL
</td>
<td style="text-align:left;">
SELECTION
</td>
<td style="text-align:left;">
. Natural Selection : its power compared with man’s selection
</td>
<td style="text-align:left;">
selection
</td>
</tr>
<tr>
<td style="text-align:left;">
text1
</td>
<td style="text-align:right;">
477
</td>
<td style="text-align:right;">
477
</td>
<td style="text-align:left;">
all relations . CHAPTER 4 . NATURAL SELECTION . Natural
</td>
<td style="text-align:left;">
Selection
</td>
<td style="text-align:left;">
: its power compared with man’s selection , its power
</td>
<td style="text-align:left;">
selection
</td>
</tr>
</tbody>
</table>
</div>
<div id="extracting-more-than-single-words" class="section level2 unnumbered">
<h2>Extracting more than single words</h2>
<p>While extracting single words is very common, you may want to extract more than just one word. To extract phrases, all you need to so is to specify that the pattern you are looking for is a phrase, as shown below.</p>
<pre class="r"><code>kwic_naturalselection &lt;- kwic(origin, pattern = phrase(&quot;natural selection&quot;))
# inspect data
kable(head(kwic_naturalselection), caption = &quot;First 6 concordances for the key phrase *natural selection*.&quot;) %&gt;%
  kable_styling(bootstrap_options = &quot;striped&quot;, full_width = T, position = &quot;left&quot;)</code></pre>
<table class="table table-striped" style="">
<caption>
First 6 concordances for the key phrase <em>natural selection</em>.
</caption>
<thead>
<tr>
<th style="text-align:left;">
docname
</th>
<th style="text-align:right;">
from
</th>
<th style="text-align:right;">
to
</th>
<th style="text-align:left;">
pre
</th>
<th style="text-align:left;">
keyword
</th>
<th style="text-align:left;">
post
</th>
<th style="text-align:left;">
pattern
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
text1
</td>
<td style="text-align:right;">
379
</td>
<td style="text-align:right;">
380
</td>
<td style="text-align:left;">
FOR EXISTENCE . Bears on
</td>
<td style="text-align:left;">
natural selection
</td>
<td style="text-align:left;">
. The term used in
</td>
<td style="text-align:left;">
natural selection
</td>
</tr>
<tr>
<td style="text-align:left;">
text1
</td>
<td style="text-align:right;">
473
</td>
<td style="text-align:right;">
474
</td>
<td style="text-align:left;">
relations . CHAPTER 4 .
</td>
<td style="text-align:left;">
NATURAL SELECTION
</td>
<td style="text-align:left;">
. Natural Selection : its
</td>
<td style="text-align:left;">
natural selection
</td>
</tr>
<tr>
<td style="text-align:left;">
text1
</td>
<td style="text-align:right;">
476
</td>
<td style="text-align:right;">
477
</td>
<td style="text-align:left;">
4 . NATURAL SELECTION .
</td>
<td style="text-align:left;">
Natural Selection
</td>
<td style="text-align:left;">
: its power compared with
</td>
<td style="text-align:left;">
natural selection
</td>
</tr>
<tr>
<td style="text-align:left;">
text1
</td>
<td style="text-align:right;">
524
</td>
<td style="text-align:right;">
525
</td>
<td style="text-align:left;">
Circumstances favourable and unfavourable to
</td>
<td style="text-align:left;">
Natural Selection
</td>
<td style="text-align:left;">
, namely , intercrossing ,
</td>
<td style="text-align:left;">
natural selection
</td>
</tr>
<tr>
<td style="text-align:left;">
text1
</td>
<td style="text-align:right;">
543
</td>
<td style="text-align:right;">
544
</td>
<td style="text-align:left;">
action . Extinction caused by
</td>
<td style="text-align:left;">
Natural Selection
</td>
<td style="text-align:left;">
. Divergence of Character ,
</td>
<td style="text-align:left;">
natural selection
</td>
</tr>
<tr>
<td style="text-align:left;">
text1
</td>
<td style="text-align:right;">
567
</td>
<td style="text-align:right;">
568
</td>
<td style="text-align:left;">
to naturalisation . Action of
</td>
<td style="text-align:left;">
Natural Selection
</td>
<td style="text-align:left;">
, through Divergence of Character
</td>
<td style="text-align:left;">
natural selection
</td>
</tr>
</tbody>
</table>
<p>Of course you can extend this to longer sequences such as entire sentences. However, you may want to extract more or less concrete patterns rather than words or phrases. To search for patterns rather than words, you need to include regular expressions in your search pattern.</p>
</div>
<div id="searches-using-regular-expressions" class="section level2 unnumbered">
<h2>Searches using regular expressions</h2>
<p>Regular expressions allow you to search for abstract patterns rather than concrete words or phrases which provides you with an extreme flexibility in what you can retrieve. A regular expression (in short also called <em>regex</em> or <em>regexp</em>) is a special sequence of characters that stand for are that describe a pattern. You can think of regular expressions as very powerful combinations of wildcards or as wildcards on steroids. For example, the sequence <code>[a-z]{1,3}</code> is a regular expression that stands for one up to three lower case characters and if you searched for this regular expression, you would get, for instance, <em>is</em>, <em>a</em>, <em>an</em>, <em>of</em>, <em>the</em>, <em>my</em>, <em>our</em>, <em>etc</em>, and many other short words as results.</p>
<p>There are three basic types of regular expressions:</p>
<ul>
<li><p>regular expressions that stand for individual symbols and determine frequencies</p></li>
<li><p>regular expressions that stand for classes of symbols</p></li>
<li><p>regular expressions that stand for structural properties</p></li>
</ul>
<p>The regular expressions below show the first type of regular expressions, i.e. regular expressions that stand for individual symbols and determine frequencies.</p>
<table class="table table-striped" style="">
<caption>
Regular expressions that stand for individual symbols and determine frequencies.
</caption>
<thead>
<tr>
<th style="text-align:left;">
RegEx Symbol/Sequence
</th>
<th style="text-align:left;">
Explanation
</th>
<th style="text-align:left;">
Example
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
?
</td>
<td style="text-align:left;">
The preceding item is optional and will be matched at most once
</td>
<td style="text-align:left;">
walk[a-z]? = walk, walks
</td>
</tr>
<tr>
<td style="text-align:left;">
*
</td>
<td style="text-align:left;">
The preceding item will be matched zero or more times
</td>
<td style="text-align:left;">
walk[a-z]* = walk, walks, walked, walking
</td>
</tr>
<tr>
<td style="text-align:left;">
+
</td>
<td style="text-align:left;">
The preceding item will be matched one or more times
</td>
<td style="text-align:left;">
walk[a-z]+ = walks, walked, walking
</td>
</tr>
<tr>
<td style="text-align:left;">
{n}
</td>
<td style="text-align:left;">
The preceding item is matched exactly n times
</td>
<td style="text-align:left;">
walk[a-z]{2} = walked
</td>
</tr>
<tr>
<td style="text-align:left;">
{n,}
</td>
<td style="text-align:left;">
The preceding item is matched n or more times
</td>
<td style="text-align:left;">
walk[a-z]{2,} = walked, walking
</td>
</tr>
<tr>
<td style="text-align:left;">
{n,m}
</td>
<td style="text-align:left;">
The preceding item is matched at least n times, but not more than m times
</td>
<td style="text-align:left;">
walk[a-z]{2,3} = walked, walking
</td>
</tr>
</tbody>
</table>
<p>The regular expressions below show the second type of regular expressions, i.e. regular expressions that stand for classes of symbols.</p>
<table class="table table-striped" style="">
<caption>
Regular expressions that stand for classes of symbols.
</caption>
<thead>
<tr>
<th style="text-align:left;">
RegEx Symbol/Sequence
</th>
<th style="text-align:left;">
Explanation
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
[ab]
</td>
<td style="text-align:left;">
lower case a and b
</td>
</tr>
<tr>
<td style="text-align:left;">
[AB]
</td>
<td style="text-align:left;">
upper case a and b
</td>
</tr>
<tr>
<td style="text-align:left;">
[12]
</td>
<td style="text-align:left;">
digits 1 and 2
</td>
</tr>
<tr>
<td style="text-align:left;">
[:digit:]
</td>
<td style="text-align:left;">
digits: 0 1 2 3 4 5 6 7 8 9
</td>
</tr>
<tr>
<td style="text-align:left;">
[:lower:]
</td>
<td style="text-align:left;">
lower case characters: a–z
</td>
</tr>
<tr>
<td style="text-align:left;">
[:upper:]
</td>
<td style="text-align:left;">
upper case characters: A–Z
</td>
</tr>
<tr>
<td style="text-align:left;">
[:alpha:]
</td>
<td style="text-align:left;">
alphabetic characters: a–z and A–Z
</td>
</tr>
<tr>
<td style="text-align:left;">
[:alnum:]
</td>
<td style="text-align:left;">
digits and alphabetic characters
</td>
</tr>
<tr>
<td style="text-align:left;">
[:punct:]
</td>
<td style="text-align:left;">
punctuation characters: . , ; etc.
</td>
</tr>
<tr>
<td style="text-align:left;">
[:graph:]
</td>
<td style="text-align:left;">
graphical characters: [:alnum:] and [:punct:]
</td>
</tr>
<tr>
<td style="text-align:left;">
[:blank:]
</td>
<td style="text-align:left;">
blank characters: Space and tab
</td>
</tr>
<tr>
<td style="text-align:left;">
[:space:]
</td>
<td style="text-align:left;">
space characters: Space, tab, newline, and other space characters
</td>
</tr>
<tr>
<td style="text-align:left;">
[:print:]
</td>
<td style="text-align:left;">
printable characters: [:alnum:], [:punct:] and [:space:]
</td>
</tr>
</tbody>
</table>
<p>The regular expressions that denote classes of symbols are enclosed in <code>[]</code> and <code>:</code>. The last type of regular expressions, i.e. regular expressions that stand for structural properties are shown below.</p>
<table class="table table-striped" style="">
<caption>
Regular expressions that stand for structural properties.
</caption>
<thead>
<tr>
<th style="text-align:left;">
RegEx Symbol/Sequence
</th>
<th style="text-align:left;">
Explanation
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
\
</td>
<td style="text-align:left;">
Word characters: [[:alnum:]_]
</td>
</tr>
<tr>
<td style="text-align:left;">
\
</td>
<td style="text-align:left;">
No word characters: [^[:alnum:]_]
</td>
</tr>
<tr>
<td style="text-align:left;">
\
</td>
<td style="text-align:left;">
Space characters: [[:blank:]]
</td>
</tr>
<tr>
<td style="text-align:left;">
\
</td>
<td style="text-align:left;">
No space characters: [^[:blank:]]
</td>
</tr>
<tr>
<td style="text-align:left;">
\/td&gt;
<td style="text-align:left;">
Digits: [[:digit:]]
</td>
</tr>
<tr>
<td style="text-align:left;">
\
</td>
<td style="text-align:left;">
No digits: [^[:digit:]]
</td>
</tr>
<tr>
<td style="text-align:left;">
\/td&gt;
<td style="text-align:left;">
Word edge
</td>
</tr>
<tr>
<td style="text-align:left;">
\
</td>
<td style="text-align:left;">
No word edge
</td>
</tr>
<tr>
<td style="text-align:left;">
\&lt;
</td>
<td style="text-align:left;">
Word beginning
</td>
</tr>
<tr>
<td style="text-align:left;">
\&gt;
</td>
<td style="text-align:left;">
Word end
</td>
</tr>
<tr>
<td style="text-align:left;">
^
</td>
<td style="text-align:left;">
Beginning of a string
</td>
</tr>
<tr>
<td style="text-align:left;">
$
</td>
<td style="text-align:left;">
End of a string
</td>
</tr>
</tbody>
</table>
<p>To include regular expressions in your KWIC searches, you include them in your search pattern and set the argument <code>valuetype</code> to <code>"regex"</code>. The search pattern <code>"\\bnatu.*|\\bselec.*"</code> retrieves elements that contain <code>natu</code> and <code>selec</code> followed by any characters and where the <code>n</code> in <code>natu</code> and the <code>s</code> in <code>selec</code> are at a word boundary, i.e. where they are the first letters of a word. Hence, our serach would not retrieve words like <em>unnatural</em> or <em>deselect</em>. The <code>|</code> is an operator (like <code>+</code>, <code>-</code>, or <code>*</code>) that stands for <em>or</em>.</p>
<pre class="r"><code># define search patterns
patterns &lt;- c(&quot;\\bnatu.*|\\bselec.*&quot;)
kwic_regex &lt;- kwic(origin, patterns, valuetype = &quot;regex&quot;)
# inspect data
kable(head(kwic_regex), caption = &quot;First 6 concordances for the regular expression \\bnatu.*.&quot;) %&gt;%
  kable_styling(bootstrap_options = &quot;striped&quot;, full_width = T, position = &quot;left&quot;)</code></pre>
<table class="table table-striped" style="">
<caption>
First 6 concordances for the regular expression .*.
</caption>
<thead>
<tr>
<th style="text-align:left;">
docname
</th>
<th style="text-align:right;">
from
</th>
<th style="text-align:right;">
to
</th>
<th style="text-align:left;">
pre
</th>
<th style="text-align:left;">
keyword
</th>
<th style="text-align:left;">
post
</th>
<th style="text-align:left;">
pattern
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
text1
</td>
<td style="text-align:right;">
269
</td>
<td style="text-align:right;">
269
</td>
<td style="text-align:left;">
and Origin . Principle of
</td>
<td style="text-align:left;">
Selection
</td>
<td style="text-align:left;">
anciently followed , its Effects
</td>
<td style="text-align:left;">
.<em>|.</em>
</td>
</tr>
<tr>
<td style="text-align:left;">
text1
</td>
<td style="text-align:right;">
279
</td>
<td style="text-align:right;">
279
</td>
<td style="text-align:left;">
Effects . Methodical and Unconscious
</td>
<td style="text-align:left;">
Selection
</td>
<td style="text-align:left;">
. Unknown Origin of our
</td>
<td style="text-align:left;">
.<em>|.</em>
</td>
</tr>
<tr>
<td style="text-align:left;">
text1
</td>
<td style="text-align:right;">
294
</td>
<td style="text-align:right;">
294
</td>
<td style="text-align:left;">
favourable to Man’s power of
</td>
<td style="text-align:left;">
Selection
</td>
<td style="text-align:left;">
. CHAPTER 2 . VARIATION
</td>
<td style="text-align:left;">
.<em>|.</em>
</td>
</tr>
<tr>
<td style="text-align:left;">
text1
</td>
<td style="text-align:right;">
301
</td>
<td style="text-align:right;">
301
</td>
<td style="text-align:left;">
CHAPTER 2 . VARIATION UNDER
</td>
<td style="text-align:left;">
NATURE
</td>
<td style="text-align:left;">
. Variability . Individual Differences
</td>
<td style="text-align:left;">
.<em>|.</em>
</td>
</tr>
<tr>
<td style="text-align:left;">
text1
</td>
<td style="text-align:right;">
379
</td>
<td style="text-align:right;">
379
</td>
<td style="text-align:left;">
FOR EXISTENCE . Bears on
</td>
<td style="text-align:left;">
natural
</td>
<td style="text-align:left;">
selection . The term used
</td>
<td style="text-align:left;">
.<em>|.</em>
</td>
</tr>
<tr>
<td style="text-align:left;">
text1
</td>
<td style="text-align:right;">
380
</td>
<td style="text-align:right;">
380
</td>
<td style="text-align:left;">
EXISTENCE . Bears on natural
</td>
<td style="text-align:left;">
selection
</td>
<td style="text-align:left;">
. The term used in
</td>
<td style="text-align:left;">
.<em>|.</em>
</td>
</tr>
</tbody>
</table>
</div>
<div id="piping-concordances" class="section level2 unnumbered">
<h2>Piping concordances</h2>
<p>Quite often, we only want to retrieve patterns if they occur in a certain context. For instance, we might be interested in instances of <em>selection</em> but only if the preceding word is <em>natural</em>. Such conditional concordances could be extracted using regular expressions but they are easier to retrieve by piping. Piping is done using the <code>%&gt;%</code> function from the <code>dplyr</code> package and the piping sequence can be translated as <em>and then</em>. We can then filter those concordances that contain <em>natural</em> using the <code>filter</code> function from the <code>dplyr</code> package. Note the the <code>$</code> stands for the end of a string so that <em>natural$</em> means that <em>natural</em> is the last element in the string that is preceding the keyword.</p>
<pre class="r"><code>kwic_pipe &lt;- kwic(x = origin, pattern = &quot;selection&quot;) %&gt;%
  filter(str_detect(pre, &quot;natural$|NATURAL$&quot;))
# inspect data
kable(head(kwic_pipe), caption = &quot;First 6 concordances for instances of *selection* that are preceeded by *natural*.&quot;) %&gt;%
  kable_styling(bootstrap_options = &quot;striped&quot;, full_width = T, position = &quot;left&quot;)</code></pre>
<table class="table table-striped" style="">
<caption>
First 6 concordances for instances of <em>selection</em> that are preceeded by <em>natural</em>.
</caption>
<thead>
<tr>
<th style="text-align:left;">
docname
</th>
<th style="text-align:right;">
from
</th>
<th style="text-align:right;">
to
</th>
<th style="text-align:left;">
pre
</th>
<th style="text-align:left;">
keyword
</th>
<th style="text-align:left;">
post
</th>
<th style="text-align:left;">
pattern
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
text1
</td>
<td style="text-align:right;">
380
</td>
<td style="text-align:right;">
380
</td>
<td style="text-align:left;">
EXISTENCE . Bears on natural
</td>
<td style="text-align:left;">
selection
</td>
<td style="text-align:left;">
. The term used in
</td>
<td style="text-align:left;">
selection
</td>
</tr>
<tr>
<td style="text-align:left;">
text1
</td>
<td style="text-align:right;">
474
</td>
<td style="text-align:right;">
474
</td>
<td style="text-align:left;">
. CHAPTER 4 . NATURAL
</td>
<td style="text-align:left;">
SELECTION
</td>
<td style="text-align:left;">
. Natural Selection : its
</td>
<td style="text-align:left;">
selection
</td>
</tr>
<tr>
<td style="text-align:left;">
text1
</td>
<td style="text-align:right;">
612
</td>
<td style="text-align:right;">
612
</td>
<td style="text-align:left;">
disuse , combined with natural
</td>
<td style="text-align:left;">
selection
</td>
<td style="text-align:left;">
; organs of flight and
</td>
<td style="text-align:left;">
selection
</td>
</tr>
<tr>
<td style="text-align:left;">
text1
</td>
<td style="text-align:right;">
1455
</td>
<td style="text-align:right;">
1455
</td>
<td style="text-align:left;">
far the theory of natural
</td>
<td style="text-align:left;">
selection
</td>
<td style="text-align:left;">
may be extended . Effects
</td>
<td style="text-align:left;">
selection
</td>
</tr>
<tr>
<td style="text-align:left;">
text1
</td>
<td style="text-align:right;">
6474
</td>
<td style="text-align:right;">
6474
</td>
<td style="text-align:left;">
do occur ; but natural
</td>
<td style="text-align:left;">
selection
</td>
<td style="text-align:left;">
, as will hereafter be
</td>
<td style="text-align:left;">
selection
</td>
</tr>
<tr>
<td style="text-align:left;">
text1
</td>
<td style="text-align:right;">
14664
</td>
<td style="text-align:right;">
14664
</td>
<td style="text-align:left;">
a process of " natural
</td>
<td style="text-align:left;">
selection
</td>
<td style="text-align:left;">
, " as will hereafter
</td>
<td style="text-align:left;">
selection
</td>
</tr>
</tbody>
</table>
<p>Piping is a very useful helper function and it is very frequently used in R - not only in the context of text processing but in all data science related domains.</p>
</div>
<div id="arranging-concordances-and-adding-frequency-information" class="section level2 unnumbered">
<h2>Arranging concordances and adding frequency information</h2>
<p>When inspecting concordances, it is useful to re-order the concordances so that they do not appear in the order that they appeared in the text or texts but by the context. To reorder concordances, we can use the <code>arrange</code> function from the <code>dplyr</code> package which takes the column according to which we want to re-arrange the data as it main argument.</p>
<p>In the example below, we extract all instances of <em>natural</em> and then arrange the instances according to the content of the <code>post</code> column in alphabetical.</p>
<pre class="r"><code>kwic_ordered &lt;- kwic(x = origin, pattern = &quot;natural&quot;) %&gt;%
  arrange(post)
# inspect data
kable(head(kwic_ordered), caption = &quot;First 6 re-ordered concordances for instances of *natural*.&quot;) %&gt;%
  kable_styling(bootstrap_options = &quot;striped&quot;, full_width = T, position = &quot;left&quot;)</code></pre>
<table class="table table-striped" style="">
<caption>
First 6 re-ordered concordances for instances of <em>natural</em>.
</caption>
<thead>
<tr>
<th style="text-align:left;">
docname
</th>
<th style="text-align:right;">
from
</th>
<th style="text-align:right;">
to
</th>
<th style="text-align:left;">
pre
</th>
<th style="text-align:left;">
keyword
</th>
<th style="text-align:left;">
post
</th>
<th style="text-align:left;">
pattern
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
text1
</td>
<td style="text-align:right;">
175809
</td>
<td style="text-align:right;">
175809
</td>
<td style="text-align:left;">
, 190 . System ,
</td>
<td style="text-align:left;">
natural
</td>
<td style="text-align:left;">
, 413 . Tail :
</td>
<td style="text-align:left;">
natural
</td>
</tr>
<tr>
<td style="text-align:left;">
text1
</td>
<td style="text-align:right;">
176269
</td>
<td style="text-align:right;">
176269
</td>
<td style="text-align:left;">
, 159 . Varieties :
</td>
<td style="text-align:left;">
natural
</td>
<td style="text-align:left;">
, 44 . struggle between
</td>
<td style="text-align:left;">
natural
</td>
</tr>
<tr>
<td style="text-align:left;">
text1
</td>
<td style="text-align:right;">
175333
</td>
<td style="text-align:right;">
175333
</td>
<td style="text-align:left;">
. unconscious , 34 .
</td>
<td style="text-align:left;">
natural
</td>
<td style="text-align:left;">
, 80 . sexual ,
</td>
<td style="text-align:left;">
natural
</td>
</tr>
<tr>
<td style="text-align:left;">
text1
</td>
<td style="text-align:right;">
146888
</td>
<td style="text-align:right;">
146888
</td>
<td style="text-align:left;">
and this would be strictly
</td>
<td style="text-align:left;">
natural
</td>
<td style="text-align:left;">
, as it would connect
</td>
<td style="text-align:left;">
natural
</td>
</tr>
<tr>
<td style="text-align:left;">
text1
</td>
<td style="text-align:right;">
175341
</td>
<td style="text-align:right;">
175341
</td>
<td style="text-align:left;">
. sexual , 87 .
</td>
<td style="text-align:left;">
natural
</td>
<td style="text-align:left;">
, circumstances favourable to ,
</td>
<td style="text-align:left;">
natural
</td>
</tr>
<tr>
<td style="text-align:left;">
text1
</td>
<td style="text-align:right;">
145995
</td>
<td style="text-align:right;">
145995
</td>
<td style="text-align:left;">
genealogical in order to be
</td>
<td style="text-align:left;">
natural
</td>
<td style="text-align:left;">
; but that the AMOUNT
</td>
<td style="text-align:left;">
natural
</td>
</tr>
</tbody>
</table>
<p>Arranging concordances according to alphabetical properties may, however, not be the most useful option. A more useful option may be to arrange concordances according to the frequency of co-occurring terms or collocates. In order to do this, we need to extract the co-occurring words and calculate their frequency. We can do this by combining the <code>mutate</code>, <code>group_by</code>, <code>n()</code> functions from the <code>dplyr</code> package with the <code>str_remove_all</code> function from the <code>stringr</code> package. Then, we arrange the concordances by the frequency of the collocates in descending order (that is why we put a <code>-</code> in the arrange function). In order to do this, we need to</p>
<ol style="list-style-type: decimal">
<li><p>create a new variable or column which represents the word that co-occurs with, or, as in the example below, immediately follows the search term. In the example below, we use the <code>mutate</code> function to create a new column called <code>post_word</code>. We then use the <code>str_remove_all</code> function to remove everything except for the word that immediately follows the search term (we simply remove everything and including a white space).</p></li>
<li><p>group the data by the word that immediately follows the search term.</p></li>
<li><p>create a new column called <code>post_word_freq</code> which represents the frequencies of all the words that immediately follow the search term.</p></li>
<li><p>arrange the concordances by the frequency of the collocates in descending order.</p></li>
</ol>
<pre class="r"><code>kwic_ordered_coll &lt;- kwic(x = origin, pattern = &quot;natural&quot;) %&gt;%
  mutate(post_word = str_remove_all(pre, &quot; .*&quot;)) %&gt;%
  group_by(post_word) %&gt;%
  mutate(post_word_freq = n()) %&gt;%
  arrange(-post_word_freq)
# inspect data
kable(head(kwic_ordered_coll), caption = &quot;First 6 re-ordered concordances for instances of *natural*.&quot;) %&gt;%
  kable_styling(bootstrap_options = &quot;striped&quot;, full_width = T, position = &quot;left&quot;)</code></pre>
<table class="table table-striped" style="">
<caption>
First 6 re-ordered concordances for instances of <em>natural</em>.
</caption>
<thead>
<tr>
<th style="text-align:left;">
docname
</th>
<th style="text-align:right;">
from
</th>
<th style="text-align:right;">
to
</th>
<th style="text-align:left;">
pre
</th>
<th style="text-align:left;">
keyword
</th>
<th style="text-align:left;">
post
</th>
<th style="text-align:left;">
pattern
</th>
<th style="text-align:left;">
post_word
</th>
<th style="text-align:right;">
post_word_freq
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
text1
</td>
<td style="text-align:right;">
3394
</td>
<td style="text-align:right;">
3394
</td>
<td style="text-align:left;">
, I am convinced that
</td>
<td style="text-align:left;">
Natural
</td>
<td style="text-align:left;">
Selection has been the main
</td>
<td style="text-align:left;">
natural
</td>
<td style="text-align:left;">
,
</td>
<td style="text-align:right;">
29
</td>
</tr>
<tr>
<td style="text-align:left;">
text1
</td>
<td style="text-align:right;">
19498
</td>
<td style="text-align:right;">
19498
</td>
<td style="text-align:left;">
, to the action of
</td>
<td style="text-align:left;">
natural
</td>
<td style="text-align:left;">
selection in accumulating ( as
</td>
<td style="text-align:left;">
natural
</td>
<td style="text-align:left;">
,
</td>
<td style="text-align:right;">
29
</td>
</tr>
<tr>
<td style="text-align:left;">
text1
</td>
<td style="text-align:right;">
22752
</td>
<td style="text-align:right;">
22752
</td>
<td style="text-align:left;">
, by the term of
</td>
<td style="text-align:left;">
Natural
</td>
<td style="text-align:left;">
Selection , in order to
</td>
<td style="text-align:left;">
natural
</td>
<td style="text-align:left;">
,
</td>
<td style="text-align:right;">
29
</td>
</tr>
<tr>
<td style="text-align:left;">
text1
</td>
<td style="text-align:right;">
31819
</td>
<td style="text-align:right;">
31819
</td>
<td style="text-align:left;">
, and if so ,
</td>
<td style="text-align:left;">
natural
</td>
<td style="text-align:left;">
selection will be able to
</td>
<td style="text-align:left;">
natural
</td>
<td style="text-align:left;">
,
</td>
<td style="text-align:right;">
29
</td>
</tr>
<tr>
<td style="text-align:left;">
text1
</td>
<td style="text-align:right;">
32745
</td>
<td style="text-align:right;">
32745
</td>
<td style="text-align:left;">
, as I believe ,
</td>
<td style="text-align:left;">
natural
</td>
<td style="text-align:left;">
selection acts , I must
</td>
<td style="text-align:left;">
natural
</td>
<td style="text-align:left;">
,
</td>
<td style="text-align:right;">
29
</td>
</tr>
<tr>
<td style="text-align:left;">
text1
</td>
<td style="text-align:right;">
39277
</td>
<td style="text-align:right;">
39277
</td>
<td style="text-align:left;">
, I do believe that
</td>
<td style="text-align:left;">
natural
</td>
<td style="text-align:left;">
selection will always act very
</td>
<td style="text-align:left;">
natural
</td>
<td style="text-align:left;">
,
</td>
<td style="text-align:right;">
29
</td>
</tr>
</tbody>
</table>
<p>We add more columns according to which we could arrange the concordance following the same schema. For example, we could add another column that represented the frequency of words that immediately preceded the search term and then arrange according to this column.</p>
</div>
<div id="concordances-from-transcriptions" class="section level2 unnumbered">
<h2>Concordances from transcriptions</h2>
<p>As many analyses use transcripts as their primary data and because transcripts have features that require additional processing, we will now perform concordancing based on on transcripts. As a first step, we load five example transcripts that represent the first five files from the Irish component of the <a href="https://www.ice-corpora.uzh.ch/en.html">International Corpus of English</a>.</p>
<pre class="r"><code># define corpus files
files &lt;- paste(&quot;https://slcladal.github.io/data/ICEIrelandSample/S1A-00&quot;, 1:5, &quot;.txt&quot;, sep = &quot;&quot;)
# load corpus files
transcripts &lt;- sapply(files, function(x){
  x &lt;- readLines(x)
})
# inspect first ten lines of the first transcript
transcripts[[1]][1:10]</code></pre>
<pre><code>##  [1] &quot;&lt;S1A-001 Riding&gt;&quot;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
##  [2] &quot;&quot;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
##  [3] &quot;&lt;I&gt;&quot;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
##  [4] &quot;&lt;S1A-001$A&gt; &lt;#&gt; Well how did the riding go tonight&quot;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
##  [5] &quot;&lt;S1A-001$B&gt; &lt;#&gt; It was good so it was &lt;#&gt; Just I I couldn&#39;t believe that she was going to let me jump &lt;,&gt; that was only the fourth time you know &lt;#&gt; It was great &lt;&amp;&gt; laughter &lt;/&amp;&gt;&quot;                                                                                                                                                                                                                                                                                                                                                                                                                                    
##  [6] &quot;&lt;S1A-001$A&gt; &lt;#&gt; What did you call your horse&quot;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
##  [7] &quot;&lt;S1A-001$B&gt; &lt;#&gt; I can&#39;t remember &lt;#&gt; Oh Mary &#39;s Town &lt;,&gt; oh&quot;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
##  [8] &quot;&lt;S1A-001$A&gt; &lt;#&gt; And how did Mabel do&quot;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
##  [9] &quot;&lt;S1A-001$B&gt; &lt;#&gt; Did you not see her whenever she was going over the jumps &lt;#&gt; There was one time her horse refused and it refused three times &lt;#&gt; And then &lt;,&gt; she got it round and she just lined it up straight and she just kicked it and she hit it with the whip &lt;,&gt; and over it went the last time you know &lt;#&gt; And Stephanie told her she was very determined and very well-ridden &lt;&amp;&gt; laughter &lt;/&amp;&gt; because it had refused the other times you know &lt;#&gt; But Stephanie wouldn&#39;t let her give up on it &lt;#&gt; She made her keep coming back and keep coming back &lt;,&gt; until &lt;,&gt; it jumped it you know &lt;#&gt; It was good&quot;
## [10] &quot;&lt;S1A-001$A&gt; &lt;#&gt; Yeah I &#39;m not so sure her jumping &#39;s improving that much &lt;#&gt; She uh &lt;,&gt; seemed to be holding the reins very tight&quot;</code></pre>
<p>The first ten lines shown above let us know that, after the header (<code>&lt;S1A-001 Riding&gt;</code>) and the symbol which indicates the start of the transcript (<code>&lt;I&gt;</code>), each utterance is preceded by a sequence which indicates the section, file, and speaker (e.g. <code>&lt;S1A-001$A&gt;</code>). The first utterance is thus uttered by speaker <code>A</code> in file <code>001</code> of section <code>S1A</code>. In addition, there are several sequences that provide meta-linguistic information which indicate the beginning of a speech unit (<code>&lt;#&gt;</code>), pauses (<code>&lt;,&gt;</code>), and laughter (<code>&lt;&amp;&gt; laughter &lt;/&amp;&gt;</code>).</p>
<p>To perform the concordancing, we need to change the format of the transcripts because the <code>kwic</code> function only works on character, corpus, tokens object- in their present form, the transcripts represent a list which contains vectors of strings. To change the format, we collapse the individual utterances into a single character vector for each transcript.</p>
<pre class="r"><code>transcripts_collapsed &lt;- sapply(files, function(x){
  x &lt;- readLines(x)
  x &lt;- paste0(x, collapse = &quot; &quot;)
  x &lt;- str_squish(x)
})
# inspect data
str(transcripts_collapsed)</code></pre>
<pre><code>##  Named chr [1:5] &quot;&lt;S1A-001 Riding&gt; &lt;I&gt; &lt;S1A-001$A&gt; &lt;#&gt; Well how did the riding go tonight &lt;S1A-001$B&gt; &lt;#&gt; It was good so it was &lt;&quot;| __truncated__ ...
##  - attr(*, &quot;names&quot;)= chr [1:5] &quot;https://slcladal.github.io/data/ICEIrelandSample/S1A-001.txt&quot; &quot;https://slcladal.github.io/data/ICEIrelandSample/S1A-002.txt&quot; &quot;https://slcladal.github.io/data/ICEIrelandSample/S1A-003.txt&quot; &quot;https://slcladal.github.io/data/ICEIrelandSample/S1A-004.txt&quot; ...</code></pre>
<p>We can now extract the concordances.</p>
<pre class="r"><code>kwic_trans &lt;- kwic(x = transcripts_collapsed, pattern = phrase(&quot;you know&quot;))
# inspect data
kable(head(kwic_trans), caption = &quot;First 6 concordances for *you know* in three example transcripts.&quot;) %&gt;%
  kable_styling(bootstrap_options = &quot;striped&quot;, full_width = T, position = &quot;left&quot;)</code></pre>
<table class="table table-striped" style="">
<caption>
First 6 concordances for <em>you know</em> in three example transcripts.
</caption>
<thead>
<tr>
<th style="text-align:left;">
docname
</th>
<th style="text-align:right;">
from
</th>
<th style="text-align:right;">
to
</th>
<th style="text-align:left;">
pre
</th>
<th style="text-align:left;">
keyword
</th>
<th style="text-align:left;">
post
</th>
<th style="text-align:left;">
pattern
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
<a href="https://slcladal.github.io/data/ICEIrelandSample/S1A-001.txt" class="uri">https://slcladal.github.io/data/ICEIrelandSample/S1A-001.txt</a>
</td>
<td style="text-align:right;">
62
</td>
<td style="text-align:right;">
63
</td>
<td style="text-align:left;">
was only the fourth time
</td>
<td style="text-align:left;">
you know
</td>
<td style="text-align:left;">
&lt; # &gt; It was
</td>
<td style="text-align:left;">
you know
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="https://slcladal.github.io/data/ICEIrelandSample/S1A-001.txt" class="uri">https://slcladal.github.io/data/ICEIrelandSample/S1A-001.txt</a>
</td>
<td style="text-align:right;">
204
</td>
<td style="text-align:right;">
205
</td>
<td style="text-align:left;">
it went the last time
</td>
<td style="text-align:left;">
you know
</td>
<td style="text-align:left;">
&lt; # &gt; And Stephanie
</td>
<td style="text-align:left;">
you know
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="https://slcladal.github.io/data/ICEIrelandSample/S1A-001.txt" class="uri">https://slcladal.github.io/data/ICEIrelandSample/S1A-001.txt</a>
</td>
<td style="text-align:right;">
235
</td>
<td style="text-align:right;">
236
</td>
<td style="text-align:left;">
had refused the other times
</td>
<td style="text-align:left;">
you know
</td>
<td style="text-align:left;">
&lt; # &gt; But Stephanie
</td>
<td style="text-align:left;">
you know
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="https://slcladal.github.io/data/ICEIrelandSample/S1A-001.txt" class="uri">https://slcladal.github.io/data/ICEIrelandSample/S1A-001.txt</a>
</td>
<td style="text-align:right;">
272
</td>
<td style="text-align:right;">
273
</td>
<td style="text-align:left;">
, &gt; it jumped it
</td>
<td style="text-align:left;">
you know
</td>
<td style="text-align:left;">
&lt; # &gt; It was
</td>
<td style="text-align:left;">
you know
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="https://slcladal.github.io/data/ICEIrelandSample/S1A-001.txt" class="uri">https://slcladal.github.io/data/ICEIrelandSample/S1A-001.txt</a>
</td>
<td style="text-align:right;">
602
</td>
<td style="text-align:right;">
603
</td>
<td style="text-align:left;">
that one &lt; , &gt;
</td>
<td style="text-align:left;">
you know
</td>
<td style="text-align:left;">
and starting anew fresh &lt;
</td>
<td style="text-align:left;">
you know
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="https://slcladal.github.io/data/ICEIrelandSample/S1A-001.txt" class="uri">https://slcladal.github.io/data/ICEIrelandSample/S1A-001.txt</a>
</td>
<td style="text-align:right;">
665
</td>
<td style="text-align:right;">
666
</td>
<td style="text-align:left;">
{ &gt; &lt; [ &gt;
</td>
<td style="text-align:left;">
you know
</td>
<td style="text-align:left;">
&lt; / [ &gt; &lt;
</td>
<td style="text-align:left;">
you know
</td>
</tr>
</tbody>
</table>
<p>The results show that each non-alphanumeric character is counted as a single word which reduces the context of the keyword substantially. Also, the docname column contains the full path to the data which make it hard to parse the content of the table. To address the first issue, we remove symbols by adding <code>remove_symbols = T</code> and remove punctuation by adding <code>remove_punct = T</code>. In addition, we clean the docname column and extract only the file name.</p>
<pre class="r"><code>kwic_trans &lt;- kwic(x = transcripts_collapsed, pattern = phrase(&quot;you know&quot;),
                   remove_symbols = T, remove_punct = T)
# clean docnames
kwic_trans$docname &lt;- kwic_trans$docname %&gt;%
  str_replace_all(&quot;.*/([A-Z][0-9][A-Z]-[0-9]{1,3}).txt&quot;, &quot;\\1&quot;) 
# inspect data
kable(head(kwic_trans), caption = &quot;First 6 concordances for *you know* in three example transcripts.&quot;) %&gt;%
  kable_styling(bootstrap_options = &quot;striped&quot;, full_width = T, position = &quot;left&quot;)</code></pre>
<table class="table table-striped" style="">
<caption>
First 6 concordances for <em>you know</em> in three example transcripts.
</caption>
<thead>
<tr>
<th style="text-align:left;">
docname
</th>
<th style="text-align:right;">
from
</th>
<th style="text-align:right;">
to
</th>
<th style="text-align:left;">
pre
</th>
<th style="text-align:left;">
keyword
</th>
<th style="text-align:left;">
post
</th>
<th style="text-align:left;">
pattern
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
S1A-001
</td>
<td style="text-align:right;">
40
</td>
<td style="text-align:right;">
41
</td>
<td style="text-align:left;">
was only the fourth time
</td>
<td style="text-align:left;">
you know
</td>
<td style="text-align:left;">
It was great laughter S1A-001
</td>
<td style="text-align:left;">
you know
</td>
</tr>
<tr>
<td style="text-align:left;">
S1A-001
</td>
<td style="text-align:right;">
129
</td>
<td style="text-align:right;">
130
</td>
<td style="text-align:left;">
it went the last time
</td>
<td style="text-align:left;">
you know
</td>
<td style="text-align:left;">
And Stephanie told her she
</td>
<td style="text-align:left;">
you know
</td>
</tr>
<tr>
<td style="text-align:left;">
S1A-001
</td>
<td style="text-align:right;">
150
</td>
<td style="text-align:right;">
151
</td>
<td style="text-align:left;">
had refused the other times
</td>
<td style="text-align:left;">
you know
</td>
<td style="text-align:left;">
But Stephanie wouldn’t let her
</td>
<td style="text-align:left;">
you know
</td>
</tr>
<tr>
<td style="text-align:left;">
S1A-001
</td>
<td style="text-align:right;">
175
</td>
<td style="text-align:right;">
176
</td>
<td style="text-align:left;">
back until it jumped it
</td>
<td style="text-align:left;">
you know
</td>
<td style="text-align:left;">
It was good S1A-001 A
</td>
<td style="text-align:left;">
you know
</td>
</tr>
<tr>
<td style="text-align:left;">
S1A-001
</td>
<td style="text-align:right;">
256
</td>
<td style="text-align:right;">
257
</td>
<td style="text-align:left;">
quite a few weeks now
</td>
<td style="text-align:left;">
you know
</td>
<td style="text-align:left;">
any proper jumping really And
</td>
<td style="text-align:left;">
you know
</td>
</tr>
<tr>
<td style="text-align:left;">
S1A-001
</td>
<td style="text-align:right;">
355
</td>
<td style="text-align:right;">
356
</td>
<td style="text-align:left;">
better waiting for that one
</td>
<td style="text-align:left;">
you know
</td>
<td style="text-align:left;">
and starting anew fresh S1A-001
</td>
<td style="text-align:left;">
you know
</td>
</tr>
</tbody>
</table>
<p>We could also extend the context window and merge the symbols that the <code>kwic</code> function has separated.</p>
<p>Extending the context can also be used to identify the speaker that has uttered the search pattern that we are interested in. We will do just that as this is a common task in linguistics analyses.</p>
<p>To extract speakers, we need to follow these steps:</p>
<ol style="list-style-type: decimal">
<li><p>Create normal concordances of the pattern that we are interested in.</p></li>
<li><p>Generate concordances of the pattern that we are interested in with a substantially enlarged context window size.</p></li>
<li><p>Extract the speakers from the enlarged context window size.</p></li>
<li><p>Add the speakers to the normal concordances using the <code>left-join</code> function from the <code>dplyr</code> package.</p></li>
</ol>
<pre class="r"><code>kwic_normal &lt;- kwic(transcripts_collapsed, phrase(&quot;you know&quot;))
kwic_long &lt;- kwic(transcripts_collapsed, phrase(&quot;you know&quot;), window = 500) %&gt;%
  mutate(pre = str_remove_all(pre, &quot;.*\\$&quot;)) %&gt;%
  mutate(pre = str_remove_all(pre, &quot;\\&gt;.*&quot;),
         speaker = str_squish(pre)) %&gt;%
  select(docname, speaker)
# add speaker to normal kwic
kwic_combined &lt;- left_join(kwic_normal, kwic_long)
# clean docnames
kwic_combined$docname &lt;- kwic_combined$docname %&gt;%
  str_replace_all(&quot;.*/([A-Z][0-9][A-Z]-[0-9]{1,3}).txt&quot;, &quot;\\1&quot;) 
# inspect data
kable(head(kwic_combined), caption = &quot;First 6 concordances for *you know* with speakers that uttered them.&quot;) %&gt;%
  kable_styling(bootstrap_options = &quot;striped&quot;, full_width = T, position = &quot;left&quot;)</code></pre>
<table class="table table-striped" style="">
<caption>
First 6 concordances for <em>you know</em> with speakers that uttered them.
</caption>
<thead>
<tr>
<th style="text-align:left;">
docname
</th>
<th style="text-align:right;">
from
</th>
<th style="text-align:right;">
to
</th>
<th style="text-align:left;">
pre
</th>
<th style="text-align:left;">
keyword
</th>
<th style="text-align:left;">
post
</th>
<th style="text-align:left;">
pattern
</th>
<th style="text-align:left;">
speaker
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
S1A-001
</td>
<td style="text-align:right;">
62
</td>
<td style="text-align:right;">
63
</td>
<td style="text-align:left;">
was only the fourth time
</td>
<td style="text-align:left;">
you know
</td>
<td style="text-align:left;">
&lt; # &gt; It was
</td>
<td style="text-align:left;">
you know
</td>
<td style="text-align:left;">
B
</td>
</tr>
<tr>
<td style="text-align:left;">
S1A-001
</td>
<td style="text-align:right;">
62
</td>
<td style="text-align:right;">
63
</td>
<td style="text-align:left;">
was only the fourth time
</td>
<td style="text-align:left;">
you know
</td>
<td style="text-align:left;">
&lt; # &gt; It was
</td>
<td style="text-align:left;">
you know
</td>
<td style="text-align:left;">
B
</td>
</tr>
<tr>
<td style="text-align:left;">
S1A-001
</td>
<td style="text-align:right;">
62
</td>
<td style="text-align:right;">
63
</td>
<td style="text-align:left;">
was only the fourth time
</td>
<td style="text-align:left;">
you know
</td>
<td style="text-align:left;">
&lt; # &gt; It was
</td>
<td style="text-align:left;">
you know
</td>
<td style="text-align:left;">
B
</td>
</tr>
<tr>
<td style="text-align:left;">
S1A-001
</td>
<td style="text-align:right;">
62
</td>
<td style="text-align:right;">
63
</td>
<td style="text-align:left;">
was only the fourth time
</td>
<td style="text-align:left;">
you know
</td>
<td style="text-align:left;">
&lt; # &gt; It was
</td>
<td style="text-align:left;">
you know
</td>
<td style="text-align:left;">
B
</td>
</tr>
<tr>
<td style="text-align:left;">
S1A-001
</td>
<td style="text-align:right;">
62
</td>
<td style="text-align:right;">
63
</td>
<td style="text-align:left;">
was only the fourth time
</td>
<td style="text-align:left;">
you know
</td>
<td style="text-align:left;">
&lt; # &gt; It was
</td>
<td style="text-align:left;">
you know
</td>
<td style="text-align:left;">
B
</td>
</tr>
<tr>
<td style="text-align:left;">
S1A-001
</td>
<td style="text-align:right;">
62
</td>
<td style="text-align:right;">
63
</td>
<td style="text-align:left;">
was only the fourth time
</td>
<td style="text-align:left;">
you know
</td>
<td style="text-align:left;">
&lt; # &gt; It was
</td>
<td style="text-align:left;">
you know
</td>
<td style="text-align:left;">
B
</td>
</tr>
</tbody>
</table>
<p>The resulting table shows that we have successfully extracted the speakers (identified by the letters in the <code>speaker</code> column) and cleaned the file names (in the <code>docnames</code> column).</p>
</div>
<div id="customizing-concordances" class="section level2 unnumbered">
<h2>Customizing concordances</h2>
<p>As R represents a fully-fledged programming environment, we can, of course, also write our own, customized concordance function. The code below shows how you could go about doing so. Note, however, that this function only works if you enter more than a single file.</p>
<pre class="r"><code>mykwic &lt;- function(txts, pattern, context) {
  # activate packages
  require(stringr)
  require(plyr)
  # list files
  conc &lt;- sapply(txts, function(x) {
    # determine length of text
    lngth &lt;- as.vector(unlist(nchar(x)))
    # determine position of hits
    idx &lt;- str_locate_all(x, pattern)
    idx &lt;- idx[[1]]
    ifelse(nrow(idx) &gt;= 1, idx &lt;- idx, return(&quot;No hits found&quot;))
    # define start position of hit
    token.start &lt;- idx[,1]
    # define end position of hit
    token.end &lt;- idx[,2]
    # define start position of preceding context
    pre.start &lt;- ifelse(token.start-context &lt; 1, 1, token.start-context)
    # define end position of preceding context
    pre.end &lt;- token.start-1
    # define start position of subsequent context
    post.start &lt;- token.end+1
    # define end position of subsequent context
    post.end &lt;- ifelse(token.end+context &gt; lngth, lngth, token.end+context)
    # extract the texts defined by the positions
    PreceedingContext &lt;- substring(x, pre.start, pre.end)
    Token &lt;- substring(x, token.start, token.end)
    SubsequentContext &lt;- substring(x, post.start, post.end)
    conc &lt;- cbind(PreceedingContext, Token, SubsequentContext)
    # return concordance
    return(conc)
    })
  concdf &lt;- ldply(conc, data.frame)
  colnames(concdf)[1]&lt;- &quot;File&quot;
  return(concdf)
}</code></pre>
<p>We can now try if this function works by searching for the sequence <em>you know</em> in the transcripts that we have loaded earlier. One difference between the <code>kwic</code> function provided by the <code>quanteda</code> package and the customized concordance function used here is that the <code>kwic</code> function uses the number of words to define the context window, while the <code>mykwic</code> function uses the number of characters or symbols instead (which is why we use a notably higher number to define the context window).</p>
<pre class="r"><code>myconcordances &lt;- mykwic(transcripts_collapsed, &quot;you know&quot;, 50)</code></pre>
<pre><code>## Loading required package: plyr</code></pre>
<pre><code>## ------------------------------------------------------------------------------</code></pre>
<pre><code>## You have loaded plyr after dplyr - this is likely to cause problems.
## If you need functions from both plyr and dplyr, please load plyr first, then dplyr:
## library(plyr); library(dplyr)</code></pre>
<pre><code>## ------------------------------------------------------------------------------</code></pre>
<pre><code>## 
## Attaching package: &#39;plyr&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:dplyr&#39;:
## 
##     arrange, count, desc, failwith, id, mutate, rename, summarise,
##     summarize</code></pre>
<pre class="r"><code># inspect data
kable(head(myconcordances), caption = &quot;First 6 concordances for you know extracted using the mykwic function.&quot;) %&gt;%
  kable_styling(bootstrap_options = &quot;striped&quot;, full_width = T, position = &quot;left&quot;)</code></pre>
<table class="table table-striped" style="">
<caption>
First 6 concordances for you know extracted using the mykwic function.
</caption>
<thead>
<tr>
<th style="text-align:left;">
File
</th>
<th style="text-align:left;">
PreceedingContext
</th>
<th style="text-align:left;">
Token
</th>
<th style="text-align:left;">
SubsequentContext
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
<a href="https://slcladal.github.io/data/ICEIrelandSample/S1A-001.txt" class="uri">https://slcladal.github.io/data/ICEIrelandSample/S1A-001.txt</a>
</td>
<td style="text-align:left;">
to let me jump &lt;,&gt; that was only the fourth time
</td>
<td style="text-align:left;">
you know
</td>
<td style="text-align:left;">
&lt;#&gt; It was great &lt;&amp;&gt; laughter &lt;/&amp;&gt; &lt;S1A-001<span class="math inline">\(A&amp;gt; &amp;lt;# &lt;/td&gt;  &lt;/tr&gt;  &lt;tr&gt;  &lt;td style=&quot;text-align:left;&quot;&gt; https://slcladal.github.io/data/ICEIrelandSample/S1A-001.txt &lt;/td&gt;  &lt;td style=&quot;text-align:left;&quot;&gt; with the whip &amp;lt;,&amp;gt; and over it went the last time &lt;/td&gt;  &lt;td style=&quot;text-align:left;&quot;&gt; you know &lt;/td&gt;  &lt;td style=&quot;text-align:left;&quot;&gt; &amp;lt;#&amp;gt; And Stephanie told her she was very determine &lt;/td&gt;  &lt;/tr&gt;  &lt;tr&gt;  &lt;td style=&quot;text-align:left;&quot;&gt; https://slcladal.github.io/data/ICEIrelandSample/S1A-001.txt &lt;/td&gt;  &lt;td style=&quot;text-align:left;&quot;&gt; ghter &amp;lt;/&amp;amp;&amp;gt; because it had refused the other times &lt;/td&gt;  &lt;td style=&quot;text-align:left;&quot;&gt; you know &lt;/td&gt;  &lt;td style=&quot;text-align:left;&quot;&gt; &amp;lt;#&amp;gt; But Stephanie wouldn&#39;t let her give up on it &lt;/td&gt;  &lt;/tr&gt;  &lt;tr&gt;  &lt;td style=&quot;text-align:left;&quot;&gt; https://slcladal.github.io/data/ICEIrelandSample/S1A-001.txt &lt;/td&gt;  &lt;td style=&quot;text-align:left;&quot;&gt; k and keep coming back &amp;lt;,&amp;gt; until &amp;lt;,&amp;gt; it jumped it &lt;/td&gt;  &lt;td style=&quot;text-align:left;&quot;&gt; you know &lt;/td&gt;  &lt;td style=&quot;text-align:left;&quot;&gt; &amp;lt;#&amp;gt; It was good &amp;lt;S1A-001\)</span>A&gt; &lt;#&gt; Yeah I ’m not so
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="https://slcladal.github.io/data/ICEIrelandSample/S1A-001.txt" class="uri">https://slcladal.github.io/data/ICEIrelandSample/S1A-001.txt</a>
</td>
<td style="text-align:left;">
she ’d be far better waiting &lt;,&gt; for that one &lt;,&gt;
</td>
<td style="text-align:left;">
you know
</td>
<td style="text-align:left;">
and starting anew fresh &lt;S1A-001<span class="math inline">\(A&amp;gt; &amp;lt;#&amp;gt; Yeah but &lt;/td&gt;  &lt;/tr&gt;  &lt;tr&gt;  &lt;td style=&quot;text-align:left;&quot;&gt; https://slcladal.github.io/data/ICEIrelandSample/S1A-001.txt &lt;/td&gt;  &lt;td style=&quot;text-align:left;&quot;&gt; er &#39;s the best goes top of the league &amp;lt;,&amp;gt; &amp;lt;{&amp;gt; &amp;lt;[&amp;gt; &lt;/td&gt;  &lt;td style=&quot;text-align:left;&quot;&gt; you know &lt;/td&gt;  &lt;td style=&quot;text-align:left;&quot;&gt; &amp;lt;/[&amp;gt; &amp;lt;S1A-001\)</span>A&gt; &lt;#&gt; &lt;[&gt; So &lt;/[&gt; &lt;/{&gt; it ’s like
</td>
</tr>
</tbody>
</table>
<p>As this concordance function only works for more than one text, we split the text of Darwin’s <em>On the Origin of Species</em> into chapters and assign each section a name.</p>
<pre class="r"><code># read in text
origin_split &lt;- origin %&gt;%
  str_squish() %&gt;%
  str_split(&quot; [0-9]{1,2}\\. &quot;) %&gt;%
  unlist()
origin_split &lt;- origin_split[which(nchar(origin_split) &gt; 2000)]
# add names
names(origin_split) &lt;- paste0(&quot;text&quot;, 1:length(origin_split))
# inspect data
nchar(origin_split)</code></pre>
<pre><code>##  text1  text2  text3  text4  text5  text6  text7  text8  text9 text10 text11 
##  10583  69614  29402  35644  94090  72494  66361  69133  61073  58530  62064 
## text12 text13 text14 text15 
##  67890  51322  87415  58207</code></pre>
<p>Now that we have named elements, we can search for the pattern <em>natural selection</em>. We also need to clean the concordance as some sections do not contain any instances of the search pattern. To clean the data, we select only the columns <code>File</code>, <code>PreceedingContext</code>, <code>Token</code>, and <code>SubsequentContext</code> and then remove all rows where information is missing.</p>
<pre class="r"><code>natsel_conc &lt;- mykwic(origin_split, &quot;natural selection&quot;, 50) 
natsel_conc &lt;- natsel_conc %&gt;%
  select(File, PreceedingContext, Token, SubsequentContext) %&gt;%
  na.omit()
# inspect data
kable(head(natsel_conc), caption = &quot;First 6 concordances for *natural selection* extracted using the mykwic function.&quot;) %&gt;%
  kable_styling(bootstrap_options = &quot;striped&quot;, full_width = T, position = &quot;left&quot;)</code></pre>
<table class="table table-striped" style="">
<caption>
First 6 concordances for <em>natural selection</em> extracted using the mykwic function.
</caption>
<thead>
<tr>
<th style="text-align:left;">
File
</th>
<th style="text-align:left;">
PreceedingContext
</th>
<th style="text-align:left;">
Token
</th>
<th style="text-align:left;">
SubsequentContext
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
text1
</td>
<td style="text-align:left;">
he immutability of species. How far the theory of
</td>
<td style="text-align:left;">
natural selection
</td>
<td style="text-align:left;">
may be extended. Effects of its adoption on the s
</td>
</tr>
<tr>
<td style="text-align:left;">
text2
</td>
<td style="text-align:left;">
nd reversions of character probably do occur; but
</td>
<td style="text-align:left;">
natural selection
</td>
<td style="text-align:left;">
, as will hereafter be explained, will determine h
</td>
</tr>
<tr>
<td style="text-align:left;">
text2
</td>
<td style="text-align:left;">
ntry than in the other, and thus by a process of "
</td>
<td style="text-align:left;">
natural selection
</td>
<td style="text-align:left;">
," as will hereafter be more fully explained, two
</td>
</tr>
<tr>
<td style="text-align:left;">
text3
</td>
<td style="text-align:left;">
ly important for us, as they afford materials for
</td>
<td style="text-align:left;">
natural selection
</td>
<td style="text-align:left;">
to accumulate, in the same manner as man can accu
</td>
</tr>
<tr>
<td style="text-align:left;">
text3
</td>
<td style="text-align:left;">
have not been seized on and rendered definite by
</td>
<td style="text-align:left;">
natural selection
</td>
<td style="text-align:left;">
, as hereafter will be explained. Those forms whic
</td>
</tr>
<tr>
<td style="text-align:left;">
text3
</td>
<td style="text-align:left;">
to one in which it differs more, to the action of
</td>
<td style="text-align:left;">
natural selection
</td>
<td style="text-align:left;">
in accumulating (as will hereafter be more fully
</td>
</tr>
</tbody>
</table>
<p>You can go ahead and modify the customized concordance function to suit your needs.</p>
</div>
</div>
<div id="citation-session-info" class="section level1 unnumbered">
<h1>Citation &amp; Session Info</h1>
<p>Schweinberger, Martin. 2020. <em>Concordancing with R</em>. Brisbane: The University of Queensland. url: <a href="https://slcladal.github.io/kwics.html" class="uri">https://slcladal.github.io/kwics.html</a> (Version 2020.09.29).</p>
<pre><code>@manual{schweinberger2020introqant,
  author = {Schweinberger, Martin},
  title = {Concordancing with R},
  note = {https://slcladal.github.io/kwics.html},
  year = {2020},
  organization = &quot;The University of Queensland, School of Languages and Cultures},
  address = {Brisbane},
  edition = {2020/09/29}
}</code></pre>
<pre class="r"><code>sessionInfo()</code></pre>
<pre><code>## R version 4.0.2 (2020-06-22)
## Platform: x86_64-w64-mingw32/x64 (64-bit)
## Running under: Windows 10 x64 (build 18362)
## 
## Matrix products: default
## 
## locale:
## [1] LC_COLLATE=German_Germany.1252  LC_CTYPE=German_Germany.1252   
## [3] LC_MONETARY=German_Germany.1252 LC_NUMERIC=C                   
## [5] LC_TIME=German_Germany.1252    
## 
## attached base packages:
## [1] stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
## [1] plyr_1.8.6       gutenbergr_0.2.0 kableExtra_1.2.1 knitr_1.30      
## [5] stringr_1.4.0    dplyr_1.0.2      quanteda_2.1.1  
## 
## loaded via a namespace (and not attached):
##  [1] Rcpp_1.0.5         pillar_1.4.6       compiler_4.0.2     highr_0.8         
##  [5] tools_4.0.2        stopwords_2.0      digest_0.6.25      viridisLite_0.3.0 
##  [9] evaluate_0.14      lifecycle_0.2.0    tibble_3.0.3       gtable_0.3.0      
## [13] lattice_0.20-41    pkgconfig_2.0.3    rlang_0.4.7        Matrix_1.2-18     
## [17] fastmatch_1.1-0    rstudioapi_0.11    curl_4.3           yaml_2.2.1        
## [21] xfun_0.16          xml2_1.3.2         httr_1.4.2         hms_0.5.3         
## [25] fs_1.5.0           generics_0.0.2     vctrs_0.3.4        triebeard_0.3.0   
## [29] webshot_0.5.2      grid_4.0.2         tidyselect_1.1.0   glue_1.4.2        
## [33] data.table_1.13.0  R6_2.4.1           rmarkdown_2.3      readr_1.3.1       
## [37] ggplot2_3.3.2      purrr_0.3.4        magrittr_1.5       urltools_1.7.3    
## [41] usethis_1.6.3      scales_1.1.1       ellipsis_0.3.1     htmltools_0.5.0   
## [45] rvest_0.3.6        colorspace_1.4-1   stringi_1.5.3      lazyeval_0.2.2    
## [49] RcppParallel_5.0.2 munsell_0.5.0      crayon_1.3.4</code></pre>
<hr />
<p><a href="https://slcladal.github.io/index.html">Main page</a></p>
<hr />
</div>
<div id="references" class="section level1 unnumbered">
<h1>References</h1>
<div id="refs" class="references">
<div id="ref-anthony2004antconc">
<p>Anthony, Laurence. 2004. “AntConc: A Learner and Classroom Friendly, Multi-Platform Corpus Analysis Toolkit.” <em>Proceedings of IWLeL</em>, 7–13.</p>
</div>
<div id="ref-fivethirtyeight2018replication">
<p>Aschwanden, Christie. n.d. “Psychologyâs Replication Crisis Has Made the Field Better.” <a href="https://fivethirtyeight.com/features/psychologys-replication-crisis-has-made-the-field-better/">https://fivethirtyeight.com/features/psychologys-replication-crisis-has-made-the-field-better/</a>.</p>
</div>
<div id="ref-barlow1999monoconc">
<p>Barlow, Michael. 1999. “Monoconc 1.5 and Paraconc.” <em>International Journal of Corpus Linguistics</em> 4 (1): 173–84.</p>
</div>
<div id="ref-barlow2002paraconc">
<p>———. 2002. “ParaConc: Concordance Software for Multilingual Parallel Corpora.” In <em>Proceedings of the Third International Conference on Language Resources and Evaluation. Workshop on Language Resources in Translation Work and Research</em>, 20–24.</p>
</div>
<div id="ref-noba2019replication">
<p>Diener, Edward, and Robert Biswas-Diener. 2019. “The Replication Crisis in Psychology.” <a href="https://nobaproject.com/modules/the-replication-crisis-in-psychology">https://nobaproject.com/modules/the-replication-crisis-in-psychology</a>.</p>
</div>
<div id="ref-fanelli2009fraud">
<p>Fanelli, Daniele. 2009. “How Many Scientists Fabricate and Falsify Research? A Systematic Review and Meta-Analysis of Survey Data.” <em>PLoS One</em> 4 (5): e5738.</p>
</div>
<div id="ref-kilgarriff2004itri">
<p>Kilgarriff, Adam, Pavel Rychly, Pavel Smrz, and David Tugwell. 2004. “Itri-04-08 the Sketch Engine.” <em>Information Technology</em> 105: 116.</p>
</div>
<div id="ref-lindquist2009corpus">
<p>Lindquist, Hans. 2009. <em>Corpus Linguistics and the Description of English</em>. Edinburgh: Edinburgh University Press.</p>
</div>
<div id="ref-sciencealert2018replication">
<p>McRae, Mike. n.d. “Science’s ’Replication Crisis’ Has Reached Even the Most Respectable Journals, Report Shows.” <a href="https://www.sciencealert.com/replication-results-reproducibility-crisis-science-nature-journals">https://www.sciencealert.com/replication-results-reproducibility-crisis-science-nature-journals</a>.</p>
</div>
<div id="ref-stafanowitsch2020corpus">
<p>Stefanowitsch, Anatol. 2020. <em>Corpus Linguistics. A Guide to the Methodology</em>. Textbooks in Language Sciences. Berlin: Language Science Press.</p>
</div>
<div id="ref-stroube2003literary">
<p>Stroube, Bryan. 2003. “Literary Freedom: Project Gutenberg.” <em>XRDS: Crossroads, the ACM Magazine for Students</em> 10 (1): 3–3.</p>
</div>
<div id="ref-physorg2018replication">
<p>Velasco, Emily. n.d. “Researcher Discusses the the Science Replication Crisis.” <a href="https://phys.org/news/2018-11-discusses-science-replication-crisis.html">https://phys.org/news/2018-11-discusses-science-replication-crisis.html</a>.</p>
</div>
<div id="ref-atlantic2018psychology">
<p>Yong, Ed. n.d. “Psychologyâs Replication Crisis Is Running Out of Excuses. Another Big Project Has Found That Only Half of Studies Can Be Repeated. And This Time, the Usual Explanations Fall Flat.” <a href="https://www.theatlantic.com/science/archive/2018/11/psychologys-replication-crisis-real/576223/">https://www.theatlantic.com/science/archive/2018/11/psychologys-replication-crisis-real/576223/</a>.</p>
</div>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
