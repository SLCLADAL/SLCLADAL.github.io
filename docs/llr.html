<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.165">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Martin Schweinberger">
<meta name="dcterms.date" content="2022-08-31">

<title>Analyzing learner language using R</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-VSGK4KYDQZ"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-VSGK4KYDQZ', { 'anonymize_ip': true});
</script>
<script src="site_libs/clipboard-1.7.1/clipboard.min.js"></script>
<link href="site_libs/primer-tooltips-1.4.0/build.css" rel="stylesheet">
<link href="site_libs/klippy-0.0.0.9500/css/klippy.min.css" rel="stylesheet">
<script src="site_libs/klippy-0.0.0.9500/js/klippy.min.js"></script>
<link href="site_libs/tabwid-1.0.0/tabwid.css" rel="stylesheet">
<link href="site_libs/tabwid-1.0.0/scrool.css" rel="stylesheet">
<script src="site_libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<link href="site_libs/wordcloud2-0.0.1/wordcloud.css" rel="stylesheet">
<script src="site_libs/wordcloud2-0.0.1/wordcloud2-all.js"></script>
<script src="site_libs/wordcloud2-0.0.1/hover.js"></script>
<script src="site_libs/wordcloud2-binding-0.2.1/wordcloud2.js"></script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a href="./index.html" class="navbar-brand navbar-brand-logo">
    <img src="./ladal_icon_cas_tran_white_trimed.png" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Language Technology and Data Analysis Laboratory</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html">HOME</a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-about-ladal" role="button" data-bs-toggle="dropdown" aria-expanded="false">ABOUT LADAL</a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-about-ladal">    
        <li>
    <a class="dropdown-item" href="./people.html">
 <span class="dropdown-text">People | Collabs</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./news.html">
 <span class="dropdown-text">News</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-events" role="button" data-bs-toggle="dropdown" aria-expanded="false">EVENTS</a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-events">    
        <li>
    <a class="dropdown-item" href="./workshops.html">
 <span class="dropdown-text">Workshops</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./compthinking.html">
 <span class="dropdown-text">Computational Thinking in HASS</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./webinars2022.html">
 <span class="dropdown-text">LADAL Webinar Series 2022</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./opening.html">
 <span class="dropdown-text">LADAL Webinar Series 2021</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./atapevents.html">
 <span class="dropdown-text">ATAP Events</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="./tutorials.html">TUTORIALS</a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-resources" role="button" data-bs-toggle="dropdown" aria-expanded="false">RESOURCES</a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-resources">    
        <li>
    <a class="dropdown-item" href="./links.html">
 <span class="dropdown-text">Links</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./base.html">
 <span class="dropdown-text">Tutorial stylesheet</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="./contact.html">CONTACT</a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a></li>
  <li><a href="#concordancing" id="toc-concordancing" class="nav-link" data-scroll-target="#concordancing">Concordancing</a></li>
  <li><a href="#frequency-lists" id="toc-frequency-lists" class="nav-link" data-scroll-target="#frequency-lists">Frequency lists</a></li>
  <li><a href="#splitting-texts-into-sentences" id="toc-splitting-texts-into-sentences" class="nav-link" data-scroll-target="#splitting-texts-into-sentences">Splitting texts into sentences</a></li>
  <li><a href="#sentence-length" id="toc-sentence-length" class="nav-link" data-scroll-target="#sentence-length">Sentence length</a></li>
  <li><a href="#extracting-n-grams" id="toc-extracting-n-grams" class="nav-link" data-scroll-target="#extracting-n-grams">Extracting N-grams</a></li>
  <li><a href="#differences-in-ngram-use" id="toc-differences-in-ngram-use" class="nav-link" data-scroll-target="#differences-in-ngram-use">Differences in ngram use</a></li>
  <li><a href="#finding-collocations" id="toc-finding-collocations" class="nav-link" data-scroll-target="#finding-collocations">Finding collocations</a>
  <ul class="collapse">
  <li><a href="#visualizing-collocation-networks" id="toc-visualizing-collocation-networks" class="nav-link" data-scroll-target="#visualizing-collocation-networks">Visualizing collocation networks</a></li>
  </ul></li>
  <li><a href="#part-of-speech-tagging" id="toc-part-of-speech-tagging" class="nav-link" data-scroll-target="#part-of-speech-tagging">Part-of-speech tagging</a></li>
  <li><a href="#differences-in-pos-sequences" id="toc-differences-in-pos-sequences" class="nav-link" data-scroll-target="#differences-in-pos-sequences">Differences in pos-sequences</a></li>
  <li><a href="#lexical-diversity" id="toc-lexical-diversity" class="nav-link" data-scroll-target="#lexical-diversity">Lexical diversity</a></li>
  <li><a href="#readability" id="toc-readability" class="nav-link" data-scroll-target="#readability">Readability</a></li>
  <li><a href="#spelling-errors" id="toc-spelling-errors" class="nav-link" data-scroll-target="#spelling-errors">Spelling errors</a></li>
  <li><a href="#citation-session-info" id="toc-citation-session-info" class="nav-link" data-scroll-target="#citation-session-info">Citation &amp; Session Info</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul>
</nav>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Analyzing learner language using R</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Martin Schweinberger </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">August 31, 2022</p>
    </div>
  </div>
    
  </div>
  

</header>

<div class="cell">
<div class="cell-output-display">
<p><img src="https://slcladal.github.io/images/uq1.jpg" class="img-fluid" style="width:100.0%"></p>
</div>
</div>
<section id="introduction" class="level1 unnumbered">
<h1 class="unnumbered">Introduction</h1>
<p>This tutorial focuses on learner language and how to analyze differences between learners and L1 speakers of English using R. The aim of this tutorial is to showcase how to extract information from essays from learners and L1 speakers of English and how to analyze these essays. The aim is not to provide a fully-fledged analysis but rather to show and exemplify some common methods for data extraction, processing, and analysis.</p>
<div class="warning" style="padding:0.1em; background-color:#f2f2f2; color:#51247a">
<span>
<p style="margin-top:1em; text-align:center">
The entire R Notebook for the tutorial can be downloaded <a href="https://slcladal.github.io/content/llr.Rmd"><strong>here</strong></a>. If you want to render the R Notebook on your machine, i.e.&nbsp;knitting the document to html or a pdf, you need to make sure that you have R and RStudio installed and you also need to download the <a href="https://slcladal.github.io/content/bibliography.bib"><strong>bibliography file</strong></a> and store it in the same folder where you store the Rmd file. <br><br> <strong><a href="https://colab.research.google.com/drive/1qgAA8iPZDjh0nmqPNtgr2HC71Y9qAuEC?usp=sharing">Here</a></strong> is a <strong>link to an interactive version of this tutorial on Google Colab</strong>. The interactive tutorial is based on a Jupyter notebook of this tutorial. This interactive Jupyter notebook allows you to execute code yourself and - if you copy the Jupyter notebook - you can also change and edit the notebook, e.g.&nbsp;you can change code and upload your own data.<br>
</p>
<p style="margin-left:1em;">
</p>
<p></p>
</span></div>
<p><br></p>
<p><strong>Preparation and session set up</strong></p>
<p>This tutorial is based on R. If you have not installed R or are new to it, you will find an introduction to and more information how to use R <a href="https://slcladal.github.io/intror.html">here</a>. For this tutorials, we need to install certain <em>packages</em> from an R <em>library</em> so that the scripts shown below are executed without errors. Before turning to the code below, please install the packages by running the code below this paragraph. If you have already installed the packages mentioned below, then you can skip ahead and ignore this section. To install the necessary packages, simply run the following code - it may take some time (between 1 and 5 minutes to install all of the packages so you do not need to worry if it takes some time).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># install packages</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"quanteda"</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"flextable"</span>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"quanteda.textstats"</span>)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"quanteda.textplots"</span>)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"tidyverse"</span>)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"tm"</span>)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"tidytext"</span>)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"tidyr"</span>)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"NLP"</span>)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"openNLP"</span>)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"openNLPdata"</span>)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"koRpus"</span>)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"stringi"</span>)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"hunspell"</span>)</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"wordcloud2"</span>)</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"pacman"</span>)</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="co"># install the language support package</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>koRpus<span class="sc">::</span><span class="fu">install.koRpus.lang</span>(<span class="st">"en"</span>)</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="co"># install klippy for copy-to-clipboard button in code chunks</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"remotes"</span>)</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>remotes<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">"rlesur/klippy"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now that we have installed the packages, we can activate them as shown below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set options</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">stringsAsFactors =</span> F)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">scipen =</span> <span class="dv">999</span>)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">max.print=</span><span class="dv">1000</span>)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">java.parameters =</span> <span class="fu">c</span>(<span class="st">"-XX:+UseConcMarkSweepGC"</span>, <span class="st">"-Xmx8192m"</span>))</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="co">#gc()</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="co"># load packages</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(flextable)</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tm)</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidytext)</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(NLP)</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(openNLP)</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(quanteda)</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(quanteda.textstats)</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(quanteda.textplots)</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(koRpus)</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(koRpus.lang.en)</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringi)</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(hunspell)</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(wordcloud2)</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pacman)</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load_gh</span>(<span class="st">"trinker/entity"</span>)</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a><span class="co"># activate klippy for copy-to-clipboard button</span></span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>klippy<span class="sc">::</span><span class="fu">klippy</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<script>
  addClassKlippyTo("pre.r, pre.markdown");
  addKlippy('left', 'top', 'auto', '1', 'Copy code', 'Copied!');
</script>
</div>
</div>
<p>Once you have installed R and RStudio and once you have also initiated the session by executing the code shown above, you are good to go.</p>
<p><strong>Loading data</strong></p>
<p>We use 7 essays written by learners from the <a href="https://uclouvain.be/en/research-institutes/ilc/cecl/icle.html"><em>International Corpus of Learner English</em> (ICLE)</a> and two files containing a-level essays written by L1-English British students from <a href="https://uclouvain.be/en/research-institutes/ilc/cecl/locness.html"><em>The Louvain Corpus of Native English Essays</em> (LOCNESS)</a> which was compiled by the <em>Centre for English Corpus Linguistics</em> (CECL), Université catholique de Louvain, Belgium. The code chunk below loads the data from the LADAL repository on GitHub into R.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load essays from l1 speakers</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>ns1 <span class="ot">&lt;-</span> base<span class="sc">::</span><span class="fu">readRDS</span>(<span class="fu">url</span>(<span class="st">"https://slcladal.github.io/data/LCorpus/ns1.rda"</span>, <span class="st">"rb"</span>))</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>ns2 <span class="ot">&lt;-</span> base<span class="sc">::</span><span class="fu">readRDS</span>(<span class="fu">url</span>(<span class="st">"https://slcladal.github.io/data/LCorpus/ns2.rda"</span>, <span class="st">"rb"</span>))</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co"># load essays from l2 speakers</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>es <span class="ot">&lt;-</span> base<span class="sc">::</span><span class="fu">readRDS</span>(<span class="fu">url</span>(<span class="st">"https://slcladal.github.io/data/LCorpus/es.rda"</span>, <span class="st">"rb"</span>))</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>de <span class="ot">&lt;-</span> base<span class="sc">::</span><span class="fu">readRDS</span>(<span class="fu">url</span>(<span class="st">"https://slcladal.github.io/data/LCorpus/de.rda"</span>, <span class="st">"rb"</span>))</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>fr <span class="ot">&lt;-</span> base<span class="sc">::</span><span class="fu">readRDS</span>(<span class="fu">url</span>(<span class="st">"https://slcladal.github.io/data/LCorpus/fr.rda"</span>, <span class="st">"rb"</span>))</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>it <span class="ot">&lt;-</span> base<span class="sc">::</span><span class="fu">readRDS</span>(<span class="fu">url</span>(<span class="st">"https://slcladal.github.io/data/LCorpus/it.rda"</span>, <span class="st">"rb"</span>))</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>pl <span class="ot">&lt;-</span> base<span class="sc">::</span><span class="fu">readRDS</span>(<span class="fu">url</span>(<span class="st">"https://slcladal.github.io/data/LCorpus/pl.rda"</span>, <span class="st">"rb"</span>))</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>ru <span class="ot">&lt;-</span> base<span class="sc">::</span><span class="fu">readRDS</span>(<span class="fu">url</span>(<span class="st">"https://slcladal.github.io/data/LCorpus/ru.rda"</span>, <span class="st">"rb"</span>))</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>ru <span class="sc">%&gt;%</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># remove header</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>  stringr<span class="sc">::</span><span class="fu">str_remove</span>(., <span class="st">"&lt;[A-Z]{4,4}.*"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># remove empty elements</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na_if</span>(<span class="st">""</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>  na.omit <span class="sc">%&gt;%</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>  <span class="co">#show first 3 elements</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "It is now a very wide spread opinion, that in the modern world there is no place for dreaming and imagination. Those who share this point of view usually say that at present we are so very much under the domination of science, industry, technology, ever-increasing tempo of our lives and so on, that neither dreaming nor imagination can possibly survive. Their usual argument is very simple - they suggest to their opponents to look at some samples of the modern art and to compare them to the masterpieces of the \"Old Masters\" of painting, music, literature."
[2] "As everything which is simple, the argument sounds very convincing. Of course, it is evident, that no modern writer, painter or musician can be compare to such names as Bach, Pushkin&lt; Byron, Mozart, Rembrandt, Raffael et cetera. Modern pictures, in the majority of cases, seem to be merely repetitions or combinations of the images and methods of painting, invented very long before. The same is also true to modern verses, novels and songs."                                                                                                                        
[3] "But, I think, those, who put forward this argument, play - if I may put it like this - not fair game with their opponents, because such an approach presupposes the firm conviction, that dreaming and imagination can deal only with Arts, moreover, only with this \"well-established set\" of Arts, which includes music, painting, architecture, sculpture and literature. That is, a person, who follows the above-mentioned point of view tries to make his opponent take for granted the statement, the evidence of which is, to say the least, doubtful."                 </code></pre>
</div>
</div>
<p>The data inspection shows the first 3 text elements from the essay written a Russian learner of English to provide an idea of what the data look like.</p>
<p>Now that we have loaded some data, we can go ahead and extract information from the texts and process the data to analyze differences between L1 speakers and learners of English.</p>
</section>
<section id="concordancing" class="level1 unnumbered">
<h1 class="unnumbered">Concordancing</h1>
<p>Concordancing refers to the extraction of words or phrases from a given text or texts <span class="citation" data-cites="lindquist2009corpus">[<a href="#ref-lindquist2009corpus" role="doc-biblioref">1</a>]</span>. Commonly, concordances are displayed in the form of key-word in contexts (KWIC) where the search term is shown with some preceding and following context. Thus, such displays are referred to as key word in context concordances. A more elaborate tutorial on how to perform concordancing with R is available <a href="https://slcladal.github.io/kwics.html">here</a>.</p>
<p>Concordancing is helpful for seeing how a given term or phrased is used in the data, for inspecting how often a given word occurs in a text or a collection of texts, for extracting examples, and it also represents a basic procedure, and often the first step, in more sophisticated analyses.</p>
<p>We begin by creating KWIC displays of the term <em>problem</em> as shown below. To extract the kwic concordances, we use the <code>kwic</code> function from the <code>quanteda</code> package <span class="citation" data-cites="benoit2018quanteda">[cf. <a href="#ref-benoit2018quanteda" role="doc-biblioref">2</a>]</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># combine data from l1 speakers</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>l1 <span class="ot">&lt;-</span> <span class="fu">c</span>(ns1, ns2)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="co"># combine data from learners</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>learner <span class="ot">&lt;-</span> <span class="fu">c</span>(de, es, fr, it, pl, ru)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="co"># extract kwic for term "problem" in learner data</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>kwic <span class="ot">&lt;-</span> quanteda<span class="sc">::</span><span class="fu">kwic</span>(learner,               <span class="co"># the data in which to search</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>                       <span class="at">pattern =</span> <span class="st">"problem.*"</span>, <span class="co"># the pattern to look for</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>                       <span class="at">valuetype =</span> <span class="st">"regex"</span>,   <span class="co"># look for exact matches or patterns</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>                       <span class="at">window =</span> <span class="dv">10</span>) <span class="sc">%&gt;%</span>       <span class="co"># how much context to display (in elements) </span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># convert to table (called data.frame in R)</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># remove superfluous columns</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>to, <span class="sc">-</span>from, <span class="sc">-</span>pattern)</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(kwic)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  docname                                                     pre  keyword
1  text12                      Many of the drug addits have legal problems
2  text12     countries , like Spain , illegal . They have social problems
3  text30     In our society there is a growing concern about the  problem
4  text33 that once the availability of guns has been removed the  problem
5  text33    honest way and remove any causes that could worsen a  problem
6  text34       violence in our society . In order to analise the  problem
                                                        post
1       because they steal money for buying the drug that is
2         too because people are afraid of them and the drug
3       of violent crime . In fact , particular attention is
4 of violence simply vanishes , but in this caotic situation
5                    which is already particularly serious .
6            in its complexity and allow people to live in a</code></pre>
</div>
</div>
<p>The output shows that the term <em>problem</em> occurs six times in the learner data.</p>
<p>We can also arrange the output according to what comes before or after the search term as shown below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># take kwic</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>kwic <span class="sc">%&gt;%</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># arrange kwic alphabetically by what comes after the key term</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(post)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  docname                                                          pre  keyword
1  text12                           Many of the drug addits have legal problems
2  text39 , greatest ideas were produced and solutions to many serious problems
3  text34            violence in our society . In order to analise the  problem
4  text33      that once the availability of guns has been removed the  problem
5  text30          In our society there is a growing concern about the  problem
6  text12          countries , like Spain , illegal . They have social problems
7  text33         honest way and remove any causes that could worsen a  problem
                                                         post
1        because they steal money for buying the drug that is
2 found . Most wonderful pieces of literature were created in
3             in its complexity and allow people to live in a
4  of violence simply vanishes , but in this caotic situation
5        of violent crime . In fact , particular attention is
6          too because people are afraid of them and the drug
7                     which is already particularly serious .</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># take quick</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>kwic <span class="sc">%&gt;%</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># reverse the preceding context</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">prerev =</span> stringi<span class="sc">::</span><span class="fu">stri_reverse</span>(pre)) <span class="sc">%&gt;%</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># arrange kwic alphabetically by reversed preceding context</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(prerev) <span class="sc">%&gt;%</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># remove column with reversed preceding context</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>prerev)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  docname                                                          pre  keyword
1  text33         honest way and remove any causes that could worsen a  problem
2  text33      that once the availability of guns has been removed the  problem
3  text34            violence in our society . In order to analise the  problem
4  text30          In our society there is a growing concern about the  problem
5  text12                           Many of the drug addits have legal problems
6  text12          countries , like Spain , illegal . They have social problems
7  text39 , greatest ideas were produced and solutions to many serious problems
                                                         post
1                     which is already particularly serious .
2  of violence simply vanishes , but in this caotic situation
3             in its complexity and allow people to live in a
4        of violent crime . In fact , particular attention is
5        because they steal money for buying the drug that is
6          too because people are afraid of them and the drug
7 found . Most wonderful pieces of literature were created in</code></pre>
</div>
</div>
<p>We can also combine concordancing with visualizations. For instance, use the <code>textplot_xray</code> function from the <code>quanteda.textplots</code> package to visualize where in some texts the term <em>people</em> and the term <em>imagination</em> occurs.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create kwics for people and imagination</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>kwic_people <span class="ot">&lt;-</span> quanteda<span class="sc">::</span><span class="fu">kwic</span>(learner, <span class="at">pattern =</span> <span class="fu">c</span>(<span class="st">"people"</span>, <span class="st">"imagination"</span>))</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="co"># generate x-ray plot</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>quanteda.textplots<span class="sc">::</span><span class="fu">textplot_xray</span>(kwic_people)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="llr_files/figure-html/conc4-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>We can also search for phrases rather than individual words. To do this, we need to use the <code>phrase</code> function in the <code>pattern</code> argument as shown below. In the code chunk below, we look for any combination of the word <em>very</em> and any following word. It we would wish, we could of course also sort (or order) the concordances as we have done above.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># generate kwic for phrases staring with very</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>kwic <span class="ot">&lt;-</span> quanteda<span class="sc">::</span><span class="fu">kwic</span>(learner,                              <span class="co"># data</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">pattern =</span> <span class="fu">phrase</span>(<span class="st">"^very [a-z]{1,}"</span>),  <span class="co"># search pattern</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">valuetype =</span> <span class="st">"regex"</span>) <span class="sc">%&gt;%</span>              <span class="co"># type of pattern</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># convert into a data frame</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">

<div class="tabwid"><style>.cl-b5f1cee0{table-layout:auto;width:75%;}.cl-b5ed5fd6{font-family:'DejaVu Sans';font-size:12pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-b5ed5fe0{font-family:'DejaVu Sans';font-size:12pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-b5ed6f58{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-b5ed6f62{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-b5ed9a32{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b5ed9a3c{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b5ed9a46{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b5ed9a47{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b5ed9a48{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b5ed9a49{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b5ed9a50{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b5ed9a51{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b5ed9a5a{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b5ed9a5b{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b5ed9a64{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b5ed9a65{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b5ed9a66{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b5ed9a6e{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b5ed9a6f{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b5ed9a78{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table class="cl-b5f1cee0">
<caption class="Table Caption">
<p>First 6 rows of the concordance for very + any other word in the learner data.</p>
</caption>

<thead><tr style="overflow-wrap:break-word;"><td class="cl-b5ed9a66"><p class="cl-b5ed6f58"><span class="cl-b5ed5fd6">docname</span></p></td><td class="cl-b5ed9a78"><p class="cl-b5ed6f62"><span class="cl-b5ed5fd6">from</span></p></td><td class="cl-b5ed9a78"><p class="cl-b5ed6f62"><span class="cl-b5ed5fd6">to</span></p></td><td class="cl-b5ed9a6f"><p class="cl-b5ed6f58"><span class="cl-b5ed5fd6">pre</span></p></td><td class="cl-b5ed9a6f"><p class="cl-b5ed6f58"><span class="cl-b5ed5fd6">keyword</span></p></td><td class="cl-b5ed9a6f"><p class="cl-b5ed6f58"><span class="cl-b5ed5fd6">post</span></p></td><td class="cl-b5ed9a6e"><p class="cl-b5ed6f58"><span class="cl-b5ed5fd6">pattern</span></p></td></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-b5ed9a46"><p class="cl-b5ed6f58"><span class="cl-b5ed5fe0">text3</span></p></td><td class="cl-b5ed9a32"><p class="cl-b5ed6f62"><span class="cl-b5ed5fe0">193</span></p></td><td class="cl-b5ed9a32"><p class="cl-b5ed6f62"><span class="cl-b5ed5fe0">194</span></p></td><td class="cl-b5ed9a3c"><p class="cl-b5ed6f58"><span class="cl-b5ed5fe0">in black trousers and only</span></p></td><td class="cl-b5ed9a3c"><p class="cl-b5ed6f58"><span class="cl-b5ed5fe0">very seldom</span></p></td><td class="cl-b5ed9a3c"><p class="cl-b5ed6f58"><span class="cl-b5ed5fe0">in skirts , because she</span></p></td><td class="cl-b5ed9a47"><p class="cl-b5ed6f58"><span class="cl-b5ed5fe0">^very [a-z]{1,}</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-b5ed9a51"><p class="cl-b5ed6f58"><span class="cl-b5ed5fe0">text4</span></p></td><td class="cl-b5ed9a48"><p class="cl-b5ed6f62"><span class="cl-b5ed5fe0">9</span></p></td><td class="cl-b5ed9a48"><p class="cl-b5ed6f62"><span class="cl-b5ed5fe0">10</span></p></td><td class="cl-b5ed9a50"><p class="cl-b5ed6f58"><span class="cl-b5ed5fe0">is admirable is that she's</span></p></td><td class="cl-b5ed9a50"><p class="cl-b5ed6f58"><span class="cl-b5ed5fe0">very active</span></p></td><td class="cl-b5ed9a50"><p class="cl-b5ed6f58"><span class="cl-b5ed5fe0">in doing sports and that</span></p></td><td class="cl-b5ed9a49"><p class="cl-b5ed6f58"><span class="cl-b5ed5fe0">^very [a-z]{1,}</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-b5ed9a46"><p class="cl-b5ed6f58"><span class="cl-b5ed5fe0">text4</span></p></td><td class="cl-b5ed9a32"><p class="cl-b5ed6f62"><span class="cl-b5ed5fe0">27</span></p></td><td class="cl-b5ed9a32"><p class="cl-b5ed6f62"><span class="cl-b5ed5fe0">28</span></p></td><td class="cl-b5ed9a3c"><p class="cl-b5ed6f58"><span class="cl-b5ed5fe0">managed by her in a</span></p></td><td class="cl-b5ed9a3c"><p class="cl-b5ed6f58"><span class="cl-b5ed5fe0">very simple</span></p></td><td class="cl-b5ed9a3c"><p class="cl-b5ed6f58"><span class="cl-b5ed5fe0">way . She's very interested</span></p></td><td class="cl-b5ed9a47"><p class="cl-b5ed6f58"><span class="cl-b5ed5fe0">^very [a-z]{1,}</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-b5ed9a51"><p class="cl-b5ed6f58"><span class="cl-b5ed5fe0">text4</span></p></td><td class="cl-b5ed9a48"><p class="cl-b5ed6f62"><span class="cl-b5ed5fe0">32</span></p></td><td class="cl-b5ed9a48"><p class="cl-b5ed6f62"><span class="cl-b5ed5fe0">33</span></p></td><td class="cl-b5ed9a50"><p class="cl-b5ed6f58"><span class="cl-b5ed5fe0">very simple way . She's</span></p></td><td class="cl-b5ed9a50"><p class="cl-b5ed6f58"><span class="cl-b5ed5fe0">very interested</span></p></td><td class="cl-b5ed9a50"><p class="cl-b5ed6f58"><span class="cl-b5ed5fe0">in cycling , swimming and</span></p></td><td class="cl-b5ed9a49"><p class="cl-b5ed6f58"><span class="cl-b5ed5fe0">^very [a-z]{1,}</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-b5ed9a64"><p class="cl-b5ed6f58"><span class="cl-b5ed5fe0">text5</span></p></td><td class="cl-b5ed9a5a"><p class="cl-b5ed6f62"><span class="cl-b5ed5fe0">3</span></p></td><td class="cl-b5ed9a5a"><p class="cl-b5ed6f62"><span class="cl-b5ed5fe0">4</span></p></td><td class="cl-b5ed9a5b"><p class="cl-b5ed6f58"><span class="cl-b5ed5fe0">She's also</span></p></td><td class="cl-b5ed9a5b"><p class="cl-b5ed6f58"><span class="cl-b5ed5fe0">very intelligent</span></p></td><td class="cl-b5ed9a5b"><p class="cl-b5ed6f58"><span class="cl-b5ed5fe0">and because of that she</span></p></td><td class="cl-b5ed9a65"><p class="cl-b5ed6f58"><span class="cl-b5ed5fe0">^very [a-z]{1,}</span></p></td></tr></tbody></table></div>
</div>
</div>
</section>
<section id="frequency-lists" class="level1 unnumbered">
<h1 class="unnumbered">Frequency lists</h1>
<p>A useful procedure when dealing with texts is to extract frequency information. To exemplify how to extract frequency lists from texts, we will do this here using the L1 data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>ftb <span class="ot">&lt;-</span> <span class="fu">c</span>(ns1, ns2) <span class="sc">%&gt;%</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># remove punctuation</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  stringr<span class="sc">::</span><span class="fu">str_replace_all</span>(., <span class="st">"</span><span class="sc">\\</span><span class="st">W"</span>, <span class="st">" "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># remove superfluous white spaces</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  stringr<span class="sc">::</span><span class="fu">str_squish</span>() <span class="sc">%&gt;%</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># convert to lower case</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tolower</span>() <span class="sc">%&gt;%</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># split into words</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>  stringr<span class="sc">::</span><span class="fu">str_split</span>(<span class="st">" "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># unlist</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unlist</span>() <span class="sc">%&gt;%</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># convert into table</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># rename column</span></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">word =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># remove empty rows</span></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(word <span class="sc">!=</span> <span class="st">""</span>) <span class="sc">%&gt;%</span></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># count words</span></span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(word) <span class="sc">%&gt;%</span></span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">freq =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># order by freq</span></span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(<span class="sc">-</span>freq)</span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect</span></span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(ftb)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 2
  word   freq
  &lt;chr&gt; &lt;int&gt;
1 the     650
2 to      373
3 of      320
4 and     283
5 is      186
6 a       176</code></pre>
</div>
</div>
<p>We can easily remove stop words (words without lexical content) using the <code>anti_join</code> function as shown below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>ftb_wosw <span class="ot">&lt;-</span> ftb <span class="sc">%&gt;%</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># remove stop words</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">anti_join</span>(stop_words)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(ftb_wosw)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 2
  word       freq
  &lt;chr&gt;     &lt;int&gt;
1 transport    98
2 people       85
3 roads        80
4 cars         69
5 road         51
6 system       50</code></pre>
</div>
</div>
<p>We can then visualize the results as a bar chart as shown below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>ftb_wosw <span class="sc">%&gt;%</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># take 20 most frequent terms</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">20</span>) <span class="sc">%&gt;%</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># generate a plot</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(word, <span class="sc">-</span>freq), <span class="at">y =</span> freq, <span class="at">label =</span> freq)) <span class="sc">+</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># define type of plot</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add labels</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">vjust=</span><span class="fl">1.6</span>, <span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># display in black-and-white theme</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># adapt x-axis tick labels</span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>, <span class="at">angle=</span><span class="dv">90</span>)) <span class="sc">+</span></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># adapt axes labels</span></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Frequnecy"</span>, <span class="at">x =</span> <span class="st">"Word"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="llr_files/figure-html/fr5-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Or we can visualize the data as a word cloud (see below).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create wordcloud</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">wordcloud2</span>(ftb_wosw[<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>,],    <span class="co"># define data to use</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>           <span class="co"># define shape</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">shape =</span> <span class="st">"diamond"</span>,</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>           <span class="co"># define colors</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> scales<span class="sc">::</span><span class="fu">viridis_pal</span>()(<span class="dv">8</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="htmlwidget-0b835a381e77374c5621" style="width:100%;height:464px;" class="wordcloud2 html-widget"></div>
<script type="application/json" data-for="htmlwidget-0b835a381e77374c5621">{"x":{"word":["transport","people","roads","cars","road","system","rail","traffic","public","trains","car","government","travel","train","cities","major","britain","increasing","british","congestion","due","city","increase","bus","main","reduce","time","house","service","buses","lead","vehicles","world","country","motorways","services","increased","network","pollution","power","vote","amount","companies","party","tax","uk","change","democrasy","expensive","means","motorway","solution","times","building","cost","fares","jams","leads","money","political","recent","stations","systems","term","town","3","built","catch","centres","create","encourage","hours","industry","london","parties","past","railway","railways","short","votes","walk","2","build","bypass","bypasses","cycle","drive","efficient","electoral","environment","fair","greatly","heavy","journeys","lines","local","majority","modern","newbury","opposition"],"freq":[98,85,80,69,51,50,48,45,41,36,35,32,31,25,24,23,22,21,20,20,19,18,17,16,16,16,16,15,15,13,13,13,13,12,12,12,11,11,11,11,11,10,10,10,10,10,9,9,9,9,9,9,9,8,8,8,8,8,8,8,8,8,8,8,8,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6],"fontFamily":"Segoe UI","fontWeight":"bold","color":["#440154FF","#46337EFF","#365C8DFF","#277F8EFF","#1FA187FF","#4AC16DFF","#9FDA3AFF","#FDE725FF"],"minSize":0,"weightFactor":1.83673469387755,"backgroundColor":"white","gridSize":0,"minRotation":-0.785398163397448,"maxRotation":0.785398163397448,"shuffle":true,"rotateRatio":0.4,"shape":"diamond","ellipticity":0.65,"figBase64":null,"hover":null},"evals":[],"jsHooks":{"render":[{"code":"function(el,x){\n                        console.log(123);\n                        if(!iii){\n                          window.location.reload();\n                          iii = False;\n\n                        }\n  }","data":null}]}}</script>
</div>
</div>
</section>
<section id="splitting-texts-into-sentences" class="level1 unnumbered">
<h1 class="unnumbered">Splitting texts into sentences</h1>
<p>It can be every useful to split texts into individual sentences. This can be done, e.g., to extract the average sentence length or simply to inspect or annotate individual sentences. To split a text into sentences, we clean the data by removing file identifiers and html tags as well as quotation marks within sentences. As we are dealing with several texts, we write a function that performs this task and that we can then apply to the individual texts.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>cleanText <span class="ot">&lt;-</span> <span class="cf">function</span>(x,...){</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">require</span>(tokenizers)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># paste text together</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">paste0</span>(x)</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># remove file identifiers</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> stringr<span class="sc">::</span><span class="fu">str_remove_all</span>(x, <span class="st">"&lt;.*?&gt;"</span>)</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># remove quotation marks</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> stringr<span class="sc">::</span><span class="fu">str_remove_all</span>(x, <span class="fu">fixed</span>(<span class="st">"</span><span class="sc">\"</span><span class="st">"</span>))</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># remove empty elements</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> x[<span class="sc">!</span>x<span class="sc">==</span><span class="st">""</span>]</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># split text into sentences</span></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">tokenize_sentences</span>(x)</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">unlist</span>(x)</span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a><span class="co"># clean texts</span></span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>ns1_sen <span class="ot">&lt;-</span> <span class="fu">cleanText</span>(ns1)</span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>ns2_sen <span class="ot">&lt;-</span> <span class="fu">cleanText</span>(ns2)</span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>de_sen <span class="ot">&lt;-</span> <span class="fu">cleanText</span>(de)</span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>es_sen <span class="ot">&lt;-</span> <span class="fu">cleanText</span>(es)</span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a>fr_sen <span class="ot">&lt;-</span> <span class="fu">cleanText</span>(fr)</span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a>it_sen <span class="ot">&lt;-</span> <span class="fu">cleanText</span>(it)</span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a>pl_sen <span class="ot">&lt;-</span> <span class="fu">cleanText</span>(pl)</span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a>ru_sen <span class="ot">&lt;-</span> <span class="fu">cleanText</span>(ru)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">

<div class="tabwid"><style>.cl-b648f67a{table-layout:auto;width:75%;}.cl-b6454aca{font-family:'DejaVu Sans';font-size:12pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-b6454ad4{font-family:'DejaVu Sans';font-size:12pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-b64559fc{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-b6457c84{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b6457c98{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b6457c99{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b6457ca2{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table class="cl-b648f67a">
<caption class="Table Caption">
<p>First 6 sentences of the Russian learner data.</p>
</caption>

<thead><tr style="overflow-wrap:break-word;"><td class="cl-b6457ca2"><p class="cl-b64559fc"><span class="cl-b6454aca">.</span></p></td></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-b6457c84"><p class="cl-b64559fc"><span class="cl-b6454ad4">It is now a very wide spread opinion, that in the modern world there is no place for dreaming and imagination.</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-b6457c98"><p class="cl-b64559fc"><span class="cl-b6454ad4">Those who share this point of view usually say that at present we are so very much under the domination of science, industry, technology, ever-increasing tempo of our lives and so on, that neither dreaming nor imagination can possibly survive.</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-b6457c84"><p class="cl-b64559fc"><span class="cl-b6454ad4">Their usual argument is very simple - they suggest to their opponents to look at some samples of the modern art and to compare them to the masterpieces of the Old Masters of painting, music, literature.</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-b6457c98"><p class="cl-b64559fc"><span class="cl-b6454ad4">As everything which is simple, the argument sounds very convincing.</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-b6457c99"><p class="cl-b64559fc"><span class="cl-b6454ad4">Of course, it is evident, that no modern writer, painter or musician can be compare to such names as Bach, Pushkin&lt; Byron, Mozart, Rembrandt, Raffael et cetera.</span></p></td></tr></tbody></table></div>
</div>
</div>
<p>Now that we have split the texts into individual sentences, we can easily extract and visualize the average sentence lengths of L1 speakers and learners of English.</p>
</section>
<section id="sentence-length" class="level1 unnumbered">
<h1 class="unnumbered">Sentence length</h1>
<p>The most basic complexity measure is average sentence length. In the following, we will extract the average sentence length for L1-speakers and learners of English with different language backgrounds.</p>
<p>We can use the <code>count_words</code> function from the <code>tokenizers</code> package to count the words in each sentence. We apply the function to all texts and generate a table (a data frame) of the results and add the L1 of the speaker who produced the sentence.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># extract sentences lengths</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>ns1_sl <span class="ot">&lt;-</span> tokenizers<span class="sc">::</span><span class="fu">count_words</span>(ns1_sen)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>ns2_sl <span class="ot">&lt;-</span> tokenizers<span class="sc">::</span><span class="fu">count_words</span>(ns2_sen)</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>de_sl <span class="ot">&lt;-</span> tokenizers<span class="sc">::</span><span class="fu">count_words</span>(de_sen)</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>es_sl <span class="ot">&lt;-</span> tokenizers<span class="sc">::</span><span class="fu">count_words</span>(es_sen)</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>fr_sl <span class="ot">&lt;-</span> tokenizers<span class="sc">::</span><span class="fu">count_words</span>(fr_sen)</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>it_sl <span class="ot">&lt;-</span> tokenizers<span class="sc">::</span><span class="fu">count_words</span>(it_sen)</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>pl_sl <span class="ot">&lt;-</span> tokenizers<span class="sc">::</span><span class="fu">count_words</span>(pl_sen)</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>ru_sl <span class="ot">&lt;-</span> tokenizers<span class="sc">::</span><span class="fu">count_words</span>(ru_sen)</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a><span class="co"># create a data frame from the results</span></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>sl_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">c</span>(ns1_sl, ns2_sl, de_sl, es_sl, fr_sl, it_sl, pl_sl, ru_sl)) <span class="sc">%&gt;%</span></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">sentenceLength =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">l1 =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"en"</span>, <span class="fu">length</span>(ns1_sl)),</span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">rep</span>(<span class="st">"en"</span>, <span class="fu">length</span>(ns2_sl)),</span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">rep</span>(<span class="st">"de"</span>, <span class="fu">length</span>(de_sl)),</span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">rep</span>(<span class="st">"es"</span>, <span class="fu">length</span>(es_sl)),</span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">rep</span>(<span class="st">"fr"</span>, <span class="fu">length</span>(fr_sl)),</span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">rep</span>(<span class="st">"it"</span>, <span class="fu">length</span>(it_sl)),</span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">rep</span>(<span class="st">"pl"</span>, <span class="fu">length</span>(pl_sl)),</span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">rep</span>(<span class="st">"ru"</span>, <span class="fu">length</span>(ru_sl))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">

<div class="tabwid"><style>.cl-b656fedc{table-layout:auto;width:75%;}.cl-b652c056{font-family:'DejaVu Sans';font-size:12pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-b652c060{font-family:'DejaVu Sans';font-size:12pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-b652cf06{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-b652cf1a{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-b6530052{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b6530066{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b6530070{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b6530071{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b653007a{background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b653007b{background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b6530084{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b6530085{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table class="cl-b656fedc">
<caption class="Table Caption">
<p>First 6 rows of the table holding the sentences lengths and the L1 of the speakers that produced them.</p>
</caption>

<thead><tr style="overflow-wrap:break-word;"><td class="cl-b6530085"><p class="cl-b652cf06"><span class="cl-b652c056">sentenceLength</span></p></td><td class="cl-b6530084"><p class="cl-b652cf1a"><span class="cl-b652c056">l1</span></p></td></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-b6530066"><p class="cl-b652cf06"><span class="cl-b652c060">2</span></p></td><td class="cl-b6530052"><p class="cl-b652cf1a"><span class="cl-b652c060">en</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-b6530071"><p class="cl-b652cf06"><span class="cl-b652c060">17</span></p></td><td class="cl-b6530070"><p class="cl-b652cf1a"><span class="cl-b652c060">en</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-b6530066"><p class="cl-b652cf06"><span class="cl-b652c060">23</span></p></td><td class="cl-b6530052"><p class="cl-b652cf1a"><span class="cl-b652c060">en</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-b6530071"><p class="cl-b652cf06"><span class="cl-b652c060">17</span></p></td><td class="cl-b6530070"><p class="cl-b652cf1a"><span class="cl-b652c060">en</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-b6530066"><p class="cl-b652cf06"><span class="cl-b652c060">20</span></p></td><td class="cl-b6530052"><p class="cl-b652cf1a"><span class="cl-b652c060">en</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-b653007b"><p class="cl-b652cf06"><span class="cl-b652c060">34</span></p></td><td class="cl-b653007a"><p class="cl-b652cf1a"><span class="cl-b652c060">en</span></p></td></tr></tbody></table></div>
</div>
</div>
<p>Now, we can use the resulting table to create a box plot showing the results.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>sl_df <span class="sc">%&gt;%</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(l1, <span class="sc">-</span>sentenceLength, mean), <span class="at">y =</span> sentenceLength, <span class="at">fill =</span> l1)) <span class="sc">+</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># adapt y-axis labels</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Sentence lenghts"</span>) <span class="sc">+</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># adapt tick labels</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="st">"L1 of learners"</span>, </span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>                   <span class="at">breaks =</span> <span class="fu">names</span>(<span class="fu">table</span>(sl_df<span class="sc">$</span>l1)), </span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>                   <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"en"</span> <span class="ot">=</span> <span class="st">"English"</span>,</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"de"</span> <span class="ot">=</span> <span class="st">"German"</span>,</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"es"</span> <span class="ot">=</span> <span class="st">"Spanish"</span>,</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"fr"</span> <span class="ot">=</span> <span class="st">"French"</span>,</span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"it"</span> <span class="ot">=</span> <span class="st">"Italian"</span>,</span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"pl"</span> <span class="ot">=</span> <span class="st">"Polish"</span>,</span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"ru"</span> <span class="ot">=</span> <span class="st">"Russian"</span>)) <span class="sc">+</span></span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="llr_files/figure-html/senl8-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="extracting-n-grams" class="level1 unnumbered">
<h1 class="unnumbered">Extracting N-grams</h1>
<p>In a next step, we extract n-grams using the <code>tokens_ngrams</code> function from the <code>quanteda</code> package. In a first step, we take the sentence data, convert it to lower case and remove punctuation. Then we apply the <code>tokens_ngrams</code> function to extract the n-grams (in this case 2-grams).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>ns1_tok <span class="ot">&lt;-</span> ns1_sen <span class="sc">%&gt;%</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tolower</span>() <span class="sc">%&gt;%</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  quanteda<span class="sc">::</span><span class="fu">tokens</span>(<span class="at">remove_punct =</span> <span class="cn">TRUE</span>)</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="co"># extract n-grams</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>ns1_2gram <span class="ot">&lt;-</span> quanteda<span class="sc">::</span><span class="fu">tokens_ngrams</span>(ns1_tok, <span class="at">n =</span> <span class="dv">2</span>)</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(ns1_2gram[[<span class="dv">2</span>]], <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "the_basic"        "basic_dilema"     "dilema_facing"    "facing_the"      
 [5] "the_uk's"         "uk's_rail"        "rail_and"         "and_road"        
 [9] "road_transport"   "transport_system"</code></pre>
</div>
</div>
<p>We can also extract tri-grams easily by changing the <code>n</code> argument in the <code>tokens_ngrams</code> function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># extract n-grams</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>ns1_3gram <span class="ot">&lt;-</span> quanteda<span class="sc">::</span><span class="fu">tokens_ngrams</span>(ns1_tok, <span class="at">n =</span> <span class="dv">3</span>)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(ns1_3gram[[<span class="dv">2</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "the_basic_dilema"    "basic_dilema_facing" "dilema_facing_the"  
[4] "facing_the_uk's"     "the_uk's_rail"       "uk's_rail_and"      </code></pre>
</div>
</div>
<p>We now apply the same procedure to all texts as shown below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>ns1_tok <span class="ot">&lt;-</span> ns1_sen <span class="sc">%&gt;%</span> <span class="fu">tolower</span>() <span class="sc">%&gt;%</span> quanteda<span class="sc">::</span><span class="fu">tokens</span>(<span class="at">remove_punct =</span> <span class="cn">TRUE</span>)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>ns2_tok <span class="ot">&lt;-</span> ns2_sen <span class="sc">%&gt;%</span> <span class="fu">tolower</span>() <span class="sc">%&gt;%</span> quanteda<span class="sc">::</span><span class="fu">tokens</span>(<span class="at">remove_punct =</span> <span class="cn">TRUE</span>)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>de_tok <span class="ot">&lt;-</span> de_sen <span class="sc">%&gt;%</span> <span class="fu">tolower</span>() <span class="sc">%&gt;%</span> quanteda<span class="sc">::</span><span class="fu">tokens</span>(<span class="at">remove_punct =</span> <span class="cn">TRUE</span>)</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>es_tok <span class="ot">&lt;-</span> es_sen <span class="sc">%&gt;%</span> <span class="fu">tolower</span>() <span class="sc">%&gt;%</span> quanteda<span class="sc">::</span><span class="fu">tokens</span>(<span class="at">remove_punct =</span> <span class="cn">TRUE</span>)</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>fr_tok <span class="ot">&lt;-</span> fr_sen <span class="sc">%&gt;%</span> <span class="fu">tolower</span>() <span class="sc">%&gt;%</span> quanteda<span class="sc">::</span><span class="fu">tokens</span>(<span class="at">remove_punct =</span> <span class="cn">TRUE</span>)</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>it_tok <span class="ot">&lt;-</span> it_sen <span class="sc">%&gt;%</span> <span class="fu">tolower</span>() <span class="sc">%&gt;%</span> quanteda<span class="sc">::</span><span class="fu">tokens</span>(<span class="at">remove_punct =</span> <span class="cn">TRUE</span>)</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>pl_tok <span class="ot">&lt;-</span> pl_sen <span class="sc">%&gt;%</span> <span class="fu">tolower</span>() <span class="sc">%&gt;%</span> quanteda<span class="sc">::</span><span class="fu">tokens</span>(<span class="at">remove_punct =</span> <span class="cn">TRUE</span>)</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>ru_tok <span class="ot">&lt;-</span> ru_sen <span class="sc">%&gt;%</span> <span class="fu">tolower</span>() <span class="sc">%&gt;%</span> quanteda<span class="sc">::</span><span class="fu">tokens</span>(<span class="at">remove_punct =</span> <span class="cn">TRUE</span>)</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a><span class="co"># extract n-grams</span></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>ns1_2gram <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(<span class="fu">unlist</span>(quanteda<span class="sc">::</span><span class="fu">tokens_ngrams</span>(ns1_tok, <span class="at">n =</span> <span class="dv">2</span>)))</span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>ns2_2gram <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(<span class="fu">unlist</span>(quanteda<span class="sc">::</span><span class="fu">tokens_ngrams</span>(ns2_tok, <span class="at">n =</span> <span class="dv">2</span>)))</span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>de_2gram <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(<span class="fu">unlist</span>(quanteda<span class="sc">::</span><span class="fu">tokens_ngrams</span>(de_tok, <span class="at">n =</span> <span class="dv">2</span>)))</span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>es_2gram <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(<span class="fu">unlist</span>(quanteda<span class="sc">::</span><span class="fu">tokens_ngrams</span>(es_tok, <span class="at">n =</span> <span class="dv">2</span>)))</span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>fr_2gram <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(<span class="fu">unlist</span>(quanteda<span class="sc">::</span><span class="fu">tokens_ngrams</span>(fr_tok, <span class="at">n =</span> <span class="dv">2</span>)))</span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a>it_2gram <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(<span class="fu">unlist</span>(quanteda<span class="sc">::</span><span class="fu">tokens_ngrams</span>(it_tok, <span class="at">n =</span> <span class="dv">2</span>)))</span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a>pl_2gram <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(<span class="fu">unlist</span>(quanteda<span class="sc">::</span><span class="fu">tokens_ngrams</span>(pl_tok, <span class="at">n =</span> <span class="dv">2</span>)))</span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a>ru_2gram <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(<span class="fu">unlist</span>(quanteda<span class="sc">::</span><span class="fu">tokens_ngrams</span>(ru_tok, <span class="at">n =</span> <span class="dv">2</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Next, we generate a table with the ngrams and the L1 background of the speaker that produced the bi-grams.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>ngram_df <span class="ot">&lt;-</span> <span class="fu">c</span>(ns1_2gram, ns2_2gram, de_2gram, es_2gram, </span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>              fr_2gram, it_2gram, pl_2gram, ru_2gram) <span class="sc">%&gt;%</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">ngram =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">l1 =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"en"</span>, <span class="fu">length</span>(ns1_2gram)),</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">rep</span>(<span class="st">"en"</span>, <span class="fu">length</span>(ns2_2gram)),</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">rep</span>(<span class="st">"de"</span>, <span class="fu">length</span>(de_2gram)),</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">rep</span>(<span class="st">"es"</span>, <span class="fu">length</span>(es_2gram)),</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">rep</span>(<span class="st">"fr"</span>, <span class="fu">length</span>(fr_2gram)),</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">rep</span>(<span class="st">"it"</span>, <span class="fu">length</span>(it_2gram)),</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">rep</span>(<span class="st">"pl"</span>, <span class="fu">length</span>(pl_2gram)),</span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">rep</span>(<span class="st">"ru"</span>, <span class="fu">length</span>(ru_2gram))),</span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>                <span class="at">learner =</span> <span class="fu">ifelse</span>(l1 <span class="sc">==</span> <span class="st">"en"</span>, <span class="st">"no"</span>, <span class="st">"yes"</span>))</span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect</span></span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(ngram_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          ngram l1 learner
1  transport_01 en      no
2     the_basic en      no
3  basic_dilema en      no
4 dilema_facing en      no
5    facing_the en      no
6      the_uk's en      no</code></pre>
</div>
</div>
<p>Now, we process the table further to add frequency information, i.e., how often a given n-gram occurs in each the language of speakers with distinct L1 backgrounds.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>ngram_fdf <span class="ot">&lt;-</span> ngram_df <span class="sc">%&gt;%</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(ngram, learner) <span class="sc">%&gt;%</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">freq =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(<span class="sc">-</span>freq)</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(ngram_fdf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 3
# Groups:   ngram [5]
  ngram            learner  freq
  &lt;chr&gt;            &lt;chr&gt;   &lt;int&gt;
1 of_the           no         72
2 to_the           no         40
3 in_the           no         39
4 public_transport no         35
5 of_the           yes        33
6 number_of        no         32</code></pre>
</div>
</div>
<p>As the word counts of the texts are quite different, we normalize the frequencies to per-1,000-word frequencies which are comparable across texts of different lengths.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>ngram_nfdf <span class="ot">&lt;-</span> ngram_fdf <span class="sc">%&gt;%</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(ngram) <span class="sc">%&gt;%</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">total_ngram =</span> <span class="fu">sum</span>(freq)) <span class="sc">%&gt;%</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(<span class="sc">-</span>total_ngram) <span class="sc">%&gt;%</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># total by learner</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(learner) <span class="sc">%&gt;%</span></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">total_learner =</span> <span class="fu">sum</span>(freq),</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>                <span class="at">rfreq =</span> freq<span class="sc">/</span>total_learner<span class="sc">*</span><span class="dv">1000</span>)</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect</span></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(ngram_nfdf, <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 6
# Groups:   learner [2]
   ngram            learner  freq total_ngram total_learner rfreq
   &lt;chr&gt;            &lt;chr&gt;   &lt;int&gt;       &lt;int&gt;         &lt;int&gt; &lt;dbl&gt;
 1 of_the           no         72         105          9452  7.62
 2 of_the           yes        33         105          3395  9.72
 3 in_the           no         39          49          9452  4.13
 4 in_the           yes        10          49          3395  2.95
 5 to_the           no         40          47          9452  4.23
 6 to_the           yes         7          47          3395  2.06
 7 it_is            no         23          44          9452  2.43
 8 it_is            yes        21          44          3395  6.19
 9 public_transport no         35          35          9452  3.70
10 number_of        no         32          35          9452  3.39</code></pre>
</div>
</div>
<p>We now reformat the table so that we have relative frequencies for both learners and L1 speakers even if a particular n-gram does not occur in the text produced by either a learner or a L1 speaker.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>ngram_rel <span class="ot">&lt;-</span> ngram_nfdf <span class="sc">%&gt;%</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(ngram, learner, rfreq, total_ngram) <span class="sc">%&gt;%</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">spread</span>(learner, rfreq) <span class="sc">%&gt;%</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">no =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(no), <span class="dv">0</span>, no),</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">yes =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(yes), <span class="dv">0</span>, yes)) <span class="sc">%&gt;%</span></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">gather</span>(learner, rfreq, no<span class="sc">:</span>yes) <span class="sc">%&gt;%</span></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(<span class="sc">-</span>total_ngram)</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect</span></span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(ngram_rel)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 4
  ngram  total_ngram learner rfreq
  &lt;chr&gt;        &lt;int&gt; &lt;chr&gt;   &lt;dbl&gt;
1 of_the         105 no       7.62
2 of_the         105 yes      9.72
3 in_the          49 no       4.13
4 in_the          49 yes      2.95
5 to_the          47 no       4.23
6 to_the          47 yes      2.06</code></pre>
</div>
</div>
<p>Finally, we visualize the most frequent n-grams in the data in a bar chart.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>ngram_rel <span class="sc">%&gt;%</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">20</span>) <span class="sc">%&gt;%</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> rfreq, <span class="at">x =</span> <span class="fu">reorder</span>(ngram, <span class="sc">-</span>total_ngram), <span class="at">group =</span> learner, <span class="at">fill =</span> learner)) <span class="sc">+</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>()) <span class="sc">+</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>, <span class="at">angle=</span><span class="dv">90</span>),</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"top"</span>) <span class="sc">+</span></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Relative frequnecy</span><span class="sc">\n</span><span class="st">(per 1,000 words)"</span>, <span class="at">x =</span> <span class="st">"n-gram"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="llr_files/figure-html/ng10-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>We can, of course also investigate only specific n-grams, e.g., n-grams containing a specific word such as <em>public</em> (below, we only show the first 6 n-grams containing <em>public</em> by using the <code>head</code> function).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>ngram_rel <span class="sc">%&gt;%</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(stringr<span class="sc">::</span><span class="fu">str_detect</span>(ngram, <span class="st">"public"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 4
  ngram            total_ngram learner rfreq
  &lt;chr&gt;                  &lt;int&gt; &lt;chr&gt;   &lt;dbl&gt;
1 public_transport          35 no      3.70 
2 public_transport          35 yes     0    
3 use_public                10 no      1.06 
4 use_public                10 yes     0    
5 of_public                  6 no      0.635
6 of_public                  6 yes     0    </code></pre>
</div>
</div>
<p>We can also specify the order by adding the underscore as shown below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>ngram_rel <span class="sc">%&gt;%</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(stringr<span class="sc">::</span><span class="fu">str_detect</span>(ngram, <span class="st">"public_"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 4
  ngram             total_ngram learner rfreq
  &lt;chr&gt;                   &lt;int&gt; &lt;chr&gt;   &lt;dbl&gt;
1 public_transport           35 no      3.70 
2 public_transport           35 yes     0    
3 public_action               1 no      0.106
4 public_and                  1 no      0.106
5 public_awareness            1 no      0.106
6 public_opposition           1 no      0.106</code></pre>
</div>
</div>
</section>
<section id="differences-in-ngram-use" class="level1 unnumbered">
<h1 class="unnumbered">Differences in ngram use</h1>
<p>Next, we will set out to identify differences in n-gram frequencies between learners and L1 speakers. In a first step, we transform the table so that we have separate columns for learners and L1-speakers. In addition, we also add columns containing all the information we need to perform Fisher’s exact test to check if learners use certain n-grams significantly more or less frequently compared to L1-speakers.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>sdif_ngram <span class="ot">&lt;-</span> ngram_fdf <span class="sc">%&gt;%</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">spread</span>(learner, freq) <span class="sc">%&gt;%</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">no =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(no), <span class="dv">0</span>, no),</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">yes =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(yes), <span class="dv">0</span>, yes)) <span class="sc">%&gt;%</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">l1speaker =</span> no, </span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">learner =</span> yes) <span class="sc">%&gt;%</span></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">total_ngram =</span> l1speaker<span class="sc">+</span>learner) <span class="sc">%&gt;%</span></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">total_learner =</span> <span class="fu">sum</span>(learner),</span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>              <span class="at">total_l1 =</span> <span class="fu">sum</span>(l1speaker)) <span class="sc">%&gt;%</span></span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">a =</span> l1speaker,</span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a>                <span class="at">b =</span> learner) <span class="sc">%&gt;%</span></span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">c =</span> total_l1<span class="sc">-</span>a,</span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a>                <span class="at">d =</span> total_learner<span class="sc">-</span>b)</span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect</span></span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(sdif_ngram)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 10
  ngram   l1speaker learner total_ngram total_learner total_l1     a     b     c
  &lt;chr&gt;       &lt;dbl&gt;   &lt;dbl&gt;       &lt;dbl&gt;         &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 -to_cr…         1       0           1          3395     9452     1     0  9451
2 `_t             0       1           1          3395     9452     0     1  9452
3 +_even          1       0           1          3395     9452     1     0  9451
4 +_peop…         1       0           1          3395     9452     1     0  9451
5 &lt;_byron         0       1           1          3395     9452     0     1  9452
6 £_1mil…         1       0           1          3395     9452     1     0  9451
# … with 1 more variable: d &lt;dbl&gt;</code></pre>
</div>
</div>
<p>On this re-arranged data set, we can now apply the Fisher’s exact tests. As we are performing many different tests, we need to correct for multiple comparisons. To this end, we create a column which holds the Bonferroni corrected critical value (.05). If a p-value is lower than the corrected critical value, then the learners and L1-speakers differ significantly in their use of that n-gram.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>sdif_ngram <span class="ot">&lt;-</span> sdif_ngram  <span class="sc">%&gt;%</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># perform fishers exact test and extract estimate and p</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rowwise</span>() <span class="sc">%&gt;%</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">fisher_p =</span> <span class="fu">fisher.test</span>(<span class="fu">matrix</span>(<span class="fu">c</span>(a,c,b,d), <span class="at">nrow=</span> <span class="dv">2</span>))<span class="sc">$</span>p.value,</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">oddsratio =</span> <span class="fu">fisher.test</span>(<span class="fu">matrix</span>(<span class="fu">c</span>(a,c,b,d), <span class="at">nrow=</span> <span class="dv">2</span>))<span class="sc">$</span>estimate,</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>                <span class="co"># calculate bonferroni correction</span></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>                <span class="at">crit =</span> .<span class="dv">05</span><span class="sc">/</span><span class="fu">nrow</span>(.),</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>                <span class="at">sig_corr =</span> <span class="fu">ifelse</span>(fisher_p <span class="sc">&lt;</span> crit, <span class="st">"p&lt;.05"</span>, <span class="st">"n.s."</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(fisher_p) <span class="sc">%&gt;%</span></span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>total_ngram, <span class="sc">-</span>total_learner, <span class="sc">-</span>total_l1, <span class="sc">-</span>a, <span class="sc">-</span>b, <span class="sc">-</span>c, <span class="sc">-</span>d, <span class="sc">-</span>crit)</span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect</span></span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(sdif_ngram)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 6
# Rowwise: 
  ngram            l1speaker learner  fisher_p oddsratio sig_corr
  &lt;chr&gt;                &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;   
1 in_silence               0       8 0.0000236         0 n.s.    
2 public_transport        35       0 0.0000276       Inf n.s.    
3 silence_is               0       7 0.0000896         0 n.s.    
4 of_all                   0       6 0.000339          0 n.s.    
5 our_society              0       6 0.000339          0 n.s.    
6 in_our                   0       5 0.00129           0 n.s.    </code></pre>
</div>
</div>
<p>In our case, there are no n-grams that differ significantly in their use by learners and L1-speakers once we have corrected for repeated testing as indicated by the <em>n.s.</em> (not significant) in the column called <em>sig_corr</em>.</p>
</section>
<section id="finding-collocations" class="level1 unnumbered">
<h1 class="unnumbered">Finding collocations</h1>
<p>There are various techniques for identifying collocations. To identify collocations without having a pre-defined target term, we can use the <code>textstat_collocations</code> function from the <code>quanteda.textstats</code> package <span class="citation" data-cites="benoit2021package">[cf. <a href="#ref-benoit2021package" role="doc-biblioref">3</a>]</span>.</p>
<p>However, before we can apply that function and start identifying collocations, we need to process the data to which we want to apply this function. In the present case, we will apply that function to the sentences in the L1 data which we extract in the code chunk below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>ns_sen <span class="ot">&lt;-</span> <span class="fu">c</span>(ns1_sen, ns2_sen) <span class="sc">%&gt;%</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tolower</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">

<div class="tabwid"><style>.cl-b93f96f4{table-layout:auto;width:95%;}.cl-b93a0388{font-family:'DejaVu Sans';font-size:12pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-b93a03a6{font-family:'DejaVu Sans';font-size:12pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-b93a1b5c{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-b93a4a78{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b93a4a82{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b93a4a8c{background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b93a4a96{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table class="cl-b93f96f4">
<caption class="Table Caption">
<p>First 6 sentences in L1 data.</p>
</caption>

<thead><tr style="overflow-wrap:break-word;"><td class="cl-b93a4a96"><p class="cl-b93a1b5c"><span class="cl-b93a0388">.</span></p></td></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-b93a4a78"><p class="cl-b93a1b5c"><span class="cl-b93a03a6">transport 01</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-b93a4a82"><p class="cl-b93a1b5c"><span class="cl-b93a03a6">the basic dilema facing the uk's rail and road transport system is the general rise in population.</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-b93a4a78"><p class="cl-b93a1b5c"><span class="cl-b93a03a6">this leads to an increase in the number of commuters and transport users every year, consequently putting pressure on the uks transports network.</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-b93a4a82"><p class="cl-b93a1b5c"><span class="cl-b93a03a6">the biggest worry to the system is the rapid rise of car users outside the major cities.</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-b93a4a78"><p class="cl-b93a1b5c"><span class="cl-b93a03a6">most large cities have managed to incourage commuters to use public transport thus decreasing major conjestion in rush hour periods.</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-b93a4a8c"><p class="cl-b93a1b5c"><span class="cl-b93a03a6">public transport is the obvious solution to to the increase in population if it is made cheep to commuters, clean, easy and efficient then it could take the strain of the overloaded british roads.</span></p></td></tr></tbody></table></div>
</div>
</div>
<p>From the output shown above, we also see that splitting texts did not work perfectly as it produces some unwarranted artifacts like the “sentences” that consist of headings (e.g., <em>transport 01</em>). Fortunately, these errors do not really matter in the case of our example.</p>
<p>Now that we have the L1 data split into sentences, we can tokenize these sentences and apply the <code>textstat_collocations</code> function which identifies collocations.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create a token object</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>ns_tokens <span class="ot">&lt;-</span> quanteda<span class="sc">::</span><span class="fu">tokens</span>(ns_sen, <span class="at">remove_punct =</span> <span class="cn">TRUE</span>)<span class="co"># %&gt;%</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a><span class="co">#  tokens_remove(stopwords("english"))</span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a><span class="co"># extract collocations</span></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>ns_coll <span class="ot">&lt;-</span> quanteda.textstats<span class="sc">::</span><span class="fu">textstat_collocations</span>(ns_tokens, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">min_count =</span> <span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">

<div class="tabwid"><style>.cl-b9586544{table-layout:auto;width:50%;}.cl-b953bbf2{font-family:'DejaVu Sans';font-size:12pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-b953bbfc{font-family:'DejaVu Sans';font-size:12pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-b953ce12{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-b953ce1c{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-b953fbf8{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b953fbf9{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b953fc02{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b953fc0c{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b953fc0d{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b953fc16{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b953fc17{background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b953fc20{background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b953fc2a{background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b953fc34{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b953fc35{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b953fc3e{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table class="cl-b9586544">
<caption class="Table Caption">
<p>Top 6 collocations in teh L1 data.</p>
</caption>

<thead><tr style="overflow-wrap:break-word;"><td class="cl-b953fc34"><p class="cl-b953ce12"><span class="cl-b953bbf2">collocation</span></p></td><td class="cl-b953fc35"><p class="cl-b953ce1c"><span class="cl-b953bbf2">count</span></p></td><td class="cl-b953fc35"><p class="cl-b953ce1c"><span class="cl-b953bbf2">count_nested</span></p></td><td class="cl-b953fc35"><p class="cl-b953ce1c"><span class="cl-b953bbf2">length</span></p></td><td class="cl-b953fc35"><p class="cl-b953ce1c"><span class="cl-b953bbf2">lambda</span></p></td><td class="cl-b953fc3e"><p class="cl-b953ce1c"><span class="cl-b953bbf2">z</span></p></td></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-b953fc02"><p class="cl-b953ce12"><span class="cl-b953bbfc">public transport</span></p></td><td class="cl-b953fbf8"><p class="cl-b953ce1c"><span class="cl-b953bbfc">35</span></p></td><td class="cl-b953fbf8"><p class="cl-b953ce1c"><span class="cl-b953bbfc">0</span></p></td><td class="cl-b953fbf8"><p class="cl-b953ce1c"><span class="cl-b953bbfc">2</span></p></td><td class="cl-b953fbf8"><p class="cl-b953ce1c"><span class="cl-b953bbfc">7.170227</span></p></td><td class="cl-b953fbf9"><p class="cl-b953ce1c"><span class="cl-b953bbfc">14.89924</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-b953fc16"><p class="cl-b953ce12"><span class="cl-b953bbfc">it is</span></p></td><td class="cl-b953fc0c"><p class="cl-b953ce1c"><span class="cl-b953bbfc">23</span></p></td><td class="cl-b953fc0c"><p class="cl-b953ce1c"><span class="cl-b953bbfc">0</span></p></td><td class="cl-b953fc0c"><p class="cl-b953ce1c"><span class="cl-b953bbfc">2</span></p></td><td class="cl-b953fc0c"><p class="cl-b953ce1c"><span class="cl-b953bbfc">3.119043</span></p></td><td class="cl-b953fc0d"><p class="cl-b953ce1c"><span class="cl-b953bbfc">12.15265</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-b953fc02"><p class="cl-b953ce12"><span class="cl-b953bbfc">of the</span></p></td><td class="cl-b953fbf8"><p class="cl-b953ce1c"><span class="cl-b953bbfc">72</span></p></td><td class="cl-b953fbf8"><p class="cl-b953ce1c"><span class="cl-b953bbfc">0</span></p></td><td class="cl-b953fbf8"><p class="cl-b953ce1c"><span class="cl-b953bbfc">2</span></p></td><td class="cl-b953fbf8"><p class="cl-b953ce1c"><span class="cl-b953bbfc">1.617862</span></p></td><td class="cl-b953fbf9"><p class="cl-b953ce1c"><span class="cl-b953bbfc">11.45624</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-b953fc16"><p class="cl-b953ce12"><span class="cl-b953bbfc">to use</span></p></td><td class="cl-b953fc0c"><p class="cl-b953ce1c"><span class="cl-b953bbfc">21</span></p></td><td class="cl-b953fc0c"><p class="cl-b953ce1c"><span class="cl-b953bbfc">0</span></p></td><td class="cl-b953fc0c"><p class="cl-b953ce1c"><span class="cl-b953bbfc">2</span></p></td><td class="cl-b953fc0c"><p class="cl-b953ce1c"><span class="cl-b953bbfc">3.458612</span></p></td><td class="cl-b953fc0d"><p class="cl-b953ce1c"><span class="cl-b953bbfc">10.59222</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-b953fc02"><p class="cl-b953ce12"><span class="cl-b953bbfc">number of</span></p></td><td class="cl-b953fbf8"><p class="cl-b953ce1c"><span class="cl-b953bbfc">32</span></p></td><td class="cl-b953fbf8"><p class="cl-b953ce1c"><span class="cl-b953bbfc">0</span></p></td><td class="cl-b953fbf8"><p class="cl-b953ce1c"><span class="cl-b953bbfc">2</span></p></td><td class="cl-b953fbf8"><p class="cl-b953ce1c"><span class="cl-b953bbfc">5.693830</span></p></td><td class="cl-b953fbf9"><p class="cl-b953ce1c"><span class="cl-b953bbfc">10.06386</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-b953fc20"><p class="cl-b953ce12"><span class="cl-b953bbfc">on the</span></p></td><td class="cl-b953fc17"><p class="cl-b953ce1c"><span class="cl-b953bbfc">31</span></p></td><td class="cl-b953fc17"><p class="cl-b953ce1c"><span class="cl-b953bbfc">0</span></p></td><td class="cl-b953fc17"><p class="cl-b953ce1c"><span class="cl-b953bbfc">2</span></p></td><td class="cl-b953fc17"><p class="cl-b953ce1c"><span class="cl-b953bbfc">2.103127</span></p></td><td class="cl-b953fc2a"><p class="cl-b953ce1c"><span class="cl-b953bbfc">9.43355</span></p></td></tr></tbody></table></div>
</div>
</div>
<p>The resulting table shows collocations in L1 data descending by collocation strength.</p>
<section id="visualizing-collocation-networks" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="visualizing-collocation-networks">Visualizing collocation networks</h2>
<p>Network graphs are a very useful and flexible tool for visualizing relationships between elements such as words, personas, or authors. This section shows how to generate a network graph for collocations of the term <em>transport</em> using the <code>quanteda</code> package.</p>
<p>In a first step, we generate a document-feature matrix based on the sentences in the L1 data. A document-feature matrix shows how often elements (here these elements are the words that occur in the L1 data) occur in a selection of documents (here these documents are the sentences in the L1 data).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create document-feature matrix</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>ns_dfm <span class="ot">&lt;-</span> ns_sen <span class="sc">%&gt;%</span> </span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">#quanteda::dfm(remove_punct = TRUE) %&gt;%</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>    quanteda<span class="sc">::</span><span class="fu">dfm</span>(<span class="at">remove =</span> <span class="fu">stopwords</span>(<span class="st">'english'</span>), <span class="at">remove_punct =</span> <span class="cn">TRUE</span>)<span class="co"># %&gt;%</span></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">#quanteda::dfm_trim(min_termfreq = 10, verbose = FALSE)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">

<div class="tabwid"><style>.cl-b9778aaa{table-layout:auto;width:50%;}.cl-b973995e{font-family:'DejaVu Sans';font-size:12pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-b9739972{font-family:'DejaVu Sans';font-size:12pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-b973a53e{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-b973a548{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-b973cc26{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b973cc27{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b973cc30{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b973cc31{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b973cc3a{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b973cc3b{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b973cc44{background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b973cc4e{background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b973cc4f{background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b973cc58{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b973cc59{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b973cc62{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table class="cl-b9778aaa">
<caption class="Table Caption">
<p>First 6 rows and columns of the document-feature matrix.</p>
</caption>

<thead><tr style="overflow-wrap:break-word;"><td class="cl-b973cc62"><p class="cl-b973a53e"><span class="cl-b973995e">doc_id</span></p></td><td class="cl-b973cc58"><p class="cl-b973a548"><span class="cl-b973995e">transport</span></p></td><td class="cl-b973cc58"><p class="cl-b973a548"><span class="cl-b973995e">01</span></p></td><td class="cl-b973cc58"><p class="cl-b973a548"><span class="cl-b973995e">basic</span></p></td><td class="cl-b973cc58"><p class="cl-b973a548"><span class="cl-b973995e">dilema</span></p></td><td class="cl-b973cc58"><p class="cl-b973a548"><span class="cl-b973995e">facing</span></p></td><td class="cl-b973cc59"><p class="cl-b973a548"><span class="cl-b973995e">uk's</span></p></td></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-b973cc30"><p class="cl-b973a53e"><span class="cl-b9739972">text1</span></p></td><td class="cl-b973cc26"><p class="cl-b973a548"><span class="cl-b9739972">1</span></p></td><td class="cl-b973cc26"><p class="cl-b973a548"><span class="cl-b9739972">1</span></p></td><td class="cl-b973cc26"><p class="cl-b973a548"><span class="cl-b9739972">0</span></p></td><td class="cl-b973cc26"><p class="cl-b973a548"><span class="cl-b9739972">0</span></p></td><td class="cl-b973cc26"><p class="cl-b973a548"><span class="cl-b9739972">0</span></p></td><td class="cl-b973cc27"><p class="cl-b973a548"><span class="cl-b9739972">0</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-b973cc3a"><p class="cl-b973a53e"><span class="cl-b9739972">text2</span></p></td><td class="cl-b973cc31"><p class="cl-b973a548"><span class="cl-b9739972">1</span></p></td><td class="cl-b973cc31"><p class="cl-b973a548"><span class="cl-b9739972">0</span></p></td><td class="cl-b973cc31"><p class="cl-b973a548"><span class="cl-b9739972">1</span></p></td><td class="cl-b973cc31"><p class="cl-b973a548"><span class="cl-b9739972">1</span></p></td><td class="cl-b973cc31"><p class="cl-b973a548"><span class="cl-b9739972">1</span></p></td><td class="cl-b973cc3b"><p class="cl-b973a548"><span class="cl-b9739972">1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-b973cc30"><p class="cl-b973a53e"><span class="cl-b9739972">text3</span></p></td><td class="cl-b973cc26"><p class="cl-b973a548"><span class="cl-b9739972">1</span></p></td><td class="cl-b973cc26"><p class="cl-b973a548"><span class="cl-b9739972">0</span></p></td><td class="cl-b973cc26"><p class="cl-b973a548"><span class="cl-b9739972">0</span></p></td><td class="cl-b973cc26"><p class="cl-b973a548"><span class="cl-b9739972">0</span></p></td><td class="cl-b973cc26"><p class="cl-b973a548"><span class="cl-b9739972">0</span></p></td><td class="cl-b973cc27"><p class="cl-b973a548"><span class="cl-b9739972">0</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-b973cc3a"><p class="cl-b973a53e"><span class="cl-b9739972">text4</span></p></td><td class="cl-b973cc31"><p class="cl-b973a548"><span class="cl-b9739972">0</span></p></td><td class="cl-b973cc31"><p class="cl-b973a548"><span class="cl-b9739972">0</span></p></td><td class="cl-b973cc31"><p class="cl-b973a548"><span class="cl-b9739972">0</span></p></td><td class="cl-b973cc31"><p class="cl-b973a548"><span class="cl-b9739972">0</span></p></td><td class="cl-b973cc31"><p class="cl-b973a548"><span class="cl-b9739972">0</span></p></td><td class="cl-b973cc3b"><p class="cl-b973a548"><span class="cl-b9739972">0</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-b973cc30"><p class="cl-b973a53e"><span class="cl-b9739972">text5</span></p></td><td class="cl-b973cc26"><p class="cl-b973a548"><span class="cl-b9739972">1</span></p></td><td class="cl-b973cc26"><p class="cl-b973a548"><span class="cl-b9739972">0</span></p></td><td class="cl-b973cc26"><p class="cl-b973a548"><span class="cl-b9739972">0</span></p></td><td class="cl-b973cc26"><p class="cl-b973a548"><span class="cl-b9739972">0</span></p></td><td class="cl-b973cc26"><p class="cl-b973a548"><span class="cl-b9739972">0</span></p></td><td class="cl-b973cc27"><p class="cl-b973a548"><span class="cl-b9739972">0</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-b973cc4f"><p class="cl-b973a53e"><span class="cl-b9739972">text6</span></p></td><td class="cl-b973cc44"><p class="cl-b973a548"><span class="cl-b9739972">1</span></p></td><td class="cl-b973cc44"><p class="cl-b973a548"><span class="cl-b9739972">0</span></p></td><td class="cl-b973cc44"><p class="cl-b973a548"><span class="cl-b9739972">0</span></p></td><td class="cl-b973cc44"><p class="cl-b973a548"><span class="cl-b9739972">0</span></p></td><td class="cl-b973cc44"><p class="cl-b973a548"><span class="cl-b9739972">0</span></p></td><td class="cl-b973cc4e"><p class="cl-b973a548"><span class="cl-b9739972">0</span></p></td></tr></tbody></table></div>
</div>
</div>
<p>As we want to generate a network graph of words that collocate with the term <em>organism</em>, we use the <code>calculateCoocStatistics</code> function to determine which words most strongly collocate with our target term (<em>organism</em>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load function for co-occurrence calculation</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"https://slcladal.github.io/rscripts/calculateCoocStatistics.R"</span>)</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a><span class="co"># define term</span></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>coocTerm <span class="ot">&lt;-</span> <span class="st">"transport"</span></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate co-occurrence statistics</span></span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>coocs <span class="ot">&lt;-</span> <span class="fu">calculateCoocStatistics</span>(coocTerm, ns_dfm, <span class="at">measure=</span><span class="st">"LOGLIK"</span>)</span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect results</span></span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>coocs[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    public        use    traffic       rail     facing  commuters    cheaper 
113.171974  19.437311  10.508626   9.652830   9.382889   9.382889   9.382889 
     roads       less      buses 
  9.080648   8.067363   6.702863 </code></pre>
</div>
</div>
<p>We now reduce the document-feature matrix to contain only the top 20 collocates of <em>transport</em> (plus our target word <em>transport</em>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>redux_dfm <span class="ot">&lt;-</span> <span class="fu">dfm_select</span>(ns_dfm, </span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>                        <span class="at">pattern =</span> <span class="fu">c</span>(<span class="fu">names</span>(coocs)[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>], <span class="st">"transport"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">

<div class="tabwid"><style>.cl-ba0f22b6{table-layout:auto;width:50%;}.cl-ba0b1644{font-family:'DejaVu Sans';font-size:12pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-ba0b164e{font-family:'DejaVu Sans';font-size:12pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-ba0b1f2c{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-ba0b1f36{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-ba0b3b88{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ba0b3b92{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ba0b3b9c{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ba0b3b9d{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ba0b3ba6{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ba0b3ba7{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ba0b3ba8{background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ba0b3bb0{background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ba0b3bba{background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ba0b3bbb{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ba0b3bbc{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ba0b3bc4{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table class="cl-ba0f22b6">
<caption class="Table Caption">
<p>First 6 rows and columns of the reduced feature co-occurrence matrix.</p>
</caption>

<thead><tr style="overflow-wrap:break-word;"><td class="cl-ba0b3bc4"><p class="cl-ba0b1f2c"><span class="cl-ba0b1644">doc_id</span></p></td><td class="cl-ba0b3bbb"><p class="cl-ba0b1f36"><span class="cl-ba0b1644">transport</span></p></td><td class="cl-ba0b3bbb"><p class="cl-ba0b1f36"><span class="cl-ba0b1644">facing</span></p></td><td class="cl-ba0b3bbb"><p class="cl-ba0b1f36"><span class="cl-ba0b1644">rail</span></p></td><td class="cl-ba0b3bbb"><p class="cl-ba0b1f36"><span class="cl-ba0b1644">commuters</span></p></td><td class="cl-ba0b3bbb"><p class="cl-ba0b1f36"><span class="cl-ba0b1644">use</span></p></td><td class="cl-ba0b3bbc"><p class="cl-ba0b1f36"><span class="cl-ba0b1644">public</span></p></td></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-ba0b3b9c"><p class="cl-ba0b1f2c"><span class="cl-ba0b164e">text1</span></p></td><td class="cl-ba0b3b88"><p class="cl-ba0b1f36"><span class="cl-ba0b164e">1</span></p></td><td class="cl-ba0b3b88"><p class="cl-ba0b1f36"><span class="cl-ba0b164e">0</span></p></td><td class="cl-ba0b3b88"><p class="cl-ba0b1f36"><span class="cl-ba0b164e">0</span></p></td><td class="cl-ba0b3b88"><p class="cl-ba0b1f36"><span class="cl-ba0b164e">0</span></p></td><td class="cl-ba0b3b88"><p class="cl-ba0b1f36"><span class="cl-ba0b164e">0</span></p></td><td class="cl-ba0b3b92"><p class="cl-ba0b1f36"><span class="cl-ba0b164e">0</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-ba0b3b9d"><p class="cl-ba0b1f2c"><span class="cl-ba0b164e">text2</span></p></td><td class="cl-ba0b3ba6"><p class="cl-ba0b1f36"><span class="cl-ba0b164e">1</span></p></td><td class="cl-ba0b3ba6"><p class="cl-ba0b1f36"><span class="cl-ba0b164e">1</span></p></td><td class="cl-ba0b3ba6"><p class="cl-ba0b1f36"><span class="cl-ba0b164e">1</span></p></td><td class="cl-ba0b3ba6"><p class="cl-ba0b1f36"><span class="cl-ba0b164e">0</span></p></td><td class="cl-ba0b3ba6"><p class="cl-ba0b1f36"><span class="cl-ba0b164e">0</span></p></td><td class="cl-ba0b3ba7"><p class="cl-ba0b1f36"><span class="cl-ba0b164e">0</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-ba0b3b9c"><p class="cl-ba0b1f2c"><span class="cl-ba0b164e">text3</span></p></td><td class="cl-ba0b3b88"><p class="cl-ba0b1f36"><span class="cl-ba0b164e">1</span></p></td><td class="cl-ba0b3b88"><p class="cl-ba0b1f36"><span class="cl-ba0b164e">0</span></p></td><td class="cl-ba0b3b88"><p class="cl-ba0b1f36"><span class="cl-ba0b164e">0</span></p></td><td class="cl-ba0b3b88"><p class="cl-ba0b1f36"><span class="cl-ba0b164e">1</span></p></td><td class="cl-ba0b3b88"><p class="cl-ba0b1f36"><span class="cl-ba0b164e">0</span></p></td><td class="cl-ba0b3b92"><p class="cl-ba0b1f36"><span class="cl-ba0b164e">0</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-ba0b3b9d"><p class="cl-ba0b1f2c"><span class="cl-ba0b164e">text4</span></p></td><td class="cl-ba0b3ba6"><p class="cl-ba0b1f36"><span class="cl-ba0b164e">0</span></p></td><td class="cl-ba0b3ba6"><p class="cl-ba0b1f36"><span class="cl-ba0b164e">0</span></p></td><td class="cl-ba0b3ba6"><p class="cl-ba0b1f36"><span class="cl-ba0b164e">0</span></p></td><td class="cl-ba0b3ba6"><p class="cl-ba0b1f36"><span class="cl-ba0b164e">0</span></p></td><td class="cl-ba0b3ba6"><p class="cl-ba0b1f36"><span class="cl-ba0b164e">0</span></p></td><td class="cl-ba0b3ba7"><p class="cl-ba0b1f36"><span class="cl-ba0b164e">0</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-ba0b3b9c"><p class="cl-ba0b1f2c"><span class="cl-ba0b164e">text5</span></p></td><td class="cl-ba0b3b88"><p class="cl-ba0b1f36"><span class="cl-ba0b164e">1</span></p></td><td class="cl-ba0b3b88"><p class="cl-ba0b1f36"><span class="cl-ba0b164e">0</span></p></td><td class="cl-ba0b3b88"><p class="cl-ba0b1f36"><span class="cl-ba0b164e">0</span></p></td><td class="cl-ba0b3b88"><p class="cl-ba0b1f36"><span class="cl-ba0b164e">1</span></p></td><td class="cl-ba0b3b88"><p class="cl-ba0b1f36"><span class="cl-ba0b164e">1</span></p></td><td class="cl-ba0b3b92"><p class="cl-ba0b1f36"><span class="cl-ba0b164e">1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-ba0b3bb0"><p class="cl-ba0b1f2c"><span class="cl-ba0b164e">text6</span></p></td><td class="cl-ba0b3ba8"><p class="cl-ba0b1f36"><span class="cl-ba0b164e">1</span></p></td><td class="cl-ba0b3ba8"><p class="cl-ba0b1f36"><span class="cl-ba0b164e">0</span></p></td><td class="cl-ba0b3ba8"><p class="cl-ba0b1f36"><span class="cl-ba0b164e">0</span></p></td><td class="cl-ba0b3ba8"><p class="cl-ba0b1f36"><span class="cl-ba0b164e">1</span></p></td><td class="cl-ba0b3ba8"><p class="cl-ba0b1f36"><span class="cl-ba0b164e">0</span></p></td><td class="cl-ba0b3bba"><p class="cl-ba0b1f36"><span class="cl-ba0b164e">1</span></p></td></tr></tbody></table></div>
</div>
</div>
<p>Now, we can transform the document-feature matrix into a feature-co-occurrence matrix as shown below. A feature-co-occurrence matrix shows how often each element in that matrix co-occurs with every other element in that matrix.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>tag_fcm <span class="ot">&lt;-</span> <span class="fu">fcm</span>(redux_dfm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">

<div class="tabwid"><style>.cl-ba26035a{table-layout:auto;width:50%;}.cl-ba2025ac{font-family:'DejaVu Sans';font-size:12pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-ba2025c0{font-family:'DejaVu Sans';font-size:12pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-ba203736{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-ba20374a{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-ba206bac{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ba206bb6{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ba206bb7{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ba206bc0{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ba206bca{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ba206bcb{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ba206bd4{background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ba206bd5{background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ba206bde{background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ba206bdf{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ba206bf2{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ba206bfc{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table class="cl-ba26035a">
<caption class="Table Caption">
<p>First 6 rows and columns of the feature co-occurrence matrix.</p>
</caption>

<thead><tr style="overflow-wrap:break-word;"><td class="cl-ba206bfc"><p class="cl-ba203736"><span class="cl-ba2025ac">doc_id</span></p></td><td class="cl-ba206bdf"><p class="cl-ba20374a"><span class="cl-ba2025ac">transport</span></p></td><td class="cl-ba206bdf"><p class="cl-ba20374a"><span class="cl-ba2025ac">facing</span></p></td><td class="cl-ba206bdf"><p class="cl-ba20374a"><span class="cl-ba2025ac">rail</span></p></td><td class="cl-ba206bdf"><p class="cl-ba20374a"><span class="cl-ba2025ac">commuters</span></p></td><td class="cl-ba206bdf"><p class="cl-ba20374a"><span class="cl-ba2025ac">use</span></p></td><td class="cl-ba206bf2"><p class="cl-ba20374a"><span class="cl-ba2025ac">public</span></p></td></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-ba206bb7"><p class="cl-ba203736"><span class="cl-ba2025c0">transport</span></p></td><td class="cl-ba206bac"><p class="cl-ba20374a"><span class="cl-ba2025c0">3</span></p></td><td class="cl-ba206bac"><p class="cl-ba20374a"><span class="cl-ba2025c0">4</span></p></td><td class="cl-ba206bac"><p class="cl-ba20374a"><span class="cl-ba2025c0">17</span></p></td><td class="cl-ba206bac"><p class="cl-ba20374a"><span class="cl-ba2025c0">4</span></p></td><td class="cl-ba206bac"><p class="cl-ba20374a"><span class="cl-ba2025c0">18</span></p></td><td class="cl-ba206bb6"><p class="cl-ba20374a"><span class="cl-ba2025c0">38</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-ba206bc0"><p class="cl-ba203736"><span class="cl-ba2025c0">facing</span></p></td><td class="cl-ba206bca"><p class="cl-ba20374a"><span class="cl-ba2025c0">0</span></p></td><td class="cl-ba206bca"><p class="cl-ba20374a"><span class="cl-ba2025c0">0</span></p></td><td class="cl-ba206bca"><p class="cl-ba20374a"><span class="cl-ba2025c0">2</span></p></td><td class="cl-ba206bca"><p class="cl-ba20374a"><span class="cl-ba2025c0">0</span></p></td><td class="cl-ba206bca"><p class="cl-ba20374a"><span class="cl-ba2025c0">0</span></p></td><td class="cl-ba206bcb"><p class="cl-ba20374a"><span class="cl-ba2025c0">0</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-ba206bb7"><p class="cl-ba203736"><span class="cl-ba2025c0">rail</span></p></td><td class="cl-ba206bac"><p class="cl-ba20374a"><span class="cl-ba2025c0">0</span></p></td><td class="cl-ba206bac"><p class="cl-ba20374a"><span class="cl-ba2025c0">0</span></p></td><td class="cl-ba206bac"><p class="cl-ba20374a"><span class="cl-ba2025c0">5</span></p></td><td class="cl-ba206bac"><p class="cl-ba20374a"><span class="cl-ba2025c0">1</span></p></td><td class="cl-ba206bac"><p class="cl-ba20374a"><span class="cl-ba2025c0">4</span></p></td><td class="cl-ba206bb6"><p class="cl-ba20374a"><span class="cl-ba2025c0">2</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-ba206bc0"><p class="cl-ba203736"><span class="cl-ba2025c0">commuters</span></p></td><td class="cl-ba206bca"><p class="cl-ba20374a"><span class="cl-ba2025c0">0</span></p></td><td class="cl-ba206bca"><p class="cl-ba20374a"><span class="cl-ba2025c0">0</span></p></td><td class="cl-ba206bca"><p class="cl-ba20374a"><span class="cl-ba2025c0">0</span></p></td><td class="cl-ba206bca"><p class="cl-ba20374a"><span class="cl-ba2025c0">0</span></p></td><td class="cl-ba206bca"><p class="cl-ba20374a"><span class="cl-ba2025c0">1</span></p></td><td class="cl-ba206bcb"><p class="cl-ba20374a"><span class="cl-ba2025c0">2</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-ba206bb7"><p class="cl-ba203736"><span class="cl-ba2025c0">use</span></p></td><td class="cl-ba206bac"><p class="cl-ba20374a"><span class="cl-ba2025c0">0</span></p></td><td class="cl-ba206bac"><p class="cl-ba20374a"><span class="cl-ba2025c0">0</span></p></td><td class="cl-ba206bac"><p class="cl-ba20374a"><span class="cl-ba2025c0">0</span></p></td><td class="cl-ba206bac"><p class="cl-ba20374a"><span class="cl-ba2025c0">0</span></p></td><td class="cl-ba206bac"><p class="cl-ba20374a"><span class="cl-ba2025c0">0</span></p></td><td class="cl-ba206bb6"><p class="cl-ba20374a"><span class="cl-ba2025c0">16</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-ba206bd5"><p class="cl-ba203736"><span class="cl-ba2025c0">public</span></p></td><td class="cl-ba206bd4"><p class="cl-ba20374a"><span class="cl-ba2025c0">0</span></p></td><td class="cl-ba206bd4"><p class="cl-ba20374a"><span class="cl-ba2025c0">0</span></p></td><td class="cl-ba206bd4"><p class="cl-ba20374a"><span class="cl-ba2025c0">0</span></p></td><td class="cl-ba206bd4"><p class="cl-ba20374a"><span class="cl-ba2025c0">0</span></p></td><td class="cl-ba206bd4"><p class="cl-ba20374a"><span class="cl-ba2025c0">0</span></p></td><td class="cl-ba206bde"><p class="cl-ba20374a"><span class="cl-ba2025c0">1</span></p></td></tr></tbody></table></div>
</div>
</div>
<p>Using the feature-co-occurrence matrix, we can generate the network graph which shows the terms that collocate with the target term <em>transport</em> with the edges representing the co-occurrence frequency. To generate this network graph, we use the <code>textplot_network</code> function from the <code>quanteda.textplots</code> package.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># generate network graph</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>quanteda.textplots<span class="sc">::</span><span class="fu">textplot_network</span>(tag_fcm, </span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">min_freq =</span> <span class="dv">1</span>, </span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">edge_alpha =</span> <span class="fl">0.3</span>, </span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">edge_size =</span> <span class="dv">5</span>,</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">edge_color =</span> <span class="st">"gray80"</span>,</span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">vertex_labelsize =</span> <span class="fu">log</span>(<span class="fu">rowSums</span>(tag_fcm)<span class="sc">*</span><span class="dv">15</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="llr_files/figure-html/dfm8-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="part-of-speech-tagging" class="level1 unnumbered">
<h1 class="unnumbered">Part-of-speech tagging</h1>
<p>Part-of-speech tagging is a very useful procedure for many analyses. Here, we automatically identify parts of speech (word classes) in the text which, for a well-studied language like English, is approximately 95% accurate.</p>
<p>The code chunk below defines a function which applies this kind of tagging to any text fed into the function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>POStag <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># load necessary packages</span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">require</span>(<span class="st">"stringr"</span>)</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">require</span>(<span class="st">"NLP"</span>)</span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">require</span>(<span class="st">"openNLP"</span>)</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># define annotators</span></span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>  sent_token_annotator <span class="ot">&lt;-</span> openNLP<span class="sc">::</span><span class="fu">Maxent_Sent_Token_Annotator</span>()</span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>  word_token_annotator <span class="ot">&lt;-</span> openNLP<span class="sc">::</span><span class="fu">Maxent_Word_Token_Annotator</span>()</span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a>  pos_tag_annotator <span class="ot">&lt;-</span> openNLP<span class="sc">::</span><span class="fu">Maxent_POS_Tag_Annotator</span>(<span class="at">language =</span> <span class="st">"en"</span>, <span class="at">probs =</span> <span class="cn">FALSE</span>)</span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># convert all file content to strings</span></span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a>  strings <span class="ot">&lt;-</span> <span class="fu">lapply</span>(x, <span class="cf">function</span>(x){</span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">as.String</span>(x)  })</span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># loop over file contents</span></span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sapply</span>(strings, <span class="cf">function</span>(x){</span>
<span id="cb52-15"><a href="#cb52-15" aria-hidden="true" tabindex="-1"></a>    a <span class="ot">&lt;-</span> NLP<span class="sc">::</span><span class="fu">annotate</span>(x, <span class="fu">list</span>(sent_token_annotator, word_token_annotator))</span>
<span id="cb52-16"><a href="#cb52-16" aria-hidden="true" tabindex="-1"></a>    p <span class="ot">&lt;-</span> NLP<span class="sc">::</span><span class="fu">annotate</span>(x, pos_tag_annotator, a)</span>
<span id="cb52-17"><a href="#cb52-17" aria-hidden="true" tabindex="-1"></a>    w <span class="ot">&lt;-</span> <span class="fu">subset</span>(p, type <span class="sc">==</span> <span class="st">"word"</span>)</span>
<span id="cb52-18"><a href="#cb52-18" aria-hidden="true" tabindex="-1"></a>    tags <span class="ot">&lt;-</span> <span class="fu">sapply</span>(w<span class="sc">$</span>features, <span class="st">'[['</span>, <span class="st">"POS"</span>)</span>
<span id="cb52-19"><a href="#cb52-19" aria-hidden="true" tabindex="-1"></a>    as <span class="ot">&lt;-</span> <span class="fu">sprintf</span>(<span class="st">"%s/%s"</span>, x[w], tags)</span>
<span id="cb52-20"><a href="#cb52-20" aria-hidden="true" tabindex="-1"></a>    at <span class="ot">&lt;-</span> <span class="fu">paste</span>(as, <span class="at">collapse =</span> <span class="st">" "</span>)</span>
<span id="cb52-21"><a href="#cb52-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(at)  </span>
<span id="cb52-22"><a href="#cb52-22" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb52-23"><a href="#cb52-23" aria-hidden="true" tabindex="-1"></a>  }</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We now apply this function to a test sentence to see if the function does what we want it to and to check the output format.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># generate test text</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>text <span class="ot">&lt;-</span> <span class="st">"It is now a very wide spread opinion, that in the modern world there is no place for dreaming and imagination."</span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a><span class="co"># apply pos-tag function to test text</span></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>tagged_text <span class="ot">&lt;-</span> <span class="fu">POStag</span>(text)</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect result</span></span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>tagged_text</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "It/PRP is/VBZ now/RB a/DT very/RB wide/JJ spread/NN opinion/NN ,/, that/IN in/IN the/DT modern/JJ world/NN there/EX is/VBZ no/DT place/NN for/IN dreaming/VBG and/CC imagination/NN ./."</code></pre>
</div>
</div>
<p>The tags which you see here are from the tag set developed for the <em>Penn Treebank</em>, a corpus of English text with syntactic annotations. The tags are not always transparent, and this is very much the case for the word class we will be looking at - the tag for an adjective is <code>/JJ</code>!</p>
<p>The next step, we write a function that will clean our texts by removing tags and quotation marks as well as superfluous white spaces.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>comText <span class="ot">&lt;-</span> <span class="cf">function</span>(x,...){</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># paste text together</span></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">paste0</span>(x)</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># remove file identifiers</span></span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> stringr<span class="sc">::</span><span class="fu">str_remove_all</span>(x, <span class="st">"&lt;.*?&gt;"</span>)</span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># remove quotation marks</span></span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> stringr<span class="sc">::</span><span class="fu">str_remove_all</span>(x, <span class="fu">fixed</span>(<span class="st">"</span><span class="sc">\"</span><span class="st">"</span>))</span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># remove superfluous white spaces</span></span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> stringr<span class="sc">::</span><span class="fu">str_squish</span>(x)</span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># remove empty elements</span></span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> x[<span class="sc">!</span>x<span class="sc">==</span><span class="st">""</span>]</span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now we apply the text cleaning function to the texts.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># combine texts</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>ns1_com <span class="ot">&lt;-</span> <span class="fu">comText</span>(ns1_sen)</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>ns2_com <span class="ot">&lt;-</span> <span class="fu">comText</span>(ns2_sen)</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>de_com <span class="ot">&lt;-</span> <span class="fu">comText</span>(de_sen)</span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>es_com <span class="ot">&lt;-</span> <span class="fu">comText</span>(es_sen)</span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>fr_com <span class="ot">&lt;-</span> <span class="fu">comText</span>(fr_sen)</span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>it_com <span class="ot">&lt;-</span> <span class="fu">comText</span>(it_sen)</span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>pl_com <span class="ot">&lt;-</span> <span class="fu">comText</span>(pl_sen)</span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a>ru_com <span class="ot">&lt;-</span> <span class="fu">comText</span>(ru_sen)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now we apply the pos-tagging function to the texts.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co"># apply pos-tag function to data</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>ns1_pos <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(<span class="fu">unlist</span>(<span class="fu">POStag</span>(ns1_com)))</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>ns2_pos <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(<span class="fu">unlist</span>(<span class="fu">POStag</span>(ns2_com)))</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>de_pos <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(<span class="fu">unlist</span>(<span class="fu">POStag</span>(de_com)))</span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>es_pos <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(<span class="fu">unlist</span>(<span class="fu">POStag</span>(es_com)))</span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>fr_pos <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(<span class="fu">unlist</span>(<span class="fu">POStag</span>(fr_com)))</span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>it_pos <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(<span class="fu">unlist</span>(<span class="fu">POStag</span>(it_com)))</span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a>pl_pos <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(<span class="fu">unlist</span>(<span class="fu">POStag</span>(pl_com)))</span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a>ru_pos <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(<span class="fu">unlist</span>(<span class="fu">POStag</span>(ru_com)))</span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect</span></span>
<span id="cb57-11"><a href="#cb57-11" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(ns1_pos)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Transport/NNP 01/CD"                                                                                                                                                                                                                                                                                                         
[2] "The/DT basic/JJ dilema/NN facing/VBG the/DT UK/NNP 's/POS rail/NN and/CC road/NN transport/NN system/NN is/VBZ the/DT general/JJ rise/NN in/IN population/NN ./."                                                                                                                                                            
[3] "This/DT leads/VBZ to/TO an/DT increase/NN in/IN the/DT number/NN of/IN commuters/NNS and/CC transport/NN users/NNS every/DT year/NN ,/, consequently/RB putting/VBG pressure/NN on/IN the/DT UKs/NNP transports/VBZ network/NN ./."                                                                                          
[4] "The/DT biggest/JJS worry/NN to/TO the/DT system/NN is/VBZ the/DT rapid/JJ rise/NN of/IN car/NN users/NNS outside/IN the/DT major/JJ cities/NNS ./."                                                                                                                                                                          
[5] "Most/JJS large/JJ cities/NNS have/VBP managed/VBN to/TO incourage/VB commuters/NNS to/TO use/VB public/JJ transport/NN thus/RB decreasing/VBG major/JJ conjestion/NN in/IN Rush/NNP hour/NN periods/NNS ./."                                                                                                                 
[6] "Public/NNP transport/NN is/VBZ the/DT obvious/JJ solution/NN to/TO to/TO the/DT increase/NN in/IN population/NN if/IN it/PRP is/VBZ made/VBN cheep/NN to/TO commuters/NNS ,/, clean/JJ ,/, easy/JJ and/CC efficient/JJ then/RB it/PRP could/MD take/VB the/DT strain/NN of/IN the/DT overloaded/VBN British/JJ roads/NNS ./."</code></pre>
</div>
</div>
<p>We end up with pos-tagged texts where the pos-tags are added to each word (or symbol).</p>
<p>In the following section, we will use these pos-tags to identify potential differences between learners and L1-speakers of English.</p>
</section>
<section id="differences-in-pos-sequences" class="level1 unnumbered">
<h1 class="unnumbered">Differences in pos-sequences</h1>
<p>To analyze differences in part-of-speech sequences between L1-speakers and learners of English,, we write a function that extracts pos-tag bigrams from the tagged texts.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co"># tokenize and extract pos tags</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>posngram <span class="ot">&lt;-</span> <span class="cf">function</span>(x,...){</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> x <span class="sc">%&gt;%</span></span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>  stringr<span class="sc">::</span><span class="fu">str_remove_all</span>(<span class="st">"</span><span class="sc">\\</span><span class="st">w*/"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>  quanteda<span class="sc">::</span><span class="fu">tokens</span>(<span class="at">remove_punct =</span> <span class="cn">TRUE</span>)  <span class="sc">%&gt;%</span></span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>    quanteda<span class="sc">::</span><span class="fu">tokens_ngrams</span>(<span class="at">n =</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>    stringr<span class="sc">::</span><span class="fu">str_remove_all</span>(<span class="st">"-"</span>)</span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(x)</span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We now apply the function to the pos-tagged texts.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># apply pos-tag function to data</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>ns1_posng <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(<span class="fu">unlist</span>(<span class="fu">posngram</span>(ns1_pos)))</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>ns2_posng <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(<span class="fu">unlist</span>(<span class="fu">posngram</span>(ns2_pos)))</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>de_posng <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(<span class="fu">unlist</span>(<span class="fu">posngram</span>(de_pos)))</span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>es_posng <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(<span class="fu">unlist</span>(<span class="fu">posngram</span>(es_pos)))</span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>fr_posng <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(<span class="fu">unlist</span>(<span class="fu">posngram</span>(fr_pos)))</span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>it_posng <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(<span class="fu">unlist</span>(<span class="fu">posngram</span>(it_pos)))</span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a>pl_posng <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(<span class="fu">unlist</span>(<span class="fu">posngram</span>(pl_pos)))</span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a>ru_posng <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(<span class="fu">unlist</span>(<span class="fu">posngram</span>(ru_pos)))</span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect</span></span>
<span id="cb60-11"><a href="#cb60-11" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(ns1_posng)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "NNP_CD" "DT_JJ"  "JJ_NN"  "NN_VBG" "VBG_DT" "DT_NNP"</code></pre>
</div>
</div>
<p>In a next step, we tabulate the results and add a column telling us about the L1 background of the speakers who have produced the texts.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>posngram_df <span class="ot">&lt;-</span> <span class="fu">c</span>(ns1_posng, ns2_posng, de_posng, es_posng, fr_posng, </span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>                 it_posng, pl_posng, ru_posng) <span class="sc">%&gt;%</span></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># rename column</span></span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">ngram =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add l1</span></span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">l1 =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"en"</span>, <span class="fu">length</span>(ns1_posng)),</span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">rep</span>(<span class="st">"en"</span>, <span class="fu">length</span>(ns2_posng)),</span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">rep</span>(<span class="st">"de"</span>, <span class="fu">length</span>(de_posng)),</span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">rep</span>(<span class="st">"es"</span>, <span class="fu">length</span>(es_posng)),</span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">rep</span>(<span class="st">"fr"</span>, <span class="fu">length</span>(fr_posng)),</span>
<span id="cb62-12"><a href="#cb62-12" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">rep</span>(<span class="st">"it"</span>, <span class="fu">length</span>(it_posng)),</span>
<span id="cb62-13"><a href="#cb62-13" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">rep</span>(<span class="st">"pl"</span>, <span class="fu">length</span>(pl_posng)),</span>
<span id="cb62-14"><a href="#cb62-14" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">rep</span>(<span class="st">"ru"</span>, <span class="fu">length</span>(ru_posng))),</span>
<span id="cb62-15"><a href="#cb62-15" aria-hidden="true" tabindex="-1"></a>                <span class="co"># add learner column</span></span>
<span id="cb62-16"><a href="#cb62-16" aria-hidden="true" tabindex="-1"></a>                <span class="at">learner =</span> <span class="fu">ifelse</span>(l1 <span class="sc">==</span> <span class="st">"en"</span>, <span class="st">"no"</span>, <span class="st">"yes"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb62-17"><a href="#cb62-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># extract frequencies of ngrams</span></span>
<span id="cb62-18"><a href="#cb62-18" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(ngram, learner) <span class="sc">%&gt;%</span></span>
<span id="cb62-19"><a href="#cb62-19" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">freq =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb62-20"><a href="#cb62-20" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(<span class="sc">-</span>freq)</span>
<span id="cb62-21"><a href="#cb62-21" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect</span></span>
<span id="cb62-22"><a href="#cb62-22" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(posngram_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 3
# Groups:   ngram [6]
  ngram learner  freq
  &lt;chr&gt; &lt;chr&gt;   &lt;int&gt;
1 DT_NN no        495
2 IN_DT no        418
3 NN_IN no        417
4 JJ_NN no        314
5 DT_JJ no        243
6 TO_VB no        237</code></pre>
</div>
</div>
<p>Next, we transform the table and add all the information that we need to perform the Fisher’s exact tests that we will use to determine if there are significant differences between L1 speakers and learners of English regarding their use of pos-sequences.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>posngram_df2 <span class="ot">&lt;-</span> posngram_df <span class="sc">%&gt;%</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">spread</span>(learner, freq) <span class="sc">%&gt;%</span></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">no =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(no), <span class="dv">0</span>, no),</span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">yes =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(yes), <span class="dv">0</span>, yes)) <span class="sc">%&gt;%</span></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">l1speaker =</span> no, </span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">learner =</span> yes) <span class="sc">%&gt;%</span></span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">total_ngram =</span> l1speaker<span class="sc">+</span>learner) <span class="sc">%&gt;%</span></span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">total_learner =</span> <span class="fu">sum</span>(learner),</span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a>              <span class="at">total_l1 =</span> <span class="fu">sum</span>(l1speaker)) <span class="sc">%&gt;%</span></span>
<span id="cb64-11"><a href="#cb64-11" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">a =</span> l1speaker,</span>
<span id="cb64-12"><a href="#cb64-12" aria-hidden="true" tabindex="-1"></a>                <span class="at">b =</span> learner) <span class="sc">%&gt;%</span></span>
<span id="cb64-13"><a href="#cb64-13" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">c =</span> total_l1<span class="sc">-</span>a,</span>
<span id="cb64-14"><a href="#cb64-14" aria-hidden="true" tabindex="-1"></a>                <span class="at">d =</span> total_learner<span class="sc">-</span>b)</span>
<span id="cb64-15"><a href="#cb64-15" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect</span></span>
<span id="cb64-16"><a href="#cb64-16" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(posngram_df2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 10
  ngram   l1speaker learner total_ngram total_learner total_l1     a     b     c
  &lt;chr&gt;       &lt;dbl&gt;   &lt;dbl&gt;       &lt;dbl&gt;         &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 `_RB            0       1           1          3518     9621     0     1  9621
2 +_JJ            1       0           1          3518     9621     1     0  9620
3 +_RB            1       0           1          3518     9621     1     0  9620
4 &lt;_NNP           0       1           1          3518     9621     0     1  9621
5 $_CC            0       1           1          3518     9621     0     1  9621
6 $_girl…         0       1           1          3518     9621     0     1  9621
# … with 1 more variable: d &lt;dbl&gt;</code></pre>
</div>
</div>
<p>On this re-arranged data set, we can now apply the Fisher’s exact tests. As we are performing many different tests, we need to correct for multiple comparisons. To this end, we create a column which holds the Bonferroni corrected critical value (.05). If a p-value is lower than the corrected critical value, then the learners and L1-speakers differ significantly in their use of that n-gram.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>sdif_posngram <span class="ot">&lt;-</span> posngram_df2  <span class="sc">%&gt;%</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># perform fishers exact test and extract estimate and p</span></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rowwise</span>() <span class="sc">%&gt;%</span></span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">fisher_p =</span> <span class="fu">fisher.test</span>(<span class="fu">matrix</span>(<span class="fu">c</span>(a,c,b,d), <span class="at">nrow=</span> <span class="dv">2</span>))<span class="sc">$</span>p.value,</span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">oddsratio =</span> <span class="fu">fisher.test</span>(<span class="fu">matrix</span>(<span class="fu">c</span>(a,c,b,d), <span class="at">nrow=</span> <span class="dv">2</span>))<span class="sc">$</span>estimate,</span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>                <span class="co"># calculate bonferroni correction</span></span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>                <span class="at">crit =</span> .<span class="dv">05</span><span class="sc">/</span><span class="fu">nrow</span>(.),</span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a>                <span class="at">sig_corr =</span> <span class="fu">ifelse</span>(fisher_p <span class="sc">&lt;</span> crit, <span class="st">"p&lt;.05"</span>, <span class="st">"n.s."</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(fisher_p) <span class="sc">%&gt;%</span></span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>total_ngram, <span class="sc">-</span>a, <span class="sc">-</span>b, <span class="sc">-</span>c, <span class="sc">-</span>d, <span class="sc">-</span>crit)</span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect</span></span>
<span id="cb66-12"><a href="#cb66-12" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(sdif_posngram)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 8
# Rowwise: 
  ngram   l1speaker learner total_learner total_l1   fisher_p oddsratio sig_corr
  &lt;chr&gt;       &lt;dbl&gt;   &lt;dbl&gt;         &lt;dbl&gt;    &lt;dbl&gt;      &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;   
1 PRP_VBZ        43      55          3518     9621    1.13e-9     0.283 p&lt;.05   
2 NN_NNS        121      10          3518     9621    4.43e-8     4.47  p&lt;.05   
3 $_NN           32      40          3518     9621    2.82e-7     0.290 p&lt;.05   
4 IN_PRP         93      72          3518     9621    3.15e-6     0.467 p&lt;.05   
5 PRP_$          81      61          3518     9621    3.38e-5     0.481 p&lt;.05   
6 JJR_NNS        39       1          3518     9621    9.89e-5    14.3   n.s.    </code></pre>
</div>
</div>
<p>We can now check and compare the use of the the pos-tagged sequences that differ significantly between learners and L1 speakers of English using simple concordancing. We begin by checking the use in the L1-data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co"># combine l1 data</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>l1_pos <span class="ot">&lt;-</span> <span class="fu">c</span>(ns1_pos, ns2_pos)</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a><span class="co"># combine l2 data</span></span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>l2_pos <span class="ot">&lt;-</span> <span class="fu">c</span>(de_pos, es_pos, fr_pos, it_pos, pl_pos, ru_pos)</span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a><span class="co"># extract PRP_VBZ</span></span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>PRP_VBZ_l1 <span class="ot">&lt;-</span>quanteda<span class="sc">::</span><span class="fu">kwic</span>(quanteda<span class="sc">::</span><span class="fu">tokens</span>(l1_pos), </span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>                            <span class="at">pattern =</span> <span class="fu">phrase</span>(<span class="st">"</span><span class="sc">\\</span><span class="st">w* / PRP </span><span class="sc">\\</span><span class="st">w* / VBZ"</span>), </span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a>                            <span class="at">valuetype =</span> <span class="st">"regex"</span>,</span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a>                            <span class="at">window =</span> <span class="dv">10</span>) <span class="sc">%&gt;%</span></span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb68-11"><a href="#cb68-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># remove superfluous columns</span></span>
<span id="cb68-12"><a href="#cb68-12" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>from, <span class="sc">-</span>to, <span class="sc">-</span>docname, <span class="sc">-</span>pattern)</span>
<span id="cb68-13"><a href="#cb68-13" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect results</span></span>
<span id="cb68-14"><a href="#cb68-14" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(PRP_VBZ_l1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                                     pre                keyword
1     NN in / IN population / NN if / IN      it / PRP is / VBZ
2  DT concrete / JJ jungle / NN yet / CC      it / PRP is / VBZ
3 NN centres / NNS during / IN rush / NN ours / PRP comes / VBZ
4                                        It / PRP removes / VBZ
5                                            It / PRP has / VBZ
6                                            It / PRP has / VBZ
                                        post
1    made / VBN cheep / NN to / TO commuters
2        only / RB trying / VBG to / TO cope
3        to / TO a / DT near / JJ standstill
4 the / DT element / NN of / IN independence
5      given / VBN us / PRP the / DT freedom
6    reached / VBN the / DT stage / NN where</code></pre>
</div>
</div>
<p>We now turn to the learner data and also extract concordances for the same pos-sequence.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="co"># extract PRP_VBZ</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>PRP_VBZ_l2 <span class="ot">&lt;-</span>quanteda<span class="sc">::</span><span class="fu">kwic</span>(quanteda<span class="sc">::</span><span class="fu">tokens</span>(l2_pos), </span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>                            <span class="at">pattern =</span> <span class="fu">phrase</span>(<span class="st">"</span><span class="sc">\\</span><span class="st">w* / PRP </span><span class="sc">\\</span><span class="st">w* / VBZ"</span>), </span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>                            <span class="at">valuetype =</span> <span class="st">"regex"</span>, </span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>                            <span class="at">window =</span> <span class="dv">10</span>) <span class="sc">%&gt;%</span></span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># remove superfluous columns</span></span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>from, <span class="sc">-</span>to, <span class="sc">-</span>docname, <span class="sc">-</span>pattern)</span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect results</span></span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(PRP_VBZ_l2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                                      pre               keyword
1       NN why / WRB I / PRP admire / VBP    her / PRP is / VBZ
2        WRB you / PRP look / VBP at / IN    her / PRP is / VBZ
3                                           She / PRP has / VBZ
4 $ shoulders / NNS and / CC usually / RB she / PRP wears / VBZ
5                                            She / PRP is / VBZ
6      IN skirts / NNS , / , because / IN she / PRP hates / VBZ
                                        post
1              her / PRP $ beauty / NN . / .
2           really / RB brilliant / JJ . / .
3 glistening / VBG dark / JJ brown / JJ hair
4             a / DT hair / NN slide / NN or
5      always / RB well / RB dressed / VBN ,
6 wearing / VBG skirts / NNS and / CC tights</code></pre>
</div>
</div>
</section>
<section id="lexical-diversity" class="level1 unnumbered">
<h1 class="unnumbered">Lexical diversity</h1>
<p>Another common measure used to asses the development of language learns is vocabulary size. Vocabulary size can be assessed with various measures that represent lexical diversity. In the present case, we will extract</p>
<ul>
<li><code>TTR</code>: <em>type-token ratio</em></li>
<li><code>C</code>: Herdan’s C (see <span class="citation" data-cites="tweedie1988lexdiv">[<a href="#ref-tweedie1988lexdiv" role="doc-biblioref">4</a>]</span>; sometimes referred to as LogTTR)</li>
<li><code>R</code>: Guiraud’s Root TTR (see <span class="citation" data-cites="tweedie1988lexdiv">[<a href="#ref-tweedie1988lexdiv" role="doc-biblioref">4</a>]</span>)</li>
<li><code>CTTR</code>: Carroll’s Corrected TTR</li>
<li><code>U</code>: Dugast’s Uber Index (see <span class="citation" data-cites="tweedie1988lexdiv">[<a href="#ref-tweedie1988lexdiv" role="doc-biblioref">4</a>]</span>)</li>
<li><code>S</code>: Summer’s index</li>
<li><code>Maas</code>: Maas’ indices</li>
</ul>
<p>The formulas showing how the lexical diversity measures are calculated as well as additional information about the lexical diversity measures can be found <a href="https://quanteda.io/reference/textstat_lexdiv.html">here</a>.</p>
<p>While we will extract all of these scores, we will only visualize Carroll’s Corrected TTR to keep things simple.</p>
<p><span class="math display">\[\begin{equation}
  CTTR =  \frac{N_{Types}}{\sqrt{2 N_{Tokens}}}
\end{equation}\]</span></p>
<p>However, before we extract the lexical diversity measures, we split the data into individual essays.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>cleanEss <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>  x <span class="sc">%&gt;%</span></span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">paste0</span>(<span class="at">collapse =</span> <span class="st">" "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>  stringr<span class="sc">::</span><span class="fu">str_split</span>(<span class="st">"Transport [0-9]{1,2}"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unlist</span>() <span class="sc">%&gt;%</span></span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a>  stringr<span class="sc">::</span><span class="fu">str_squish</span>() <span class="sc">%&gt;%</span></span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a>  .[. <span class="sc">!=</span> <span class="st">""</span>]</span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb72-9"><a href="#cb72-9" aria-hidden="true" tabindex="-1"></a><span class="co"># apply function</span></span>
<span id="cb72-10"><a href="#cb72-10" aria-hidden="true" tabindex="-1"></a>ns1_ess <span class="ot">&lt;-</span> <span class="fu">cleanEss</span>(ns1)</span>
<span id="cb72-11"><a href="#cb72-11" aria-hidden="true" tabindex="-1"></a>ns2_ess <span class="ot">&lt;-</span> <span class="fu">cleanEss</span>(ns2)</span>
<span id="cb72-12"><a href="#cb72-12" aria-hidden="true" tabindex="-1"></a>de_ess <span class="ot">&lt;-</span> <span class="fu">cleanEss</span>(de)</span>
<span id="cb72-13"><a href="#cb72-13" aria-hidden="true" tabindex="-1"></a>es_ess <span class="ot">&lt;-</span> <span class="fu">cleanEss</span>(es)</span>
<span id="cb72-14"><a href="#cb72-14" aria-hidden="true" tabindex="-1"></a>fr_ess <span class="ot">&lt;-</span> <span class="fu">cleanEss</span>(fr)</span>
<span id="cb72-15"><a href="#cb72-15" aria-hidden="true" tabindex="-1"></a>it_ess <span class="ot">&lt;-</span> <span class="fu">cleanEss</span>(it)</span>
<span id="cb72-16"><a href="#cb72-16" aria-hidden="true" tabindex="-1"></a>pl_ess <span class="ot">&lt;-</span> <span class="fu">cleanEss</span>(pl)</span>
<span id="cb72-17"><a href="#cb72-17" aria-hidden="true" tabindex="-1"></a>ru_ess <span class="ot">&lt;-</span> <span class="fu">cleanEss</span>(ru)</span>
<span id="cb72-18"><a href="#cb72-18" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect</span></span>
<span id="cb72-19"><a href="#cb72-19" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(ns1_ess, <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "The basic dilema facing the UK's rail and road transport system is the general rise in population. This leads to an increase in the number of commuters and transport users every year, consequently putting pressure on the UKs transports network. The biggest worry to the system is the rapid rise of car users outside the major cities. Most large cities have managed to incourage commuters to use public transport thus decreasing major conjestion in Rush hour periods. Public transport is the obvious solution to to the increase in population if it is made cheep to commuters, clean, easy and efficient then it could take the strain of the overloaded British roads. For commuters who regularly travel long distances rail transport should be made more appealing, more comfortable and cheaper. Motorways and other transport links are constantly being extended, widened and slowly turning the country into a concrete jungle yet it is only trying to cope with the increase in traffic, we are our own enemy! Another major problem created by the mass of vehicle transport is the pollution emitted into the atmosphere damaging the ozone layer, creating smog and forming acid rain. Tourturing the Earth we are living on. In concluding I wish to propose clean, efficient comfortable and cheap public transport for the near future."</code></pre>
</div>
</div>
<p>In a next step, we can apply the <code>lex.div</code> function from the <code>koRpus</code> package which calculates the different lexical diversity measures for us.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="co"># extract lex. div. measures</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>ns1_lds <span class="ot">&lt;-</span> <span class="fu">lapply</span>(ns1_ess, <span class="cf">function</span>(x){</span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> koRpus<span class="sc">::</span><span class="fu">lex.div</span>(x, <span class="at">force.lang =</span> <span class="st">'en'</span>, <span class="co"># define language </span></span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">segment =</span> <span class="dv">20</span>,      <span class="co"># define segment width</span></span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">window =</span> <span class="dv">20</span>,       <span class="co"># define window width</span></span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a>                       <span class="at">quiet =</span> T,</span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a>                       <span class="co"># define lex div measures</span></span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a>                       <span class="at">measure=</span><span class="fu">c</span>(<span class="st">"TTR"</span>, <span class="st">"C"</span>, <span class="st">"R"</span>, <span class="st">"CTTR"</span>, <span class="st">"U"</span>, <span class="st">"Maas"</span>),</span>
<span id="cb74-9"><a href="#cb74-9" aria-hidden="true" tabindex="-1"></a>                       <span class="at">char=</span><span class="fu">c</span>(<span class="st">"TTR"</span>, <span class="st">"C"</span>, <span class="st">"R"</span>, <span class="st">"CTTR"</span>,<span class="st">"U"</span>, <span class="st">"Maas"</span>))</span>
<span id="cb74-10"><a href="#cb74-10" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb74-11"><a href="#cb74-11" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect</span></span>
<span id="cb74-12"><a href="#cb74-12" aria-hidden="true" tabindex="-1"></a>ns1_lds[<span class="dv">1</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]

Total number of tokens: 217 
Total number of types:  134

Type-Token Ratio
               TTR: 0.62 

TTR characteristics:
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
 0.6140  0.6322  0.6429  0.6888  0.7129  0.9000 
   SD
 0.0852


Herdan's C
                 C: 0.91 

C characteristics:
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
 0.8614  0.9059  0.9131  0.9157  0.9164  0.9648 
   SD
 0.0186


Guiraud's R
                 R: 9.1 

R characteristics:
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  1.789   5.459   6.484   6.596   8.158   9.080 
   SD
 1.8316


Carroll's CTTR
              CTTR: 6.43 

CTTR characteristics:
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  1.265   3.860   4.585   4.664   5.769   6.420 
   SD
 1.2951


Uber Index
                 U: 26.08 

U characteristics:
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  5.041  21.104  22.588  23.564  26.226  36.992 
   SD
 4.5831


Maas' Indices
                 a: 0.2 
              lgV0: 5.14 
             lgeV0: 11.84 

Relative vocabulary growth (first half to full text)
                 a: 0 
              lgV0: 1.83 
                V': 0 (0 new types every 100 tokens)

Maas Indices characteristics:
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
 0.1644  0.1953  0.2104  0.2112  0.2177  0.4454 
   SD
 0.0392
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  1.185   4.106   4.506   4.428   4.955   5.223 
   SD
 0.7145
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  2.729   9.455  10.376  10.196  11.410  12.026 
   SD
 1.6452</code></pre>
</div>
</div>
<p>We now go ahead and extract the lexical diversity scores for the other essays.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>lexDiv <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lapply</span>(x, <span class="cf">function</span>(y){</span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>    koRpus<span class="sc">::</span><span class="fu">lex.div</span>(y, <span class="at">force.lang =</span> <span class="st">'en'</span>,  <span class="at">segment =</span> <span class="dv">20</span>, <span class="at">window =</span> <span class="dv">20</span>,  </span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">quiet =</span> T, <span class="at">measure=</span><span class="fu">c</span>(<span class="st">"TTR"</span>, <span class="st">"C"</span>, <span class="st">"R"</span>, <span class="st">"CTTR"</span>, <span class="st">"U"</span>, <span class="st">"Maas"</span>),</span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">char=</span><span class="fu">c</span>(<span class="st">"TTR"</span>, <span class="st">"C"</span>, <span class="st">"R"</span>, <span class="st">"CTTR"</span>,<span class="st">"U"</span>, <span class="st">"Maas"</span>))</span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb76-8"><a href="#cb76-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-9"><a href="#cb76-9" aria-hidden="true" tabindex="-1"></a><span class="co"># extract lex. div. measures</span></span>
<span id="cb76-10"><a href="#cb76-10" aria-hidden="true" tabindex="-1"></a>ns2_lds <span class="ot">&lt;-</span> <span class="fu">lexDiv</span>(ns2_ess)</span>
<span id="cb76-11"><a href="#cb76-11" aria-hidden="true" tabindex="-1"></a>de_lds <span class="ot">&lt;-</span> <span class="fu">lexDiv</span>(de_ess)</span>
<span id="cb76-12"><a href="#cb76-12" aria-hidden="true" tabindex="-1"></a>es_lds <span class="ot">&lt;-</span> <span class="fu">lexDiv</span>(es_ess)</span>
<span id="cb76-13"><a href="#cb76-13" aria-hidden="true" tabindex="-1"></a>fr_lds <span class="ot">&lt;-</span> <span class="fu">lexDiv</span>(fr_ess)</span>
<span id="cb76-14"><a href="#cb76-14" aria-hidden="true" tabindex="-1"></a>it_lds <span class="ot">&lt;-</span> <span class="fu">lexDiv</span>(it_ess)</span>
<span id="cb76-15"><a href="#cb76-15" aria-hidden="true" tabindex="-1"></a>pl_lds <span class="ot">&lt;-</span> <span class="fu">lexDiv</span>(pl_ess)</span>
<span id="cb76-16"><a href="#cb76-16" aria-hidden="true" tabindex="-1"></a>ru_lds <span class="ot">&lt;-</span> <span class="fu">lexDiv</span>(ru_ess)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In a next step, we extract the CTTR values from L1-speakers and learners and put the results into a table.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>cttr <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">c</span>(<span class="fu">as.vector</span>(<span class="fu">sapply</span>(ns1_lds, <span class="st">'['</span>, <span class="st">"CTTR"</span>)), </span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">as.vector</span>(<span class="fu">sapply</span>(ns2_lds, <span class="st">'['</span>, <span class="st">"CTTR"</span>)), </span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">as.vector</span>(<span class="fu">sapply</span>(de_lds, <span class="st">'['</span>, <span class="st">"CTTR"</span>)), </span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">as.vector</span>(<span class="fu">sapply</span>(es_lds, <span class="st">'['</span>, <span class="st">"CTTR"</span>)),</span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">as.vector</span>(<span class="fu">sapply</span>(fr_lds, <span class="st">'['</span>, <span class="st">"CTTR"</span>)), </span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">as.vector</span>(<span class="fu">sapply</span>(it_lds, <span class="st">'['</span>, <span class="st">"CTTR"</span>)), </span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">as.vector</span>(<span class="fu">sapply</span>(pl_lds, <span class="st">'['</span>, <span class="st">"CTTR"</span>)), </span>
<span id="cb77-8"><a href="#cb77-8" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">as.vector</span>(<span class="fu">sapply</span>(ru_lds, <span class="st">'['</span>, <span class="st">"CTTR"</span>))),</span>
<span id="cb77-9"><a href="#cb77-9" aria-hidden="true" tabindex="-1"></a>          <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"en"</span>, <span class="fu">length</span>(<span class="fu">as.vector</span>(<span class="fu">sapply</span>(ns1_lds, <span class="st">'['</span>, <span class="st">"CTTR"</span>)))),</span>
<span id="cb77-10"><a href="#cb77-10" aria-hidden="true" tabindex="-1"></a>            <span class="fu">rep</span>(<span class="st">"en"</span>, <span class="fu">length</span>(<span class="fu">as.vector</span>(<span class="fu">sapply</span>(ns2_lds, <span class="st">'['</span>, <span class="st">"CTTR"</span>)))),</span>
<span id="cb77-11"><a href="#cb77-11" aria-hidden="true" tabindex="-1"></a>            <span class="fu">rep</span>(<span class="st">"de"</span>, <span class="fu">length</span>(<span class="fu">as.vector</span>(<span class="fu">sapply</span>(de_lds, <span class="st">'['</span>, <span class="st">"CTTR"</span>)))),</span>
<span id="cb77-12"><a href="#cb77-12" aria-hidden="true" tabindex="-1"></a>            <span class="fu">rep</span>(<span class="st">"es"</span>, <span class="fu">length</span>(<span class="fu">as.vector</span>(<span class="fu">sapply</span>(es_lds, <span class="st">'['</span>, <span class="st">"CTTR"</span>)))),</span>
<span id="cb77-13"><a href="#cb77-13" aria-hidden="true" tabindex="-1"></a>            <span class="fu">rep</span>(<span class="st">"fr"</span>, <span class="fu">length</span>(<span class="fu">as.vector</span>(<span class="fu">sapply</span>(fr_lds, <span class="st">'['</span>, <span class="st">"CTTR"</span>)))),</span>
<span id="cb77-14"><a href="#cb77-14" aria-hidden="true" tabindex="-1"></a>            <span class="fu">rep</span>(<span class="st">"it"</span>, <span class="fu">length</span>(<span class="fu">as.vector</span>(<span class="fu">sapply</span>(it_lds, <span class="st">'['</span>, <span class="st">"CTTR"</span>)))),</span>
<span id="cb77-15"><a href="#cb77-15" aria-hidden="true" tabindex="-1"></a>            <span class="fu">rep</span>(<span class="st">"pl"</span>, <span class="fu">length</span>(<span class="fu">as.vector</span>(<span class="fu">sapply</span>(pl_lds, <span class="st">'['</span>, <span class="st">"CTTR"</span>)))),</span>
<span id="cb77-16"><a href="#cb77-16" aria-hidden="true" tabindex="-1"></a>            <span class="fu">rep</span>(<span class="st">"ru"</span>, <span class="fu">length</span>(<span class="fu">as.vector</span>(<span class="fu">sapply</span>(ru_lds, <span class="st">'['</span>, <span class="st">"CTTR"</span>)))))) <span class="sc">%&gt;%</span></span>
<span id="cb77-17"><a href="#cb77-17" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">CTTR =</span> <span class="dv">1</span>,</span>
<span id="cb77-18"><a href="#cb77-18" aria-hidden="true" tabindex="-1"></a>                <span class="at">l1 =</span> <span class="dv">2</span>)</span>
<span id="cb77-19"><a href="#cb77-19" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect</span></span>
<span id="cb77-20"><a href="#cb77-20" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(cttr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  CTTR l1
1 6.43 en
2 8.84 en
3 8.20 en
4 8.34 en
5 7.34 en
6 8.78 en</code></pre>
</div>
</div>
<p>We can now visualize the information in the table in the form of a dot plot to inspect potential differences with respect to the L1-background of speakers.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>cttr <span class="sc">%&gt;%</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(l1) <span class="sc">%&gt;%</span></span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">CTTR =</span> <span class="fu">mean</span>(CTTR)) <span class="sc">%&gt;%</span></span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(l1, CTTR, mean), <span class="at">y =</span> CTTR)) <span class="sc">+</span></span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># adapt y-axis labels</span></span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Lexical diversity (CTTR)"</span>) <span class="sc">+</span></span>
<span id="cb79-8"><a href="#cb79-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># adapt tick labels</span></span>
<span id="cb79-9"><a href="#cb79-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="st">"L1 of learners"</span>, </span>
<span id="cb79-10"><a href="#cb79-10" aria-hidden="true" tabindex="-1"></a>                   <span class="at">breaks =</span> <span class="fu">names</span>(<span class="fu">table</span>(cttr<span class="sc">$</span>l1)), </span>
<span id="cb79-11"><a href="#cb79-11" aria-hidden="true" tabindex="-1"></a>                   <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"en"</span> <span class="ot">=</span> <span class="st">"English"</span>,</span>
<span id="cb79-12"><a href="#cb79-12" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"de"</span> <span class="ot">=</span> <span class="st">"German"</span>,</span>
<span id="cb79-13"><a href="#cb79-13" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"es"</span> <span class="ot">=</span> <span class="st">"Spanish"</span>,</span>
<span id="cb79-14"><a href="#cb79-14" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"fr"</span> <span class="ot">=</span> <span class="st">"French"</span>,</span>
<span id="cb79-15"><a href="#cb79-15" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"it"</span> <span class="ot">=</span> <span class="st">"Italian"</span>,</span>
<span id="cb79-16"><a href="#cb79-16" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"pl"</span> <span class="ot">=</span> <span class="st">"Polish"</span>,</span>
<span id="cb79-17"><a href="#cb79-17" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"ru"</span> <span class="ot">=</span> <span class="st">"Russian"</span>)) <span class="sc">+</span></span>
<span id="cb79-18"><a href="#cb79-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb79-19"><a href="#cb79-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">15</span>)) <span class="sc">+</span></span>
<span id="cb79-20"><a href="#cb79-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="llr_files/figure-html/ld7-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="readability" class="level1 unnumbered">
<h1 class="unnumbered">Readability</h1>
<p>Another measure to assess text quality or text complexity is <em>readability</em>. As with lexical diversity scores, the <code>textstat_readability</code> function from the <code>quanteda.textstats</code> package provides a multitude of different measures (see <a href="https://quanteda.io/reference/textstat_readability.html">here</a> for the entire list of readability scores that can be extracted). In the following, we will focus on Flesch’s Reading Ease Score exclusively <span class="citation" data-cites="flesch1948new">[cf. <a href="#ref-flesch1948new" role="doc-biblioref">5</a>]</span> (see below; ALS = average sentence length).</p>
<p><span class="math display">\[\begin{equation}
  Flesch =  206.835−(1.015 ASL)−(84.6 \frac{N_{Syllables}}{N_{Words}})
\end{equation}\]</span></p>
<p>In a first step, we extract the Flesch scores by applying the <code>textstat_readability</code> to the essays.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>ns1_read <span class="ot">&lt;-</span> quanteda.textstats<span class="sc">::</span><span class="fu">textstat_readability</span>(ns1_ess)</span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>ns2_read <span class="ot">&lt;-</span> quanteda.textstats<span class="sc">::</span><span class="fu">textstat_readability</span>(ns2_ess)</span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>de_read <span class="ot">&lt;-</span> quanteda.textstats<span class="sc">::</span><span class="fu">textstat_readability</span>(de_ess)</span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>es_read <span class="ot">&lt;-</span> quanteda.textstats<span class="sc">::</span><span class="fu">textstat_readability</span>(es_ess)</span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a>fr_read <span class="ot">&lt;-</span> quanteda.textstats<span class="sc">::</span><span class="fu">textstat_readability</span>(fr_ess)</span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a>it_read <span class="ot">&lt;-</span> quanteda.textstats<span class="sc">::</span><span class="fu">textstat_readability</span>(it_ess)</span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true" tabindex="-1"></a>pl_read <span class="ot">&lt;-</span> quanteda.textstats<span class="sc">::</span><span class="fu">textstat_readability</span>(pl_ess)</span>
<span id="cb80-8"><a href="#cb80-8" aria-hidden="true" tabindex="-1"></a>ru_read <span class="ot">&lt;-</span> quanteda.textstats<span class="sc">::</span><span class="fu">textstat_readability</span>(ru_ess)</span>
<span id="cb80-9"><a href="#cb80-9" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect</span></span>
<span id="cb80-10"><a href="#cb80-10" aria-hidden="true" tabindex="-1"></a>ns1_read</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   document   Flesch
1     text1 43.12767
2     text2 62.34563
3     text3 63.16179
4     text4 62.90455
5     text5 53.53250
6     text6 56.92020
7     text7 53.89138
8     text8 59.28742
9     text9 62.26228
10   text10 53.60807
11   text11 58.24022
12   text12 58.36792
13   text13 55.85388
14   text14 48.55222
15   text15 55.41899
16   text16 62.98538</code></pre>
</div>
</div>
<p>Now, we generate a table with the results and the L1 of the speaker that produced the essay.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>l1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"en"</span>, <span class="fu">nrow</span>(ns1_read)), <span class="fu">rep</span>(<span class="st">"en"</span>, <span class="fu">nrow</span>(ns2_read)),</span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>        <span class="st">"de"</span>, <span class="st">"es"</span>, <span class="st">"fr"</span>, <span class="st">"it"</span>, <span class="st">"pl"</span>, <span class="st">"ru"</span>)</span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>read_l1 <span class="ot">&lt;-</span> base<span class="sc">::</span><span class="fu">rbind</span>(ns1_read, ns2_read, de_read, es_read, </span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a>                    fr_read, it_read, pl_read, ru_read)</span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a>read_l1 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(read_l1, l1) <span class="sc">%&gt;%</span></span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb82-7"><a href="#cb82-7" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">l1 =</span> <span class="fu">factor</span>(l1, <span class="at">level =</span> <span class="fu">c</span>(<span class="st">"en"</span>, <span class="st">"de"</span>, <span class="st">"es"</span>, <span class="st">"fr"</span>, <span class="st">"it"</span>, <span class="st">"pl"</span>, <span class="st">"ru"</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb82-8"><a href="#cb82-8" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(l1) <span class="sc">%&gt;%</span></span>
<span id="cb82-9"><a href="#cb82-9" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">Flesch =</span> <span class="fu">mean</span>(Flesch))</span>
<span id="cb82-10"><a href="#cb82-10" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect</span></span>
<span id="cb82-11"><a href="#cb82-11" aria-hidden="true" tabindex="-1"></a>read_l1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 7 × 2
  l1    Flesch
  &lt;fct&gt;  &lt;dbl&gt;
1 en      56.7
2 de      65.2
3 es      57.6
4 fr      66.4
5 it      55.4
6 pl      62.5
7 ru      43.8</code></pre>
</div>
</div>
<p>As before, we can visualize the results to check for potential differences between L1-speakers and learners of English. In this case, we use bar charts to visualize the results.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>read_l1 <span class="sc">%&gt;%</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> l1, <span class="at">y =</span> Flesch, <span class="at">label =</span> <span class="fu">round</span>(Flesch, <span class="dv">1</span>))) <span class="sc">+</span></span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">vjust=</span><span class="fl">1.6</span>, <span class="at">color =</span> <span class="st">"white"</span>)<span class="sc">+</span></span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># adapt tick labels</span></span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="st">"L1 of learners"</span>, </span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a>                   <span class="at">breaks =</span> <span class="fu">names</span>(<span class="fu">table</span>(read_l1<span class="sc">$</span>l1)), </span>
<span id="cb84-8"><a href="#cb84-8" aria-hidden="true" tabindex="-1"></a>                   <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"en"</span> <span class="ot">=</span> <span class="st">"English"</span>,</span>
<span id="cb84-9"><a href="#cb84-9" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"de"</span> <span class="ot">=</span> <span class="st">"German"</span>,</span>
<span id="cb84-10"><a href="#cb84-10" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"es"</span> <span class="ot">=</span> <span class="st">"Spanish"</span>,</span>
<span id="cb84-11"><a href="#cb84-11" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"fr"</span> <span class="ot">=</span> <span class="st">"French"</span>,</span>
<span id="cb84-12"><a href="#cb84-12" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"it"</span> <span class="ot">=</span> <span class="st">"Italian"</span>,</span>
<span id="cb84-13"><a href="#cb84-13" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"pl"</span> <span class="ot">=</span> <span class="st">"Polish"</span>,</span>
<span id="cb84-14"><a href="#cb84-14" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"ru"</span> <span class="ot">=</span> <span class="st">"Russian"</span>)) <span class="sc">+</span></span>
<span id="cb84-15"><a href="#cb84-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb84-16"><a href="#cb84-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">75</span>)) <span class="sc">+</span></span>
<span id="cb84-17"><a href="#cb84-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="llr_files/figure-html/rd4-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="spelling-errors" class="level1 unnumbered">
<h1 class="unnumbered">Spelling errors</h1>
<p>We can also determine the number of spelling errors in L1 and learner texts by checking if words in a given text occur in a dictionary or not. To do this, we can use the <code>hunspell</code> function from the <code>hunspell</code> package. We can choose between different dictionaries (use <code>list_dictionaries()</code> to see which dictionaries are available) and we can specify words to ignore via the <code>ignore</code> argument.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="co"># list words that are not in dict</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hunspell</span>(ns1_ess, </span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">format =</span> <span class="fu">c</span>(<span class="st">"text"</span>),</span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">dict =</span> <span class="fu">dictionary</span>(<span class="st">"en_GB"</span>),</span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">ignore =</span> en_stats) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
[1] "dilema"     "UKs"        "incourage"  "conjestion" "Tourturing"

[[2]]
[1] "appealling"

[[3]]
[1] "dependance" "recieve"    "travell"   

[[4]]
[1] "ie"          "Improvent"   "maintanence" "theier"      "airplanes"  
[6] "buisness"    "thier"       "ie"          "etc"        

[[5]]
[1] "tendancy"     "etc"          "HGV's"        "Eurotunnel"   "Eurotunnel's"

[[6]]
[1] "indaquacies"      "croweded"         "accomadating"     "roadsystem"      
[5] "enviromentalists" "undergrouth"      "enviromentalists" "exponnentionally"

[[7]]
[1] "taffic"    "taffic"    "percieved"

[[8]]
[1] "notorously" "gars"      

[[9]]
[1] "seperate"    "secondy"     "Dwyford"     "disastorous" "railtrak"   
[6] "anymore"     "loocally"    "offes"      

[[10]]
[1] "apparant" "persuede" "detere"   "overal"  

[[11]]
[1] "Tarmat"

[[12]]
 [1] "Britains"      "streches"      "improoved"     "ammount"      
 [5] "soloution"     "privitisation" "bos"           "soloution"    
 [9] "improove"      "liase"        

[[13]]
[1] "abducters" "Bulger"    "enourmos"  "tyed"      "Britains"  "useage"   
[7] "busses"    "useage"   

[[14]]
 [1] "ment"         "accross"      "harmfull"     "byproducts"   "disel"       
 [6] "traveling"    "likelyhood"   "adverage"     "collegue"     "effectivly"  
[11] "controll"     "incrasing"    "restablished" "councills"   

[[15]]
[1] "susstacial" "cataylitic" "alot"       "cataylitic"

[[16]]
 [1] "ourselfs"     "ameander"     "illistrate"   "likly"        "firsty"      
 [6] "mannor"       "greeny"       "tipee's"      "somthing"     "thent"       
[11] "westeren"     "beause"       "earilene"     "shorly"       "disasterous" 
[16] "nd"           "promblem"     "spiraling"    "intensifyed"  "privite"     
[21] "companys"     "priviously"   "subsudised"   "privite"      "Unfortunatly"
[26] "appethetic"  </code></pre>
</div>
</div>
<p>We can check how many spelling mistakes and words are in a text as shown below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>ns1_nerr <span class="ot">&lt;-</span> <span class="fu">hunspell</span>(ns1_ess, <span class="at">dict =</span> <span class="fu">dictionary</span>(<span class="st">"en_GB"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unlist</span>() <span class="sc">%&gt;%</span></span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">length</span>()</span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a>ns1_nw <span class="ot">&lt;-</span> <span class="fu">sum</span>(tokenizers<span class="sc">::</span><span class="fu">count_words</span>(ns1_ess))</span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect</span></span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a>ns1_nerr; ns1_nw</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 111</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 8499</code></pre>
</div>
</div>
<p>To check if L1 speakers and learners differ regrading the likelihood of making spelling errors, we apply the <code>hunspell</code> function to all texts and also extract the number of words for each text.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ns1</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>ns1_nerr <span class="ot">&lt;-</span> <span class="fu">hunspell</span>(ns1_ess, <span class="at">dict =</span> <span class="fu">dictionary</span>(<span class="st">"en_GB"</span>)) <span class="sc">%&gt;%</span>  <span class="fu">unlist</span>() <span class="sc">%&gt;%</span> <span class="fu">length</span>()</span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>ns1_nw <span class="ot">&lt;-</span> <span class="fu">sum</span>(tokenizers<span class="sc">::</span><span class="fu">count_words</span>(ns1_ess))</span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a><span class="co"># ns2</span></span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a>ns2_nerr <span class="ot">&lt;-</span> <span class="fu">hunspell</span>(ns2_ess, <span class="at">dict =</span> <span class="fu">dictionary</span>(<span class="st">"en_GB"</span>)) <span class="sc">%&gt;%</span>  <span class="fu">unlist</span>() <span class="sc">%&gt;%</span> <span class="fu">length</span>()</span>
<span id="cb90-6"><a href="#cb90-6" aria-hidden="true" tabindex="-1"></a>ns2_nw <span class="ot">&lt;-</span> <span class="fu">sum</span>(tokenizers<span class="sc">::</span><span class="fu">count_words</span>(ns2_ess))</span>
<span id="cb90-7"><a href="#cb90-7" aria-hidden="true" tabindex="-1"></a><span class="co"># de</span></span>
<span id="cb90-8"><a href="#cb90-8" aria-hidden="true" tabindex="-1"></a>de_nerr <span class="ot">&lt;-</span> <span class="fu">hunspell</span>(de_ess, <span class="at">dict =</span> <span class="fu">dictionary</span>(<span class="st">"en_GB"</span>)) <span class="sc">%&gt;%</span>  <span class="fu">unlist</span>() <span class="sc">%&gt;%</span> <span class="fu">length</span>()</span>
<span id="cb90-9"><a href="#cb90-9" aria-hidden="true" tabindex="-1"></a>de_nw <span class="ot">&lt;-</span> <span class="fu">sum</span>(tokenizers<span class="sc">::</span><span class="fu">count_words</span>(de_ess))</span>
<span id="cb90-10"><a href="#cb90-10" aria-hidden="true" tabindex="-1"></a><span class="co"># es</span></span>
<span id="cb90-11"><a href="#cb90-11" aria-hidden="true" tabindex="-1"></a>es_nerr <span class="ot">&lt;-</span> <span class="fu">hunspell</span>(es_ess, <span class="at">dict =</span> <span class="fu">dictionary</span>(<span class="st">"en_GB"</span>)) <span class="sc">%&gt;%</span>  <span class="fu">unlist</span>() <span class="sc">%&gt;%</span> <span class="fu">length</span>()</span>
<span id="cb90-12"><a href="#cb90-12" aria-hidden="true" tabindex="-1"></a>es_nw <span class="ot">&lt;-</span> <span class="fu">sum</span>(tokenizers<span class="sc">::</span><span class="fu">count_words</span>(es_ess))</span>
<span id="cb90-13"><a href="#cb90-13" aria-hidden="true" tabindex="-1"></a><span class="co"># fr</span></span>
<span id="cb90-14"><a href="#cb90-14" aria-hidden="true" tabindex="-1"></a>fr_nerr <span class="ot">&lt;-</span> <span class="fu">hunspell</span>(fr_ess, <span class="at">dict =</span> <span class="fu">dictionary</span>(<span class="st">"en_GB"</span>)) <span class="sc">%&gt;%</span>  <span class="fu">unlist</span>() <span class="sc">%&gt;%</span> <span class="fu">length</span>()</span>
<span id="cb90-15"><a href="#cb90-15" aria-hidden="true" tabindex="-1"></a>fr_nw <span class="ot">&lt;-</span> <span class="fu">sum</span>(tokenizers<span class="sc">::</span><span class="fu">count_words</span>(fr_ess))</span>
<span id="cb90-16"><a href="#cb90-16" aria-hidden="true" tabindex="-1"></a><span class="co"># it</span></span>
<span id="cb90-17"><a href="#cb90-17" aria-hidden="true" tabindex="-1"></a>it_nerr <span class="ot">&lt;-</span> <span class="fu">hunspell</span>(it_ess, <span class="at">dict =</span> <span class="fu">dictionary</span>(<span class="st">"en_GB"</span>)) <span class="sc">%&gt;%</span>  <span class="fu">unlist</span>() <span class="sc">%&gt;%</span> <span class="fu">length</span>()</span>
<span id="cb90-18"><a href="#cb90-18" aria-hidden="true" tabindex="-1"></a>it_nw <span class="ot">&lt;-</span> <span class="fu">sum</span>(tokenizers<span class="sc">::</span><span class="fu">count_words</span>(it_ess))</span>
<span id="cb90-19"><a href="#cb90-19" aria-hidden="true" tabindex="-1"></a><span class="co"># pl</span></span>
<span id="cb90-20"><a href="#cb90-20" aria-hidden="true" tabindex="-1"></a>pl_nerr <span class="ot">&lt;-</span> <span class="fu">hunspell</span>(pl_ess, <span class="at">dict =</span> <span class="fu">dictionary</span>(<span class="st">"en_GB"</span>)) <span class="sc">%&gt;%</span>  <span class="fu">unlist</span>() <span class="sc">%&gt;%</span> <span class="fu">length</span>()</span>
<span id="cb90-21"><a href="#cb90-21" aria-hidden="true" tabindex="-1"></a>pl_nw <span class="ot">&lt;-</span> <span class="fu">sum</span>(tokenizers<span class="sc">::</span><span class="fu">count_words</span>(pl_ess))</span>
<span id="cb90-22"><a href="#cb90-22" aria-hidden="true" tabindex="-1"></a><span class="co"># ru</span></span>
<span id="cb90-23"><a href="#cb90-23" aria-hidden="true" tabindex="-1"></a>ru_nerr <span class="ot">&lt;-</span> <span class="fu">hunspell</span>(ru_ess, <span class="at">dict =</span> <span class="fu">dictionary</span>(<span class="st">"en_GB"</span>)) <span class="sc">%&gt;%</span>  <span class="fu">unlist</span>() <span class="sc">%&gt;%</span> <span class="fu">length</span>()</span>
<span id="cb90-24"><a href="#cb90-24" aria-hidden="true" tabindex="-1"></a>ru_nw <span class="ot">&lt;-</span> <span class="fu">sum</span>(tokenizers<span class="sc">::</span><span class="fu">count_words</span>(ru_ess))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now, we generate a table from the results.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>err_tb <span class="ot">&lt;-</span> <span class="fu">c</span>(ns1_nerr, ns2_nerr, de_nerr, es_nerr, fr_nerr, it_nerr, pl_nerr, ru_nerr) <span class="sc">%&gt;%</span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># rename column</span></span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">errors =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add n of words</span></span>
<span id="cb91-6"><a href="#cb91-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">words =</span> <span class="fu">c</span>(ns1_nw, ns2_nw, de_nw, es_nw, fr_nw, it_nw, pl_nw, ru_nw)) <span class="sc">%&gt;%</span></span>
<span id="cb91-7"><a href="#cb91-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add l1</span></span>
<span id="cb91-8"><a href="#cb91-8" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">l1 =</span> <span class="fu">c</span>(<span class="st">"en"</span>, <span class="st">"en"</span>, <span class="st">"de"</span>, <span class="st">"es"</span>, <span class="st">"fr"</span>, <span class="st">"it"</span>, <span class="st">"pl"</span>, <span class="st">"ru"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb91-9"><a href="#cb91-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># calculate rel freq</span></span>
<span id="cb91-10"><a href="#cb91-10" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">freq =</span> <span class="fu">round</span>(errors<span class="sc">/</span>words<span class="sc">*</span><span class="dv">1000</span>, <span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb91-11"><a href="#cb91-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># summarise</span></span>
<span id="cb91-12"><a href="#cb91-12" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(l1) <span class="sc">%&gt;%</span></span>
<span id="cb91-13"><a href="#cb91-13" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">freq =</span> <span class="fu">mean</span>(freq))</span>
<span id="cb91-14"><a href="#cb91-14" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect</span></span>
<span id="cb91-15"><a href="#cb91-15" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(err_tb)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 2
  l1     freq
  &lt;chr&gt; &lt;dbl&gt;
1 de     23.4
2 en     17.0
3 es     27.6
4 fr     27.5
5 it      9  
6 pl      7.9</code></pre>
</div>
</div>
<p>We can now visualize the results.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>err_tb <span class="sc">%&gt;%</span></span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(l1, <span class="sc">-</span>freq), <span class="at">y =</span> freq, <span class="at">label =</span> freq)) <span class="sc">+</span></span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">vjust=</span><span class="fl">1.6</span>, <span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># adapt tick labels</span></span>
<span id="cb93-6"><a href="#cb93-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="st">"L1 of learners"</span>, </span>
<span id="cb93-7"><a href="#cb93-7" aria-hidden="true" tabindex="-1"></a>                   <span class="at">breaks =</span> <span class="fu">names</span>(<span class="fu">table</span>(read_l1<span class="sc">$</span>l1)), </span>
<span id="cb93-8"><a href="#cb93-8" aria-hidden="true" tabindex="-1"></a>                   <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"en"</span> <span class="ot">=</span> <span class="st">"English"</span>,</span>
<span id="cb93-9"><a href="#cb93-9" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"de"</span> <span class="ot">=</span> <span class="st">"German"</span>,</span>
<span id="cb93-10"><a href="#cb93-10" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"es"</span> <span class="ot">=</span> <span class="st">"Spanish"</span>,</span>
<span id="cb93-11"><a href="#cb93-11" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"fr"</span> <span class="ot">=</span> <span class="st">"French"</span>,</span>
<span id="cb93-12"><a href="#cb93-12" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"it"</span> <span class="ot">=</span> <span class="st">"Italian"</span>,</span>
<span id="cb93-13"><a href="#cb93-13" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"pl"</span> <span class="ot">=</span> <span class="st">"Polish"</span>,</span>
<span id="cb93-14"><a href="#cb93-14" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"ru"</span> <span class="ot">=</span> <span class="st">"Russian"</span>)) <span class="sc">+</span></span>
<span id="cb93-15"><a href="#cb93-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Relative frequency</span><span class="sc">\n</span><span class="st">(per 1,000 words)"</span>) <span class="sc">+</span></span>
<span id="cb93-16"><a href="#cb93-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb93-17"><a href="#cb93-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">40</span>)) <span class="sc">+</span></span>
<span id="cb93-18"><a href="#cb93-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="llr_files/figure-html/sp7-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="citation-session-info" class="level1 unnumbered">
<h1 class="unnumbered">Citation &amp; Session Info</h1>
<p>Schweinberger, Martin. 2022. <em>Analyzing learner language using R</em>. Brisbane: The University of Queensland. url: https://slcladal.github.io/llr.html (Version 2022.08.31).</p>
<pre><code>@manual{schweinberger2022llr,
  author = {Schweinberger, Martin},
  title = {Analyzing learner language using R},
  note = {https://slcladal.github.io/pwr.html},
  year = {2022},
  organization = "The University of Queensland, Australia. School of Languages and Cultures},
  address = {Brisbane},
  edition = {2022.08.31}
}</code></pre>
<div class="cell">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sessionInfo</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R version 4.2.1 (2022-06-23)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 22.04.1 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.10.0
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.10.0

locale:
 [1] LC_CTYPE=en_AU.UTF-8          LC_NUMERIC=C                 
 [3] LC_TIME=en_AU.UTF-8           LC_COLLATE=en_AU.UTF-8       
 [5] LC_MONETARY=en_AU.UTF-8       LC_MESSAGES=en_AU.UTF-8      
 [7] LC_PAPER=en_AU.UTF-8          LC_NAME=en_AU.UTF-8          
 [9] LC_ADDRESS=en_AU.UTF-8        LC_TELEPHONE=en_AU.UTF-8     
[11] LC_MEASUREMENT=en_AU.UTF-8    LC_IDENTIFICATION=en_AU.UTF-8

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
 [1] slam_0.1-50               Matrix_1.4-1             
 [3] tokenizers_0.2.1          entity_0.1.0             
 [5] pacman_0.5.1              wordcloud2_0.2.1         
 [7] hunspell_3.0.1            stringi_1.7.8            
 [9] koRpus.lang.en_0.1-4      koRpus_0.13-8            
[11] sylly_0.1-6               quanteda.textplots_0.94.1
[13] quanteda.textstats_0.95   quanteda_3.2.1           
[15] openNLP_0.2-7             tidytext_0.3.3           
[17] tm_0.7-8                  NLP_0.2-1                
[19] flextable_0.7.3           forcats_0.5.1            
[21] stringr_1.4.0             dplyr_1.0.9              
[23] purrr_0.3.4               readr_2.1.2              
[25] tidyr_1.2.0               tibble_3.1.7             
[27] ggplot2_3.3.6             tidyverse_1.3.2          

loaded via a namespace (and not attached):
 [1] googledrive_2.0.0    openNLPdata_1.5.3-4  colorspace_2.0-3    
 [4] ellipsis_0.3.2       ISOcodes_2022.01.10  base64enc_0.1-3     
 [7] fs_1.5.2             rstudioapi_0.13      farver_2.1.1        
[10] SnowballC_0.7.0      ggrepel_0.9.1        fansi_1.0.3         
[13] lubridate_1.8.0      xml2_1.3.3           knitr_1.39          
[16] jsonlite_1.8.0       rJava_1.0-6          broom_1.0.0         
[19] dbplyr_2.2.1         compiler_4.2.1       httr_1.4.3          
[22] backports_1.4.1      assertthat_0.2.1     fastmap_1.1.0       
[25] gargle_1.2.0         cli_3.3.0            htmltools_0.5.2     
[28] tools_4.2.1          coda_0.19-4          gtable_0.3.0        
[31] glue_1.6.2           fastmatch_1.1-3      Rcpp_1.0.8.3        
[34] statnet.common_4.6.0 cellranger_1.1.0     vctrs_0.4.1         
[37] xfun_0.31            stopwords_2.3        network_1.17.2      
[40] rvest_1.0.2          nsyllable_1.0.1      lifecycle_1.0.1     
[43] googlesheets4_1.0.0  klippy_0.0.0.9500    scales_1.2.0        
[46] hms_1.1.1            parallel_4.2.1       yaml_2.3.5          
[49] gdtools_0.2.4        zip_2.2.0            sylly.en_0.1-3      
[52] rlang_1.0.4          pkgconfig_2.0.3      systemfonts_1.0.4   
[55] evaluate_0.15        lattice_0.20-45      htmlwidgets_1.5.4   
[58] labeling_0.4.2       tidyselect_1.1.2     magrittr_2.0.3      
[61] R6_2.5.1             generics_0.1.3       sna_2.7             
[64] DBI_1.1.3            pillar_1.7.0         haven_2.5.0         
[67] withr_2.5.0          janeaustenr_0.1.5    modelr_0.1.8        
[70] crayon_1.5.1         uuid_1.1-0           utf8_1.2.2          
[73] tzdb_0.3.0           rmarkdown_2.14       officer_0.4.3       
[76] grid_4.2.1           readxl_1.4.0         data.table_1.14.2   
[79] reprex_2.0.1         digest_0.6.29        RcppParallel_5.1.5  
[82] munsell_0.5.0        viridisLite_0.4.0   </code></pre>
</div>
</div>
<hr>
<p><a href="#introduction">Back to top</a></p>
<p><a href="https://slcladal.github.io/index.html">Back to HOME</a></p>
<hr>
</section>
<section id="references" class="level1 unnumbered">




</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body" role="doc-bibliography">
<div id="ref-lindquist2009corpus" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">1. </div><div class="csl-right-inline">Lindquist, H.: Corpus linguistics and the description of english. Edinburgh University Press, Edinburgh (2009).</div>
</div>
<div id="ref-benoit2018quanteda" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">2. </div><div class="csl-right-inline">Benoit, K., Watanabe, K., Wang, H., Nulty, P., Obeng, A., Müller, S., Matsuo, A.: Quanteda: An r package for the quantitative analysis of textual data. Journal of Open Source Software. 3, 774 (2018).</div>
</div>
<div id="ref-benoit2021package" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">3. </div><div class="csl-right-inline">Benoit, K., Watanabe, K., Wang, H., Lua, J.W., Kuha, J.: Package <span>“quanteda. Textstats.”</span> Research Bulletin. 27, 37–54 (2021).</div>
</div>
<div id="ref-tweedie1988lexdiv" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">4. </div><div class="csl-right-inline">Tweedie, F.J., Baayen, R.H.: How variable may a constant be? Measures of lexical richness in perspective. Computers and the Humanities. 32, 323–352 (1998).</div>
</div>
<div id="ref-flesch1948new" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">5. </div><div class="csl-right-inline">Flesch, R.: A new readability yardstick. Journal of applied psychology. 32, 221–233 (1948).</div>
</div>
</div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>