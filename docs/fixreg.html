<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.165">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Martin Schweinberger">
<meta name="dcterms.date" content="2022-08-31">

<title>Fixed-Effects Regression Modelling in R</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-VSGK4KYDQZ"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-VSGK4KYDQZ', { 'anonymize_ip': true});
</script>
<script src="site_libs/clipboard-1.7.1/clipboard.min.js"></script>
<link href="site_libs/primer-tooltips-1.4.0/build.css" rel="stylesheet">
<link href="site_libs/klippy-0.0.0.9500/css/klippy.min.css" rel="stylesheet">
<script src="site_libs/klippy-0.0.0.9500/js/klippy.min.js"></script>
<link href="site_libs/tabwid-1.0.0/tabwid.css" rel="stylesheet">
<link href="site_libs/tabwid-1.0.0/scrool.css" rel="stylesheet">

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a href="./index.html" class="navbar-brand navbar-brand-logo">
    <img src="./ladal_icon_cas_tran_white_trimed.png" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Language Technology and Data Analysis Laboratory</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html">HOME</a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-about-ladal" role="button" data-bs-toggle="dropdown" aria-expanded="false">ABOUT LADAL</a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-about-ladal">    
        <li>
    <a class="dropdown-item" href="./people.html">
 <span class="dropdown-text">People | Collabs</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./news.html">
 <span class="dropdown-text">News</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-events" role="button" data-bs-toggle="dropdown" aria-expanded="false">EVENTS</a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-events">    
        <li>
    <a class="dropdown-item" href="./workshops.html">
 <span class="dropdown-text">Workshops</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./compthinking.html">
 <span class="dropdown-text">Computational Thinking in HASS</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./webinars2022.html">
 <span class="dropdown-text">LADAL Webinar Series 2022</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./opening.html">
 <span class="dropdown-text">LADAL Webinar Series 2021</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./atapevents.html">
 <span class="dropdown-text">ATAP Events</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="./tutorials.html">TUTORIALS</a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-resources" role="button" data-bs-toggle="dropdown" aria-expanded="false">RESOURCES</a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-resources">    
        <li>
    <a class="dropdown-item" href="./links.html">
 <span class="dropdown-text">Links</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./base.html">
 <span class="dropdown-text">Tutorial stylesheet</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="./contact.html">CONTACT</a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a>
  <ul class="collapse">
  <li><a href="#multiple-linear-regression" id="toc-multiple-linear-regression" class="nav-link" data-scroll-target="#multiple-linear-regression">Multiple Linear Regression</a>
  <ul class="collapse">
  <li><a href="#example-gifts-and-availability" id="toc-example-gifts-and-availability" class="nav-link" data-scroll-target="#example-gifts-and-availability">Example: Gifts and Availability</a></li>
  <li><a href="#automatic-model-fitting" id="toc-automatic-model-fitting" class="nav-link" data-scroll-target="#automatic-model-fitting">Automatic Model Fitting</a></li>
  <li><a href="#outlier-detection" id="toc-outlier-detection" class="nav-link" data-scroll-target="#outlier-detection">Outlier Detection</a></li>
  <li><a href="#rerun-regression" id="toc-rerun-regression" class="nav-link" data-scroll-target="#rerun-regression">Rerun Regression</a></li>
  <li><a href="#additional-model-diagnostics" id="toc-additional-model-diagnostics" class="nav-link" data-scroll-target="#additional-model-diagnostics">Additional Model Diagnostics</a></li>
  <li><a href="#evaluation-of-sample-size" id="toc-evaluation-of-sample-size" class="nav-link" data-scroll-target="#evaluation-of-sample-size">Evaluation of Sample Size</a></li>
  </ul></li>
  <li><a href="#robust-regression" id="toc-robust-regression" class="nav-link" data-scroll-target="#robust-regression">Robust Regression</a></li>
  <li><a href="#logistic-regression" id="toc-logistic-regression" class="nav-link" data-scroll-target="#logistic-regression">Logistic Regression</a>
  <ul class="collapse">
  <li><a href="#example-eh-in-kiwi-english" id="toc-example-eh-in-kiwi-english" class="nav-link" data-scroll-target="#example-eh-in-kiwi-english">Example: EH in Kiwi English</a></li>
  <li><a href="#model-building" id="toc-model-building" class="nav-link" data-scroll-target="#model-building">Model Building</a></li>
  <li><a href="#model-fitting" id="toc-model-fitting" class="nav-link" data-scroll-target="#model-fitting">Model Fitting</a></li>
  <li><a href="#model-diagnostics" id="toc-model-diagnostics" class="nav-link" data-scroll-target="#model-diagnostics">Model Diagnostics</a></li>
  <li><a href="#model-evaluation" id="toc-model-evaluation" class="nav-link" data-scroll-target="#model-evaluation">Model Evaluation</a></li>
  <li><a href="#effect-size" id="toc-effect-size" class="nav-link" data-scroll-target="#effect-size">Effect Size</a></li>
  <li><a href="#prediction-accuracy" id="toc-prediction-accuracy" class="nav-link" data-scroll-target="#prediction-accuracy">Prediction Accuracy</a></li>
  <li><a href="#outlier-detection-1" id="toc-outlier-detection-1" class="nav-link" data-scroll-target="#outlier-detection-1">Outlier detection</a></li>
  <li><a href="#sample-size" id="toc-sample-size" class="nav-link" data-scroll-target="#sample-size">Sample Size</a></li>
  <li><a href="#summarizing-results" id="toc-summarizing-results" class="nav-link" data-scroll-target="#summarizing-results">Summarizing Results</a></li>
  </ul></li>
  <li><a href="#ordinal-regression" id="toc-ordinal-regression" class="nav-link" data-scroll-target="#ordinal-regression">Ordinal Regression</a></li>
  <li><a href="#poisson-regression" id="toc-poisson-regression" class="nav-link" data-scroll-target="#poisson-regression">Poisson Regression</a></li>
  </ul></li>
  <li><a href="#citation-session-info" id="toc-citation-session-info" class="nav-link" data-scroll-target="#citation-session-info">Citation &amp; Session Info</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul>
</nav>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Fixed-Effects Regression Modelling in R</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Martin Schweinberger </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">August 31, 2022</p>
    </div>
  </div>
    
  </div>
  

</header>

<div class="cell">
<div class="cell-output-display">
<p><img src="https://slcladal.github.io/images/uq1.jpg" class="img-fluid" style="width:100.0%"></p>
</div>
</div>
<section id="introduction" class="level1 unnumbered">
<h1 class="unnumbered">Introduction</h1>
<p>This tutorial focuses on different types of fixed-effects regression analysis using R.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> Regression models can be divided into fixed- and mixed-effects regression models (depending on whether the model has a random effect structure or not) and this tutorial covers multiple fixed-effects linear, logistic, ordinal, and Poisson regression which differ in that they take different types of dependent or response variables. The versatility regarding being able to deal with many different response variables is one of the reasons why regression analysis is among the most widely used quantitative methods in the language sciences. Such regression models are used to assess if and how predictors (variables or interactions between variables) correlate with a certain response.</p>
<p><a href="https://slcladal.github.io/introreg.html">Check out this tutorial</a> if you want to know more about the theoretical underpinnings and the conceptual basis of regression analysis.</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="https://slcladal.github.io/images/yr_chili.jpg" class="img-fluid" style="float:right; padding:10px;width:15.0%"></p>
</div>
</div>
<p>This tutorial is aimed at intermediate and advanced users of R with the aim of showcasing how to perform regression analysis using R. The aim is not to provide a fully-fledged analysis but rather to show and exemplify common regression types, model diagnostics, and model fitting using R.</p>
<br>
<div class="warning" style="padding:0.1em; background-color:#f2f2f2; color:#51247a">
<span>
<p style="margin-top:1em; text-align:center">
The entire R Notebook for the tutorial can be downloaded <a href="https://slcladal.github.io/content/fixreg.Rmd"><strong>here</strong></a>. If you want to render the R Notebook on your machine, i.e.&nbsp;knitting the document to html or a pdf, you need to make sure that you have R and RStudio installed and you also need to download the <a href="https://slcladal.github.io/content/bibliography.bib"><strong>bibliography file</strong></a> and store it in the same folder where you store the Rmd or the Rproj file. <br>
</p>
<p style="margin-left:1em;">
</p>
<p></p>
</span></div>
<p><br></p>
<p><strong>Preparation and session set up</strong></p>
<p>This tutorial is based on R. If you have not installed R or are new to it, you will find an introduction to and more information how to use R <a href="https://slcladal.github.io/intror.html">here</a>. For this tutorials, we need to install certain <em>packages</em> from an R <em>library</em> so that the scripts shown below are executed without errors. Before turning to the code below, please install the packages by running the code below this paragraph. If you have already installed the packages mentioned below, then you can skip ahead and ignore this section. To install the necessary packages, simply run the following code - it may take some time (between 1 and 5 minutes to install all of the libraries so you do not need to worry if it takes some time).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># install</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"car"</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"flextable"</span>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"ggplot2"</span>)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"ggpubr"</span>)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"Hmisc"</span>)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"MASS"</span>)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"mclogit"</span>)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"ordinal"</span>)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"rms"</span>)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"robustbase"</span>)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"sjPlot"</span>)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"stringr"</span>)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"tibble"</span>)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"dplyr"</span>)</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"vcd"</span>)</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"vip"</span>)</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"see"</span>)</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"glmulti"</span>)</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"performance"</span>)</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"report"</span>)</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"ggfortify"</span>)</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"caret"</span>)</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"msm"</span>)</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a><span class="co"># install klippy for copy-to-clipboard button in code chunks</span></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"remotes"</span>)</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>remotes<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">"rlesur/klippy"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now that we have installed the packages, we activate them as shown below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set options</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">stringsAsFactors =</span> F)          <span class="co"># no automatic data transformation</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="st">"scipen"</span> <span class="ot">=</span> <span class="dv">100</span>, <span class="st">"digits"</span> <span class="ot">=</span> <span class="dv">12</span>) <span class="co"># suppress math annotation</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># load packages</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(flextable)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggfortify)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Hmisc)</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ordinal)</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rms)</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sjPlot)</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr)</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(vcd)</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(vip)</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(glmulti)</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(performance)</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(report)</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a><span class="co"># activate klippy for copy-to-clipboard button</span></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>klippy<span class="sc">::</span><span class="fu">klippy</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<script>
  addClassKlippyTo("pre.r, pre.markdown");
  addKlippy('left', 'top', 'auto', '1', 'Copy code', 'Copied!');
</script>
</div>
</div>
<p>Once you have installed R and RStudio and initiated the session by executing the code shown above, you are good to go.</p>
<section id="multiple-linear-regression" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="multiple-linear-regression">Multiple Linear Regression</h2>
<p>In contrast to simple linear regression, which estimates the effect of a single predictor, multiple linear regression estimates the effect of various predictor (see the equation below). A multiple linear regression can thus test the effects of various predictors simultaneously.</p>
<p><span class="math display">\[\begin{equation}

f_{(x)} = \alpha + \beta_{1}x_{i} + \beta_{2}x_{i+1} + \dots + \beta_{n}x_{i+n} + \epsilon

\end{equation}\]</span></p>
<p>There exists a wealth of literature focusing on multiple linear regressions and the concepts it is based on. For instance, there are <span class="citation" data-cites="achen1982interpreting">[<a href="#ref-achen1982interpreting" role="doc-biblioref">1</a>]</span>, <span class="citation" data-cites="bortz2006statistik">[<a href="#ref-bortz2006statistik" role="doc-biblioref">2</a>]</span>, <span class="citation" data-cites="crawley2005statistics">[<a href="#ref-crawley2005statistics" role="doc-biblioref">3</a>]</span>, <span class="citation" data-cites="faraway2002practical">[<a href="#ref-faraway2002practical" role="doc-biblioref">4</a>]</span>, <span class="citation" data-cites="field2012discovering">[<a href="#ref-field2012discovering" role="doc-biblioref">5</a>]</span>, <span class="citation" data-cites="gries2021statistics">[<a href="#ref-gries2021statistics" role="doc-biblioref">6</a>]</span>, <span class="citation" data-cites="levshina2015linguistics">[<a href="#ref-levshina2015linguistics" role="doc-biblioref">7</a>]</span>, <span class="citation" data-cites="winter2019statistics">[<a href="#ref-winter2019statistics" role="doc-biblioref">8</a>]</span> and <span class="citation" data-cites="wilcox2009basic">[<a href="#ref-wilcox2009basic" role="doc-biblioref">9</a>]</span> to name just a few. Introductions to regression modeling in R are <span class="citation" data-cites="baayen2008analyzing">[<a href="#ref-baayen2008analyzing" role="doc-biblioref">10</a>]</span>, <span class="citation" data-cites="crawley2012r">[<a href="#ref-crawley2012r" role="doc-biblioref">11</a>]</span>, <span class="citation" data-cites="gries2021statistics">[<a href="#ref-gries2021statistics" role="doc-biblioref">6</a>]</span>, or <span class="citation" data-cites="levshina2015linguistics">[<a href="#ref-levshina2015linguistics" role="doc-biblioref">7</a>]</span>.</p>
<p>The model diagnostics we are dealing with here are partly identical to the diagnostic methods discussed in the section on simple linear regression. Because of this overlap, diagnostics will only be described in more detail if they have not been described in the section on simple linear regression.</p>
<hr>
<div class="warning" style="padding:0.1em; background-color:#f2f2f2; color:#51247a">
<span>
<p style="margin-top:1em; text-align:center">
<b>EXCURSION</b>
</p>
<p style="margin-left:1em;">
</p>
<p></p>
</span></div>
<div class="question">
<p>`</p>
<details>
<summary>
A note on sample size and power
</summary>
<p>Although there appears to be a general assumption that 25 data points per variable level are sufficient, this is merely a general rule of thumb that is actually often incorrect. Such rules of thumb are inadequate because the required sample size depends on the number of variables in a given model, the size of the effect, the variance of the effect, and the desired power - in other words, the minimum necessary sample size relates to <em>statistical power</em> (see <a href="https://slcladal.github.io/pwr.html">here</a> for a tutorial on power). If a model contains many variables, then this requires a larger sample size than a model which only uses very few predictors and if the effect that we want to find is small, then this also requires a larger sample than if the effect we are interested in is large. Finally, effects that are very robust and do not exhibit substantive variability require a much smaller sample size compared with effects that are spurious and vary notably Since the sample size depends on the effect size and variance as well as the number of variables, there is no one-size-fits-all answer to what the best sample size is.</p>
Another, slightly better but still incorrect, rule of thumb is that the more data, the better. This is not correct because models based on many cases are prone to report almost any effect as significant (although with a tiny effect size). A discussion about this phenomenon led to a discussion between Adam Kilgariff and Stefan Gries (see <a href="https://www.degruyter.com/document/doi/10.1515/cllt.2005.1.2.263/html">here for Adam’s initial discussion note</a> and see <a href="https://www.degruyter.com/document/doi/10.1515/cllt.2005.1.2.277/html?lang=de">here for Stefan’s response</a>) resulting in a wider acknowledgement that effect sizes are more important than mere p-values. Also, given that there are procedures that can correct for overfitting, larger data sets are still preferable to data sets that are simply too small to warrant reliable results. In conclusion, it remains true that the sample size depends on the effect under investigation.
</details>
</div>
<p>`</p>
<hr>
<p>Despite there being no ultimate rule of thumb, <span class="citation" data-cites="field2012discovering">[<a href="#ref-field2012discovering" role="doc-biblioref">5</a>]</span>, based on <span class="citation" data-cites="green1991many">[<a href="#ref-green1991many" role="doc-biblioref">12</a>]</span>, provide data-driven suggestions for the minimal size of data required for regression models that aim to find medium sized effects (k = number of predictors; categorical variables with more than two levels should be transformed into dummy variables):</p>
<ul>
<li><p>If one is merely interested in the overall model fit (something I have not encountered), then the sample size should be at least 50 + k (k = number of predictors in model).</p></li>
<li><p>If one is only interested in the effect of specific variables, then the sample size should be at least 104 + k (k = number of predictors in model).</p></li>
<li><p>If one is only interested in both model fit and the effect of specific variables, then the sample size should be at least the higher value of 50 + k or 104 + k (k = number of predictors in model).</p></li>
</ul>
<p>You will see in the R code below that there is already a function that tests whether the sample size is sufficient.</p>
<section id="example-gifts-and-availability" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="example-gifts-and-availability">Example: Gifts and Availability</h3>
<p>The example we will go through here is taken from <span class="citation" data-cites="field2012discovering">[<a href="#ref-field2012discovering" role="doc-biblioref">5</a>]</span>. In this example, the research question is if the money that men spend on presents for women depends on the women’s attractiveness and their relationship status. To answer this research question, we will implement a multiple linear regression and start by loading the data and inspect its structure and properties.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load data</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>mlrdata  <span class="ot">&lt;-</span> base<span class="sc">::</span><span class="fu">readRDS</span>(<span class="fu">url</span>(<span class="st">"https://slcladal.github.io/data/mld.rda"</span>, <span class="st">"rb"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">

<div class="tabwid"><style>.cl-4ad5373e{table-layout:auto;width:75%;}.cl-4ad0cf5a{font-family:'DejaVu Sans';font-size:12pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-4ad0cf6e{font-family:'DejaVu Sans';font-size:12pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-4ad0e8a0{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-4ad0e8aa{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-4ad12af4{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-4ad12b08{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-4ad12b09{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-4ad12b12{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-4ad12b1c{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-4ad12b1d{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-4ad12b26{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-4ad12b27{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-4ad12b30{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-4ad12b3a{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-4ad12b3b{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-4ad12b44{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table class="cl-4ad5373e">
<caption class="Table Caption">
<p>First 15 rows of the mlrdata.</p>
</caption>

<thead><tr style="overflow-wrap:break-word;"><td class="cl-4ad12b3b"><p class="cl-4ad0e8a0"><span class="cl-4ad0cf5a">status</span></p></td><td class="cl-4ad12b3a"><p class="cl-4ad0e8a0"><span class="cl-4ad0cf5a">attraction</span></p></td><td class="cl-4ad12b44"><p class="cl-4ad0e8aa"><span class="cl-4ad0cf5a">money</span></p></td></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-4ad12b09"><p class="cl-4ad0e8a0"><span class="cl-4ad0cf6e">Relationship</span></p></td><td class="cl-4ad12af4"><p class="cl-4ad0e8a0"><span class="cl-4ad0cf6e">NotInterested</span></p></td><td class="cl-4ad12b08"><p class="cl-4ad0e8aa"><span class="cl-4ad0cf6e">86.33</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-4ad12b1d"><p class="cl-4ad0e8a0"><span class="cl-4ad0cf6e">Relationship</span></p></td><td class="cl-4ad12b12"><p class="cl-4ad0e8a0"><span class="cl-4ad0cf6e">NotInterested</span></p></td><td class="cl-4ad12b1c"><p class="cl-4ad0e8aa"><span class="cl-4ad0cf6e">45.58</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-4ad12b09"><p class="cl-4ad0e8a0"><span class="cl-4ad0cf6e">Relationship</span></p></td><td class="cl-4ad12af4"><p class="cl-4ad0e8a0"><span class="cl-4ad0cf6e">NotInterested</span></p></td><td class="cl-4ad12b08"><p class="cl-4ad0e8aa"><span class="cl-4ad0cf6e">68.43</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-4ad12b1d"><p class="cl-4ad0e8a0"><span class="cl-4ad0cf6e">Relationship</span></p></td><td class="cl-4ad12b12"><p class="cl-4ad0e8a0"><span class="cl-4ad0cf6e">NotInterested</span></p></td><td class="cl-4ad12b1c"><p class="cl-4ad0e8aa"><span class="cl-4ad0cf6e">52.93</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-4ad12b09"><p class="cl-4ad0e8a0"><span class="cl-4ad0cf6e">Relationship</span></p></td><td class="cl-4ad12af4"><p class="cl-4ad0e8a0"><span class="cl-4ad0cf6e">NotInterested</span></p></td><td class="cl-4ad12b08"><p class="cl-4ad0e8aa"><span class="cl-4ad0cf6e">61.86</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-4ad12b1d"><p class="cl-4ad0e8a0"><span class="cl-4ad0cf6e">Relationship</span></p></td><td class="cl-4ad12b12"><p class="cl-4ad0e8a0"><span class="cl-4ad0cf6e">NotInterested</span></p></td><td class="cl-4ad12b1c"><p class="cl-4ad0e8aa"><span class="cl-4ad0cf6e">48.47</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-4ad12b09"><p class="cl-4ad0e8a0"><span class="cl-4ad0cf6e">Relationship</span></p></td><td class="cl-4ad12af4"><p class="cl-4ad0e8a0"><span class="cl-4ad0cf6e">NotInterested</span></p></td><td class="cl-4ad12b08"><p class="cl-4ad0e8aa"><span class="cl-4ad0cf6e">32.79</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-4ad12b1d"><p class="cl-4ad0e8a0"><span class="cl-4ad0cf6e">Relationship</span></p></td><td class="cl-4ad12b12"><p class="cl-4ad0e8a0"><span class="cl-4ad0cf6e">NotInterested</span></p></td><td class="cl-4ad12b1c"><p class="cl-4ad0e8aa"><span class="cl-4ad0cf6e">35.91</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-4ad12b09"><p class="cl-4ad0e8a0"><span class="cl-4ad0cf6e">Relationship</span></p></td><td class="cl-4ad12af4"><p class="cl-4ad0e8a0"><span class="cl-4ad0cf6e">NotInterested</span></p></td><td class="cl-4ad12b08"><p class="cl-4ad0e8aa"><span class="cl-4ad0cf6e">30.98</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-4ad12b1d"><p class="cl-4ad0e8a0"><span class="cl-4ad0cf6e">Relationship</span></p></td><td class="cl-4ad12b12"><p class="cl-4ad0e8a0"><span class="cl-4ad0cf6e">NotInterested</span></p></td><td class="cl-4ad12b1c"><p class="cl-4ad0e8aa"><span class="cl-4ad0cf6e">44.82</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-4ad12b09"><p class="cl-4ad0e8a0"><span class="cl-4ad0cf6e">Relationship</span></p></td><td class="cl-4ad12af4"><p class="cl-4ad0e8a0"><span class="cl-4ad0cf6e">NotInterested</span></p></td><td class="cl-4ad12b08"><p class="cl-4ad0e8aa"><span class="cl-4ad0cf6e">35.05</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-4ad12b1d"><p class="cl-4ad0e8a0"><span class="cl-4ad0cf6e">Relationship</span></p></td><td class="cl-4ad12b12"><p class="cl-4ad0e8a0"><span class="cl-4ad0cf6e">NotInterested</span></p></td><td class="cl-4ad12b1c"><p class="cl-4ad0e8aa"><span class="cl-4ad0cf6e">64.49</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-4ad12b09"><p class="cl-4ad0e8a0"><span class="cl-4ad0cf6e">Relationship</span></p></td><td class="cl-4ad12af4"><p class="cl-4ad0e8a0"><span class="cl-4ad0cf6e">NotInterested</span></p></td><td class="cl-4ad12b08"><p class="cl-4ad0e8aa"><span class="cl-4ad0cf6e">54.50</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-4ad12b1d"><p class="cl-4ad0e8a0"><span class="cl-4ad0cf6e">Relationship</span></p></td><td class="cl-4ad12b12"><p class="cl-4ad0e8a0"><span class="cl-4ad0cf6e">NotInterested</span></p></td><td class="cl-4ad12b1c"><p class="cl-4ad0e8aa"><span class="cl-4ad0cf6e">61.48</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-4ad12b30"><p class="cl-4ad0e8a0"><span class="cl-4ad0cf6e">Relationship</span></p></td><td class="cl-4ad12b27"><p class="cl-4ad0e8a0"><span class="cl-4ad0cf6e">NotInterested</span></p></td><td class="cl-4ad12b26"><p class="cl-4ad0e8aa"><span class="cl-4ad0cf6e">55.51</span></p></td></tr></tbody></table></div>
</div>
</div>
<p>The data set consist of three variables stored in three columns. The first column contains the relationship status of the present giver (in this study this were men), the second whether the man is interested in the woman (the present receiver in this study), and the third column represents the money spend on the present. The data set represents 100 cases and the mean amount of money spend on a present is 88.38 dollars. In a next step, we visualize the data to get a more detailed impression of the relationships between variables.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create plots</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(mlrdata, <span class="fu">aes</span>(status, money)) <span class="sc">+</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span> </span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="co"># plot 2</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(mlrdata, <span class="fu">aes</span>(attraction, money)) <span class="sc">+</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="co"># plot 3</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(mlrdata, <span class="fu">aes</span>(<span class="at">x =</span> money)) <span class="sc">+</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y=</span>..density..)) <span class="sc">+</span>            </span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span>         </span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">alpha=</span>.<span class="dv">2</span>, <span class="at">fill =</span> <span class="st">"gray50"</span>) </span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a><span class="co"># plot 4</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>p4 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(mlrdata, <span class="fu">aes</span>(status, money)) <span class="sc">+</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">fill =</span> <span class="fu">factor</span>(status))) <span class="sc">+</span> </span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"grey30"</span>, <span class="st">"grey70"</span>)) <span class="sc">+</span> </span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> attraction) <span class="sc">+</span> </span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a><span class="co"># show plots</span></span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>vip<span class="sc">::</span><span class="fu">grid.arrange</span>(<span class="at">grobs =</span> <span class="fu">list</span>(p1, p2, p3, p4), <span class="at">widths =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>), <span class="at">layout_matrix =</span> <span class="fu">rbind</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">4</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="fixreg_files/figure-html/mlr3-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The upper left figure consists of a boxplot which shows how much money was spent by relationship status. The figure suggests that men spend more on women if they are not in a relationship. The next figure shows the relationship between the money spend on presents and whether or not the men were interested in the women.</p>
<p>The boxplot in the upper right panel suggests that men spend substantially more on women if the men are interested in them. The next figure depicts the distribution of the amounts of money spend on the presents for the women. In addition, the figure indicates the existence of two outliers (dots in the boxplot)</p>
<p>The histogram in the lower left panel shows that, although the mean amount of money spent on presents is 88.38 dollars, the distribution peaks around 50 dollars indicating that on average, men spend about 50 dollars on presents. Finally, we will plot the amount of money spend on presents against relationship status by attraction in order to check whether the money spent on presents is affected by an interaction between attraction and relationship status.</p>
<p>The boxplot in the lower right panel confirms the existence of an interaction (a non-additive term) as men only spend more money on women if the men single <em>and</em> they are interested in the women. If men are not interested in the women, then the relationship has no effect as they spend an equal amount of money on the women regardless of whether they are in a relationship or not.</p>
<p>We will now start to implement the regression model. In a first step, we create two saturated models that contain all possible predictors (main effects and interactions). The two models are identical but one is generated with the <code>lm</code> and the other with the <code>glm</code> function as these functions offer different model parameters in their output.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>m1.mlr <span class="ot">=</span> <span class="fu">lm</span>(                      <span class="co"># generate lm regression object</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  money <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> attraction<span class="sc">*</span>status,  <span class="co"># def. regression formula (1 = intercept)</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mlrdata)                 <span class="co"># def. data</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>m1.glm <span class="ot">=</span> <span class="fu">glm</span>(                     <span class="co"># generate glm regression object</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  money <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> attraction<span class="sc">*</span>status,  <span class="co"># def. regression formula (1 = intercept)</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> gaussian,              <span class="co"># def. linkage function</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mlrdata)                 <span class="co"># def. data</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>After generating the saturated models we can now start with the model fitting. Model fitting refers to a process that aims at find the model that explains a maximum of variance with a minimum of predictors <span class="citation" data-cites="field2012discovering">[see <a href="#ref-field2012discovering" role="doc-biblioref">5</a>]</span>. Model fitting is therefore based on the <em>principle of parsimony</em> which is related to Occam’s razor according to which explanations that require fewer assumptions are more likely to be true.</p>
</section>
<section id="automatic-model-fitting" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="automatic-model-fitting">Automatic Model Fitting</h3>
<p>In this section, we will use a backward elimination procedure that uses decreases in AIC (<em>Akaike Information Criterion</em>) as the criterion to minimize the model in a step-wise manner. This procedure aims at finding the model with the lowest AIC values by evaluating - step-by-step - whether the removal of a predictor (term) leads to a lower AIC value.</p>
<p>We use this method here to show how to implement it but a better option would be to use the <code>glmulti</code> function from the <code>glmulti</code> package <span class="citation" data-cites="calcagno2020glmulti">[see <a href="#ref-calcagno2020glmulti" role="doc-biblioref">13</a>]</span> to find the best model. The <code>glmulti</code> function is better as it checks all possible models and the reports the model(s) with the best fit. This is advantages over forward or backward elimination as these procedures will often lead to different suggestions for the best model (based on the order in which predictors are added or removed). The tutorial on mixed-effects regression modelling shows how to implement</p>
<p>The reason for avoiding automated model fitting is that the algorithm only checks if the AIC has decreased but not if the model is stable or reliable. Thus, automated model fitting has the problem that you can never be sure that the way that lead you to the final model is reliable and that all models were indeed stable. Imagine you want to climb down from a roof top and you have a ladder. The problem is that you do not know if and how many steps are broken. This is similar to using automated model fitting. In other sections, we will explore better methods to fit models (manual step-wise step-up and step-down procedures, for example).</p>
<p>The AIC is calculated using the equation below. The lower the AIC value, the better the balance between explained variance and the number of predictors. AIC values can and should only be compared for models that are fit on the same data set with the same (number of) cases (<em>LL</em> stands for <em>logged likelihood</em> or <em>LogLikelihood</em> and <em>k</em> represents the number of predictors in the model (including the intercept); the LL represents a measure of how good the model fits the data).</p>
<p><span class="math display">\[\begin{equation}
Akaike Information Criterion (AIC) = -2LL + 2k
\end{equation}\]</span></p>
<p>An alternative to the AIC is the BIC (Bayesian Information Criterion). Both AIC and BIC penalize models for including variables in a model. The penalty of the BIC is bigger than the penalty of the AIC and it includes the number of cases in the model (<em>LL</em> stands for <em>logged likelihood</em> or <em>LogLikelihood</em>, <em>k</em> represents the number of predictors in the model (including the intercept), and <em>N</em> represents the number of cases in the model).</p>
<p><span class="math display">\[\begin{equation}
Bayesian Information Criterion (BIC) = -2LL + 2k * log(N)
\end{equation}\]</span></p>
<p>Interactions are evaluated first and only if all insignificant interactions have been removed would the procedure start removing insignificant main effects (that are not part of significant interactions). Other model fitting procedures (forced entry, step-wise step up, hierarchical) are discussed during the implementation of other regression models. We cannot discuss all procedures here as model fitting is rather complex and a discussion of even the most common procedures would to lengthy and time consuming at this point. It is important to note though that there is not perfect model fitting procedure and automated approaches should be handled with care as they are likely to ignore violations of model parameters that can be detected during manual - but time consuming - model fitting procedures. As a general rule of thumb, it is advisable to fit models as carefully and deliberately as possible. We will now begin to fit the model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># automated AIC based model fitting</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">step</span>(m1.mlr, <span class="at">direction =</span> <span class="st">"both"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=592.52
money ~ 1 + attraction * status

                    Df   Sum of Sq         RSS         AIC
&lt;none&gt;                             34557.56428 592.5211556
- attraction:status  1 24947.25481 59504.81909 644.8642395</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = money ~ 1 + attraction * status, data = mlrdata)

Coefficients:
                         (Intercept)               attractionNotInterested  
                             99.1548                              -47.6628  
                        statusSingle  attractionNotInterested:statusSingle  
                             57.6928                              -63.1788  </code></pre>
</div>
</div>
<p>The automated model fitting procedure informs us that removing predictors has not caused a decrease in the AIC. The saturated model is thus also the final minimal adequate model. We will now inspect the final minimal model and go over the model report.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>m2.mlr <span class="ot">=</span> <span class="fu">lm</span>(                       <span class="co"># generate lm regression object</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  money <span class="sc">~</span> (status <span class="sc">+</span> attraction)<span class="sc">^</span><span class="dv">2</span>, <span class="co"># def. regression formula</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mlrdata)                  <span class="co"># def. data</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>m2.glm <span class="ot">=</span> <span class="fu">glm</span>(                      <span class="co"># generate glm regression object</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  money <span class="sc">~</span> (status <span class="sc">+</span> attraction)<span class="sc">^</span><span class="dv">2</span>, <span class="co"># def. regression formula</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> gaussian,               <span class="co"># def. linkage function</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mlrdata)                  <span class="co"># def. data</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect final minimal model</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m2.mlr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = money ~ (status + attraction)^2, data = mlrdata)

Residuals:
     Min       1Q   Median       3Q      Max 
-45.0760 -14.2580   0.4596  11.9315  44.1424 

Coefficients:
                                         Estimate   Std. Error  t value
(Intercept)                           99.15480000   3.79459947 26.13050
statusSingle                          57.69280000   5.36637403 10.75080
attractionNotInterested              -47.66280000   5.36637403 -8.88175
statusSingle:attractionNotInterested -63.17880000   7.58919893 -8.32483
                                                   Pr(&gt;|t|)    
(Intercept)                          &lt; 0.000000000000000222 ***
statusSingle                         &lt; 0.000000000000000222 ***
attractionNotInterested                 0.00000000000003751 ***
statusSingle:attractionNotInterested    0.00000000000058085 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 18.9729973 on 96 degrees of freedom
Multiple R-squared:  0.852041334,   Adjusted R-squared:  0.847417626 
F-statistic: 184.276619 on 3 and 96 DF,  p-value: &lt; 0.0000000000000002220446</code></pre>
</div>
</div>
<p>The first element of the report is called <em>Call</em> and it reports the regression formula of the model. Then, the report provides the residual distribution (the range, median and quartiles of the residuals) which allows drawing inferences about the distribution of differences between observed and expected values. If the residuals are distributed non-normally, then this is a strong indicator that the model is unstable and unreliable because mathematical assumptions on which the model is based are violated.</p>
<p>Next, the model summary reports the most important part: a table with model statistics of the fixed-effects structure of the model. The table contains the estimates (coefficients of the predictors), standard errors, t-values, and the p-values which show whether a predictor significantly correlates with the dependent variable that the model investigates.</p>
<p>All main effects (status and attraction) as well as the interaction between status and attraction is reported as being significantly correlated with the dependent variable (money). An interaction occurs if a correlation between the dependent variable and a predictor is affected by another predictor.</p>
<p>The top most term is called intercept and has a value of 99.15 which represents the base estimate to which all other estimates refer. To exemplify what this means, let us consider what the model would predict that a man would spend on a present if he interested in the woman but he is also in a relationship. The amount he would spend (based on the model would be 99.15 dollars (which is the intercept). This means that the intercept represents the predicted value if all predictors take the base or reference level. And since being in relationship but being interested are the case, and because the interaction does not apply, the predicted value in our example is exactly the intercept (see below).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co">#intercept  Single  NotInterested  Single:NotInterested</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fl">99.15</span>     <span class="sc">+</span> <span class="fl">57.69</span>  <span class="sc">+</span> <span class="dv">0</span>           <span class="sc">+</span> <span class="dv">0</span>     <span class="co"># 156.8 single + interested</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 156.84</code></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fl">99.15</span>     <span class="sc">+</span> <span class="fl">57.69</span>  <span class="sc">-</span> <span class="fl">47.66</span>       <span class="sc">-</span> <span class="fl">63.18</span> <span class="co"># 46.00 single + not interested</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 46</code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fl">99.15</span>     <span class="sc">-</span> <span class="dv">0</span>      <span class="sc">+</span> <span class="dv">0</span>           <span class="sc">-</span> <span class="dv">0</span>     <span class="co"># 99.15 relationship + interested</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 99.15</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fl">99.15</span>     <span class="sc">-</span> <span class="dv">0</span>      <span class="sc">-</span> <span class="fl">47.66</span>       <span class="sc">-</span> <span class="dv">0</span>     <span class="co"># 51.49 relationship + not interested</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 51.49</code></pre>
</div>
</div>
<p>Now, let us consider what a man would spend if he is in a relationship and he is not attracted to the women. In that case, the model predicts that the man would spend only 51.49 dollars on a present: the intercept (99.15) minus 47.66 because the man is not interested (and no additional subtraction because the interaction does not apply).</p>
<p>We can derive the same results easier using the <code>predict</code> function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># make prediction based on the model for original data</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>prediction <span class="ot">&lt;-</span> <span class="fu">predict</span>(m2.mlr, <span class="at">newdata =</span> mlrdata)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect predictions</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(<span class="fu">round</span>(prediction,<span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 46.01  51.49  99.15 156.85 
    25     25     25     25 </code></pre>
</div>
</div>
<p>Below the table of coefficients, the regression summary reports model statistics that provide information about how well the model performs. The difference between the values and the values in the coefficients table is that the model statistics refer to the model as a whole rather than focusing on individual predictors.</p>
<p>The multiple R<sup>2</sup>-value is a measure of how much variance the model explains. A multiple R<sup>2</sup>-value of 0 would inform us that the model does not explain any variance while a value of .852 mean that the model explains 85.2 percent of the variance. A value of 1 would inform us that the model explains 100 percent of the variance and that the predictions of the model match the observed values perfectly. Multiplying the multiple R<sup>2</sup>-value thus provides the percentage of explained variance. Models that have a multiple R<sup>2</sup>-value equal or higher than .05 are deemed substantially significant <span class="citation" data-cites="szmrecsanyi2006morphosyntactic">[see <a href="#ref-szmrecsanyi2006morphosyntactic" role="doc-biblioref">14</a>]</span>. It has been claimed that models should explain a minimum of 5 percent of variance but this is problematic as it is not uncommon for models to have very low explanatory power while still performing significantly and systematically better than chance. In addition, the total amount of variance is negligible in cases where one is interested in very weak but significant effects. It is much more important for model to perform significantly better than minimal base-line models because if this is not the case, then the model does not have any predictive and therefore no explanatory power.</p>
<p>The adjusted R<sup>2</sup>-value considers the amount of explained variance in light of the number of predictors in the model (it is thus somewhat similar to the AIC and BIC) and informs about how well the model would perform if it were applied to the population that the sample is drawn from. Ideally, the difference between multiple and adjusted R<sup>2</sup>-value should be very small as this means that the model is not overfitted. If, however, the difference between multiple and adjusted R<sup>2</sup>-value is substantial, then this would strongly suggest that the model is unstable and overfitted to the data while being inadequate for drawing inferences about the population. Differences between multiple and adjusted R<sup>2</sup>-values indicate that the data contains outliers that cause the distribution of the data on which the model is based to differ from the distributions that the model mathematically requires to provide reliable estimates. The difference between multiple and adjusted R<sup>2</sup>-value in our model is very small (85.2-84.7=.05) and should not cause concern.</p>
<p>Before continuing, we will calculate the confidence intervals of the coefficients.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># extract confidence intervals of the coefficients</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(m2.mlr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                                              2.5 %         97.5 %
(Intercept)                           91.6225795890 106.6870204110
statusSingle                          47.0406317400  68.3449682600
attractionNotInterested              -58.3149682600 -37.0106317400
statusSingle:attractionNotInterested -78.2432408219 -48.1143591781</code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create and compare baseline- and minimal adequate model</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>m0.mlr <span class="ot">&lt;-</span> <span class="fu">lm</span>(money <span class="sc">~</span><span class="dv">1</span>, <span class="at">data =</span> mlrdata)</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(m0.mlr, m2.mlr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Model 1: money ~ 1
Model 2: money ~ (status + attraction)^2
  Res.Df          RSS Df   Sum of Sq         F                 Pr(&gt;F)    
1     99 233562.28650                                                    
2     96  34557.56428  3 199004.7222 184.27662 &lt; 0.000000000000000222 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>Now, we compare the final minimal adequate model to the base-line model to test whether then final model significantly outperforms the baseline model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># compare baseline- and minimal adequate model</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">Anova</span>(m0.mlr, m2.mlr, <span class="at">type =</span> <span class="st">"III"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Anova Table (Type III tests)

Response: money
                 Sum Sq Df    F value                 Pr(&gt;F)    
(Intercept) 781015.8300  1 2169.64133 &lt; 0.000000000000000222 ***
Residuals    34557.5643 96                                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>The comparison between the two model confirms that the minimal adequate model performs significantly better (makes significantly more accurate estimates of the outcome variable) compared with the baseline model.</p>
</section>
<section id="outlier-detection" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="outlier-detection">Outlier Detection</h3>
<p>After implementing the multiple regression, we now need to look for outliers and perform the model diagnostics by testing whether removing data points disproportionately decreases model fit. To begin with, we generate diagnostic plots.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># generate plots</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(m2.mlr) <span class="sc">+</span> </span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="fixreg_files/figure-html/mlr11-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The plots do not show severe problems such as funnel shaped patterns or drastic deviations from the diagonal line in Normal Q-Q plot (have a look at the explanation of what to look for and how to interpret these diagnostic plots in the section on simple linear regression) but data points 52, 64, and 83 are repeatedly indicated as potential outliers.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># determine a cutoff for data points that have D-values higher than 4/(n-k-1)</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>cutoff <span class="ot">&lt;-</span> <span class="dv">4</span><span class="sc">/</span>((<span class="fu">nrow</span>(mlrdata)<span class="sc">-</span><span class="fu">length</span>(m2.mlr<span class="sc">$</span>coefficients)<span class="sc">-</span><span class="dv">2</span>))</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="co"># start plotting</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))           <span class="co"># display plots in 3 rows/2 columns</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="fu">qqPlot</span>(m2.mlr, <span class="at">main=</span><span class="st">"QQ Plot"</span>) <span class="co"># create qq-plot</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 52 83</code></pre>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(m2.mlr, <span class="at">which=</span><span class="dv">4</span>, <span class="at">cook.levels =</span> cutoff); <span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="fixreg_files/figure-html/mlr12-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The graphs indicate that data points 52, 64, and 83 may be problematic. We will therefore statistically evaluate whether these data points need to be removed. In order to find out which data points require removal, we extract the influence measure statistics and add them to out data set.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># extract influence statistics</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>infl <span class="ot">&lt;-</span> <span class="fu">influence.measures</span>(m2.mlr)</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="co"># add infl. statistics to data</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>mlrdata <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(mlrdata, infl[[<span class="dv">1</span>]], infl[[<span class="dv">2</span>]])</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a><span class="co"># annotate too influential data points</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>remove <span class="ot">&lt;-</span> <span class="fu">apply</span>(infl<span class="sc">$</span>is.inf, <span class="dv">1</span>, <span class="cf">function</span>(x) {</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ifelse</span>(x <span class="sc">==</span> <span class="cn">TRUE</span>, <span class="fu">return</span>(<span class="st">"remove"</span>), <span class="fu">return</span>(<span class="st">"keep"</span>)) } )</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a><span class="co"># add annotation to data</span></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>mlrdata <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(mlrdata, remove)</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a><span class="co"># number of rows before removing outliers</span></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(mlrdata)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 100</code></pre>
</div>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># remove outliers</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>mlrdata <span class="ot">&lt;-</span> mlrdata[mlrdata<span class="sc">$</span>remove <span class="sc">==</span> <span class="st">"keep"</span>, ]</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="co"># number of rows after removing outliers</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(mlrdata)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 98</code></pre>
</div>
</div>
<p>The difference in row in the data set before and after removing data points indicate that two data points which represented outliers have been removed.</p>
<div class="warning" style="padding:0.1em; background-color:#f2f2f2; color:#51247a">
<span>
<p style="margin-top:1em; text-align:center">
<b>NOTE</b><br><br>In general, outliers should not simply be removed unless there are good reasons for it (this could be that the outliers represent measurement errors). If a data set contains outliers, one should rather switch to methods that are better at handling outliers, e.g.&nbsp;by using weights to account for data points with high leverage. One alternative would be to switch to a robust regression (see <a href="https://slcladal.github.io/regression.html#16_Robust_Regression">here</a>). However, here we show how to proceed by removing outliers as this is a common, though potentially problematic, method of dealing with outliers.
</p>
<p style="margin-left:1em;">
</p>
<p></p>
</span></div>
<p><br></p>
</section>
<section id="rerun-regression" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="rerun-regression">Rerun Regression</h3>
<p>As we have decided to remove the outliers which means that we are now dealing with a different data set, we need to rerun the regression analysis. As the steps are identical to the regression analysis performed above, the steps will not be described in greater detail.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># recreate regression models on new data</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>m0.mlr <span class="ot">=</span> <span class="fu">lm</span>(money <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> mlrdata)</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>m0.glm <span class="ot">=</span> <span class="fu">glm</span>(money <span class="sc">~</span> <span class="dv">1</span>, <span class="at">family =</span> gaussian, <span class="at">data =</span> mlrdata)</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>m1.mlr <span class="ot">=</span> <span class="fu">lm</span>(money <span class="sc">~</span> (status <span class="sc">+</span> attraction)<span class="sc">^</span><span class="dv">2</span>, <span class="at">data =</span> mlrdata)</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>m1.glm <span class="ot">=</span> <span class="fu">glm</span>(money <span class="sc">~</span> status <span class="sc">*</span> attraction, <span class="at">family =</span> gaussian,</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> mlrdata)</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a><span class="co"># automated AIC based model fitting</span></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a><span class="fu">step</span>(m1.mlr, <span class="at">direction =</span> <span class="st">"both"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=570.29
money ~ (status + attraction)^2

                    Df   Sum of Sq         RSS         AIC
&lt;none&gt;                             30411.31714 570.2850562
- status:attraction  1 21646.86199 52058.17914 620.9646729</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = money ~ (status + attraction)^2, data = mlrdata)

Coefficients:
                         (Intercept)                          statusSingle  
                          99.1548000                            55.8535333  
             attractionNotInterested  statusSingle:attractionNotInterested  
                         -47.6628000                           -59.4613667  </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create new final models</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>m2.mlr <span class="ot">=</span> <span class="fu">lm</span>(money <span class="sc">~</span> (status <span class="sc">+</span> attraction)<span class="sc">^</span><span class="dv">2</span>, <span class="at">data =</span> mlrdata)</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>m2.glm <span class="ot">=</span> <span class="fu">glm</span>(money <span class="sc">~</span> status <span class="sc">*</span> attraction, <span class="at">family =</span> gaussian,</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> mlrdata)</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect final minimal model</span></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m2.mlr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = money ~ (status + attraction)^2, data = mlrdata)

Residuals:
         Min           1Q       Median           3Q          Max 
-35.76416667 -13.50520000  -0.98948333  10.59887500  38.77166667 

Coefficients:
                                         Estimate   Std. Error  t value
(Intercept)                           99.15480000   3.59735820 27.56323
statusSingle                          55.85353333   5.14015367 10.86612
attractionNotInterested              -47.66280000   5.08743275 -9.36873
statusSingle:attractionNotInterested -59.46136667   7.26927504 -8.17982
                                                   Pr(&gt;|t|)    
(Intercept)                          &lt; 0.000000000000000222 ***
statusSingle                         &lt; 0.000000000000000222 ***
attractionNotInterested               0.0000000000000040429 ***
statusSingle:attractionNotInterested  0.0000000000013375166 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 17.986791 on 94 degrees of freedom
Multiple R-squared:  0.857375902,   Adjusted R-squared:  0.852824069 
F-statistic: 188.358387 on 3 and 94 DF,  p-value: &lt; 0.0000000000000002220446</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># extract confidence intervals of the coefficients</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(m2.mlr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                                              2.5 %         97.5 %
(Intercept)                           92.0121609656 106.2974390344
statusSingle                          45.6476377202  66.0594289465
attractionNotInterested              -57.7640169936 -37.5615830064
statusSingle:attractionNotInterested -73.8946826590 -45.0280506744</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># compare baseline with final model</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(m0.mlr, m2.mlr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Model 1: money ~ 1
Model 2: money ~ (status + attraction)^2
  Res.Df          RSS Df   Sum of Sq         F                 Pr(&gt;F)    
1     97 213227.06081                                                    
2     94  30411.31714  3 182815.7437 188.35839 &lt; 0.000000000000000222 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># compare baseline with final model</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="fu">Anova</span>(m0.mlr, m2.mlr, <span class="at">type =</span> <span class="st">"III"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Anova Table (Type III tests)

Response: money
                 Sum Sq Df    F value                 Pr(&gt;F)    
(Intercept) 760953.2107  1 2352.07181 &lt; 0.000000000000000222 ***
Residuals    30411.3171 94                                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</section>
<section id="additional-model-diagnostics" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="additional-model-diagnostics">Additional Model Diagnostics</h3>
<p>After rerunning the regression analysis on the updated data set, we again create diagnostic plots in order to check whether there are potentially problematic data points.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># generate plots</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(m2.mlr) <span class="sc">+</span> </span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="fixreg_files/figure-html/mlr19-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># determine a cutoff for data points that have</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="co"># D-values higher than 4/(n-k-1)</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>cutoff <span class="ot">&lt;-</span> <span class="dv">4</span><span class="sc">/</span>((<span class="fu">nrow</span>(mlrdata)<span class="sc">-</span><span class="fu">length</span>(m2.mlr<span class="sc">$</span>coefficients)<span class="sc">-</span><span class="dv">2</span>))</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a><span class="co"># start plotting</span></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))           <span class="co"># display plots in 1 row/2 columns</span></span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a><span class="fu">qqPlot</span>(m2.mlr, <span class="at">main=</span><span class="st">"QQ Plot"</span>) <span class="co"># create qq-plot</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>84 88 
82 86 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(m2.mlr, <span class="at">which=</span><span class="dv">4</span>, <span class="at">cook.levels =</span> cutoff); <span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="fixreg_files/figure-html/mlr20-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Although the diagnostic plots indicate that additional points may be problematic, but these data points deviate substantially less from the trend than was the case with the data points that have already been removed. To make sure that retaining the data points that are deemed potentially problematic by the diagnostic plots, is acceptable, we extract diagnostic statistics and add them to the data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># add model diagnostics to the data</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>mlrdata <span class="ot">&lt;-</span> mlrdata <span class="sc">%&gt;%</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">residuals =</span> <span class="fu">resid</span>(m2.mlr),</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">standardized.residuals =</span> <span class="fu">rstandard</span>(m2.mlr),</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">studentized.residuals =</span> <span class="fu">rstudent</span>(m2.mlr),</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">cooks.distance =</span> <span class="fu">cooks.distance</span>(m2.mlr),</span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>                <span class="at">dffit =</span> <span class="fu">dffits</span>(m2.mlr),</span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>                <span class="at">leverage =</span> <span class="fu">hatvalues</span>(m2.mlr),</span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>                <span class="at">covariance.ratios =</span> <span class="fu">covratio</span>(m2.mlr),</span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>                <span class="at">fitted =</span> m2.mlr<span class="sc">$</span>fitted.values)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can now use these diagnostic statistics to create more precise diagnostic plots.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot 5</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>p5 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(mlrdata,</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(studentized.residuals)) <span class="sc">+</span></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)<span class="sc">+</span></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y=</span>..density..),</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>                 <span class="at">binwidth =</span> .<span class="dv">2</span>,</span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>                 <span class="at">colour=</span><span class="st">"black"</span>,</span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill=</span><span class="st">"gray90"</span>) <span class="sc">+</span></span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Studentized Residual"</span>, <span class="at">y =</span> <span class="st">"Density"</span>) <span class="sc">+</span></span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dnorm,</span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a>                <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> <span class="fu">mean</span>(mlrdata<span class="sc">$</span>studentized.residuals, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a>                            <span class="at">sd =</span> <span class="fu">sd</span>(mlrdata<span class="sc">$</span>studentized.residuals, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)),</span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a>                <span class="at">colour =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">8</span>)</span>
<span id="cb51-15"><a href="#cb51-15" aria-hidden="true" tabindex="-1"></a><span class="co"># plot 6</span></span>
<span id="cb51-16"><a href="#cb51-16" aria-hidden="true" tabindex="-1"></a>p6 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(mlrdata, <span class="fu">aes</span>(fitted, studentized.residuals)) <span class="sc">+</span></span>
<span id="cb51-17"><a href="#cb51-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb51-18"><a href="#cb51-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">colour =</span> <span class="st">"Red"</span>)<span class="sc">+</span></span>
<span id="cb51-19"><a href="#cb51-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">8</span>)<span class="sc">+</span></span>
<span id="cb51-20"><a href="#cb51-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Fitted Values"</span>,</span>
<span id="cb51-21"><a href="#cb51-21" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Studentized Residual"</span>)</span>
<span id="cb51-22"><a href="#cb51-22" aria-hidden="true" tabindex="-1"></a><span class="co"># plot 7</span></span>
<span id="cb51-23"><a href="#cb51-23" aria-hidden="true" tabindex="-1"></a>p7 <span class="ot">&lt;-</span> <span class="fu">qplot</span>(<span class="at">sample =</span> mlrdata<span class="sc">$</span>studentized.residuals, <span class="at">stat=</span><span class="st">"qq"</span>) <span class="sc">+</span></span>
<span id="cb51-24"><a href="#cb51-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">8</span>) <span class="sc">+</span></span>
<span id="cb51-25"><a href="#cb51-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Theoretical Values"</span>,</span>
<span id="cb51-26"><a href="#cb51-26" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Observed Values"</span>)</span>
<span id="cb51-27"><a href="#cb51-27" aria-hidden="true" tabindex="-1"></a>vip<span class="sc">::</span><span class="fu">grid.arrange</span>(p5, p6, p7, <span class="at">nrow =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="fixreg_files/figure-html/mlr22-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The new diagnostic plots do not indicate outliers that require removal. With respect to such data points the following parameters should be considered:</p>
<ol type="1">
<li><p>Data points with standardized residuals &gt; 3.29 should be removed <span class="citation" data-cites="field2012discovering">[<a href="#ref-field2012discovering" role="doc-biblioref">5</a>]</span></p></li>
<li><p>If more than 1 percent of data points have standardized residuals exceeding values &gt; 2.58, then the error rate of the model is unacceptable <span class="citation" data-cites="field2012discovering">[<a href="#ref-field2012discovering" role="doc-biblioref">5</a>]</span>.</p></li>
<li><p>If more than 5 percent of data points have standardized residuals exceeding values &gt; 1.96, then the error rate of the model is unacceptable <span class="citation" data-cites="field2012discovering">[<a href="#ref-field2012discovering" role="doc-biblioref">5</a>]</span></p></li>
<li><p>In addition, data points with Cook’s D-values &gt; 1 should be removed <span class="citation" data-cites="field2012discovering">[<a href="#ref-field2012discovering" role="doc-biblioref">5</a>]</span></p></li>
<li><p>Also, data points with leverage values higher than <span class="math inline">\(3(k + 1)/N\)</span> or <span class="math inline">\(2(k + 1)/N\)</span> (k = Number of predictors, N = Number of cases in model) should be removed <span class="citation" data-cites="field2012discovering">[<a href="#ref-field2012discovering" role="doc-biblioref">5</a>]</span></p></li>
<li><p>There should not be (any) autocorrelation among predictors. This means that independent variables cannot be correlated with itself (for instance, because data points come from the same subject). If there is autocorrelation among predictors, then a Repeated Measures Design or a (hierarchical) mixed-effects model should be implemented instead.</p></li>
<li><p>Predictors cannot substantially correlate with each other (multicollinearity) (see the <a href="https://slcladal.github.io/regression.html#Multicollinearity">subsection on (multi-)collinearity</a> in the section of multiple binomial logistic regression for more details about (multi-)collinearity). If a model contains predictors that have variance inflation factors (VIF) &gt; 10 the model is unreliable <span class="citation" data-cites="myers1990classical">[<a href="#ref-myers1990classical" role="doc-biblioref">15</a>]</span> and predictors causing such VIFs should be removed. Indeed, even VIFs of 2.5 can be problematic <span class="citation" data-cites="szmrecsanyi2006morphosyntactic">[<a href="#ref-szmrecsanyi2006morphosyntactic" role="doc-biblioref">14</a>]</span> Indeed, <span class="citation" data-cites="zuur2010protocol">[<a href="#ref-zuur2010protocol" role="doc-biblioref">16</a>]</span> propose that variables with VIFs exceeding 3 should be removed!</p></li>
</ol>
<div class="warning" style="padding:0.1em; background-color:#f2f2f2; color:#51247a">
<span>
<p style="margin-top:1em; text-align:center">
<b>NOTE</b><br><br>However, (multi-)collinearity is only an issue if one is interested in interpreting regression results! If the interpretation is irrelevant because what is relevant is prediction(!), then it does not matter if the model contains collinear predictors! See <span class="citation" data-cites="gries2021statistics">[<a href="#ref-gries2021statistics" role="doc-biblioref">6</a>]</span> for a more elaborate explanation.
</p>
<p style="margin-left:1em;">
</p>
<p></p>
</span></div>
<p><br></p>
<ol start="8" type="1">
<li>The mean value of VIFs should be ~ 1 <span class="citation" data-cites="bowerman1990linear">[<a href="#ref-bowerman1990linear" role="doc-biblioref">17</a>]</span>.</li>
</ol>
<p>The following code chunk evaluates these criteria.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1: optimal = 0</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="co"># (listed data points should be removed)</span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a><span class="fu">which</span>(mlrdata<span class="sc">$</span>standardized.residuals <span class="sc">&gt;</span> <span class="fl">3.29</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>named integer(0)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 2: optimal = 1</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="co"># (listed data points should be removed)</span></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>stdres_258 <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(<span class="fu">sapply</span>(mlrdata<span class="sc">$</span>standardized.residuals, <span class="cf">function</span>(x) {</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ifelse</span>(<span class="fu">sqrt</span>((x<span class="sc">^</span><span class="dv">2</span>)) <span class="sc">&gt;</span> <span class="fl">2.58</span>, <span class="dv">1</span>, <span class="dv">0</span>) } ))</span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>(<span class="fu">sum</span>(stdres_258) <span class="sc">/</span> <span class="fu">length</span>(stdres_258)) <span class="sc">*</span> <span class="dv">100</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 3: optimal = 5</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="co"># (listed data points should be removed)</span></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>stdres_196 <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(<span class="fu">sapply</span>(mlrdata<span class="sc">$</span>standardized.residuals, <span class="cf">function</span>(x) {</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ifelse</span>(<span class="fu">sqrt</span>((x<span class="sc">^</span><span class="dv">2</span>)) <span class="sc">&gt;</span> <span class="fl">1.96</span>, <span class="dv">1</span>, <span class="dv">0</span>) } ))</span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>(<span class="fu">sum</span>(stdres_196) <span class="sc">/</span> <span class="fu">length</span>(stdres_196)) <span class="sc">*</span> <span class="dv">100</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 6.12244897959</code></pre>
</div>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 4: optimal = 0</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="co"># (listed data points should be removed)</span></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a><span class="fu">which</span>(mlrdata<span class="sc">$</span>cooks.distance <span class="sc">&gt;</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>named integer(0)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 5: optimal = 0</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="co"># (data points should be removed if cooks distance is close to 1)</span></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a><span class="fu">which</span>(mlrdata<span class="sc">$</span>leverage <span class="sc">&gt;=</span> (<span class="dv">3</span><span class="sc">*</span><span class="fu">mean</span>(mlrdata<span class="sc">$</span>leverage)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>named integer(0)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 6: checking autocorrelation:</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Durbin-Watson test (optimal: high p-value)</span></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a><span class="fu">dwt</span>(m2.mlr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> lag  Autocorrelation D-W Statistic p-value
   1 -0.0143324675649  1.9680423527   0.622
 Alternative hypothesis: rho != 0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 7: test multicollinearity 1</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="fu">vif</span>(m2.mlr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                        statusSingle              attractionNotInterested 
                                2.00                                 1.96 
statusSingle:attractionNotInterested 
                                2.96 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 8: test multicollinearity 2</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="sc">/</span><span class="fu">vif</span>(m2.mlr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                        statusSingle              attractionNotInterested 
                      0.500000000000                       0.510204081633 
statusSingle:attractionNotInterested 
                      0.337837837838 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 9: mean vif should not exceed 1</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="fu">vif</span>(m2.mlr))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.30666666667</code></pre>
</div>
</div>
<p>Except for the mean VIF value (2.307) which should not exceed 1, all diagnostics are acceptable. We will now test whether the sample size is sufficient for our model. With respect to the minimal sample size and based on <span class="citation" data-cites="green1991many">[<a href="#ref-green1991many" role="doc-biblioref">12</a>]</span>, <span class="citation" data-cites="field2012discovering">[<a href="#ref-field2012discovering" role="doc-biblioref">5</a>]</span> offer the following rules of thumb for an adequate sample size (k = number of predictors; categorical predictors with more than two levels should be recoded as dummy variables):</p>
<ul>
<li><p>if you are interested in the overall model: 50 + 8k (k = number of predictors)</p></li>
<li><p>if you are interested in individual predictors: 104 + k</p></li>
<li><p>if you are interested in both: take the higher value!</p></li>
</ul>
</section>
<section id="evaluation-of-sample-size" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="evaluation-of-sample-size">Evaluation of Sample Size</h3>
<p>After performing the diagnostics, we will now test whether the sample size is adequate and what the values of R would be based on a random distribution in order to be able to estimate how likely a <span class="math inline">\(\beta\)</span>-error is given the present sample size <span class="citation" data-cites="field2012discovering">[see <a href="#ref-field2012discovering" role="doc-biblioref">5</a>]</span>. Beta errors (or <span class="math inline">\(\beta\)</span>-errors) refer to the erroneous assumption that a predictor is not significant (based on the analysis and given the sample) although it does have an effect in the population. In other words, <span class="math inline">\(\beta\)</span>-error means to overlook a significant effect because of weaknesses of the analysis. The test statistics ranges between 0 and 1 where lower values are better. If the values approximate 1, then there is serious concern as the model is not reliable given the sample size. In such cases, unfortunately, the best option is to increase the sample size.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load functions</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"https://slcladal.github.io/rscripts/SampleSizeMLR.r"</span>)</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"https://slcladal.github.io/rscripts/ExpR.r"</span>)</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a><span class="co"># check if sample size is sufficient</span></span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a><span class="fu">smplesz</span>(m2.mlr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Sample too small: please increase your sample by  9  data points"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check beta-error likelihood</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a><span class="fu">expR</span>(m2.mlr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Based on the sample size expect a false positive correlation of 0.0309 between the predictors and the predicted"</code></pre>
</div>
</div>
<p>The function <code>smplesz</code> reports that the sample size is insufficient by 9 data points according to <span class="citation" data-cites="green1991many">[<a href="#ref-green1991many" role="doc-biblioref">12</a>]</span>. The likelihood of <span class="math inline">\(\beta\)</span>-errors, however, is very small (0.0309). As a last step, we summarize the results of the regression analysis.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="co"># tabulate model results</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>sjPlot<span class="sc">::</span><span class="fu">tab_model</span>(m0.glm, m2.glm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<table style="border-collapse:collapse; border:none;">
<tbody><tr>
<th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">&nbsp;</th>
<th colspan="3" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">money</th>
<th colspan="3" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">money</th>
</tr>
<tr>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">Predictors</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">Estimates</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">CI</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">p</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">Estimates</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">CI</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  col7">p</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">(Intercept)</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">88.12</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">78.72&nbsp;–&nbsp;97.52</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">99.15</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">92.10&nbsp;–&nbsp;106.21</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7"><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">status [Single]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">55.85</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">45.78&nbsp;–&nbsp;65.93</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7"><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">attraction<br>[NotInterested]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-47.66</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-57.63&nbsp;–&nbsp;-37.69</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7"><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">status [Single] *<br>attraction<br>[NotInterested]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-59.46</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-73.71&nbsp;–&nbsp;-45.21</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7"><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;">Observations</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="3">98</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="3">98</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">R<sup>2</sup></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.000</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.857</td>
</tr>

</tbody></table>

</div>
</div>
<p>Additionally, we can inspect the summary of the regression model as shown below to extract additional information.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m2.mlr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = money ~ (status + attraction)^2, data = mlrdata)

Residuals:
         Min           1Q       Median           3Q          Max 
-35.76416667 -13.50520000  -0.98948333  10.59887500  38.77166667 

Coefficients:
                                         Estimate   Std. Error  t value
(Intercept)                           99.15480000   3.59735820 27.56323
statusSingle                          55.85353333   5.14015367 10.86612
attractionNotInterested              -47.66280000   5.08743275 -9.36873
statusSingle:attractionNotInterested -59.46136667   7.26927504 -8.17982
                                                   Pr(&gt;|t|)    
(Intercept)                          &lt; 0.000000000000000222 ***
statusSingle                         &lt; 0.000000000000000222 ***
attractionNotInterested               0.0000000000000040429 ***
statusSingle:attractionNotInterested  0.0000000000013375166 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 17.986791 on 94 degrees of freedom
Multiple R-squared:  0.857375902,   Adjusted R-squared:  0.852824069 
F-statistic: 188.358387 on 3 and 94 DF,  p-value: &lt; 0.0000000000000002220446</code></pre>
</div>
</div>
<p>Although <span class="citation" data-cites="field2012discovering">[<a href="#ref-field2012discovering" role="doc-biblioref">5</a>]</span> suggest that the main effects of the predictors involved in the interaction should not be interpreted, they are interpreted here to illustrate how the results of a multiple linear regression can be reported.</p>
<p>We can use the <code>reports</code> package <span class="citation" data-cites="report">[<a href="#ref-report" role="doc-biblioref">18</a>]</span> to summarize the analysis.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>report<span class="sc">::</span><span class="fu">report</span>(m2.mlr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>We fitted a linear model (estimated using OLS) to predict money with status and attraction (formula: money ~ (status + attraction)^2). The model explains a statistically significant and substantial proportion of variance (R2 = 0.86, F(3, 94) = 188.36, p &lt; .001, adj. R2 = 0.85). The model's intercept, corresponding to status = Relationship and attraction = Interested, is at 99.15 (95% CI [92.01, 106.30], t(94) = 27.56, p &lt; .001). Within this model:

  - The effect of status [Single] is statistically significant and positive (beta = 55.85, 95% CI [45.65, 66.06], t(94) = 10.87, p &lt; .001; Std. beta = 1.19, 95% CI [0.97, 1.41])
  - The effect of attraction [NotInterested] is statistically significant and negative (beta = -47.66, 95% CI [-57.76, -37.56], t(94) = -9.37, p &lt; .001; Std. beta = -1.02, 95% CI [-1.23, -0.80])
  - The interaction effect of attraction [NotInterested] on status [Single] is statistically significant and negative (beta = -59.46, 95% CI [-73.89, -45.03], t(94) = -8.18, p &lt; .001; Std. beta = -1.27, 95% CI [-1.58, -0.96])

Standardized parameters were obtained by fitting the model on a standardized version of the dataset. 95% Confidence Intervals (CIs) and p-values were computed using the Wald approximation.</code></pre>
</div>
</div>
<p>We can use this output to write up a final report:</p>
<p>A multiple linear regression was fitted to the data using an automated, step-wise, AIC-based (Akaike’s Information Criterion) procedure. The model fitting arrived at a final minimal model. During the model diagnostics, two outliers were detected and removed. Further diagnostics did not find other issues after the removal.</p>
<p>The final minimal adequate regression model is based on 98 data points and performs highly significantly better than a minimal baseline model (multiple R<sup>2</sup>: .857, adjusted R<sup>2</sup>: .853, F-statistic (3, 94): 154.4, AIC: 850.4, BIC: 863.32, p&lt;.001<sup><span class="math inline">\(***\)</span></sup>). The final minimal adequate regression model reports <em>attraction</em> and <em>status</em> as significant main effects. The relationship status of men correlates highly significantly and positively with the amount of money spend on the women’s presents (SE: 5.14, t-value: 10.87, p&lt;.001<sup><span class="math inline">\(***\)</span></sup>). This shows that men spend 156.8 dollars on presents if they are single while they spend 99,15 dollars if they are in a relationship. Whether men are attracted to women also correlates highly significantly and positively with the money they spend on women (SE: 5.09, t-values: -9.37, p&lt;.001<sup><span class="math inline">\(***\)</span></sup>). If men are not interested in women, they spend 47.66 dollar less on a present for women compared with women the men are interested in.</p>
<p>Furthermore, the final minimal adequate regression model reports a highly significant interaction between relationship <em>status</em> and <em>attraction</em> (SE: 7.27, t-value: -8.18, p&lt;.001<sup><span class="math inline">\(***\)</span></sup>): If men are single but they are not interested in a women, a man would spend only 59.46 dollars on a present compared to all other constellations.</p>
</section>
</section>
<section id="robust-regression" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="robust-regression">Robust Regression</h2>
<p>Robust regression represents an alternative to linear regression models when the data contains outliers that should not be removed. As such, robust regressions can handle overly influential data points (outliers) and they allow us to retain outliers rather than removing them by adding weights <span class="citation" data-cites="rousseeuw2005robust">[<a href="#ref-rousseeuw2005robust" role="doc-biblioref">19</a>]</span>. Thus, robust regressions are used when there are outliers present in the data and we can thus not use traditional models but we do not have a good reason for removing the outliers.</p>
<blockquote class="blockquote">
<p>Robust regressions allow us to handle overly influential data points (outliers) by using weights. Thus, robust regressions enable us to retain all data points.</p>
</blockquote>
<p>We begin by loading a data set (the mlrdata set which have used for multiple linear regression).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load data</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>robustdata  <span class="ot">&lt;-</span> base<span class="sc">::</span><span class="fu">readRDS</span>(<span class="fu">url</span>(<span class="st">"https://slcladal.github.io/data/mld.rda"</span>, <span class="st">"rb"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">

<div class="tabwid"><style>.cl-4e542942{table-layout:auto;width:75%;}.cl-4e50c8ce{font-family:'DejaVu Sans';font-size:12pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-4e50c8d8{font-family:'DejaVu Sans';font-size:12pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-4e50d58a{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-4e50d594{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-4e510870{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-4e51087a{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-4e51087b{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-4e510884{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-4e5108c0{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-4e5108c1{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-4e5108ca{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-4e5108d4{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-4e5108d5{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-4e5108d6{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-4e5108de{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-4e5108df{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table class="cl-4e542942">
<caption class="Table Caption">
<p>First 15 rows of the robustdata.</p>
</caption>

<thead><tr style="overflow-wrap:break-word;"><td class="cl-4e5108de"><p class="cl-4e50d58a"><span class="cl-4e50c8ce">status</span></p></td><td class="cl-4e5108d6"><p class="cl-4e50d58a"><span class="cl-4e50c8ce">attraction</span></p></td><td class="cl-4e5108df"><p class="cl-4e50d594"><span class="cl-4e50c8ce">money</span></p></td></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-4e51087b"><p class="cl-4e50d58a"><span class="cl-4e50c8d8">Relationship</span></p></td><td class="cl-4e510870"><p class="cl-4e50d58a"><span class="cl-4e50c8d8">NotInterested</span></p></td><td class="cl-4e51087a"><p class="cl-4e50d594"><span class="cl-4e50c8d8">86.33</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-4e5108c1"><p class="cl-4e50d58a"><span class="cl-4e50c8d8">Relationship</span></p></td><td class="cl-4e510884"><p class="cl-4e50d58a"><span class="cl-4e50c8d8">NotInterested</span></p></td><td class="cl-4e5108c0"><p class="cl-4e50d594"><span class="cl-4e50c8d8">45.58</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-4e51087b"><p class="cl-4e50d58a"><span class="cl-4e50c8d8">Relationship</span></p></td><td class="cl-4e510870"><p class="cl-4e50d58a"><span class="cl-4e50c8d8">NotInterested</span></p></td><td class="cl-4e51087a"><p class="cl-4e50d594"><span class="cl-4e50c8d8">68.43</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-4e5108c1"><p class="cl-4e50d58a"><span class="cl-4e50c8d8">Relationship</span></p></td><td class="cl-4e510884"><p class="cl-4e50d58a"><span class="cl-4e50c8d8">NotInterested</span></p></td><td class="cl-4e5108c0"><p class="cl-4e50d594"><span class="cl-4e50c8d8">52.93</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-4e51087b"><p class="cl-4e50d58a"><span class="cl-4e50c8d8">Relationship</span></p></td><td class="cl-4e510870"><p class="cl-4e50d58a"><span class="cl-4e50c8d8">NotInterested</span></p></td><td class="cl-4e51087a"><p class="cl-4e50d594"><span class="cl-4e50c8d8">61.86</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-4e5108c1"><p class="cl-4e50d58a"><span class="cl-4e50c8d8">Relationship</span></p></td><td class="cl-4e510884"><p class="cl-4e50d58a"><span class="cl-4e50c8d8">NotInterested</span></p></td><td class="cl-4e5108c0"><p class="cl-4e50d594"><span class="cl-4e50c8d8">48.47</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-4e51087b"><p class="cl-4e50d58a"><span class="cl-4e50c8d8">Relationship</span></p></td><td class="cl-4e510870"><p class="cl-4e50d58a"><span class="cl-4e50c8d8">NotInterested</span></p></td><td class="cl-4e51087a"><p class="cl-4e50d594"><span class="cl-4e50c8d8">32.79</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-4e5108c1"><p class="cl-4e50d58a"><span class="cl-4e50c8d8">Relationship</span></p></td><td class="cl-4e510884"><p class="cl-4e50d58a"><span class="cl-4e50c8d8">NotInterested</span></p></td><td class="cl-4e5108c0"><p class="cl-4e50d594"><span class="cl-4e50c8d8">35.91</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-4e51087b"><p class="cl-4e50d58a"><span class="cl-4e50c8d8">Relationship</span></p></td><td class="cl-4e510870"><p class="cl-4e50d58a"><span class="cl-4e50c8d8">NotInterested</span></p></td><td class="cl-4e51087a"><p class="cl-4e50d594"><span class="cl-4e50c8d8">30.98</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-4e5108c1"><p class="cl-4e50d58a"><span class="cl-4e50c8d8">Relationship</span></p></td><td class="cl-4e510884"><p class="cl-4e50d58a"><span class="cl-4e50c8d8">NotInterested</span></p></td><td class="cl-4e5108c0"><p class="cl-4e50d594"><span class="cl-4e50c8d8">44.82</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-4e51087b"><p class="cl-4e50d58a"><span class="cl-4e50c8d8">Relationship</span></p></td><td class="cl-4e510870"><p class="cl-4e50d58a"><span class="cl-4e50c8d8">NotInterested</span></p></td><td class="cl-4e51087a"><p class="cl-4e50d594"><span class="cl-4e50c8d8">35.05</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-4e5108c1"><p class="cl-4e50d58a"><span class="cl-4e50c8d8">Relationship</span></p></td><td class="cl-4e510884"><p class="cl-4e50d58a"><span class="cl-4e50c8d8">NotInterested</span></p></td><td class="cl-4e5108c0"><p class="cl-4e50d594"><span class="cl-4e50c8d8">64.49</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-4e51087b"><p class="cl-4e50d58a"><span class="cl-4e50c8d8">Relationship</span></p></td><td class="cl-4e510870"><p class="cl-4e50d58a"><span class="cl-4e50c8d8">NotInterested</span></p></td><td class="cl-4e51087a"><p class="cl-4e50d594"><span class="cl-4e50c8d8">54.50</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-4e5108c1"><p class="cl-4e50d58a"><span class="cl-4e50c8d8">Relationship</span></p></td><td class="cl-4e510884"><p class="cl-4e50d58a"><span class="cl-4e50c8d8">NotInterested</span></p></td><td class="cl-4e5108c0"><p class="cl-4e50d594"><span class="cl-4e50c8d8">61.48</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-4e5108d5"><p class="cl-4e50d58a"><span class="cl-4e50c8d8">Relationship</span></p></td><td class="cl-4e5108d4"><p class="cl-4e50d58a"><span class="cl-4e50c8d8">NotInterested</span></p></td><td class="cl-4e5108ca"><p class="cl-4e50d594"><span class="cl-4e50c8d8">55.51</span></p></td></tr></tbody></table></div>
</div>
</div>
<p>We first fit an ordinary linear model (and although we know from the section on multiple regression that the interaction between status and attraction is significant, we will disregard this for now as this will help to explain the weighing procedure which is the focus of this section).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create model</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>slm <span class="ot">&lt;-</span> <span class="fu">lm</span>(money <span class="sc">~</span> status<span class="sc">+</span>attraction, <span class="at">data =</span> robustdata)</span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect model</span></span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(slm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = money ~ status + attraction, data = robustdata)

Residuals:
      Min        1Q    Median        3Q       Max 
-60.87070 -15.78645  -2.61010  13.88770  59.93710 

Coefficients:
                            Estimate   Std. Error   t value
(Intercept)             114.94950000   4.28993616  26.79515
statusSingle             26.10340000   4.95359160   5.26959
attractionNotInterested -79.25220000   4.95359160 -15.99894
                                      Pr(&gt;|t|)    
(Intercept)             &lt; 0.000000000000000222 ***
statusSingle                     0.00000082576 ***
attractionNotInterested &lt; 0.000000000000000222 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 24.767958 on 97 degrees of freedom
Multiple R-squared:  0.745229335,   Adjusted R-squared:  0.739976331 
F-statistic: 141.867286 on 2 and 97 DF,  p-value: &lt; 0.0000000000000002220446</code></pre>
</div>
</div>
<p>We now check whether the model is well fitted using diagnostic plots.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="co"># generate plots</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(slm) <span class="sc">+</span> </span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>()) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="fixreg_files/figure-html/rr4-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The diagnostic plots indicate that there are three outliers in the data (data points 52, 83 and possibly 64). Therefore, we need to evaluate if the outliers severely affect the fit of the model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>robustdata[<span class="fu">c</span>(<span class="dv">52</span>, <span class="dv">64</span>, <span class="dv">83</span>),]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   status    attraction  money
52 Single NotInterested   0.93
64 Single NotInterested  84.28
83 Single    Interested 200.99</code></pre>
</div>
</div>
<p>We can now calculate Cook’s distance and standardized residuals check if the values of the potentially problematic points have unacceptably high values (-2 &lt; ok &lt; 2).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>CooksDistance <span class="ot">&lt;-</span> <span class="fu">cooks.distance</span>(slm)</span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>StandardizedResiduals <span class="ot">&lt;-</span> <span class="fu">stdres</span>(slm)</span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">cbind</span>(robustdata, CooksDistance, StandardizedResiduals)</span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a>a[CooksDistance <span class="sc">&gt;</span> <span class="dv">4</span><span class="sc">/</span><span class="dv">100</span>, ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         status    attraction  money   CooksDistance StandardizedResiduals
1  Relationship NotInterested  86.33 0.0444158829857         2.07565427025
52       Single NotInterested   0.93 0.0641937458854        -2.49535435377
65       Single NotInterested  12.12 0.0427613629698        -2.03662765573
67       Single NotInterested  13.28 0.0407877963315        -1.98907421786
83       Single    Interested 200.99 0.0622397126545         2.45708203516
84       Single    Interested 193.69 0.0480020776213         2.15782333134
88       Single    Interested 193.78 0.0481663678409         2.16151282221</code></pre>
</div>
</div>
<p>We will calculate the absolute value and reorder the table so that it is easier to check the values.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>AbsoluteStandardizedResiduals <span class="ot">&lt;-</span> <span class="fu">abs</span>(StandardizedResiduals)</span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">cbind</span>(robustdata, CooksDistance, StandardizedResiduals, AbsoluteStandardizedResiduals)</span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>asorted <span class="ot">&lt;-</span> a[<span class="fu">order</span>(<span class="sc">-</span>AbsoluteStandardizedResiduals), ]</span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a>asorted[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         status    attraction  money   CooksDistance StandardizedResiduals
52       Single NotInterested   0.93 0.0641937458854        -2.49535435377
83       Single    Interested 200.99 0.0622397126545         2.45708203516
88       Single    Interested 193.78 0.0481663678409         2.16151282221
84       Single    Interested 193.69 0.0480020776213         2.15782333134
1  Relationship NotInterested  86.33 0.0444158829857         2.07565427025
65       Single NotInterested  12.12 0.0427613629698        -2.03662765573
67       Single NotInterested  13.28 0.0407877963315        -1.98907421786
78       Single    Interested 188.76 0.0394313968241         1.95572122040
21 Relationship NotInterested  81.90 0.0369837409025         1.89404933081
24 Relationship NotInterested  81.56 0.0364414260634         1.88011125419
   AbsoluteStandardizedResiduals
52                 2.49535435377
83                 2.45708203516
88                 2.16151282221
84                 2.15782333134
1                  2.07565427025
65                 2.03662765573
67                 1.98907421786
78                 1.95572122040
21                 1.89404933081
24                 1.88011125419</code></pre>
</div>
</div>
<p>As Cook’s distance and the standardized residuals do have unacceptable values, we re-calculate the linear model as a robust regression and inspect the results</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create robust regression model</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>rmodel <span class="ot">&lt;-</span> robustbase<span class="sc">::</span><span class="fu">lmrob</span>(money <span class="sc">~</span> status <span class="sc">+</span> attraction, <span class="at">data =</span> robustdata)</span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect model</span></span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(rmodel)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
robustbase::lmrob(formula = money ~ status + attraction, data = robustdata)
 \--&gt; method = "MM"
Residuals:
         Min           1Q       Median           3Q          Max 
-61.14269797 -15.20405742  -1.48712073  14.43502548  62.42342866 

Coefficients:
                            Estimate   Std. Error   t value
(Intercept)             113.18405742   3.89777743  29.03810
statusSingle             25.38251392   5.08841085   4.98830
attractionNotInterested -76.49387337   5.06626478 -15.09867
                                      Pr(&gt;|t|)    
(Intercept)             &lt; 0.000000000000000222 ***
statusSingle                      0.0000026725 ***
attractionNotInterested &lt; 0.000000000000000222 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Robust residual standard error: 22.349751 
Multiple R-squared:  0.740716956,   Adjusted R-squared:  0.735370914 
Convergence in 11 IRWLS iterations

Robustness weights: 
 10 weights are ~= 1. The remaining 90 ones are summarized as
       Min.     1st Qu.      Median        Mean     3rd Qu.        Max. 
0.415507115 0.856134372 0.947485761 0.889078637 0.986192098 0.998890516 
Algorithmic parameters: 
           tuning.chi                    bb            tuning.psi 
1.5476399999999999046 0.5000000000000000000 4.6850610000000001421 
           refine.tol               rel.tol             scale.tol 
0.0000001000000000000 0.0000001000000000000 0.0000000001000000000 
            solve.tol           eps.outlier                 eps.x 
0.0000001000000000000 0.0010000000000000000 0.0000000000018189894 
    warn.limit.reject     warn.limit.meanrw 
0.5000000000000000000 0.5000000000000000000 
     nResample         max.it       best.r.s       k.fast.s          k.max 
           500             50              2              1            200 
   maxit.scale      trace.lev            mts     compute.rd fast.s.large.n 
           200              0           1000              0           2000 
                  psi           subsampling                   cov 
           "bisquare"         "nonsingular"         ".vcov.avar1" 
compute.outlier.stats 
                 "SM" 
seed : int(0) </code></pre>
</div>
</div>
<p>The output shows that both status and attraction are significant but, as we have seen above, the effect that really matters is the interaction between status and attraction.</p>
<p>We will briefly check the weights to understand the process of weighing better. The idea of weighing is to downgrade data points that are too influential while not punishing data points that have a good fit and are thus less influential. This means that the problematic data points should have lower weights than other data points (the maximum is 1 - so points can only be made “lighter”).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>hweights <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">status =</span> robustdata<span class="sc">$</span>status, <span class="at">resid =</span> rmodel<span class="sc">$</span>resid, <span class="at">weight =</span> rmodel<span class="sc">$</span>rweights)</span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>hweights2 <span class="ot">&lt;-</span> hweights[<span class="fu">order</span>(rmodel<span class="sc">$</span>rweights), ]</span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>hweights2[<span class="dv">1</span><span class="sc">:</span><span class="dv">15</span>, ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         status          resid         weight
83       Single  62.4234286579 0.415507114929
52       Single -61.1426979713 0.434323488879
88       Single  55.2134286579 0.521220438134
84       Single  55.1234286579 0.522529018160
78       Single  50.1934286579 0.593234264142
65       Single -49.9526979713 0.596626236587
1  Relationship  49.6398159519 0.601024799801
67       Single -48.7926979713 0.612874510784
21 Relationship  45.2098159519 0.661914443015
24 Relationship  44.8698159519 0.666467525203
39 Relationship -43.8940574189 0.679427923638
79       Single  40.8234286579 0.719104302439
58       Single -40.5226979713 0.722893398846
89       Single  39.9734286579 0.729766935693
95       Single  39.8234286579 0.731633318260</code></pre>
</div>
</div>
<p>The values of the weights support our assumption that those data points that were deemed too influential are made <em>lighter</em> as they now only have weights of 0.415507114929 and 0.434323488879 respectively. This was, however, not the focus of this sections as this section merely served to introduce the concept of weights and how they can be used in the context of a robust linear regression.</p>
</section>
<section id="logistic-regression" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="logistic-regression">Logistic Regression</h2>
<p>Logistic regression is a multivariate analysis technique that builds on and is very similar in terms of its implementation to linear regression but logistic regressions take dependent variables that represent nominal rather than numeric scaling <span class="citation" data-cites="harrell2015regression">[<a href="#ref-harrell2015regression" role="doc-biblioref">20</a>]</span>. The difference requires that the linear regression must be modified in certain ways to avoid producing non-sensical outcomes. The most fundamental difference between logistic and linear regressions is that logistic regression work on the probabilities of an outcome (the likelihood), rather than the outcome itself. In addition, the likelihoods on which the logistic regression works must be logged (logarithmized) in order to avoid produce predictions that produce values greater than 1 (instance occurs) and 0 (instance does not occur). You can check this by logging the values from -10 to 10 using the <code>plogis</code> function as shown below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">plogis</span>(<span class="sc">-</span><span class="dv">10</span><span class="sc">:</span><span class="dv">10</span>), <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 0.00005 0.00012 0.00034 0.00091 0.00247 0.00669 0.01799 0.04743 0.11920
[10] 0.26894 0.50000 0.73106 0.88080 0.95257 0.98201 0.99331 0.99753 0.99909
[19] 0.99966 0.99988 0.99995</code></pre>
</div>
</div>
<p>If we visualize these logged values, we get an S-shaped curve which reflects the logistic function.</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="fixreg_files/figure-html/blm0b-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>To understand what this mean, we will use a very simple example. In this example, we want to see whether the height of men affect their likelihood of being in a relationship. The data we use represents a data set consisting of two variables: height and relationship.</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="fixreg_files/figure-html/blm1-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The left panel of the Figure above shows that a linear model would predict values for the relationship status, which represents a factor (0 = Single and 1 = In a Relationship), that are nonsensical because values above 1 or below 0 do not make sense. In contrast to a linear regression, which predicts actual values, such as the frequencies of prepositions in a certain text, a logistic regression predicts <em>probabilities</em> of events (for example, being in a relationship) rather than actual values. The center panel shows the predictions of a logistic regression and we see that a logistic regression also has an intercept and a (very steep) slope but that the regression line also predicts values that are above 1 and below 0. However, when we log the predicted values we these predicted values are transformed into probabilities with values between 0 and 1. And the logged regression line has a S-shape which reflects the logistic function. Furthermore, we can then find the optimal line (the line with the lowest residual deviance) by comparing the sum of residuals - just as we did for a simple linear model and that way, we find the regression line for a logistic regression.</p>
<section id="example-eh-in-kiwi-english" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="example-eh-in-kiwi-english">Example: EH in Kiwi English</h3>
<p>To exemplify how to implement a logistic regression in R <span class="citation" data-cites="agresti1996introduction agresti2011categorical">[see <a href="#ref-agresti1996introduction" role="doc-biblioref">21</a>, <a href="#ref-agresti2011categorical" role="doc-biblioref">22</a>]</span> for very good and thorough introductions to this topic], we will analyze the use of the discourse particle <em>eh</em> in New Zealand English and test which factors correlate with its occurrence. The data set represents speech units in a corpus that were coded for the speaker who uttered a given speech unit, the gender, ethnicity, and age of that speaker and whether or not the speech unit contained an <em>eh</em>. To begin with, we clean the current work space, set option, install and activate relevant packages, load customized functions, and load the example data set.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load data</span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>blrdata  <span class="ot">&lt;-</span> base<span class="sc">::</span><span class="fu">readRDS</span>(<span class="fu">url</span>(<span class="st">"https://slcladal.github.io/data/bld.rda"</span>, <span class="st">"rb"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">

<div class="tabwid"><style>.cl-4fa831da{table-layout:auto;width:75%;}.cl-4fa2c650{font-family:'DejaVu Sans';font-size:12pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-4fa2c66e{font-family:'DejaVu Sans';font-size:12pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-4fa2dc62{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-4fa2dc6c{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-4fa32cee{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-4fa32d02{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-4fa32d03{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-4fa32d0c{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-4fa32d16{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-4fa32d20{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-4fa32d21{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-4fa32d2a{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-4fa32d34{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-4fa32d3e{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-4fa32d3f{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-4fa32d48{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table class="cl-4fa831da">
<caption class="Table Caption">
<p>First 15 rows of the blrdata.</p>
</caption>

<thead><tr style="overflow-wrap:break-word;"><td class="cl-4fa32d3e"><p class="cl-4fa2dc62"><span class="cl-4fa2c650">ID</span></p></td><td class="cl-4fa32d3f"><p class="cl-4fa2dc62"><span class="cl-4fa2c650">Gender</span></p></td><td class="cl-4fa32d3f"><p class="cl-4fa2dc62"><span class="cl-4fa2c650">Age</span></p></td><td class="cl-4fa32d3f"><p class="cl-4fa2dc62"><span class="cl-4fa2c650">Ethnicity</span></p></td><td class="cl-4fa32d48"><p class="cl-4fa2dc6c"><span class="cl-4fa2c650">EH</span></p></td></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-4fa32d03"><p class="cl-4fa2dc62"><span class="cl-4fa2c66e">&lt;S1A-001#M&gt;</span></p></td><td class="cl-4fa32d02"><p class="cl-4fa2dc62"><span class="cl-4fa2c66e">Men</span></p></td><td class="cl-4fa32d02"><p class="cl-4fa2dc62"><span class="cl-4fa2c66e">Young</span></p></td><td class="cl-4fa32d02"><p class="cl-4fa2dc62"><span class="cl-4fa2c66e">Pakeha</span></p></td><td class="cl-4fa32cee"><p class="cl-4fa2dc6c"><span class="cl-4fa2c66e">0</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-4fa32d20"><p class="cl-4fa2dc62"><span class="cl-4fa2c66e">&lt;S1A-001#M&gt;</span></p></td><td class="cl-4fa32d0c"><p class="cl-4fa2dc62"><span class="cl-4fa2c66e">Men</span></p></td><td class="cl-4fa32d0c"><p class="cl-4fa2dc62"><span class="cl-4fa2c66e">Young</span></p></td><td class="cl-4fa32d0c"><p class="cl-4fa2dc62"><span class="cl-4fa2c66e">Pakeha</span></p></td><td class="cl-4fa32d16"><p class="cl-4fa2dc6c"><span class="cl-4fa2c66e">1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-4fa32d03"><p class="cl-4fa2dc62"><span class="cl-4fa2c66e">&lt;S1A-001#M&gt;</span></p></td><td class="cl-4fa32d02"><p class="cl-4fa2dc62"><span class="cl-4fa2c66e">Men</span></p></td><td class="cl-4fa32d02"><p class="cl-4fa2dc62"><span class="cl-4fa2c66e">Young</span></p></td><td class="cl-4fa32d02"><p class="cl-4fa2dc62"><span class="cl-4fa2c66e">Pakeha</span></p></td><td class="cl-4fa32cee"><p class="cl-4fa2dc6c"><span class="cl-4fa2c66e">0</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-4fa32d20"><p class="cl-4fa2dc62"><span class="cl-4fa2c66e">&lt;S1A-001#M&gt;</span></p></td><td class="cl-4fa32d0c"><p class="cl-4fa2dc62"><span class="cl-4fa2c66e">Men</span></p></td><td class="cl-4fa32d0c"><p class="cl-4fa2dc62"><span class="cl-4fa2c66e">Young</span></p></td><td class="cl-4fa32d0c"><p class="cl-4fa2dc62"><span class="cl-4fa2c66e">Pakeha</span></p></td><td class="cl-4fa32d16"><p class="cl-4fa2dc6c"><span class="cl-4fa2c66e">0</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-4fa32d03"><p class="cl-4fa2dc62"><span class="cl-4fa2c66e">&lt;S1A-001#M&gt;</span></p></td><td class="cl-4fa32d02"><p class="cl-4fa2dc62"><span class="cl-4fa2c66e">Men</span></p></td><td class="cl-4fa32d02"><p class="cl-4fa2dc62"><span class="cl-4fa2c66e">Young</span></p></td><td class="cl-4fa32d02"><p class="cl-4fa2dc62"><span class="cl-4fa2c66e">Pakeha</span></p></td><td class="cl-4fa32cee"><p class="cl-4fa2dc6c"><span class="cl-4fa2c66e">1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-4fa32d20"><p class="cl-4fa2dc62"><span class="cl-4fa2c66e">&lt;S1A-001#M&gt;</span></p></td><td class="cl-4fa32d0c"><p class="cl-4fa2dc62"><span class="cl-4fa2c66e">Men</span></p></td><td class="cl-4fa32d0c"><p class="cl-4fa2dc62"><span class="cl-4fa2c66e">Young</span></p></td><td class="cl-4fa32d0c"><p class="cl-4fa2dc62"><span class="cl-4fa2c66e">Pakeha</span></p></td><td class="cl-4fa32d16"><p class="cl-4fa2dc6c"><span class="cl-4fa2c66e">1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-4fa32d03"><p class="cl-4fa2dc62"><span class="cl-4fa2c66e">&lt;S1A-001#M&gt;</span></p></td><td class="cl-4fa32d02"><p class="cl-4fa2dc62"><span class="cl-4fa2c66e">Men</span></p></td><td class="cl-4fa32d02"><p class="cl-4fa2dc62"><span class="cl-4fa2c66e">Young</span></p></td><td class="cl-4fa32d02"><p class="cl-4fa2dc62"><span class="cl-4fa2c66e">Pakeha</span></p></td><td class="cl-4fa32cee"><p class="cl-4fa2dc6c"><span class="cl-4fa2c66e">0</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-4fa32d20"><p class="cl-4fa2dc62"><span class="cl-4fa2c66e">&lt;S1A-001#M&gt;</span></p></td><td class="cl-4fa32d0c"><p class="cl-4fa2dc62"><span class="cl-4fa2c66e">Men</span></p></td><td class="cl-4fa32d0c"><p class="cl-4fa2dc62"><span class="cl-4fa2c66e">Young</span></p></td><td class="cl-4fa32d0c"><p class="cl-4fa2dc62"><span class="cl-4fa2c66e">Pakeha</span></p></td><td class="cl-4fa32d16"><p class="cl-4fa2dc6c"><span class="cl-4fa2c66e">0</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-4fa32d03"><p class="cl-4fa2dc62"><span class="cl-4fa2c66e">&lt;S1A-001#M&gt;</span></p></td><td class="cl-4fa32d02"><p class="cl-4fa2dc62"><span class="cl-4fa2c66e">Men</span></p></td><td class="cl-4fa32d02"><p class="cl-4fa2dc62"><span class="cl-4fa2c66e">Young</span></p></td><td class="cl-4fa32d02"><p class="cl-4fa2dc62"><span class="cl-4fa2c66e">Pakeha</span></p></td><td class="cl-4fa32cee"><p class="cl-4fa2dc6c"><span class="cl-4fa2c66e">0</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-4fa32d20"><p class="cl-4fa2dc62"><span class="cl-4fa2c66e">&lt;S1A-001#M&gt;</span></p></td><td class="cl-4fa32d0c"><p class="cl-4fa2dc62"><span class="cl-4fa2c66e">Men</span></p></td><td class="cl-4fa32d0c"><p class="cl-4fa2dc62"><span class="cl-4fa2c66e">Young</span></p></td><td class="cl-4fa32d0c"><p class="cl-4fa2dc62"><span class="cl-4fa2c66e">Pakeha</span></p></td><td class="cl-4fa32d16"><p class="cl-4fa2dc6c"><span class="cl-4fa2c66e">1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-4fa32d03"><p class="cl-4fa2dc62"><span class="cl-4fa2c66e">&lt;S1A-001#M&gt;</span></p></td><td class="cl-4fa32d02"><p class="cl-4fa2dc62"><span class="cl-4fa2c66e">Men</span></p></td><td class="cl-4fa32d02"><p class="cl-4fa2dc62"><span class="cl-4fa2c66e">Young</span></p></td><td class="cl-4fa32d02"><p class="cl-4fa2dc62"><span class="cl-4fa2c66e">Pakeha</span></p></td><td class="cl-4fa32cee"><p class="cl-4fa2dc6c"><span class="cl-4fa2c66e">0</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-4fa32d20"><p class="cl-4fa2dc62"><span class="cl-4fa2c66e">&lt;S1A-001#M&gt;</span></p></td><td class="cl-4fa32d0c"><p class="cl-4fa2dc62"><span class="cl-4fa2c66e">Men</span></p></td><td class="cl-4fa32d0c"><p class="cl-4fa2dc62"><span class="cl-4fa2c66e">Young</span></p></td><td class="cl-4fa32d0c"><p class="cl-4fa2dc62"><span class="cl-4fa2c66e">Pakeha</span></p></td><td class="cl-4fa32d16"><p class="cl-4fa2dc6c"><span class="cl-4fa2c66e">0</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-4fa32d03"><p class="cl-4fa2dc62"><span class="cl-4fa2c66e">&lt;S1A-001#M&gt;</span></p></td><td class="cl-4fa32d02"><p class="cl-4fa2dc62"><span class="cl-4fa2c66e">Men</span></p></td><td class="cl-4fa32d02"><p class="cl-4fa2dc62"><span class="cl-4fa2c66e">Young</span></p></td><td class="cl-4fa32d02"><p class="cl-4fa2dc62"><span class="cl-4fa2c66e">Pakeha</span></p></td><td class="cl-4fa32cee"><p class="cl-4fa2dc6c"><span class="cl-4fa2c66e">1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-4fa32d20"><p class="cl-4fa2dc62"><span class="cl-4fa2c66e">&lt;S1A-001#M&gt;</span></p></td><td class="cl-4fa32d0c"><p class="cl-4fa2dc62"><span class="cl-4fa2c66e">Men</span></p></td><td class="cl-4fa32d0c"><p class="cl-4fa2dc62"><span class="cl-4fa2c66e">Young</span></p></td><td class="cl-4fa32d0c"><p class="cl-4fa2dc62"><span class="cl-4fa2c66e">Pakeha</span></p></td><td class="cl-4fa32d16"><p class="cl-4fa2dc6c"><span class="cl-4fa2c66e">1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-4fa32d2a"><p class="cl-4fa2dc62"><span class="cl-4fa2c66e">&lt;S1A-001#M&gt;</span></p></td><td class="cl-4fa32d21"><p class="cl-4fa2dc62"><span class="cl-4fa2c66e">Men</span></p></td><td class="cl-4fa32d21"><p class="cl-4fa2dc62"><span class="cl-4fa2c66e">Young</span></p></td><td class="cl-4fa32d21"><p class="cl-4fa2dc62"><span class="cl-4fa2c66e">Pakeha</span></p></td><td class="cl-4fa32d34"><p class="cl-4fa2dc6c"><span class="cl-4fa2c66e">0</span></p></td></tr></tbody></table></div>
</div>
</div>
<p>The summary of the data show that the data set contains 25,821 observations of five variables. The variable <code>ID</code> contains strings that represent a combination file and speaker of a speech unit. The second variable represents the gender, the third the age, and the fourth the ethnicity of speakers. The fifth variable represents whether or not a speech unit contained the discourse particle <em>eh</em>.</p>
<p>Next, we factorize the variables in our data set. In other words, we specify that the strings represent variable levels and define new reference levels because as a default <code>R</code> will use the variable level which first occurs in alphabet ordering as the reference level for each variable, we redefine the variable levels for Age and Ethnicity.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>blrdata <span class="ot">&lt;-</span> blrdata <span class="sc">%&gt;%</span></span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># factorize variables</span></span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">Age =</span> <span class="fu">factor</span>(Age),</span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">Gender =</span> <span class="fu">factor</span>(Gender),</span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">Ethnicity =</span> <span class="fu">factor</span>(Ethnicity),</span>
<span id="cb96-6"><a href="#cb96-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">ID =</span> <span class="fu">factor</span>(ID),</span>
<span id="cb96-7"><a href="#cb96-7" aria-hidden="true" tabindex="-1"></a>                <span class="at">EH =</span> <span class="fu">factor</span>(EH)) <span class="sc">%&gt;%</span></span>
<span id="cb96-8"><a href="#cb96-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># relevel Age (Reference = Young) and Ethnicity (Reference= Pakeha))</span></span>
<span id="cb96-9"><a href="#cb96-9" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">Age =</span> <span class="fu">relevel</span>(Age, <span class="st">"Young"</span>),</span>
<span id="cb96-10"><a href="#cb96-10" aria-hidden="true" tabindex="-1"></a>                <span class="at">Ethnicity =</span> <span class="fu">relevel</span>(Ethnicity, <span class="st">"Pakeha"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>After preparing the data, we will now plot the data to get an overview of potential relationships between variables.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>blrdata <span class="sc">%&gt;%</span></span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">EH =</span> <span class="fu">ifelse</span>(EH <span class="sc">==</span> <span class="st">"0"</span>, <span class="dv">0</span>, <span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(Age, EH, <span class="at">color =</span> Gender)) <span class="sc">+</span></span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Ethnicity) <span class="sc">+</span></span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">"point"</span>) <span class="sc">+</span></span>
<span id="cb97-6"><a href="#cb97-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> mean_cl_boot, <span class="at">geom =</span> <span class="st">"errorbar"</span>, <span class="at">width =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb97-7"><a href="#cb97-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_set</span>(<span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="cb97-8"><a href="#cb97-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>) <span class="sc">+</span></span>
<span id="cb97-9"><a href="#cb97-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="st">"Observed Probabilty of eh"</span>) <span class="sc">+</span></span>
<span id="cb97-10"><a href="#cb97-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"gray20"</span>, <span class="st">"gray70"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="fixreg_files/figure-html/blm6-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>With respect to main effects, the Figure above indicates that men use <em>eh</em> more frequently than women, that young speakers use it more frequently compared with old speakers, and that speakers that are descendants of European settlers (Pakeha) use <em>eh</em> more frequently compared with Maori (the native inhabitants of New Zealand).</p>
<p>The plots in the lower panels do not indicate significant interactions between use of <em>eh</em> and the Age, Gender, and Ethnicity of speakers. In a next step, we will start building the logistic regression model.</p>
</section>
<section id="model-building" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="model-building">Model Building</h3>
<p>As a first step, we need to define contrasts and use the <code>datadist</code> function to store aspects of our variables that can be accessed later when plotting and summarizing the model. Contrasts define what and how variable levels should be compared and therefore influences how the results of the regression analysis are presented. In this case, we use treatment contrasts which are in-built. Treatment contrasts mean that we assess the significance of levels of a predictor against a baseline which is the reference level of a predictor. <span class="citation" data-cites="field2012discovering">[<a href="#ref-field2012discovering" role="doc-biblioref">5</a>]</span> and <span class="citation" data-cites="gries2021statistics">[<a href="#ref-gries2021statistics" role="doc-biblioref">6</a>]</span> provide very good and accessible explanations of contrasts and how to manually define contrasts if you would like to know more.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set contrasts</span></span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">contrasts  =</span><span class="fu">c</span>(<span class="st">"contr.treatment"</span>, <span class="st">"contr.poly"</span>))</span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a><span class="co"># create distance matrix</span></span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a>blrdata.dist <span class="ot">&lt;-</span> <span class="fu">datadist</span>(blrdata)</span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a><span class="co"># include distance matrix in options</span></span>
<span id="cb98-6"><a href="#cb98-6" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">datadist =</span> <span class="st">"blrdata.dist"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Next, we generate a minimal model that predicts the use of <em>eh</em> solely based on the intercept.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="co"># baseline glm model</span></span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>m0.glm <span class="ot">=</span> <span class="fu">glm</span>(EH <span class="sc">~</span> <span class="dv">1</span>, <span class="at">family =</span> binomial, <span class="at">data =</span> blrdata)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="model-fitting" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="model-fitting">Model Fitting</h3>
<p>We will now start with the model fitting procedure. In the present case, we will not use a manual step-wise procedure as above but we will use the the <code>glmulti</code> function from the <code>glmulti</code> package <span class="citation" data-cites="calcagno2020glmulti">[see <a href="#ref-calcagno2020glmulti" role="doc-biblioref">13</a>]</span> to select the best model. The <code>glmulti</code> function computes all possible models (when we choose exhaustive screen by setting the method to <code>"h"</code>) and then reports those models that have the best information criterion values, i.e.&nbsp;values which provide information about the most parsimonious models (models that explain a maxi,um amount of variance with a minimum number of predictors).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>blr.glmulti <span class="ot">&lt;-</span> <span class="fu">glmulti</span>(<span class="at">y =</span> EH <span class="sc">~</span> Gender <span class="sc">+</span> Age <span class="sc">+</span> Ethnicity, <span class="co"># formula</span></span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>                       <span class="at">crit =</span> aicc,                     <span class="co"># information crit. (aic, bic, aicc, qaic, qaicc)</span></span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">data =</span> blrdata,                  <span class="co"># data</span></span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">family =</span> binomial,               <span class="co"># model type</span></span>
<span id="cb100-5"><a href="#cb100-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">method =</span> <span class="st">"h"</span>,                    <span class="co"># screening type</span></span>
<span id="cb100-6"><a href="#cb100-6" aria-hidden="true" tabindex="-1"></a>                       <span class="at">fitfunc =</span> glm,                   <span class="co"># fit function</span></span>
<span id="cb100-7"><a href="#cb100-7" aria-hidden="true" tabindex="-1"></a>                       <span class="at">level =</span> <span class="dv">2</span>)                       <span class="co"># 2 = with intercations (1 = without)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Initialization...
TASK: Exhaustive screening of candidate set.
Fitting...
Completed.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect</span></span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(blr.glmulti)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>glmulti.analysis
Method: h / Fitting: glm / IC used: aicc
Level: 2 / Marginality: FALSE
From 18 models:
Best IC: 32145.5418216606
Best model:
[1] "EH ~ 1 + Gender + Age"
Evidence weight: 0.293712170021837
Worst IC: 33009.7548480748
4 models within 2 IC units.
7 models to reach 95% of evidence weight.</code></pre>
</div>
</div>
<p>As the results inform us that there are 4 additional models that perform similarly well (<code>4 models within 2 IC units.</code>) we inspect these 4 models.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="fu">weightable</span>(blr.glmulti)[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>,] <span class="sc">%&gt;%</span></span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">regulartable</span>() <span class="sc">%&gt;%</span></span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autofit</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div class="tabwid"><style>.cl-5124f3a4{}.cl-512243ca{font-family:'DejaVu Sans';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-51224c3a{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-51224c44{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-512262ce{width:307pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-512262d8{width:115pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-512262d9{width:111.5pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-512262da{width:111.5pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-512262e2{width:307pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-512262ec{width:115pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-512262ed{width:111.5pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 2pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-512262f6{width:307pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 2pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-512262f7{width:115pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 2pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table class="cl-5124f3a4">
<thead><tr style="overflow-wrap:break-word;"><td class="cl-512262f6"><p class="cl-51224c3a"><span class="cl-512243ca">model</span></p></td><td class="cl-512262ed"><p class="cl-51224c44"><span class="cl-512243ca">aicc</span></p></td><td class="cl-512262f7"><p class="cl-51224c44"><span class="cl-512243ca">weights</span></p></td></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-512262ce"><p class="cl-51224c3a"><span class="cl-512243ca">EH ~ 1 + Gender + Age</span></p></td><td class="cl-512262d9"><p class="cl-51224c44"><span class="cl-512243ca">32,145.5418217</span></p></td><td class="cl-512262d8"><p class="cl-51224c44"><span class="cl-512243ca">0.293712170022</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-512262ce"><p class="cl-51224c3a"><span class="cl-512243ca">EH ~ 1 + Gender + Age + Ethnicity + Ethnicity:Age</span></p></td><td class="cl-512262d9"><p class="cl-51224c44"><span class="cl-512243ca">32,146.4745618</span></p></td><td class="cl-512262d8"><p class="cl-51224c44"><span class="cl-512243ca">0.184238336451</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-512262ce"><p class="cl-51224c3a"><span class="cl-512243ca">EH ~ 1 + Gender + Age + Ethnicity</span></p></td><td class="cl-512262d9"><p class="cl-51224c44"><span class="cl-512243ca">32,147.2814269</span></p></td><td class="cl-512262d8"><p class="cl-51224c44"><span class="cl-512243ca">0.123075457179</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-512262e2"><p class="cl-51224c3a"><span class="cl-512243ca">EH ~ 1 + Gender + Age + Age:Gender</span></p></td><td class="cl-512262da"><p class="cl-51224c44"><span class="cl-512243ca">32,147.4182015</span></p></td><td class="cl-512262ec"><p class="cl-51224c44"><span class="cl-512243ca">0.114940009116</span></p></td></tr></tbody></table></div>
</div>
</div>
<p>The results show that a model with only <em>Gender</em> and <em>Age</em> is the most parsimonious model and we decide to consider this model our final minimal adequate model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="co"># baseline glm model</span></span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>lr.glm <span class="ot">&lt;-</span> <span class="fu">glm</span>(EH <span class="sc">~</span> Age <span class="sc">+</span> Gender, <span class="at">family =</span> binomial, <span class="at">data =</span> blrdata)</span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a>lr.lrm <span class="ot">&lt;-</span> <span class="fu">lrm</span>(EH <span class="sc">~</span> Age <span class="sc">+</span> Gender, <span class="at">data =</span> blrdata, <span class="at">x =</span> T, <span class="at">y =</span> T, <span class="at">linear.predictors =</span> T)</span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect</span></span>
<span id="cb105-5"><a href="#cb105-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lr.glm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = EH ~ Age + Gender, family = binomial, data = blrdata)

Deviance Residuals: 
         Min            1Q        Median            3Q           Max  
-1.080454338  -0.915641628  -0.770357585   1.277555296   1.837151604  

Coefficients:
                 Estimate    Std. Error   z value               Pr(&gt;|z|)    
(Intercept) -0.2323829796  0.0222629000 -10.43813 &lt; 0.000000000000000222 ***
AgeOld      -0.8305365551  0.0335166085 -24.77985 &lt; 0.000000000000000222 ***
GenderWomen -0.4201134305  0.0272517594 -15.41601 &lt; 0.000000000000000222 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 33007.75469  on 25820  degrees of freedom
Residual deviance: 32139.54089  on 25818  degrees of freedom
AIC: 32145.54089

Number of Fisher Scoring iterations: 4</code></pre>
</div>
</div>
</section>
<section id="model-diagnostics" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="model-diagnostics">Model Diagnostics</h3>
<p>We will now check for incomplete information, complete separation, and (multi-)collinearity.</p>
<p><strong>Incomplete information</strong> means that the data does not contain all combinations of the predictor or the dependent variable. This is important because if the data does not contain cases of all combinations, it will be unable to provide accurate results.</p>
<p><strong>Complete separation</strong> is a related phenomenon where a model will assume that it has found a perfect predictor (because one level of a predictor correlates purely with hits or with fails but not both hits and fails of the dependent variable). In such cases the model overestimates the effect of that predictor and the results of that model are no longer reliable. For example, if <em>eh</em> was only used by young speakers in the data, the model would jump on that fact and say:</p>
<blockquote class="blockquote">
<p>Ha! If there is an old speaker, that means that that speaker will never ever and under no circumstances say <em>eh</em> - I can therefore ignore all other factors!</p>
</blockquote>
<p><strong>Multicollinearity</strong> means that predictors in a model can be predicted by other predictors in the model (this means that they <em>share</em> variance with other predictors). If this is the case, the model results are unreliable because the presence of absence of one predictor has substantive effects on at least one other predictor.</p>
<p>To check whether the final minimal model contains predictors that correlate with each other, we extract variance inflation factors (VIF). If a model contains predictors that have variance inflation factors (VIF) &gt; 10 the model is unreliable <span class="citation" data-cites="myers1990classical">[<a href="#ref-myers1990classical" role="doc-biblioref">15</a>]</span>. <span class="citation" data-cites="gries2021statistics">[<a href="#ref-gries2021statistics" role="doc-biblioref">6</a>]</span> shows that a VIF of 10 means that that predictor is explainable (predictable) from the other predictors in the model with an R<sup>2</sup> of .9 (a VIF of 5 means that predictor is explainable (predictable) from the other predictors in the model with an R<sup>2</sup> of .8).Indeed, predictors with VIF values greater than 4 are usually already problematic but, for large data sets, even VIFs greater than 2 can lead inflated standard errors (<a href="http://wiki.bcs.rochester.edu/HlpLab/LSA2013Regression?action=AttachFile&amp;do=view&amp;target=LSA13-Lecture6-CommonIssuesAndSolutions.pdf">Jaeger 2013</a>). Also, VIFs of 2.5 can be problematic <span class="citation" data-cites="szmrecsanyi2006morphosyntactic">[<a href="#ref-szmrecsanyi2006morphosyntactic" role="doc-biblioref">14</a>]</span> and <span class="citation" data-cites="zuur2010protocol">[<a href="#ref-zuur2010protocol" role="doc-biblioref">16</a>]</span> proposes that variables with VIFs exceeding 3 should be removed.</p>
<div class="warning" style="padding:0.1em; background-color:#f2f2f2; color:#51247a">
<span>
<p style="margin-top:1em; text-align:center">
<b>NOTE</b><br><br>However, (multi-)collinearity is only an issue if one is interested in interpreting regression results! If the interpretation is irrelevant because what is relevant is prediction(!), then it does not matter if the model contains collinear predictors! See <span class="citation" data-cites="gries2021statistics">[<a href="#ref-gries2021statistics" role="doc-biblioref">6</a>]</span> or the excursion below for a more elaborate explanation.
</p>
<p style="margin-left:1em;">
</p>
<p></p>
</span></div>
<p><br></p>
<hr>
<div class="warning" style="padding:0.1em; background-color:#f2f2f2; color:#51247a">
<span>
<p style="margin-top:1em; text-align:center">
<b>EXCURSION</b>
</p>
<p style="margin-left:1em;">
</p>
<p></p>
</span></div>
<div class="question">
<p>`</p>
<p>What is multicollinearity?<br></p>
<details>
<summary>
Answer
</summary>
<p><br></p>
<p>During the workshop on mixed-effects modeling, we talked about (multi-)collinearity and someone asked if collinearity reflected shared variance (what I thought) or predictability of variables (what the other person thought). Both answers are correct! We will see below why…</p>
<hr>
<div class="warning" style="padding:0.1em; background-color:#f2f2f2; color:#51247a">
<span>
<p style="margin-top:1em; text-align:center">
(Multi-)collinearity reflects the predictability of predictors based on the values of other predictors!
</p>
</span>
</div>
<hr>
<p>To test this, I generate a data set with 4 independent variables <code>a</code>, <code>b</code>, <code>c</code>, and <code>d</code> as well as two potential response variables <code>r1</code> (which is random) and <code>r2</code> (where the first 50 data points are the same as in <code>r1</code> but for the second 50 data points I have added a value of 50 to the data points 51 to 100 from <code>r1</code>). This means that the predictors <code>a</code> and <code>d</code> should both strongly correlate with <code>r2</code>.</p>
<p>::: {.cell}</p>
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>  <span class="co"># load packages</span></span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(dplyr)</span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(rms)</span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># create data set</span></span>
<span id="cb107-5"><a href="#cb107-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># responses</span></span>
<span id="cb107-6"><a href="#cb107-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 100 random numbers</span></span>
<span id="cb107-7"><a href="#cb107-7" aria-hidden="true" tabindex="-1"></a>  r1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="dv">50</span>, <span class="dv">10</span>)</span>
<span id="cb107-8"><a href="#cb107-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 50 smaller + 50 larger numbers</span></span>
<span id="cb107-9"><a href="#cb107-9" aria-hidden="true" tabindex="-1"></a>  r2 <span class="ot">&lt;-</span> <span class="fu">c</span>(r1[<span class="dv">1</span><span class="sc">:</span><span class="dv">50</span>], r1[<span class="dv">51</span><span class="sc">:</span><span class="dv">100</span>] <span class="sc">+</span> <span class="dv">50</span>)</span>
<span id="cb107-10"><a href="#cb107-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># predictors</span></span>
<span id="cb107-11"><a href="#cb107-11" aria-hidden="true" tabindex="-1"></a>  a <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"1"</span>, <span class="dv">50</span>), <span class="fu">rep</span> (<span class="st">"0"</span>, <span class="dv">50</span>))</span>
<span id="cb107-12"><a href="#cb107-12" aria-hidden="true" tabindex="-1"></a>  b <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"1"</span>, <span class="dv">25</span>), <span class="fu">rep</span> (<span class="st">"0"</span>, <span class="dv">25</span>)), <span class="dv">2</span>)</span>
<span id="cb107-13"><a href="#cb107-13" aria-hidden="true" tabindex="-1"></a>  c <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"1"</span>, <span class="dv">10</span>), <span class="fu">rep</span>(<span class="st">"0"</span>, <span class="dv">10</span>)), <span class="dv">5</span>)</span>
<span id="cb107-14"><a href="#cb107-14" aria-hidden="true" tabindex="-1"></a>  d <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"1"</span>, <span class="dv">47</span>), <span class="fu">rep</span> (<span class="st">"0"</span>, <span class="dv">3</span>), <span class="fu">rep</span> (<span class="st">"0"</span>, <span class="dv">47</span>), <span class="fu">rep</span> (<span class="st">"1"</span>, <span class="dv">3</span>))</span>
<span id="cb107-15"><a href="#cb107-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># create data set</span></span>
<span id="cb107-16"><a href="#cb107-16" aria-hidden="true" tabindex="-1"></a>  df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(r1, r2, a, b, c, d)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>:::</p>
<p>::: {.cell} ::: {.cell-output-display}</p>

  <div class="tabwid"><style>.cl-513f9100{table-layout:auto;width:75%;}.cl-513bcbf6{font-family:'DejaVu Sans';font-size:12pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-513bcc00{font-family:'DejaVu Sans';font-size:12pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-513bd524{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-513bd525{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-513bf0d6{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-513bf0e0{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-513bf0e1{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-513bf0ea{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-513bf0eb{background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-513bf0ec{background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-513bf0f4{background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-513bf0f5{background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-513bf0f6{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-513bf0fe{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-513bf0ff{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-513bf100{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-513bf108{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-513bf109{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-513bf10a{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-513bf10b{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table class="cl-513f9100">
<caption class="Table Caption">
<p>First 10 rows of the mlrdata.</p>
</caption>

  <thead><tr style="overflow-wrap:break-word;"><td class="cl-513bf10b"><p class="cl-513bd524"><span class="cl-513bcbf6">r1</span></p></td><td class="cl-513bf109"><p class="cl-513bd524"><span class="cl-513bcbf6">r2</span></p></td><td class="cl-513bf108"><p class="cl-513bd525"><span class="cl-513bcbf6">a</span></p></td><td class="cl-513bf108"><p class="cl-513bd525"><span class="cl-513bcbf6">b</span></p></td><td class="cl-513bf108"><p class="cl-513bd525"><span class="cl-513bcbf6">c</span></p></td><td class="cl-513bf10a"><p class="cl-513bd525"><span class="cl-513bcbf6">d</span></p></td></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-513bf0e0"><p class="cl-513bd524"><span class="cl-513bcc00">55.3805120133</span></p></td><td class="cl-513bf0d6"><p class="cl-513bd524"><span class="cl-513bcc00">55.3805120133</span></p></td><td class="cl-513bf0ea"><p class="cl-513bd525"><span class="cl-513bcc00">1</span></p></td><td class="cl-513bf0ea"><p class="cl-513bd525"><span class="cl-513bcc00">1</span></p></td><td class="cl-513bf0ea"><p class="cl-513bd525"><span class="cl-513bcc00">1</span></p></td><td class="cl-513bf0e1"><p class="cl-513bd525"><span class="cl-513bcc00">1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-513bf0fe"><p class="cl-513bd524"><span class="cl-513bcc00">50.5169933942</span></p></td><td class="cl-513bf100"><p class="cl-513bd524"><span class="cl-513bcc00">50.5169933942</span></p></td><td class="cl-513bf0f6"><p class="cl-513bd525"><span class="cl-513bcc00">1</span></p></td><td class="cl-513bf0f6"><p class="cl-513bd525"><span class="cl-513bcc00">1</span></p></td><td class="cl-513bf0f6"><p class="cl-513bd525"><span class="cl-513bcc00">1</span></p></td><td class="cl-513bf0ff"><p class="cl-513bd525"><span class="cl-513bcc00">1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-513bf0e0"><p class="cl-513bd524"><span class="cl-513bcc00">67.5135734932</span></p></td><td class="cl-513bf0d6"><p class="cl-513bd524"><span class="cl-513bcc00">67.5135734932</span></p></td><td class="cl-513bf0ea"><p class="cl-513bd525"><span class="cl-513bcc00">1</span></p></td><td class="cl-513bf0ea"><p class="cl-513bd525"><span class="cl-513bcc00">1</span></p></td><td class="cl-513bf0ea"><p class="cl-513bd525"><span class="cl-513bcc00">1</span></p></td><td class="cl-513bf0e1"><p class="cl-513bd525"><span class="cl-513bcc00">1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-513bf0fe"><p class="cl-513bd524"><span class="cl-513bcc00">60.1733973728</span></p></td><td class="cl-513bf100"><p class="cl-513bd524"><span class="cl-513bcc00">60.1733973728</span></p></td><td class="cl-513bf0f6"><p class="cl-513bd525"><span class="cl-513bcc00">1</span></p></td><td class="cl-513bf0f6"><p class="cl-513bd525"><span class="cl-513bcc00">1</span></p></td><td class="cl-513bf0f6"><p class="cl-513bd525"><span class="cl-513bcc00">1</span></p></td><td class="cl-513bf0ff"><p class="cl-513bd525"><span class="cl-513bcc00">1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-513bf0e0"><p class="cl-513bd524"><span class="cl-513bcc00">72.3678161278</span></p></td><td class="cl-513bf0d6"><p class="cl-513bd524"><span class="cl-513bcc00">72.3678161278</span></p></td><td class="cl-513bf0ea"><p class="cl-513bd525"><span class="cl-513bcc00">1</span></p></td><td class="cl-513bf0ea"><p class="cl-513bd525"><span class="cl-513bcc00">1</span></p></td><td class="cl-513bf0ea"><p class="cl-513bd525"><span class="cl-513bcc00">1</span></p></td><td class="cl-513bf0e1"><p class="cl-513bd525"><span class="cl-513bcc00">1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-513bf0fe"><p class="cl-513bd524"><span class="cl-513bcc00">52.4309002788</span></p></td><td class="cl-513bf100"><p class="cl-513bd524"><span class="cl-513bcc00">52.4309002788</span></p></td><td class="cl-513bf0f6"><p class="cl-513bd525"><span class="cl-513bcc00">1</span></p></td><td class="cl-513bf0f6"><p class="cl-513bd525"><span class="cl-513bcc00">1</span></p></td><td class="cl-513bf0f6"><p class="cl-513bd525"><span class="cl-513bcc00">1</span></p></td><td class="cl-513bf0ff"><p class="cl-513bd525"><span class="cl-513bcc00">1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-513bf0e0"><p class="cl-513bd524"><span class="cl-513bcc00">55.6904236277</span></p></td><td class="cl-513bf0d6"><p class="cl-513bd524"><span class="cl-513bcc00">55.6904236277</span></p></td><td class="cl-513bf0ea"><p class="cl-513bd525"><span class="cl-513bcc00">1</span></p></td><td class="cl-513bf0ea"><p class="cl-513bd525"><span class="cl-513bcc00">1</span></p></td><td class="cl-513bf0ea"><p class="cl-513bd525"><span class="cl-513bcc00">1</span></p></td><td class="cl-513bf0e1"><p class="cl-513bd525"><span class="cl-513bcc00">1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-513bf0fe"><p class="cl-513bd524"><span class="cl-513bcc00">44.2366484882</span></p></td><td class="cl-513bf100"><p class="cl-513bd524"><span class="cl-513bcc00">44.2366484882</span></p></td><td class="cl-513bf0f6"><p class="cl-513bd525"><span class="cl-513bcc00">1</span></p></td><td class="cl-513bf0f6"><p class="cl-513bd525"><span class="cl-513bcc00">1</span></p></td><td class="cl-513bf0f6"><p class="cl-513bd525"><span class="cl-513bcc00">1</span></p></td><td class="cl-513bf0ff"><p class="cl-513bd525"><span class="cl-513bcc00">1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-513bf0e0"><p class="cl-513bd524"><span class="cl-513bcc00">55.5987335816</span></p></td><td class="cl-513bf0d6"><p class="cl-513bd524"><span class="cl-513bcc00">55.5987335816</span></p></td><td class="cl-513bf0ea"><p class="cl-513bd525"><span class="cl-513bcc00">1</span></p></td><td class="cl-513bf0ea"><p class="cl-513bd525"><span class="cl-513bcc00">1</span></p></td><td class="cl-513bf0ea"><p class="cl-513bd525"><span class="cl-513bcc00">1</span></p></td><td class="cl-513bf0e1"><p class="cl-513bd525"><span class="cl-513bcc00">1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-513bf0ec"><p class="cl-513bd524"><span class="cl-513bcc00">58.3120761737</span></p></td><td class="cl-513bf0eb"><p class="cl-513bd524"><span class="cl-513bcc00">58.3120761737</span></p></td><td class="cl-513bf0f4"><p class="cl-513bd525"><span class="cl-513bcc00">1</span></p></td><td class="cl-513bf0f4"><p class="cl-513bd525"><span class="cl-513bcc00">1</span></p></td><td class="cl-513bf0f4"><p class="cl-513bd525"><span class="cl-513bcc00">1</span></p></td><td class="cl-513bf0f5"><p class="cl-513bd525"><span class="cl-513bcc00">1</span></p></td></tr></tbody></table></div>
<p>::: :::</p>
<p>Here are the visualizations of r1 and r2</p>
<p>::: {.cell} ::: {.cell-output-display} <img src="fixreg_files/figure-html/data2-1.png" class="img-fluid" width="672"> :::</p>
<p>::: {.cell-output-display} <img src="fixreg_files/figure-html/data2-2.png" class="img-fluid" width="672"> ::: :::</p>
<p><strong>Fit first model</strong></p>
<p>Now, I fit a first model. As the response is random, we do not expect any of the predictors to have a significant effect and we expect the R<sup>2</sup> to be rather low.</p>
<p>::: {.cell}</p>
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>  m1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(r1 <span class="sc">~</span> a <span class="sc">+</span> b <span class="sc">+</span> c <span class="sc">+</span> d, <span class="at">data =</span> df)</span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># inspect model</span></span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>(m1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>::: {.cell-output .cell-output-stdout} ```</p>
<p>Call: lm(formula = r1 ~ a + b + c + d, data = df)</p>
<p>Residuals: Min 1Q Median 3Q Max -25.076373713 -7.774694324 0.933388851 6.630369791 22.021652947</p>
<p>Coefficients: Estimate Std. Error t value Pr(&gt;|t|)<br>
(Intercept) 46.077236782 2.059313248 22.37505 &lt; 0.0000000000000002 **<em> a1 5.957479586 4.593681927 1.29689 0.197812<br>
b1 5.148440925 2.098541787 2.45334 0.015977 </em><br>
c1 -0.213502165 2.188893729 -0.09754 0.922504<br>
d1 -5.232737413 4.515342995 -1.15888 0.249410<br>
— Signif. codes: 0 ‘<em><strong>’ 0.001 ’</strong>’ 0.01 ’</em>’ 0.05 ‘.’ 0.1 ’ ’ 1</p>
<p>Residual standard error: 10.4927089 on 95 degrees of freedom Multiple R-squared: 0.075627922, Adjusted R-squared: 0.0367069924 F-statistic: 1.94311705 on 4 and 95 DF, p-value: 0.109586389 ``` ::: :::</p>
<p>We now check for (multi-)collinearity using the <code>vif</code> function from the <code>rms</code> package <span class="citation" data-cites="rms">[<a href="#ref-rms" role="doc-biblioref">23</a>]</span>. Variables <code>a</code> and <code>d</code> should have high variance inflation factor values (vif-values) because they overlap very much!</p>
<p>::: {.cell}</p>
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>  <span class="co"># extract vifs</span></span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a>  rms<span class="sc">::</span><span class="fu">vif</span>(m1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>::: {.cell-output .cell-output-stdout} <code>a1            b1            c1            d1    4.79166666667 1.00000000000 1.08796296296 4.62962962963</code> ::: :::</p>
<p>Variables <code>a</code> and <code>d</code> do indeed have high vif-values.</p>
<p><strong>Fit second model</strong></p>
<p>We now fit a second model to the response which has higher values for the latter part of the response. Both <code>a</code> and <code>d</code> strongly correlate with the response. <strong>But</strong> because <code>a</code> and <code>d</code> are collinear, <code>d</code> should not be reported as being significant by the model. The R<sup>2</sup> of the model should be rather high (given the correlation between the response r2 and <code>a</code> and <code>d</code>).</p>
<p>::: {.cell}</p>
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a>  m2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(r2 <span class="sc">~</span> a <span class="sc">+</span> b <span class="sc">+</span> c <span class="sc">+</span> d, <span class="at">data =</span> df)</span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># inspect model</span></span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>(m2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>::: {.cell-output .cell-output-stdout} ```</p>
<p>Call: lm(formula = r2 ~ a + b + c + d, data = df)</p>
<p>Residuals: Min 1Q Median 3Q Max -25.076373713 -7.774694324 0.933388851 6.630369791 22.021652947</p>
<p>Coefficients: Estimate Std. Error t value Pr(&gt;|t|)<br>
(Intercept) 96.077236782 2.059313248 46.65499 &lt; 0.000000000000000222 <strong><em> a1 -44.042520414 4.593681927 -9.58763 0.0000000000000012574 </em></strong> b1 5.148440925 2.098541787 2.45334 0.015977 *<br>
c1 -0.213502165 2.188893729 -0.09754 0.922504<br>
d1 -5.232737413 4.515342995 -1.15888 0.249410<br>
— Signif. codes: 0 ‘<em><strong>’ 0.001 ’</strong>’ 0.01 ’</em>’ 0.05 ‘.’ 0.1 ’ ’ 1</p>
<p>Residual standard error: 10.4927089 on 95 degrees of freedom Multiple R-squared: 0.851726565, Adjusted R-squared: 0.845483473 F-statistic: 136.427041 on 4 and 95 DF, p-value: &lt; 0.0000000000000002220446 ``` ::: :::</p>
<p>Again, we extract the vif-values.</p>
<p>::: {.cell}</p>
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a>  <span class="co"># extract vifs</span></span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a>  rms<span class="sc">::</span><span class="fu">vif</span>(m2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>::: {.cell-output .cell-output-stdout} <code>a1            b1            c1            d1    4.79166666667 1.00000000000 1.08796296296 4.62962962963</code> ::: :::</p>
<p>The vif-values are identical which shows that what matters is if the variables are predictable. To understand how we arrive at vif-values, we inspect the model matrix.</p>
<p>::: {.cell}</p>
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>  <span class="co"># inspect model matrix</span></span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>  mm <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(m2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>:::</p>
<p>::: {.cell} ::: {.cell-output-display}</p>

  <div class="tabwid"><style>.cl-5162d2a0{table-layout:auto;width:75%;}.cl-515e8e66{font-family:'DejaVu Sans';font-size:12pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-515e8e70{font-family:'DejaVu Sans';font-size:12pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-515e9d20{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-515ed60a{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-515ed614{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-515ed615{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-515ed616{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-515ed61e{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-515ed61f{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-515ed628{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-515ed629{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-515ed632{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-515ed633{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-515ed634{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-515ed63c{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table class="cl-5162d2a0">
<caption class="Table Caption">
<p>First 10 rows of the mlrdata.</p>
</caption>

  <thead><tr style="overflow-wrap:break-word;"><td class="cl-515ed633"><p class="cl-515e9d20"><span class="cl-515e8e66">(Intercept)</span></p></td><td class="cl-515ed634"><p class="cl-515e9d20"><span class="cl-515e8e66">a1</span></p></td><td class="cl-515ed634"><p class="cl-515e9d20"><span class="cl-515e8e66">b1</span></p></td><td class="cl-515ed634"><p class="cl-515e9d20"><span class="cl-515e8e66">c1</span></p></td><td class="cl-515ed63c"><p class="cl-515e9d20"><span class="cl-515e8e66">d1</span></p></td></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-515ed615"><p class="cl-515e9d20"><span class="cl-515e8e70">1</span></p></td><td class="cl-515ed60a"><p class="cl-515e9d20"><span class="cl-515e8e70">1</span></p></td><td class="cl-515ed60a"><p class="cl-515e9d20"><span class="cl-515e8e70">1</span></p></td><td class="cl-515ed60a"><p class="cl-515e9d20"><span class="cl-515e8e70">1</span></p></td><td class="cl-515ed614"><p class="cl-515e9d20"><span class="cl-515e8e70">1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-515ed61f"><p class="cl-515e9d20"><span class="cl-515e8e70">1</span></p></td><td class="cl-515ed616"><p class="cl-515e9d20"><span class="cl-515e8e70">1</span></p></td><td class="cl-515ed616"><p class="cl-515e9d20"><span class="cl-515e8e70">1</span></p></td><td class="cl-515ed616"><p class="cl-515e9d20"><span class="cl-515e8e70">1</span></p></td><td class="cl-515ed61e"><p class="cl-515e9d20"><span class="cl-515e8e70">1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-515ed615"><p class="cl-515e9d20"><span class="cl-515e8e70">1</span></p></td><td class="cl-515ed60a"><p class="cl-515e9d20"><span class="cl-515e8e70">1</span></p></td><td class="cl-515ed60a"><p class="cl-515e9d20"><span class="cl-515e8e70">1</span></p></td><td class="cl-515ed60a"><p class="cl-515e9d20"><span class="cl-515e8e70">1</span></p></td><td class="cl-515ed614"><p class="cl-515e9d20"><span class="cl-515e8e70">1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-515ed61f"><p class="cl-515e9d20"><span class="cl-515e8e70">1</span></p></td><td class="cl-515ed616"><p class="cl-515e9d20"><span class="cl-515e8e70">1</span></p></td><td class="cl-515ed616"><p class="cl-515e9d20"><span class="cl-515e8e70">1</span></p></td><td class="cl-515ed616"><p class="cl-515e9d20"><span class="cl-515e8e70">1</span></p></td><td class="cl-515ed61e"><p class="cl-515e9d20"><span class="cl-515e8e70">1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-515ed615"><p class="cl-515e9d20"><span class="cl-515e8e70">1</span></p></td><td class="cl-515ed60a"><p class="cl-515e9d20"><span class="cl-515e8e70">1</span></p></td><td class="cl-515ed60a"><p class="cl-515e9d20"><span class="cl-515e8e70">1</span></p></td><td class="cl-515ed60a"><p class="cl-515e9d20"><span class="cl-515e8e70">1</span></p></td><td class="cl-515ed614"><p class="cl-515e9d20"><span class="cl-515e8e70">1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-515ed61f"><p class="cl-515e9d20"><span class="cl-515e8e70">1</span></p></td><td class="cl-515ed616"><p class="cl-515e9d20"><span class="cl-515e8e70">1</span></p></td><td class="cl-515ed616"><p class="cl-515e9d20"><span class="cl-515e8e70">1</span></p></td><td class="cl-515ed616"><p class="cl-515e9d20"><span class="cl-515e8e70">1</span></p></td><td class="cl-515ed61e"><p class="cl-515e9d20"><span class="cl-515e8e70">1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-515ed615"><p class="cl-515e9d20"><span class="cl-515e8e70">1</span></p></td><td class="cl-515ed60a"><p class="cl-515e9d20"><span class="cl-515e8e70">1</span></p></td><td class="cl-515ed60a"><p class="cl-515e9d20"><span class="cl-515e8e70">1</span></p></td><td class="cl-515ed60a"><p class="cl-515e9d20"><span class="cl-515e8e70">1</span></p></td><td class="cl-515ed614"><p class="cl-515e9d20"><span class="cl-515e8e70">1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-515ed61f"><p class="cl-515e9d20"><span class="cl-515e8e70">1</span></p></td><td class="cl-515ed616"><p class="cl-515e9d20"><span class="cl-515e8e70">1</span></p></td><td class="cl-515ed616"><p class="cl-515e9d20"><span class="cl-515e8e70">1</span></p></td><td class="cl-515ed616"><p class="cl-515e9d20"><span class="cl-515e8e70">1</span></p></td><td class="cl-515ed61e"><p class="cl-515e9d20"><span class="cl-515e8e70">1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-515ed615"><p class="cl-515e9d20"><span class="cl-515e8e70">1</span></p></td><td class="cl-515ed60a"><p class="cl-515e9d20"><span class="cl-515e8e70">1</span></p></td><td class="cl-515ed60a"><p class="cl-515e9d20"><span class="cl-515e8e70">1</span></p></td><td class="cl-515ed60a"><p class="cl-515e9d20"><span class="cl-515e8e70">1</span></p></td><td class="cl-515ed614"><p class="cl-515e9d20"><span class="cl-515e8e70">1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-515ed61f"><p class="cl-515e9d20"><span class="cl-515e8e70">1</span></p></td><td class="cl-515ed616"><p class="cl-515e9d20"><span class="cl-515e8e70">1</span></p></td><td class="cl-515ed616"><p class="cl-515e9d20"><span class="cl-515e8e70">1</span></p></td><td class="cl-515ed616"><p class="cl-515e9d20"><span class="cl-515e8e70">1</span></p></td><td class="cl-515ed61e"><p class="cl-515e9d20"><span class="cl-515e8e70">1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-515ed615"><p class="cl-515e9d20"><span class="cl-515e8e70">1</span></p></td><td class="cl-515ed60a"><p class="cl-515e9d20"><span class="cl-515e8e70">1</span></p></td><td class="cl-515ed60a"><p class="cl-515e9d20"><span class="cl-515e8e70">1</span></p></td><td class="cl-515ed60a"><p class="cl-515e9d20"><span class="cl-515e8e70">0</span></p></td><td class="cl-515ed614"><p class="cl-515e9d20"><span class="cl-515e8e70">1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-515ed61f"><p class="cl-515e9d20"><span class="cl-515e8e70">1</span></p></td><td class="cl-515ed616"><p class="cl-515e9d20"><span class="cl-515e8e70">1</span></p></td><td class="cl-515ed616"><p class="cl-515e9d20"><span class="cl-515e8e70">1</span></p></td><td class="cl-515ed616"><p class="cl-515e9d20"><span class="cl-515e8e70">0</span></p></td><td class="cl-515ed61e"><p class="cl-515e9d20"><span class="cl-515e8e70">1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-515ed615"><p class="cl-515e9d20"><span class="cl-515e8e70">1</span></p></td><td class="cl-515ed60a"><p class="cl-515e9d20"><span class="cl-515e8e70">1</span></p></td><td class="cl-515ed60a"><p class="cl-515e9d20"><span class="cl-515e8e70">1</span></p></td><td class="cl-515ed60a"><p class="cl-515e9d20"><span class="cl-515e8e70">0</span></p></td><td class="cl-515ed614"><p class="cl-515e9d20"><span class="cl-515e8e70">1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-515ed61f"><p class="cl-515e9d20"><span class="cl-515e8e70">1</span></p></td><td class="cl-515ed616"><p class="cl-515e9d20"><span class="cl-515e8e70">1</span></p></td><td class="cl-515ed616"><p class="cl-515e9d20"><span class="cl-515e8e70">1</span></p></td><td class="cl-515ed616"><p class="cl-515e9d20"><span class="cl-515e8e70">0</span></p></td><td class="cl-515ed61e"><p class="cl-515e9d20"><span class="cl-515e8e70">1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-515ed628"><p class="cl-515e9d20"><span class="cl-515e8e70">1</span></p></td><td class="cl-515ed629"><p class="cl-515e9d20"><span class="cl-515e8e70">1</span></p></td><td class="cl-515ed629"><p class="cl-515e9d20"><span class="cl-515e8e70">1</span></p></td><td class="cl-515ed629"><p class="cl-515e9d20"><span class="cl-515e8e70">0</span></p></td><td class="cl-515ed632"><p class="cl-515e9d20"><span class="cl-515e8e70">1</span></p></td></tr></tbody></table></div>
<p>::: :::</p>
<p>We now fit a linear model in which we predict <code>d</code> from the other predictors in the model matrix.</p>
<p>::: {.cell}</p>
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a>  mt <span class="ot">&lt;-</span> <span class="fu">lm</span>(mm[,<span class="dv">5</span>] <span class="sc">~</span> mm[,<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>])</span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>(mt)<span class="sc">$</span>r.squared</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>::: {.cell-output .cell-output-stdout} <code>[1] 0.784</code> ::: :::</p>
<p>The R<sup>2</sup> shows that the values of <code>d</code> are explained to 78.4 percent by the values of the other predictors in the model.</p>
<p>Now, we can write a function <span class="citation" data-cites="gries2021statistics">[taken from <a href="#ref-gries2021statistics" role="doc-biblioref">6</a>]</span> that converts this R<sup>2</sup> value</p>
<p>::: {.cell}</p>
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a>  R2.to.VIF <span class="ot">&lt;-</span> <span class="cf">function</span>(some.modelmatrix.r2) {</span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="dv">1</span><span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span>some.modelmatrix.r2)) } </span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">R2.to.VIF</span>(<span class="fl">0.784</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>::: {.cell-output .cell-output-stdout} <code>[1] 4.62962962963</code> ::: :::</p>
<p>The function outputs the vif-value of <code>d</code>. This shows that the vif-value of <code>d</code> represents its predictability from the other predictors in the model matrix which represents the amount of shared variance between <code>d</code> and the other predictors in the model.</p>
</details>
</div>
<p>`</p>
<hr>
<p><br></p>
<p>We start by We will now check for incomplete information and complete separation.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check incomplete information and complete separation</span></span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ifelse</span>(<span class="fu">min</span>(<span class="fu">ftable</span>(blrdata<span class="sc">$</span>Age, blrdata<span class="sc">$</span>Gender, blrdata<span class="sc">$</span>EH)) <span class="sc">==</span> <span class="dv">0</span>, <span class="st">"not possible"</span>, <span class="st">"possible"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "possible"</code></pre>
</div>
</div>
<p>As the table does not contain any 0s, we can rule out incomplete information and complete separation. We continue to check for (multi-)collinearity.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ifelse</span>(<span class="fu">max</span>(<span class="fu">vif</span>(lr.glm)) <span class="sc">&lt;=</span> <span class="dv">3</span>,  <span class="st">"vifs ok"</span>, <span class="st">"WARNING: high vifs!"</span>) <span class="co"># VIFs ok</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "vifs ok"</code></pre>
</div>
</div>
<p>In addition, predictors with 1/VIF values <span class="math inline">\(&lt;\)</span> .1 must be removed (data points with values above .2 are considered problematic) <span class="citation" data-cites="menard1995applied">[<a href="#ref-menard1995applied" role="doc-biblioref">24</a>]</span> and the mean value of VIFs should be <span class="math inline">\(~\)</span> 1 <span class="citation" data-cites="bowerman1990linear">[<a href="#ref-bowerman1990linear" role="doc-biblioref">17</a>]</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="fu">vif</span>(lr.glm))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.00481494539</code></pre>
</div>
</div>
<p>As the variance inflation factors are below 3, we do not need to worry about (multi-)collinearity.</p>
</section>
<section id="model-evaluation" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="model-evaluation">Model Evaluation</h3>
<p>Now, that we have confirmed that our model is not suffering from incomplete information, complete separation, and (multi-)collinearity we can check if the final minimal model significantly improves model fit compared to the null model. For this, we calculate a Model Likelihood Ratio Test.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check if adding Age significantly improves model fit</span></span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(lr.glm, m0.glm, <span class="at">test =</span> <span class="st">"Chi"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Deviance Table

Model 1: EH ~ Age + Gender
Model 2: EH ~ 1
  Resid. Df  Resid. Dev Df     Deviance               Pr(&gt;Chi)    
1     25818 32139.54089                                           
2     25820 33007.75469 -2 -868.2138011 &lt; 0.000000000000000222 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Anova</span>(lr.glm, <span class="at">test =</span> <span class="st">"LR"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Deviance Table (Type II tests)

Response: EH
          LR Chisq Df             Pr(&gt;Chisq)    
Age    668.6350712  1 &lt; 0.000000000000000222 ***
Gender 237.3199140  1 &lt; 0.000000000000000222 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>The final model significantly improves model fit which means that we have now arrived at the final minimal adequate model. To elaborate, the code above provides three values: a <span class="math inline">\(\chi\)</span><sup>2</sup>, the degrees of freedom, and a p-value. The p-value is lower than .05 and the results of the Model Likelihood Ratio Test therefore confirm that the final minimal adequate model performs significantly better than the initial minimal base-line model.</p>
<p>In a next step, we calculate pseudo-R<sup>2</sup> values which represent the amount of residual variance that is explained by the final minimal adequate model. We cannot use the ordinary R<sup>2</sup> because the model works on the logged probabilities rather than the values of the dependent variable.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate pseudo R^2</span></span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a><span class="co"># number of cases</span></span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true" tabindex="-1"></a>modelChi <span class="ot">&lt;-</span> lr.glm<span class="sc">$</span>null.deviance <span class="sc">-</span> lr.glm<span class="sc">$</span>deviance</span>
<span id="cb125-4"><a href="#cb125-4" aria-hidden="true" tabindex="-1"></a>ncases <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">fitted</span>(lr.glm))</span>
<span id="cb125-5"><a href="#cb125-5" aria-hidden="true" tabindex="-1"></a>R2.hl <span class="ot">&lt;-</span> modelChi<span class="sc">/</span>lr.glm<span class="sc">$</span>null.deviance</span>
<span id="cb125-6"><a href="#cb125-6" aria-hidden="true" tabindex="-1"></a>R.cs <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">exp</span> ((lr.glm<span class="sc">$</span>deviance <span class="sc">-</span> lr.glm<span class="sc">$</span>null.deviance)<span class="sc">/</span>ncases)</span>
<span id="cb125-7"><a href="#cb125-7" aria-hidden="true" tabindex="-1"></a>R.n <span class="ot">&lt;-</span> R.cs <span class="sc">/</span>( <span class="dv">1</span><span class="sc">-</span> ( <span class="fu">exp</span> (<span class="sc">-</span>(lr.glm<span class="sc">$</span>null.deviance<span class="sc">/</span> ncases))))</span>
<span id="cb125-8"><a href="#cb125-8" aria-hidden="true" tabindex="-1"></a><span class="co"># function for extracting pseudo-R^2</span></span>
<span id="cb125-9"><a href="#cb125-9" aria-hidden="true" tabindex="-1"></a>logisticPseudoR2s <span class="ot">&lt;-</span> <span class="cf">function</span>(LogModel) {</span>
<span id="cb125-10"><a href="#cb125-10" aria-hidden="true" tabindex="-1"></a>  dev <span class="ot">&lt;-</span> LogModel<span class="sc">$</span>deviance</span>
<span id="cb125-11"><a href="#cb125-11" aria-hidden="true" tabindex="-1"></a>    nullDev <span class="ot">&lt;-</span> LogModel<span class="sc">$</span>null.deviance</span>
<span id="cb125-12"><a href="#cb125-12" aria-hidden="true" tabindex="-1"></a>    modelN <span class="ot">&lt;-</span>  <span class="fu">length</span>(LogModel<span class="sc">$</span>fitted.values)</span>
<span id="cb125-13"><a href="#cb125-13" aria-hidden="true" tabindex="-1"></a>    R.l <span class="ot">&lt;-</span>  <span class="dv">1</span> <span class="sc">-</span>  dev <span class="sc">/</span> nullDev</span>
<span id="cb125-14"><a href="#cb125-14" aria-hidden="true" tabindex="-1"></a>    R.cs <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">-</span> <span class="fu">exp</span> ( <span class="sc">-</span>(nullDev <span class="sc">-</span> dev) <span class="sc">/</span> modelN)</span>
<span id="cb125-15"><a href="#cb125-15" aria-hidden="true" tabindex="-1"></a>    R.n <span class="ot">&lt;-</span> R.cs <span class="sc">/</span> ( <span class="dv">1</span> <span class="sc">-</span> ( <span class="fu">exp</span> (<span class="sc">-</span>(nullDev <span class="sc">/</span> modelN))))</span>
<span id="cb125-16"><a href="#cb125-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"Pseudo R^2 for logistic regression</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb125-17"><a href="#cb125-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"Hosmer and Lemeshow R^2  "</span>, <span class="fu">round</span>(R.l, <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb125-18"><a href="#cb125-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"Cox and Snell R^2        "</span>, <span class="fu">round</span>(R.cs, <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb125-19"><a href="#cb125-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"Nagelkerke R^2           "</span>, <span class="fu">round</span>(R.n, <span class="dv">3</span>),    <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>) }</span>
<span id="cb125-20"><a href="#cb125-20" aria-hidden="true" tabindex="-1"></a><span class="fu">logisticPseudoR2s</span>(lr.glm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Pseudo R^2 for logistic regression
Hosmer and Lemeshow R^2   0.026 
Cox and Snell R^2         0.033 
Nagelkerke R^2            0.046 </code></pre>
</div>
</div>
<p>The low pseudo-R<sup>2</sup> values show that our model has very low explanatory power. For instance, the value of Hosmer and Lemeshow R<sup>2</sup> (0.026) “is the proportional reduction in the absolute value of the log-likelihood measure and as such it is a measure of how much the badness of fit improves as a result of the inclusion of the predictor variables” <span class="citation" data-cites="field2012discovering">[<a href="#ref-field2012discovering" role="doc-biblioref">5</a>]</span>. In essence, all the pseudo-R<sup>2</sup> values are measures of how substantive the model is (how much better it is compared to a baseline model). Next, we extract the confidence intervals for the coefficients of the model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="co"># extract the confidence intervals for the coefficients</span></span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(lr.glm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                      2.5 %          97.5 %
(Intercept) -0.276050866670 -0.188778707810
AgeOld      -0.896486392279 -0.765095825382
GenderWomen -0.473530977637 -0.366703827307</code></pre>
</div>
</div>
<p>Despite having low explanatory and predictive power, the age of speakers and their gender are significant as the confidence intervals of the coefficients do not overlap with 0.</p>
</section>
<section id="effect-size" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="effect-size">Effect Size</h3>
<p>In a next step, we compute odds ratios and their confidence intervals. Odds Ratios represent a common measure of effect size and can be used to compare effect sizes across models. Odds ratios rang between 0 and infinity. Values of 1 indicate that there is no effect. The further away the values are from 1, the stronger the effect. If the values are lower than 1, then the variable level correlates negatively with the occurrence of the outcome (the probability decreases) while values above 1 indicate a positive correlation and show that the variable level causes an increase in the probability of the outcome (the occurrence of EH).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(lr.glm<span class="sc">$</span>coefficients) <span class="co"># odds ratios</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   (Intercept)         AgeOld    GenderWomen 
0.792642499264 0.435815384592 0.656972294902 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(<span class="fu">confint</span>(lr.glm))     <span class="co"># confidence intervals of the odds ratios</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Waiting for profiling to be done...</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>                     2.5 %         97.5 %
(Intercept) 0.758774333456 0.827969709653
AgeOld      0.408000698619 0.465289342309
GenderWomen 0.622799290871 0.693014866732</code></pre>
</div>
</div>
<p>The odds ratios confirm that older speakers use <em>eh</em> significantly less often compared with younger speakers and that women use <em>eh</em> less frequently than men as the confidence intervals of the odds rations do not overlap with 1. In a next step, we calculate the prediction accuracy of the model.</p>
</section>
<section id="prediction-accuracy" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="prediction-accuracy">Prediction Accuracy</h3>
<p>In order to calculate the prediction accuracy of the model, we generate a variable called <em>Prediction</em> that contains the predictions of pour model and which we add to the data. Then, we use the <code>confusionMatrix</code> function from the <code>caret</code> package <span class="citation" data-cites="caret">[<a href="#ref-caret" role="doc-biblioref">25</a>]</span> to extract the prediction accuracy.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create variable with contains the prediction of the model</span></span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a>blrdata <span class="ot">&lt;-</span> blrdata <span class="sc">%&gt;%</span></span>
<span id="cb134-3"><a href="#cb134-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">Prediction =</span> <span class="fu">predict</span>(lr.glm, <span class="at">type =</span> <span class="st">"response"</span>),</span>
<span id="cb134-4"><a href="#cb134-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">Prediction =</span> <span class="fu">ifelse</span>(Prediction <span class="sc">&gt;</span> .<span class="dv">5</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb134-5"><a href="#cb134-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">Prediction =</span> <span class="fu">factor</span>(Prediction, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"0"</span>, <span class="st">"1"</span>)),</span>
<span id="cb134-6"><a href="#cb134-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">EH =</span> <span class="fu">factor</span>(EH, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"0"</span>, <span class="st">"1"</span>)))</span>
<span id="cb134-7"><a href="#cb134-7" aria-hidden="true" tabindex="-1"></a><span class="co"># create a confusion matrix with compares observed against predicted values</span></span>
<span id="cb134-8"><a href="#cb134-8" aria-hidden="true" tabindex="-1"></a>caret<span class="sc">::</span><span class="fu">confusionMatrix</span>(blrdata<span class="sc">$</span>Prediction, blrdata<span class="sc">$</span>EH)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction     0     1
         0 17114  8707
         1     0     0
                                                    
               Accuracy : 0.66279385                
                 95% CI : (0.656990096, 0.668560948)
    No Information Rate : 0.66279385                
    P-Value [Acc &gt; NIR] : 0.5029107                 
                                                    
                  Kappa : 0                         
                                                    
 Mcnemar's Test P-Value : &lt; 0.00000000000000022     
                                                    
            Sensitivity : 1.00000000                
            Specificity : 0.00000000                
         Pos Pred Value : 0.66279385                
         Neg Pred Value :        NaN                
             Prevalence : 0.66279385                
         Detection Rate : 0.66279385                
   Detection Prevalence : 1.00000000                
      Balanced Accuracy : 0.50000000                
                                                    
       'Positive' Class : 0                         
                                                    </code></pre>
</div>
</div>
<p>We can see that out model has never predicted the use of <em>eh</em> which is common when dealing with rare phenomena. This is expected as the event s so rare that the probability of it not occurring substantively outweighs the probability of it occurring. As such, the prediction accuracy of our model is not significantly better compared to the prediction accuracy of the baseline model which is the no-information rate (NIR)) (p = 0.5029).</p>
<p>We can use the <code>plot_model</code> function from the <code>sjPlot</code> package <span class="citation" data-cites="sjPlot">[<a href="#ref-sjPlot" role="doc-biblioref">26</a>]</span> to visualize the effects.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="co"># predicted probability</span></span>
<span id="cb136-2"><a href="#cb136-2" aria-hidden="true" tabindex="-1"></a>efp1 <span class="ot">&lt;-</span> <span class="fu">plot_model</span>(lr.glm, <span class="at">type =</span> <span class="st">"pred"</span>, <span class="at">terms =</span> <span class="fu">c</span>(<span class="st">"Age"</span>), <span class="at">axis.lim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) </span>
<span id="cb136-3"><a href="#cb136-3" aria-hidden="true" tabindex="-1"></a><span class="co"># predicted percentage</span></span>
<span id="cb136-4"><a href="#cb136-4" aria-hidden="true" tabindex="-1"></a>efp2 <span class="ot">&lt;-</span> <span class="fu">plot_model</span>(lr.glm, <span class="at">type =</span> <span class="st">"pred"</span>, <span class="at">terms =</span> <span class="fu">c</span>(<span class="st">"Gender"</span>), <span class="at">axis.lim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) </span>
<span id="cb136-5"><a href="#cb136-5" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(efp1, efp2, <span class="at">nrow =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="fixreg_files/figure-html/blm27-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>And we can also combine the visualization of the effects in a single plot as shown below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a>sjPlot<span class="sc">::</span><span class="fu">plot_model</span>(lr.glm, <span class="at">type =</span> <span class="st">"pred"</span>, <span class="at">terms =</span> <span class="fu">c</span>(<span class="st">"Age"</span>, <span class="st">"Gender"</span>), <span class="at">axis.lim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>) <span class="sc">+</span></span>
<span id="cb137-3"><a href="#cb137-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="st">"Predicted Probabilty of eh"</span>, <span class="at">title =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb137-4"><a href="#cb137-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"gray20"</span>, <span class="st">"gray70"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="fixreg_files/figure-html/blm28-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="outlier-detection-1" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="outlier-detection-1">Outlier detection</h3>
<p>In order to detect potential outliers, we will calculate diagnostic parameters and add these to our data set.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a>infl <span class="ot">&lt;-</span> <span class="fu">influence.measures</span>(lr.glm) <span class="co"># calculate influence statistics</span></span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true" tabindex="-1"></a>blrdata <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(blrdata, infl[[<span class="dv">1</span>]], infl[[<span class="dv">2</span>]]) <span class="co"># add influence statistics</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In a next step, we use these diagnostic parameters to check if there are data points which should be removed as they unduly affect the model fit.</p>
</section>
<section id="sample-size" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="sample-size">Sample Size</h3>
<p>We now check whether the sample size is sufficient for our analysis <span class="citation" data-cites="green1991many">[<a href="#ref-green1991many" role="doc-biblioref">12</a>]</span>.</p>
<ul>
<li><p>if you are interested in the overall model: 50 + 8k (k = number of predictors)</p></li>
<li><p>if you are interested in individual predictors: 104 + k</p></li>
<li><p>if you are interested in both: take the higher value!</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="co"># function to evaluate sample size</span></span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a>smplesz <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb139-3"><a href="#cb139-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ifelse</span>((<span class="fu">length</span>(x<span class="sc">$</span>fitted) <span class="sc">&lt;</span> (<span class="dv">104</span> <span class="sc">+</span> <span class="fu">ncol</span>(<span class="fu">summary</span>(x)<span class="sc">$</span>coefficients)<span class="sc">-</span><span class="dv">1</span>)) <span class="sc">==</span> <span class="cn">TRUE</span>,</span>
<span id="cb139-4"><a href="#cb139-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(</span>
<span id="cb139-5"><a href="#cb139-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">paste</span>(<span class="st">"Sample too small: please increase your sample by "</span>,</span>
<span id="cb139-6"><a href="#cb139-6" aria-hidden="true" tabindex="-1"></a>      <span class="dv">104</span> <span class="sc">+</span> <span class="fu">ncol</span>(<span class="fu">summary</span>(x)<span class="sc">$</span>coefficients)<span class="sc">-</span><span class="dv">1</span> <span class="sc">-</span> <span class="fu">length</span>(x<span class="sc">$</span>fitted),</span>
<span id="cb139-7"><a href="#cb139-7" aria-hidden="true" tabindex="-1"></a>      <span class="st">" data points"</span>, <span class="at">collapse =</span> <span class="st">""</span>)),</span>
<span id="cb139-8"><a href="#cb139-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="st">"Sample size sufficient"</span>)) }</span>
<span id="cb139-9"><a href="#cb139-9" aria-hidden="true" tabindex="-1"></a><span class="co"># apply unction to model</span></span>
<span id="cb139-10"><a href="#cb139-10" aria-hidden="true" tabindex="-1"></a><span class="fu">smplesz</span>(lr.glm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Sample size sufficient"</code></pre>
</div>
</div>
<p>According to rule of thumb provided in <span class="citation" data-cites="green1991many">[<a href="#ref-green1991many" role="doc-biblioref">12</a>]</span>, the sample size is sufficient for our analysis.</p>
</section>
<section id="summarizing-results" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="summarizing-results">Summarizing Results</h3>
<p>As a final step, we summarize our findings in tabulated form.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a>sjPlot<span class="sc">::</span><span class="fu">tab_model</span>(lr.glm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<table style="border-collapse:collapse; border:none;">
<tbody><tr>
<th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">&nbsp;</th>
<th colspan="3" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">EH</th>
</tr>
<tr>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">Predictors</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">Odds Ratios</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">CI</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">p</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">(Intercept)</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.79</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.76&nbsp;–&nbsp;0.83</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Age [Old]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.44</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.41&nbsp;–&nbsp;0.47</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Gender [Women]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.66</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.62&nbsp;–&nbsp;0.69</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;">Observations</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="3">25821</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">R<sup>2</sup> Tjur</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.032</td>
</tr>

</tbody></table>

</div>
</div>
<hr>
<p>A more detailed summary table can be retrieved as follows:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load function</span></span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"https://slcladal.github.io/rscripts/blrsummary.r"</span>)</span>
<span id="cb142-3"><a href="#cb142-3" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate accuracy </span></span>
<span id="cb142-4"><a href="#cb142-4" aria-hidden="true" tabindex="-1"></a>predict.acc <span class="ot">&lt;-</span> caret<span class="sc">::</span><span class="fu">confusionMatrix</span>(blrdata<span class="sc">$</span>Prediction, blrdata<span class="sc">$</span>EH)</span>
<span id="cb142-5"><a href="#cb142-5" aria-hidden="true" tabindex="-1"></a>predict.acc <span class="ot">&lt;-</span> predict.acc[<span class="dv">3</span>]<span class="sc">$</span>overall[[<span class="dv">1</span>]]</span>
<span id="cb142-6"><a href="#cb142-6" aria-hidden="true" tabindex="-1"></a><span class="co"># create summary table</span></span>
<span id="cb142-7"><a href="#cb142-7" aria-hidden="true" tabindex="-1"></a>blrsummarytb <span class="ot">&lt;-</span> <span class="fu">blrsummary</span>(lr.glm, lr.lrm, predict.acc) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">

<div class="tabwid"><style>.cl-54669676{table-layout:auto;width:75%;}.cl-5460e834{font-family:'DejaVu Sans';font-size:12pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-5460e848{font-family:'DejaVu Sans';font-size:12pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-546105d0{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-5461644e{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-54616458{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5461646c{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5461646d{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-54616476{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-54616480{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5461648a{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5461648b{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-54616494{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5461649e{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5461649f{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-546164a8{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table class="cl-54669676">
<caption class="Table Caption">
<p>Results of the binomial logistic regression analysis.</p>
</caption>

<thead><tr style="overflow-wrap:break-word;"><td class="cl-5461649f"><p class="cl-546105d0"><span class="cl-5460e834">Statistics</span></p></td><td class="cl-5461649e"><p class="cl-546105d0"><span class="cl-5460e834">Estimate</span></p></td><td class="cl-5461649e"><p class="cl-546105d0"><span class="cl-5460e834">VIF</span></p></td><td class="cl-5461649e"><p class="cl-546105d0"><span class="cl-5460e834">OddsRatio</span></p></td><td class="cl-5461649e"><p class="cl-546105d0"><span class="cl-5460e834">CI(2.5%)</span></p></td><td class="cl-5461649e"><p class="cl-546105d0"><span class="cl-5460e834">CI(97.5%)</span></p></td><td class="cl-5461649e"><p class="cl-546105d0"><span class="cl-5460e834">Std. Error</span></p></td><td class="cl-5461649e"><p class="cl-546105d0"><span class="cl-5460e834">z value</span></p></td><td class="cl-5461649e"><p class="cl-546105d0"><span class="cl-5460e834">Pr(&gt;|z|)</span></p></td><td class="cl-546164a8"><p class="cl-546105d0"><span class="cl-5460e834">Significance</span></p></td></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-54616458"><p class="cl-546105d0"><span class="cl-5460e848">(Intercept)</span></p></td><td class="cl-5461644e"><p class="cl-546105d0"><span class="cl-5460e848">-0.23</span></p></td><td class="cl-5461644e"><p class="cl-546105d0"><span class="cl-5460e848"></span></p></td><td class="cl-5461644e"><p class="cl-546105d0"><span class="cl-5460e848">0.79</span></p></td><td class="cl-5461644e"><p class="cl-546105d0"><span class="cl-5460e848">0.76</span></p></td><td class="cl-5461644e"><p class="cl-546105d0"><span class="cl-5460e848">0.83</span></p></td><td class="cl-5461644e"><p class="cl-546105d0"><span class="cl-5460e848">0.02</span></p></td><td class="cl-5461644e"><p class="cl-546105d0"><span class="cl-5460e848">-10.44</span></p></td><td class="cl-5461644e"><p class="cl-546105d0"><span class="cl-5460e848">0</span></p></td><td class="cl-5461646c"><p class="cl-546105d0"><span class="cl-5460e848">p &lt; .001***</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-54616476"><p class="cl-546105d0"><span class="cl-5460e848">AgeOld</span></p></td><td class="cl-5461646d"><p class="cl-546105d0"><span class="cl-5460e848">-0.83</span></p></td><td class="cl-5461646d"><p class="cl-546105d0"><span class="cl-5460e848">1</span></p></td><td class="cl-5461646d"><p class="cl-546105d0"><span class="cl-5460e848">0.44</span></p></td><td class="cl-5461646d"><p class="cl-546105d0"><span class="cl-5460e848">0.41</span></p></td><td class="cl-5461646d"><p class="cl-546105d0"><span class="cl-5460e848">0.47</span></p></td><td class="cl-5461646d"><p class="cl-546105d0"><span class="cl-5460e848">0.03</span></p></td><td class="cl-5461646d"><p class="cl-546105d0"><span class="cl-5460e848">-24.78</span></p></td><td class="cl-5461646d"><p class="cl-546105d0"><span class="cl-5460e848">0</span></p></td><td class="cl-54616480"><p class="cl-546105d0"><span class="cl-5460e848">p &lt; .001***</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-54616458"><p class="cl-546105d0"><span class="cl-5460e848">GenderWomen</span></p></td><td class="cl-5461644e"><p class="cl-546105d0"><span class="cl-5460e848">-0.42</span></p></td><td class="cl-5461644e"><p class="cl-546105d0"><span class="cl-5460e848">1</span></p></td><td class="cl-5461644e"><p class="cl-546105d0"><span class="cl-5460e848">0.66</span></p></td><td class="cl-5461644e"><p class="cl-546105d0"><span class="cl-5460e848">0.62</span></p></td><td class="cl-5461644e"><p class="cl-546105d0"><span class="cl-5460e848">0.69</span></p></td><td class="cl-5461644e"><p class="cl-546105d0"><span class="cl-5460e848">0.03</span></p></td><td class="cl-5461644e"><p class="cl-546105d0"><span class="cl-5460e848">-15.42</span></p></td><td class="cl-5461644e"><p class="cl-546105d0"><span class="cl-5460e848">0</span></p></td><td class="cl-5461646c"><p class="cl-546105d0"><span class="cl-5460e848">p &lt; .001***</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-54616476"><p class="cl-546105d0"><span class="cl-5460e848">Model statistics</span></p></td><td class="cl-5461646d"><p class="cl-546105d0"><span class="cl-5460e848"></span></p></td><td class="cl-5461646d"><p class="cl-546105d0"><span class="cl-5460e848"></span></p></td><td class="cl-5461646d"><p class="cl-546105d0"><span class="cl-5460e848"></span></p></td><td class="cl-5461646d"><p class="cl-546105d0"><span class="cl-5460e848"></span></p></td><td class="cl-5461646d"><p class="cl-546105d0"><span class="cl-5460e848"></span></p></td><td class="cl-5461646d"><p class="cl-546105d0"><span class="cl-5460e848"></span></p></td><td class="cl-5461646d"><p class="cl-546105d0"><span class="cl-5460e848"></span></p></td><td class="cl-5461646d"><p class="cl-546105d0"><span class="cl-5460e848"></span></p></td><td class="cl-54616480"><p class="cl-546105d0"><span class="cl-5460e848">Value</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-54616458"><p class="cl-546105d0"><span class="cl-5460e848">Number of cases in model</span></p></td><td class="cl-5461644e"><p class="cl-546105d0"><span class="cl-5460e848"></span></p></td><td class="cl-5461644e"><p class="cl-546105d0"><span class="cl-5460e848"></span></p></td><td class="cl-5461644e"><p class="cl-546105d0"><span class="cl-5460e848"></span></p></td><td class="cl-5461644e"><p class="cl-546105d0"><span class="cl-5460e848"></span></p></td><td class="cl-5461644e"><p class="cl-546105d0"><span class="cl-5460e848"></span></p></td><td class="cl-5461644e"><p class="cl-546105d0"><span class="cl-5460e848"></span></p></td><td class="cl-5461644e"><p class="cl-546105d0"><span class="cl-5460e848"></span></p></td><td class="cl-5461644e"><p class="cl-546105d0"><span class="cl-5460e848"></span></p></td><td class="cl-5461646c"><p class="cl-546105d0"><span class="cl-5460e848">25821</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-54616476"><p class="cl-546105d0"><span class="cl-5460e848">Observed misses</span></p></td><td class="cl-5461646d"><p class="cl-546105d0"><span class="cl-5460e848"></span></p></td><td class="cl-5461646d"><p class="cl-546105d0"><span class="cl-5460e848"></span></p></td><td class="cl-5461646d"><p class="cl-546105d0"><span class="cl-5460e848"></span></p></td><td class="cl-5461646d"><p class="cl-546105d0"><span class="cl-5460e848"></span></p></td><td class="cl-5461646d"><p class="cl-546105d0"><span class="cl-5460e848"></span></p></td><td class="cl-5461646d"><p class="cl-546105d0"><span class="cl-5460e848"></span></p></td><td class="cl-5461646d"><p class="cl-546105d0"><span class="cl-5460e848"></span></p></td><td class="cl-5461646d"><p class="cl-546105d0"><span class="cl-5460e848">0 :</span></p></td><td class="cl-54616480"><p class="cl-546105d0"><span class="cl-5460e848">17114</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-54616458"><p class="cl-546105d0"><span class="cl-5460e848">Observed successes</span></p></td><td class="cl-5461644e"><p class="cl-546105d0"><span class="cl-5460e848"></span></p></td><td class="cl-5461644e"><p class="cl-546105d0"><span class="cl-5460e848"></span></p></td><td class="cl-5461644e"><p class="cl-546105d0"><span class="cl-5460e848"></span></p></td><td class="cl-5461644e"><p class="cl-546105d0"><span class="cl-5460e848"></span></p></td><td class="cl-5461644e"><p class="cl-546105d0"><span class="cl-5460e848"></span></p></td><td class="cl-5461644e"><p class="cl-546105d0"><span class="cl-5460e848"></span></p></td><td class="cl-5461644e"><p class="cl-546105d0"><span class="cl-5460e848"></span></p></td><td class="cl-5461644e"><p class="cl-546105d0"><span class="cl-5460e848">1 :</span></p></td><td class="cl-5461646c"><p class="cl-546105d0"><span class="cl-5460e848">8707</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-54616476"><p class="cl-546105d0"><span class="cl-5460e848">Null deviance</span></p></td><td class="cl-5461646d"><p class="cl-546105d0"><span class="cl-5460e848"></span></p></td><td class="cl-5461646d"><p class="cl-546105d0"><span class="cl-5460e848"></span></p></td><td class="cl-5461646d"><p class="cl-546105d0"><span class="cl-5460e848"></span></p></td><td class="cl-5461646d"><p class="cl-546105d0"><span class="cl-5460e848"></span></p></td><td class="cl-5461646d"><p class="cl-546105d0"><span class="cl-5460e848"></span></p></td><td class="cl-5461646d"><p class="cl-546105d0"><span class="cl-5460e848"></span></p></td><td class="cl-5461646d"><p class="cl-546105d0"><span class="cl-5460e848"></span></p></td><td class="cl-5461646d"><p class="cl-546105d0"><span class="cl-5460e848"></span></p></td><td class="cl-54616480"><p class="cl-546105d0"><span class="cl-5460e848">33007.75</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-54616458"><p class="cl-546105d0"><span class="cl-5460e848">Residual deviance</span></p></td><td class="cl-5461644e"><p class="cl-546105d0"><span class="cl-5460e848"></span></p></td><td class="cl-5461644e"><p class="cl-546105d0"><span class="cl-5460e848"></span></p></td><td class="cl-5461644e"><p class="cl-546105d0"><span class="cl-5460e848"></span></p></td><td class="cl-5461644e"><p class="cl-546105d0"><span class="cl-5460e848"></span></p></td><td class="cl-5461644e"><p class="cl-546105d0"><span class="cl-5460e848"></span></p></td><td class="cl-5461644e"><p class="cl-546105d0"><span class="cl-5460e848"></span></p></td><td class="cl-5461644e"><p class="cl-546105d0"><span class="cl-5460e848"></span></p></td><td class="cl-5461644e"><p class="cl-546105d0"><span class="cl-5460e848"></span></p></td><td class="cl-5461646c"><p class="cl-546105d0"><span class="cl-5460e848">32139.54</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-54616476"><p class="cl-546105d0"><span class="cl-5460e848">R2 (Nagelkerke)</span></p></td><td class="cl-5461646d"><p class="cl-546105d0"><span class="cl-5460e848"></span></p></td><td class="cl-5461646d"><p class="cl-546105d0"><span class="cl-5460e848"></span></p></td><td class="cl-5461646d"><p class="cl-546105d0"><span class="cl-5460e848"></span></p></td><td class="cl-5461646d"><p class="cl-546105d0"><span class="cl-5460e848"></span></p></td><td class="cl-5461646d"><p class="cl-546105d0"><span class="cl-5460e848"></span></p></td><td class="cl-5461646d"><p class="cl-546105d0"><span class="cl-5460e848"></span></p></td><td class="cl-5461646d"><p class="cl-546105d0"><span class="cl-5460e848"></span></p></td><td class="cl-5461646d"><p class="cl-546105d0"><span class="cl-5460e848"></span></p></td><td class="cl-54616480"><p class="cl-546105d0"><span class="cl-5460e848">0.046</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-54616458"><p class="cl-546105d0"><span class="cl-5460e848">R2 (Hosmer &amp; Lemeshow)</span></p></td><td class="cl-5461644e"><p class="cl-546105d0"><span class="cl-5460e848"></span></p></td><td class="cl-5461644e"><p class="cl-546105d0"><span class="cl-5460e848"></span></p></td><td class="cl-5461644e"><p class="cl-546105d0"><span class="cl-5460e848"></span></p></td><td class="cl-5461644e"><p class="cl-546105d0"><span class="cl-5460e848"></span></p></td><td class="cl-5461644e"><p class="cl-546105d0"><span class="cl-5460e848"></span></p></td><td class="cl-5461644e"><p class="cl-546105d0"><span class="cl-5460e848"></span></p></td><td class="cl-5461644e"><p class="cl-546105d0"><span class="cl-5460e848"></span></p></td><td class="cl-5461644e"><p class="cl-546105d0"><span class="cl-5460e848"></span></p></td><td class="cl-5461646c"><p class="cl-546105d0"><span class="cl-5460e848">0.026</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-54616476"><p class="cl-546105d0"><span class="cl-5460e848">R2 (Cox &amp; Snell)</span></p></td><td class="cl-5461646d"><p class="cl-546105d0"><span class="cl-5460e848"></span></p></td><td class="cl-5461646d"><p class="cl-546105d0"><span class="cl-5460e848"></span></p></td><td class="cl-5461646d"><p class="cl-546105d0"><span class="cl-5460e848"></span></p></td><td class="cl-5461646d"><p class="cl-546105d0"><span class="cl-5460e848"></span></p></td><td class="cl-5461646d"><p class="cl-546105d0"><span class="cl-5460e848"></span></p></td><td class="cl-5461646d"><p class="cl-546105d0"><span class="cl-5460e848"></span></p></td><td class="cl-5461646d"><p class="cl-546105d0"><span class="cl-5460e848"></span></p></td><td class="cl-5461646d"><p class="cl-546105d0"><span class="cl-5460e848"></span></p></td><td class="cl-54616480"><p class="cl-546105d0"><span class="cl-5460e848">0.033</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-54616458"><p class="cl-546105d0"><span class="cl-5460e848">C</span></p></td><td class="cl-5461644e"><p class="cl-546105d0"><span class="cl-5460e848"></span></p></td><td class="cl-5461644e"><p class="cl-546105d0"><span class="cl-5460e848"></span></p></td><td class="cl-5461644e"><p class="cl-546105d0"><span class="cl-5460e848"></span></p></td><td class="cl-5461644e"><p class="cl-546105d0"><span class="cl-5460e848"></span></p></td><td class="cl-5461644e"><p class="cl-546105d0"><span class="cl-5460e848"></span></p></td><td class="cl-5461644e"><p class="cl-546105d0"><span class="cl-5460e848"></span></p></td><td class="cl-5461644e"><p class="cl-546105d0"><span class="cl-5460e848"></span></p></td><td class="cl-5461644e"><p class="cl-546105d0"><span class="cl-5460e848"></span></p></td><td class="cl-5461646c"><p class="cl-546105d0"><span class="cl-5460e848">0.602</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-54616476"><p class="cl-546105d0"><span class="cl-5460e848">Somers' Dxy</span></p></td><td class="cl-5461646d"><p class="cl-546105d0"><span class="cl-5460e848"></span></p></td><td class="cl-5461646d"><p class="cl-546105d0"><span class="cl-5460e848"></span></p></td><td class="cl-5461646d"><p class="cl-546105d0"><span class="cl-5460e848"></span></p></td><td class="cl-5461646d"><p class="cl-546105d0"><span class="cl-5460e848"></span></p></td><td class="cl-5461646d"><p class="cl-546105d0"><span class="cl-5460e848"></span></p></td><td class="cl-5461646d"><p class="cl-546105d0"><span class="cl-5460e848"></span></p></td><td class="cl-5461646d"><p class="cl-546105d0"><span class="cl-5460e848"></span></p></td><td class="cl-5461646d"><p class="cl-546105d0"><span class="cl-5460e848"></span></p></td><td class="cl-54616480"><p class="cl-546105d0"><span class="cl-5460e848">0.203</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-54616458"><p class="cl-546105d0"><span class="cl-5460e848">AIC</span></p></td><td class="cl-5461644e"><p class="cl-546105d0"><span class="cl-5460e848"></span></p></td><td class="cl-5461644e"><p class="cl-546105d0"><span class="cl-5460e848"></span></p></td><td class="cl-5461644e"><p class="cl-546105d0"><span class="cl-5460e848"></span></p></td><td class="cl-5461644e"><p class="cl-546105d0"><span class="cl-5460e848"></span></p></td><td class="cl-5461644e"><p class="cl-546105d0"><span class="cl-5460e848"></span></p></td><td class="cl-5461644e"><p class="cl-546105d0"><span class="cl-5460e848"></span></p></td><td class="cl-5461644e"><p class="cl-546105d0"><span class="cl-5460e848"></span></p></td><td class="cl-5461644e"><p class="cl-546105d0"><span class="cl-5460e848"></span></p></td><td class="cl-5461646c"><p class="cl-546105d0"><span class="cl-5460e848">32145.54</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-54616476"><p class="cl-546105d0"><span class="cl-5460e848">Prediction accuracy</span></p></td><td class="cl-5461646d"><p class="cl-546105d0"><span class="cl-5460e848"></span></p></td><td class="cl-5461646d"><p class="cl-546105d0"><span class="cl-5460e848"></span></p></td><td class="cl-5461646d"><p class="cl-546105d0"><span class="cl-5460e848"></span></p></td><td class="cl-5461646d"><p class="cl-546105d0"><span class="cl-5460e848"></span></p></td><td class="cl-5461646d"><p class="cl-546105d0"><span class="cl-5460e848"></span></p></td><td class="cl-5461646d"><p class="cl-546105d0"><span class="cl-5460e848"></span></p></td><td class="cl-5461646d"><p class="cl-546105d0"><span class="cl-5460e848"></span></p></td><td class="cl-5461646d"><p class="cl-546105d0"><span class="cl-5460e848"></span></p></td><td class="cl-54616480"><p class="cl-546105d0"><span class="cl-5460e848">0.66%</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-5461648b"><p class="cl-546105d0"><span class="cl-5460e848">Model Likelihood Ratio Test</span></p></td><td class="cl-5461648a"><p class="cl-546105d0"><span class="cl-5460e848"></span></p></td><td class="cl-5461648a"><p class="cl-546105d0"><span class="cl-5460e848"></span></p></td><td class="cl-5461648a"><p class="cl-546105d0"><span class="cl-5460e848"></span></p></td><td class="cl-5461648a"><p class="cl-546105d0"><span class="cl-5460e848"></span></p></td><td class="cl-5461648a"><p class="cl-546105d0"><span class="cl-5460e848"></span></p></td><td class="cl-5461648a"><p class="cl-546105d0"><span class="cl-5460e848">Model L.R.: 868.21</span></p></td><td class="cl-5461648a"><p class="cl-546105d0"><span class="cl-5460e848">df: 2</span></p></td><td class="cl-5461648a"><p class="cl-546105d0"><span class="cl-5460e848">p-value: 0</span></p></td><td class="cl-54616494"><p class="cl-546105d0"><span class="cl-5460e848">sig: p &lt; .001***</span></p></td></tr></tbody></table></div>
</div>
</div>
<p><strong>R<sup>2</sup> (Hosmer &amp; Lemeshow)</strong></p>
<p>Hosmer and Lemeshow’s R<sup>2</sup> “is the proportional reduction in the absolute value of the log-likelihood measure and as such it is a measure of how much the badness of fit improves as a result of the inclusion of the predictor variables. It can vary between 0 (indicating that the predictors are useless at predicting the outcome variable) and 1 (indicating that the model predicts the outcome variable perfectly)” <span class="citation" data-cites="field2012discovering">[<a href="#ref-field2012discovering" role="doc-biblioref">5</a>]</span>.</p>
<p><strong>R<sup>2</sup> (Cox &amp; Snell)</strong></p>
<p>“Cox and Snell’s R<sup>2</sup> (1989) is based on the deviance of the model (-2LL(new») and the deviance of the baseline model (-2LL(baseline), and the sample size, n […]. However, this statistic never reaches its theoretical maximum of 1.</p>
<p><strong>R2 (Nagelkerke)</strong></p>
<p>Since R<sup>2</sup> (Cox &amp; Snell) never reaches its theoretical maximum of 1, Nagelkerke (1991) suggested Nagelkerke’s R<sup>2</sup> <span class="citation" data-cites="field2012discovering">[<a href="#ref-field2012discovering" role="doc-biblioref">5</a>]</span>.</p>
<p><strong>Somers’ D<sub>xy</sub></strong></p>
<p>Somers’ D<sub>xy</sub> is a rank correlation between predicted probabilities and observed responses ranges between 0 (randomness) and 1 (perfect prediction). Somers’ D<sub>xy</sub> should have a value higher than .5 for the model to be meaningful <span class="citation" data-cites="baayen2008analyzing">[<a href="#ref-baayen2008analyzing" role="doc-biblioref">10</a>]</span>.</p>
<p><strong>C</strong></p>
<p>C is an index of concordance between the predicted probability and the observed response. When C takes the value 0.5, the predictions are random, when it is 1, prediction is perfect. A value above 0.8 indicates that the model may have some real predictive capacity <span class="citation" data-cites="baayen2008analyzing">[<a href="#ref-baayen2008analyzing" role="doc-biblioref">10</a>]</span>.</p>
<p><strong>Akaike information criteria (AIC)</strong></p>
<p>Akaike information criteria (AlC = -2LL + 2k) provide a value that reflects a ratio between the number of predictors in the model and the variance that is explained by these predictors. Changes in AIC can serve as a measure of whether the inclusion of a variable leads to a significant increase in the amount of variance that is explained by the model. “You can think of this as the price you pay for something: you get a better value of R<sup>2</sup>, but you pay a higher price, and was that higher price worth it? These information criteria help you to decide. The BIC is the same as the AIC but adjusts the penalty included in the AlC (i.e., 2k) by the number of cases: BlC = -2LL + 2k x log(n) in which n is the number of cases in the model” <span class="citation" data-cites="field2012discovering">[<a href="#ref-field2012discovering" role="doc-biblioref">5</a>]</span>.</p>
<p>We can use the <code>reports</code> package <span class="citation" data-cites="report">[<a href="#ref-report" role="doc-biblioref">18</a>]</span> to summarize the analysis.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a>report<span class="sc">::</span><span class="fu">report</span>(lr.glm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>We fitted a logistic model (estimated using ML) to predict EH with Age and Gender (formula: EH ~ Age + Gender). The model's explanatory power is weak (Tjur's R2 = 0.03). The model's intercept, corresponding to Age = Young and Gender = Men, is at -0.23 (95% CI [-0.28, -0.19], p &lt; .001). Within this model:

  - The effect of Age [Old] is statistically significant and negative (beta = -0.83, 95% CI [-0.90, -0.77], p &lt; .001; Std. beta = -0.83, 95% CI [-0.90, -0.77])
  - The effect of Gender [Women] is statistically significant and negative (beta = -0.42, 95% CI [-0.47, -0.37], p &lt; .001; Std. beta = -0.42, 95% CI [-0.47, -0.37])

Standardized parameters were obtained by fitting the model on a standardized version of the dataset. 95% Confidence Intervals (CIs) and p-values were computed using </code></pre>
</div>
</div>
<p>We can use this output to write up a final report:</p>
<p>We fitted a logistic model (estimated using ML) to predict the use of the utterance-final discourse particle <em>eh</em> with Age and Gender (formula: EH ~ Age + Gender). The model’s explanatory power is weak (Tjur’s R<sup>2</sup> = 0.03). The model’s intercept, corresponding to Age = Young and Gender = Men, is at -0.23 (95% CI [-0.28, -0.19], p &lt; .001). Within this model:</p>
<ul>
<li><p>The effect of Age [Old] is statistically significant and negative (beta = -0.83, 95% CI [-0.90, -0.77], p &lt; .001; Std. beta = -0.83, 95% CI [-0.90, -0.77])</p></li>
<li><p>The effect of Gender [Women] is statistically significant and negative (beta = -0.42, 95% CI [-0.47, -0.37], p &lt; .001; Std. beta = -0.42, 95% CI [-0.47, -0.37])</p></li>
</ul>
<p>Standardized parameters were obtained by fitting the model on a standardized version of the dataset. 95% Confidence Intervals (CIs) and p-values were computed using</p>
</section>
</section>
<section id="ordinal-regression" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="ordinal-regression">Ordinal Regression</h2>
<p>Ordinal regression is very similar to multiple linear regression but takes an ordinal dependent variable <span class="citation" data-cites="agresti2010analysis">[<a href="#ref-agresti2010analysis" role="doc-biblioref">27</a>]</span>. For this reason, ordinal regression is one of the key methods in analysing Likert data.</p>
<p>To see how an ordinal regression is implemented in R, we load and inspect the ´ordinaldata´ data set. The data set consists of 400 observations of students that were either educated at this school (Internal = 1) or not (Internal = 0). Some of the students have been abroad (Exchange = 1) while other have not (Exchange = 0). In addition, the data set contains the students’ final score of a language test (FinalScore) and the dependent variable which the recommendation of a committee for an additional, very prestigious program. The recommendation has three levels (<em>very likely</em>, <em>somewhat likely</em>, and <em>unlikely</em>) and reflects the committees’ assessment of whether the student is likely to succeed in the program.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load data</span></span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a>ordata  <span class="ot">&lt;-</span> base<span class="sc">::</span><span class="fu">readRDS</span>(<span class="fu">url</span>(<span class="st">"https://slcladal.github.io/data/ord.rda"</span>, <span class="st">"rb"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb145-3"><a href="#cb145-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">Recommend =</span> <span class="dv">1</span>, </span>
<span id="cb145-4"><a href="#cb145-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">Internal =</span> <span class="dv">2</span>, </span>
<span id="cb145-5"><a href="#cb145-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">Exchange =</span> <span class="dv">3</span>, </span>
<span id="cb145-6"><a href="#cb145-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">FinalScore =</span> <span class="dv">4</span>) <span class="sc">%&gt;%</span></span>
<span id="cb145-7"><a href="#cb145-7" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">FinalScore =</span> <span class="fu">round</span>(FinalScore, <span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">

<div class="tabwid"><style>.cl-565cfb0a{table-layout:auto;width:75%;}.cl-56597b74{font-family:'DejaVu Sans';font-size:12pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-56597b7e{font-family:'DejaVu Sans';font-size:12pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-56598560{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-5659856a{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-5659b03a{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5659b044{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5659b045{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5659b04e{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5659b058{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5659b062{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5659b063{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5659b06c{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5659b06d{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5659b076{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5659b080{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5659b0bc{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table class="cl-565cfb0a">
<caption class="Table Caption">
<p>First 15 rows of the ordata.</p>
</caption>

<thead><tr style="overflow-wrap:break-word;"><td class="cl-5659b080"><p class="cl-56598560"><span class="cl-56597b74">Recommend</span></p></td><td class="cl-5659b076"><p class="cl-5659856a"><span class="cl-56597b74">Internal</span></p></td><td class="cl-5659b076"><p class="cl-5659856a"><span class="cl-56597b74">Exchange</span></p></td><td class="cl-5659b0bc"><p class="cl-5659856a"><span class="cl-56597b74">FinalScore</span></p></td></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-5659b044"><p class="cl-56598560"><span class="cl-56597b7e">very likely</span></p></td><td class="cl-5659b045"><p class="cl-5659856a"><span class="cl-56597b7e">0</span></p></td><td class="cl-5659b045"><p class="cl-5659856a"><span class="cl-56597b7e">0</span></p></td><td class="cl-5659b03a"><p class="cl-5659856a"><span class="cl-56597b7e">3.26</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-5659b058"><p class="cl-56598560"><span class="cl-56597b7e">somewhat likely</span></p></td><td class="cl-5659b04e"><p class="cl-5659856a"><span class="cl-56597b7e">1</span></p></td><td class="cl-5659b04e"><p class="cl-5659856a"><span class="cl-56597b7e">0</span></p></td><td class="cl-5659b062"><p class="cl-5659856a"><span class="cl-56597b7e">3.21</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-5659b044"><p class="cl-56598560"><span class="cl-56597b7e">unlikely</span></p></td><td class="cl-5659b045"><p class="cl-5659856a"><span class="cl-56597b7e">1</span></p></td><td class="cl-5659b045"><p class="cl-5659856a"><span class="cl-56597b7e">1</span></p></td><td class="cl-5659b03a"><p class="cl-5659856a"><span class="cl-56597b7e">3.94</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-5659b058"><p class="cl-56598560"><span class="cl-56597b7e">somewhat likely</span></p></td><td class="cl-5659b04e"><p class="cl-5659856a"><span class="cl-56597b7e">0</span></p></td><td class="cl-5659b04e"><p class="cl-5659856a"><span class="cl-56597b7e">0</span></p></td><td class="cl-5659b062"><p class="cl-5659856a"><span class="cl-56597b7e">2.81</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-5659b044"><p class="cl-56598560"><span class="cl-56597b7e">somewhat likely</span></p></td><td class="cl-5659b045"><p class="cl-5659856a"><span class="cl-56597b7e">0</span></p></td><td class="cl-5659b045"><p class="cl-5659856a"><span class="cl-56597b7e">0</span></p></td><td class="cl-5659b03a"><p class="cl-5659856a"><span class="cl-56597b7e">2.53</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-5659b058"><p class="cl-56598560"><span class="cl-56597b7e">unlikely</span></p></td><td class="cl-5659b04e"><p class="cl-5659856a"><span class="cl-56597b7e">0</span></p></td><td class="cl-5659b04e"><p class="cl-5659856a"><span class="cl-56597b7e">1</span></p></td><td class="cl-5659b062"><p class="cl-5659856a"><span class="cl-56597b7e">2.59</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-5659b044"><p class="cl-56598560"><span class="cl-56597b7e">somewhat likely</span></p></td><td class="cl-5659b045"><p class="cl-5659856a"><span class="cl-56597b7e">0</span></p></td><td class="cl-5659b045"><p class="cl-5659856a"><span class="cl-56597b7e">0</span></p></td><td class="cl-5659b03a"><p class="cl-5659856a"><span class="cl-56597b7e">2.56</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-5659b058"><p class="cl-56598560"><span class="cl-56597b7e">somewhat likely</span></p></td><td class="cl-5659b04e"><p class="cl-5659856a"><span class="cl-56597b7e">0</span></p></td><td class="cl-5659b04e"><p class="cl-5659856a"><span class="cl-56597b7e">0</span></p></td><td class="cl-5659b062"><p class="cl-5659856a"><span class="cl-56597b7e">2.73</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-5659b044"><p class="cl-56598560"><span class="cl-56597b7e">unlikely</span></p></td><td class="cl-5659b045"><p class="cl-5659856a"><span class="cl-56597b7e">0</span></p></td><td class="cl-5659b045"><p class="cl-5659856a"><span class="cl-56597b7e">0</span></p></td><td class="cl-5659b03a"><p class="cl-5659856a"><span class="cl-56597b7e">3.00</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-5659b058"><p class="cl-56598560"><span class="cl-56597b7e">somewhat likely</span></p></td><td class="cl-5659b04e"><p class="cl-5659856a"><span class="cl-56597b7e">1</span></p></td><td class="cl-5659b04e"><p class="cl-5659856a"><span class="cl-56597b7e">0</span></p></td><td class="cl-5659b062"><p class="cl-5659856a"><span class="cl-56597b7e">3.50</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-5659b044"><p class="cl-56598560"><span class="cl-56597b7e">unlikely</span></p></td><td class="cl-5659b045"><p class="cl-5659856a"><span class="cl-56597b7e">1</span></p></td><td class="cl-5659b045"><p class="cl-5659856a"><span class="cl-56597b7e">1</span></p></td><td class="cl-5659b03a"><p class="cl-5659856a"><span class="cl-56597b7e">3.65</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-5659b058"><p class="cl-56598560"><span class="cl-56597b7e">somewhat likely</span></p></td><td class="cl-5659b04e"><p class="cl-5659856a"><span class="cl-56597b7e">0</span></p></td><td class="cl-5659b04e"><p class="cl-5659856a"><span class="cl-56597b7e">0</span></p></td><td class="cl-5659b062"><p class="cl-5659856a"><span class="cl-56597b7e">2.84</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-5659b044"><p class="cl-56598560"><span class="cl-56597b7e">very likely</span></p></td><td class="cl-5659b045"><p class="cl-5659856a"><span class="cl-56597b7e">0</span></p></td><td class="cl-5659b045"><p class="cl-5659856a"><span class="cl-56597b7e">1</span></p></td><td class="cl-5659b03a"><p class="cl-5659856a"><span class="cl-56597b7e">3.90</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-5659b058"><p class="cl-56598560"><span class="cl-56597b7e">somewhat likely</span></p></td><td class="cl-5659b04e"><p class="cl-5659856a"><span class="cl-56597b7e">0</span></p></td><td class="cl-5659b04e"><p class="cl-5659856a"><span class="cl-56597b7e">0</span></p></td><td class="cl-5659b062"><p class="cl-5659856a"><span class="cl-56597b7e">2.68</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-5659b06d"><p class="cl-56598560"><span class="cl-56597b7e">unlikely</span></p></td><td class="cl-5659b063"><p class="cl-5659856a"><span class="cl-56597b7e">1</span></p></td><td class="cl-5659b063"><p class="cl-5659856a"><span class="cl-56597b7e">0</span></p></td><td class="cl-5659b06c"><p class="cl-5659856a"><span class="cl-56597b7e">3.57</span></p></td></tr></tbody></table></div>
</div>
</div>
<p>In a first step, we need to relevel the ordinal variable to represent an ordinal factor (or a progression from “unlikely” over “somewhat likely” to “very likely”. And we will also factorize Internal and Exchange to make it easier to interpret the output later on.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="co"># relevel data</span></span>
<span id="cb146-2"><a href="#cb146-2" aria-hidden="true" tabindex="-1"></a>ordata <span class="ot">&lt;-</span> ordata <span class="sc">%&gt;%</span></span>
<span id="cb146-3"><a href="#cb146-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">Recommend =</span> <span class="fu">factor</span>(Recommend, </span>
<span id="cb146-4"><a href="#cb146-4" aria-hidden="true" tabindex="-1"></a>                           <span class="at">levels=</span><span class="fu">c</span>(<span class="st">"unlikely"</span>, <span class="st">"somewhat likely"</span>, <span class="st">"very likely"</span>),</span>
<span id="cb146-5"><a href="#cb146-5" aria-hidden="true" tabindex="-1"></a>                           <span class="at">labels=</span><span class="fu">c</span>(<span class="st">"unlikely"</span>,  <span class="st">"somewhat likely"</span>,  <span class="st">"very likely"</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb146-6"><a href="#cb146-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">Exchange =</span> <span class="fu">ifelse</span>(Exchange <span class="sc">==</span> <span class="dv">1</span>, <span class="st">"Exchange"</span>, <span class="st">"NoExchange"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb146-7"><a href="#cb146-7" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">Internal =</span> <span class="fu">ifelse</span>(Internal <span class="sc">==</span> <span class="dv">1</span>, <span class="st">"Internal"</span>, <span class="st">"External"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now that the dependent variable is releveled, we check the distribution of the variable levels by tabulating the data. To get a better understanding of the data we create frequency tables across variables rather than viewing the variables in isolation.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="do">## three way cross tabs (xtabs) and flatten the table</span></span>
<span id="cb147-2"><a href="#cb147-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ftable</span>(<span class="fu">xtabs</span>(<span class="sc">~</span> Exchange <span class="sc">+</span> Recommend <span class="sc">+</span> Internal, <span class="at">data =</span> ordata))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                           Internal External Internal
Exchange   Recommend                                 
Exchange   unlikely                       25        6
           somewhat likely                12        4
           very likely                     7        3
NoExchange unlikely                      175       14
           somewhat likely                98       26
           very likely                    20       10</code></pre>
</div>
</div>
<p>We also check the mean and standard deviation of the final score as final score is a numeric variable and cannot be tabulated (unless we convert it to a factor).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb149"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ordata<span class="sc">$</span>FinalScore); <span class="fu">sd</span>(ordata<span class="sc">$</span>FinalScore)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. 
1.900000 2.720000 2.990000 2.998925 3.270000 4.000000 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.397940933861</code></pre>
</div>
</div>
<p>The lowest score is 1.9 and the highest score is a 4.0 with a mean of approximately 3. Finally, we inspect the distributions graphically.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb152"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a><span class="co"># visualize data</span></span>
<span id="cb152-2"><a href="#cb152-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(ordata, <span class="fu">aes</span>(<span class="at">x =</span> Recommend, <span class="at">y =</span> FinalScore)) <span class="sc">+</span></span>
<span id="cb152-3"><a href="#cb152-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">size =</span> .<span class="dv">75</span>) <span class="sc">+</span></span>
<span id="cb152-4"><a href="#cb152-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">alpha =</span> .<span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb152-5"><a href="#cb152-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(Exchange <span class="sc">~</span> Internal, <span class="at">margins =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb152-6"><a href="#cb152-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">vjust =</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="fixreg_files/figure-html/orr6-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>We see that we have only few students that have taken part in an exchange program and there are also only few internal students overall. With respect to recommendations, only few students are considered to very likely succeed in the program. We can now start with the modeling by using the <code>polr</code> function. To make things easier for us, we will only consider the main effects here as this tutorial only aims to how to implement an ordinal regression but not how it should be done in a proper study - then, the model fitting and diagnostic procedures would have to be performed accurately, of course.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb153"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a><span class="co"># fit ordered logit model and store results 'm'</span></span>
<span id="cb153-2"><a href="#cb153-2" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">polr</span>(Recommend <span class="sc">~</span> Internal <span class="sc">+</span> Exchange <span class="sc">+</span> FinalScore, <span class="at">data =</span> ordata, <span class="at">Hess=</span><span class="cn">TRUE</span>)</span>
<span id="cb153-3"><a href="#cb153-3" aria-hidden="true" tabindex="-1"></a><span class="co"># summarize model</span></span>
<span id="cb153-4"><a href="#cb153-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
polr(formula = Recommend ~ Internal + Exchange + FinalScore, 
    data = ordata, Hess = TRUE)

Coefficients:
                          Value  Std. Error     t value
InternalInternal   1.0476639460 0.265789134 3.941710973
ExchangeNoExchange 0.0586810767 0.297858822 0.197009698
FinalScore         0.6157435926 0.260631275 2.362508462

Intercepts:
                            Value       Std. Error  t value    
unlikely|somewhat likely    2.261997623 0.882173604 2.564118460
somewhat likely|very likely 4.357441880 0.904467838 4.817685824

Residual Deviance: 717.024871356 
AIC: 727.024871356 </code></pre>
</div>
</div>
<p>The results show that having studied here at this school increases the chances of receiving a positive recommendation but that having been on an exchange has a negative but insignificant effect on the recommendation. The final score also correlates positively with a positive recommendation but not as much as having studied here.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb155"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a><span class="do">## store table</span></span>
<span id="cb155-2"><a href="#cb155-2" aria-hidden="true" tabindex="-1"></a>(ctable <span class="ot">&lt;-</span> <span class="fu">coef</span>(<span class="fu">summary</span>(m)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                                      Value     Std. Error        t value
InternalInternal            1.0476639460469 0.265789134041 3.941710972596
ExchangeNoExchange          0.0586810766831 0.297858821982 0.197009698396
FinalScore                  0.6157435925546 0.260631274948 2.362508462104
unlikely|somewhat likely    2.2619976233665 0.882173604268 2.564118459704
somewhat likely|very likely 4.3574418799106 0.904467837679 4.817685824069</code></pre>
</div>
</div>
<p>As the regression report does not provide p-values, we have to calculate them separately (after having calculated them, we add them to the coefficient table).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb157"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="do">## calculate and store p values</span></span>
<span id="cb157-2"><a href="#cb157-2" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">pnorm</span>(<span class="fu">abs</span>(ctable[, <span class="st">"t value"</span>]), <span class="at">lower.tail =</span> <span class="cn">FALSE</span>) <span class="sc">*</span> <span class="dv">2</span></span>
<span id="cb157-3"><a href="#cb157-3" aria-hidden="true" tabindex="-1"></a><span class="do">## combined table</span></span>
<span id="cb157-4"><a href="#cb157-4" aria-hidden="true" tabindex="-1"></a>(ctable <span class="ot">&lt;-</span> <span class="fu">cbind</span>(ctable, <span class="st">"p value"</span> <span class="ot">=</span> p))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                                      Value     Std. Error        t value
InternalInternal            1.0476639460469 0.265789134041 3.941710972596
ExchangeNoExchange          0.0586810766831 0.297858821982 0.197009698396
FinalScore                  0.6157435925546 0.260631274948 2.362508462104
unlikely|somewhat likely    2.2619976233665 0.882173604268 2.564118459704
somewhat likely|very likely 4.3574418799106 0.904467837679 4.817685824069
                                        p value
InternalInternal            0.00008090242989074
ExchangeNoExchange          0.84381994829785212
FinalScore                  0.01815172703306605
unlikely|somewhat likely    0.01034382345525988
somewhat likely|very likely 0.00000145232812832</code></pre>
</div>
</div>
<p>As predicted, Exchange does not have a significant effect but FinalScore and Internal both correlate significantly with the likelihood of receiving a positive recommendation.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb159"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a><span class="co"># extract profiled confidence intervals</span></span>
<span id="cb159-2"><a href="#cb159-2" aria-hidden="true" tabindex="-1"></a>ci <span class="ot">&lt;-</span> <span class="fu">confint</span>(m)</span>
<span id="cb159-3"><a href="#cb159-3" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate odds ratios and combine them with profiled CIs</span></span>
<span id="cb159-4"><a href="#cb159-4" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(<span class="fu">cbind</span>(<span class="at">OR =</span> <span class="fu">coef</span>(m), ci))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                              OR          2.5 %        97.5 %
InternalInternal   2.85098328212 1.695837799597 4.81711408266
ExchangeNoExchange 1.06043698872 0.595033205649 1.91977108408
FinalScore         1.85103250193 1.113625249822 3.09849059342</code></pre>
</div>
</div>
<p>The odds ratios show that internal students are 2.85 times or 285 percent as likely as non-internal students to receive positive evaluations and that a 1-point increase in the test score lead to a 1.85 times or 185 percent increase in the chances of receiving a positive recommendation. The effect of an exchange is slightly negative but, as we have seen above, not significant.</p>
</section>
<section id="poisson-regression" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="poisson-regression">Poisson Regression</h2>
<p>This section is based on <a href="https://stats.idre.ucla.edu/r/dae/poisson-regression/">this tutorials</a> on how to perform a Poisson regression in R.</p>
<div class="warning" style="padding:0.1em; background-color:#f2f2f2; color:#51247a">
<span>
<p style="margin-top:1em; text-align:center">
<br>Poisson regressions are used to analyze data where the dependent variable represents counts.
</p>
<p style="margin-left:1em;">
</p>
<p></p>
</span></div>
<p><br></p>
<p>This applied particularly to counts that are based on observations of something that is measured in set intervals. For instances the number of pauses in two-minute-long conversations. Poisson regressions are particularly appealing when dealing with rare events, i.e.&nbsp;when something only occurs very infrequently. In such cases, normal linear regressions do not work because the instances that do occur are automatically considered outliers. Therefore, it is useful to check if the data conform to a Poisson distribution.</p>
<p>However, the tricky thing about Poisson regressions is that the data has to conform to the Poisson distribution which is, according to my experience, rarely the case, unfortunately. The Gaussian Normal Distribution is very flexible because it is defined by two parameters, the mean (mu, i.e.&nbsp;<span class="math inline">\(\mu\)</span>) and the standard deviation (sigma, i.e.&nbsp;<span class="math inline">\(\sigma\)</span>). This allows the normal distribution to take very different shapes (for example, very high and slim (compressed) or very wide and flat). In contrast, the Poisson is defined by only one parameter (lambda, i.e.&nbsp;<span class="math inline">\(\lambda\)</span>) which mean that if we have a mean of 2, then the standard deviation is also 2 (actually we would have to say that the mean is <span class="math inline">\(\lambda\)</span> and the standard deviation is also <span class="math inline">\(\lambda\)</span> or <span class="math inline">\(\lambda\)</span> = <span class="math inline">\(\mu\)</span> = <span class="math inline">\(\sigma\)</span>). This is much trickier for natural data as this means that the Poisson distribution is very rigid.</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="fixreg_files/figure-html/pr0-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>As we can see, as <span class="math inline">\(\lambda\)</span> takes on higher values, the distribution becomes wider and flatter - a compressed distribution with a high mean can therefore not be Poisson-distributed. We will now start by loading the data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb161"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load data</span></span>
<span id="cb161-2"><a href="#cb161-2" aria-hidden="true" tabindex="-1"></a>poissondata  <span class="ot">&lt;-</span> base<span class="sc">::</span><span class="fu">readRDS</span>(<span class="fu">url</span>(<span class="st">"https://slcladal.github.io/data/prd.rda"</span>, <span class="st">"rb"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">

<div class="tabwid"><style>.cl-578ec5f8{table-layout:auto;width:75%;}.cl-578a4866{font-family:'DejaVu Sans';font-size:12pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-578a487a{font-family:'DejaVu Sans';font-size:12pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-578a5b76{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-578a5b80{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-578a9c80{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-578a9c8a{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-578a9c8b{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-578a9c94{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-578a9c9e{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-578a9ca8{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-578a9cb2{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-578a9cb3{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-578a9cbc{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-578a9cc6{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-578a9cd0{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-578a9cda{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-578a9cdb{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-578a9ce4{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-578a9cee{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-578a9cf8{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table class="cl-578ec5f8">
<caption class="Table Caption">
<p>First 15 rows of the poissondata.</p>
</caption>

<thead><tr style="overflow-wrap:break-word;"><td class="cl-578a9cf8"><p class="cl-578a5b76"><span class="cl-578a4866">Id</span></p></td><td class="cl-578a9ce4"><p class="cl-578a5b76"><span class="cl-578a4866">Pauses</span></p></td><td class="cl-578a9cee"><p class="cl-578a5b80"><span class="cl-578a4866">Language</span></p></td><td class="cl-578a9cdb"><p class="cl-578a5b76"><span class="cl-578a4866">Alcohol</span></p></td></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-578a9c8b"><p class="cl-578a5b76"><span class="cl-578a487a">45</span></p></td><td class="cl-578a9c94"><p class="cl-578a5b76"><span class="cl-578a487a">0</span></p></td><td class="cl-578a9c80"><p class="cl-578a5b80"><span class="cl-578a487a">German</span></p></td><td class="cl-578a9c8a"><p class="cl-578a5b76"><span class="cl-578a487a">41</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-578a9ca8"><p class="cl-578a5b76"><span class="cl-578a487a">108</span></p></td><td class="cl-578a9c9e"><p class="cl-578a5b76"><span class="cl-578a487a">0</span></p></td><td class="cl-578a9cb3"><p class="cl-578a5b80"><span class="cl-578a487a">Russian</span></p></td><td class="cl-578a9cb2"><p class="cl-578a5b76"><span class="cl-578a487a">41</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-578a9c8b"><p class="cl-578a5b76"><span class="cl-578a487a">15</span></p></td><td class="cl-578a9c94"><p class="cl-578a5b76"><span class="cl-578a487a">0</span></p></td><td class="cl-578a9c80"><p class="cl-578a5b80"><span class="cl-578a487a">German</span></p></td><td class="cl-578a9c8a"><p class="cl-578a5b76"><span class="cl-578a487a">44</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-578a9ca8"><p class="cl-578a5b76"><span class="cl-578a487a">67</span></p></td><td class="cl-578a9c9e"><p class="cl-578a5b76"><span class="cl-578a487a">0</span></p></td><td class="cl-578a9cb3"><p class="cl-578a5b80"><span class="cl-578a487a">German</span></p></td><td class="cl-578a9cb2"><p class="cl-578a5b76"><span class="cl-578a487a">42</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-578a9c8b"><p class="cl-578a5b76"><span class="cl-578a487a">153</span></p></td><td class="cl-578a9c94"><p class="cl-578a5b76"><span class="cl-578a487a">0</span></p></td><td class="cl-578a9c80"><p class="cl-578a5b80"><span class="cl-578a487a">German</span></p></td><td class="cl-578a9c8a"><p class="cl-578a5b76"><span class="cl-578a487a">40</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-578a9ca8"><p class="cl-578a5b76"><span class="cl-578a487a">51</span></p></td><td class="cl-578a9c9e"><p class="cl-578a5b76"><span class="cl-578a487a">0</span></p></td><td class="cl-578a9cb3"><p class="cl-578a5b80"><span class="cl-578a487a">Russian</span></p></td><td class="cl-578a9cb2"><p class="cl-578a5b76"><span class="cl-578a487a">42</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-578a9c8b"><p class="cl-578a5b76"><span class="cl-578a487a">164</span></p></td><td class="cl-578a9c94"><p class="cl-578a5b76"><span class="cl-578a487a">0</span></p></td><td class="cl-578a9c80"><p class="cl-578a5b80"><span class="cl-578a487a">German</span></p></td><td class="cl-578a9c8a"><p class="cl-578a5b76"><span class="cl-578a487a">46</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-578a9ca8"><p class="cl-578a5b76"><span class="cl-578a487a">133</span></p></td><td class="cl-578a9c9e"><p class="cl-578a5b76"><span class="cl-578a487a">0</span></p></td><td class="cl-578a9cb3"><p class="cl-578a5b80"><span class="cl-578a487a">German</span></p></td><td class="cl-578a9cb2"><p class="cl-578a5b76"><span class="cl-578a487a">40</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-578a9c8b"><p class="cl-578a5b76"><span class="cl-578a487a">2</span></p></td><td class="cl-578a9c94"><p class="cl-578a5b76"><span class="cl-578a487a">0</span></p></td><td class="cl-578a9c80"><p class="cl-578a5b80"><span class="cl-578a487a">German</span></p></td><td class="cl-578a9c8a"><p class="cl-578a5b76"><span class="cl-578a487a">33</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-578a9ca8"><p class="cl-578a5b76"><span class="cl-578a487a">53</span></p></td><td class="cl-578a9c9e"><p class="cl-578a5b76"><span class="cl-578a487a">0</span></p></td><td class="cl-578a9cb3"><p class="cl-578a5b80"><span class="cl-578a487a">German</span></p></td><td class="cl-578a9cb2"><p class="cl-578a5b76"><span class="cl-578a487a">46</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-578a9c8b"><p class="cl-578a5b76"><span class="cl-578a487a">1</span></p></td><td class="cl-578a9c94"><p class="cl-578a5b76"><span class="cl-578a487a">0</span></p></td><td class="cl-578a9c80"><p class="cl-578a5b80"><span class="cl-578a487a">German</span></p></td><td class="cl-578a9c8a"><p class="cl-578a5b76"><span class="cl-578a487a">40</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-578a9ca8"><p class="cl-578a5b76"><span class="cl-578a487a">128</span></p></td><td class="cl-578a9c9e"><p class="cl-578a5b76"><span class="cl-578a487a">0</span></p></td><td class="cl-578a9cb3"><p class="cl-578a5b80"><span class="cl-578a487a">English</span></p></td><td class="cl-578a9cb2"><p class="cl-578a5b76"><span class="cl-578a487a">38</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-578a9c8b"><p class="cl-578a5b76"><span class="cl-578a487a">16</span></p></td><td class="cl-578a9c94"><p class="cl-578a5b76"><span class="cl-578a487a">0</span></p></td><td class="cl-578a9c80"><p class="cl-578a5b80"><span class="cl-578a487a">German</span></p></td><td class="cl-578a9c8a"><p class="cl-578a5b76"><span class="cl-578a487a">44</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-578a9ca8"><p class="cl-578a5b76"><span class="cl-578a487a">106</span></p></td><td class="cl-578a9c9e"><p class="cl-578a5b76"><span class="cl-578a487a">0</span></p></td><td class="cl-578a9cb3"><p class="cl-578a5b80"><span class="cl-578a487a">German</span></p></td><td class="cl-578a9cb2"><p class="cl-578a5b76"><span class="cl-578a487a">37</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-578a9cc6"><p class="cl-578a5b76"><span class="cl-578a487a">89</span></p></td><td class="cl-578a9cda"><p class="cl-578a5b76"><span class="cl-578a487a">0</span></p></td><td class="cl-578a9cbc"><p class="cl-578a5b80"><span class="cl-578a487a">German</span></p></td><td class="cl-578a9cd0"><p class="cl-578a5b76"><span class="cl-578a487a">40</span></p></td></tr></tbody></table></div>
</div>
</div>
<p>We will clean the data by factorizing Id which is currently considered a numeric variable rather than a factor.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb162"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a><span class="co"># process data</span></span>
<span id="cb162-2"><a href="#cb162-2" aria-hidden="true" tabindex="-1"></a>poissondata <span class="ot">&lt;-</span> poissondata <span class="sc">%&gt;%</span></span>
<span id="cb162-3"><a href="#cb162-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Id =</span> <span class="fu">factor</span>(Id, <span class="at">levels =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">200</span>, <span class="at">labels =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">200</span>))</span>
<span id="cb162-4"><a href="#cb162-4" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect data</span></span>
<span id="cb162-5"><a href="#cb162-5" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(poissondata)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   200 obs. of  4 variables:
 $ Id      : Factor w/ 200 levels "1","2","3","4",..: 45 108 15 67 153 51 164 133 2 53 ...
 $ Pauses  : int  0 0 0 0 0 0 0 0 0 0 ...
 $ Language: chr  "German" "Russian" "German" "German" ...
 $ Alcohol : int  41 41 44 42 40 42 46 40 33 46 ...</code></pre>
</div>
</div>
<p>First, we check if the conditions for a Poisson regression are met.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb164"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a><span class="co"># output the results</span></span>
<span id="cb164-2"><a href="#cb164-2" aria-hidden="true" tabindex="-1"></a>gf <span class="ot">=</span> vcd<span class="sc">::</span><span class="fu">goodfit</span>(poissondata<span class="sc">$</span>Pauses, </span>
<span id="cb164-3"><a href="#cb164-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">type=</span> <span class="st">"poisson"</span>, </span>
<span id="cb164-4"><a href="#cb164-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">method=</span> <span class="st">"ML"</span>)</span>
<span id="cb164-5"><a href="#cb164-5" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect results</span></span>
<span id="cb164-6"><a href="#cb164-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(gf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
     Goodness-of-fit test for poisson distribution

                           X^2 df            P(&gt; X^2)
Likelihood Ratio 33.0122916717  5 0.00000374234139957</code></pre>
</div>
</div>
<p>If the p-values is smaller than .05, then data is not Poisson distributed which means that it differs significantly from a Poisson distribution and is very likely over-dispersed. We will check the divergence from a Poisson distribution visually by plotting the observed counts against the expected counts if the data were Poisson distributed.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb166"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(gf,<span class="at">main=</span><span class="st">"Count data vs Poisson distribution"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="fixreg_files/figure-html/pr5-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Although the goodfit function reported that the data differs significantly from the Poisson distribution, the fit is rather good. We can use an additional Levene’s test to check if variance homogeneity is given.</p>
<div class="warning" style="padding:0.1em; background-color:#f2f2f2; color:#51247a">
<span>
<p style="margin-top:1em; text-align:center">
<b>NOTE</b><br><br>The use of Levene’s test to check if the model is heteroscedastic is generally not recommended as it is too lax when dealing with few observations (because in such cases it does not have the power to identify heteroscedasticity) while it is too harsh when dealing with many observations (when heteroscedasticity typically is not a severe problem).
</p>
<p style="margin-left:1em;">
</p>
<p></p>
</span></div>
<p><br></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb167"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check homogeneity</span></span>
<span id="cb167-2"><a href="#cb167-2" aria-hidden="true" tabindex="-1"></a><span class="fu">leveneTest</span>(poissondata<span class="sc">$</span>Pauses, poissondata<span class="sc">$</span>Language, <span class="at">center =</span> mean)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Levene's Test for Homogeneity of Variance (center = mean)
       Df  F value        Pr(&gt;F)    
group   2 17.15274 0.00000013571 ***
      197                           
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>The Levene’s test indicates that variance homogeneity is also violated. Since both the approximation to a Poisson distribution and variance homogeneity are violated, we should switch either to a quasi-Poisson model or a negative binomial model. However, as we are only interested in how to implement a Poisson model here, we continue despite the fact that this could not be recommended if we were actually interested in accurate results based on a reliable model.</p>
<p>In a next step, we summarize Progression by inspecting the means and standard deviations of the individual variable levels.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb169"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb169-1"><a href="#cb169-1" aria-hidden="true" tabindex="-1"></a><span class="co"># extract mean and standard deviation</span></span>
<span id="cb169-2"><a href="#cb169-2" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(poissondata, <span class="fu">tapply</span>(Pauses, Language, <span class="cf">function</span>(x) {</span>
<span id="cb169-3"><a href="#cb169-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sprintf</span>(<span class="st">"M (SD) = %1.2f (%1.2f)"</span>, <span class="fu">mean</span>(x), <span class="fu">sd</span>(x))</span>
<span id="cb169-4"><a href="#cb169-4" aria-hidden="true" tabindex="-1"></a>}))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>               English                 German                Russian 
"M (SD) = 1.00 (1.28)" "M (SD) = 0.24 (0.52)" "M (SD) = 0.20 (0.40)" </code></pre>
</div>
</div>
<p>Now, we visualize the data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb171"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot data</span></span>
<span id="cb171-2"><a href="#cb171-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(poissondata, <span class="fu">aes</span>(Pauses, <span class="at">fill =</span> Language)) <span class="sc">+</span></span>
<span id="cb171-3"><a href="#cb171-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth=</span>.<span class="dv">5</span>, <span class="at">position=</span><span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb171-4"><a href="#cb171-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"gray30"</span>, <span class="st">"gray50"</span>, <span class="st">"gray70"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="fixreg_files/figure-html/pr8-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb172"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb172-1"><a href="#cb172-1" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate Poisson regression</span></span>
<span id="cb172-2"><a href="#cb172-2" aria-hidden="true" tabindex="-1"></a>m1.poisson <span class="ot">&lt;-</span> <span class="fu">glm</span>(Pauses <span class="sc">~</span> Language <span class="sc">+</span> Alcohol, <span class="at">family=</span><span class="st">"poisson"</span>, <span class="at">data=</span>poissondata)</span>
<span id="cb172-3"><a href="#cb172-3" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect model</span></span>
<span id="cb172-4"><a href="#cb172-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m1.poisson)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = Pauses ~ Language + Alcohol, family = "poisson", 
    data = poissondata)

Deviance Residuals: 
         Min            1Q        Median            3Q           Max  
-2.204338080  -0.843641817  -0.510586515   0.255772098   2.679576560  

Coefficients:
                     Estimate    Std. Error  z value         Pr(&gt;|z|)    
(Intercept)     -4.1632652529  0.6628774832 -6.28060 0.00000000033728 ***
LanguageGerman  -0.7140499158  0.3200148750 -2.23130         0.025661 *  
LanguageRussian -1.0838591456  0.3582529824 -3.02540         0.002483 ** 
Alcohol          0.0701523975  0.0105992050  6.61865 0.00000000003625 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 287.6722345  on 199  degrees of freedom
Residual deviance: 189.4496199  on 196  degrees of freedom
AIC: 373.5045031

Number of Fisher Scoring iterations: 6</code></pre>
</div>
</div>
<p>In addition to the Estimates for the coefficients, we could also calculate the confidence intervals for the coefficients (LL stands for lower limit and UL for upper limit in the table below).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb174"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb174-1"><a href="#cb174-1" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate model</span></span>
<span id="cb174-2"><a href="#cb174-2" aria-hidden="true" tabindex="-1"></a>cov.m1 <span class="ot">&lt;-</span> sandwich<span class="sc">::</span><span class="fu">vcovHC</span>(m1.poisson, <span class="at">type=</span><span class="st">"HC0"</span>)</span>
<span id="cb174-3"><a href="#cb174-3" aria-hidden="true" tabindex="-1"></a><span class="co"># extract standard error</span></span>
<span id="cb174-4"><a href="#cb174-4" aria-hidden="true" tabindex="-1"></a>std.err <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">diag</span>(cov.m1))</span>
<span id="cb174-5"><a href="#cb174-5" aria-hidden="true" tabindex="-1"></a><span class="co"># extract robust estimates</span></span>
<span id="cb174-6"><a href="#cb174-6" aria-hidden="true" tabindex="-1"></a>r.est <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="at">Estimate=</span> <span class="fu">coef</span>(m1.poisson), </span>
<span id="cb174-7"><a href="#cb174-7" aria-hidden="true" tabindex="-1"></a>               <span class="st">"Robust SE"</span> <span class="ot">=</span> std.err,</span>
<span id="cb174-8"><a href="#cb174-8" aria-hidden="true" tabindex="-1"></a>               <span class="st">"Pr(&gt;|z|)"</span> <span class="ot">=</span> <span class="dv">2</span> <span class="sc">*</span> <span class="fu">pnorm</span>(<span class="fu">abs</span>(<span class="fu">coef</span>(m1.poisson)<span class="sc">/</span>std.err),</span>
<span id="cb174-9"><a href="#cb174-9" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">lower.tail=</span><span class="cn">FALSE</span>),</span>
<span id="cb174-10"><a href="#cb174-10" aria-hidden="true" tabindex="-1"></a><span class="at">LL =</span> <span class="fu">coef</span>(m1.poisson) <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> std.err,</span>
<span id="cb174-11"><a href="#cb174-11" aria-hidden="true" tabindex="-1"></a><span class="at">UL =</span> <span class="fu">coef</span>(m1.poisson) <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> std.err)</span>
<span id="cb174-12"><a href="#cb174-12" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect data</span></span>
<span id="cb174-13"><a href="#cb174-13" aria-hidden="true" tabindex="-1"></a>r.est</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                        Estimate       Robust SE                 Pr(&gt;|z|)
(Intercept)     -4.1632652529178 0.6480942940026 0.0000000001328637743948
LanguageGerman  -0.7140499157783 0.2986422497410 0.0168031204011183932234
LanguageRussian -1.0838591456208 0.3210481575684 0.0007354744824167306532
Alcohol          0.0701523974937 0.0104351647012 0.0000000000178397516955
                              LL               UL
(Intercept)     -5.4335300691629 -2.8930004366727
LanguageGerman  -1.2993887252708 -0.1287111062859
LanguageRussian -1.7131135344549 -0.4546047567867
Alcohol          0.0496994746793  0.0906053203082</code></pre>
</div>
</div>
<p>We can now calculate the p-value of the model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb176"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb176-1"><a href="#cb176-1" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(m1.poisson, <span class="fu">cbind</span>(<span class="at">res.deviance =</span> deviance, <span class="at">df =</span> df.residual,</span>
<span id="cb176-2"><a href="#cb176-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">p =</span> <span class="fu">pchisq</span>(deviance, df.residual, <span class="at">lower.tail=</span><span class="cn">FALSE</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     res.deviance  df              p
[1,] 189.44961991 196 0.618227445717</code></pre>
</div>
</div>
<p>Now, we check, if removing Language leads to a significant decrease in model fit.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb178"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb178-1"><a href="#cb178-1" aria-hidden="true" tabindex="-1"></a><span class="co"># remove Language from the model</span></span>
<span id="cb178-2"><a href="#cb178-2" aria-hidden="true" tabindex="-1"></a>m2.poisson <span class="ot">&lt;-</span> <span class="fu">update</span>(m1.poisson, . <span class="sc">~</span> . <span class="sc">-</span>Language)</span>
<span id="cb178-3"><a href="#cb178-3" aria-hidden="true" tabindex="-1"></a><span class="co"># check if dropping Language causes a significant decrease in model fit</span></span>
<span id="cb178-4"><a href="#cb178-4" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(m2.poisson, m1.poisson, <span class="at">test=</span><span class="st">"Chisq"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Deviance Table

Model 1: Pauses ~ Alcohol
Model 2: Pauses ~ Language + Alcohol
  Resid. Df  Resid. Dev Df   Deviance   Pr(&gt;Chi)    
1       198 204.0213018                             
2       196 189.4496199  2 14.5716819 0.00068517 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>We now calculate robust coefficients using the <code>msm</code> package <span class="citation" data-cites="msm">[<a href="#ref-msm" role="doc-biblioref">28</a>]</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb180"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb180-1"><a href="#cb180-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get estimates</span></span>
<span id="cb180-2"><a href="#cb180-2" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> msm<span class="sc">::</span><span class="fu">deltamethod</span>(<span class="fu">list</span>(<span class="sc">~</span> <span class="fu">exp</span>(x1), <span class="sc">~</span> <span class="fu">exp</span>(x2), <span class="sc">~</span> <span class="fu">exp</span>(x3), <span class="sc">~</span> <span class="fu">exp</span>(x4)), </span>
<span id="cb180-3"><a href="#cb180-3" aria-hidden="true" tabindex="-1"></a>                                                <span class="fu">coef</span>(m1.poisson), cov.m1)</span>
<span id="cb180-4"><a href="#cb180-4" aria-hidden="true" tabindex="-1"></a><span class="co"># exponentiate old estimates dropping the p values</span></span>
<span id="cb180-5"><a href="#cb180-5" aria-hidden="true" tabindex="-1"></a>rexp.est <span class="ot">&lt;-</span> <span class="fu">exp</span>(r.est[, <span class="sc">-</span><span class="dv">3</span>])</span>
<span id="cb180-6"><a href="#cb180-6" aria-hidden="true" tabindex="-1"></a><span class="co"># replace SEs with estimates for exponentiated coefficients</span></span>
<span id="cb180-7"><a href="#cb180-7" aria-hidden="true" tabindex="-1"></a>rexp.est[, <span class="st">"Robust SE"</span>] <span class="ot">&lt;-</span> s</span>
<span id="cb180-8"><a href="#cb180-8" aria-hidden="true" tabindex="-1"></a><span class="co"># display results</span></span>
<span id="cb180-9"><a href="#cb180-9" aria-hidden="true" tabindex="-1"></a>rexp.est</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                       Estimate       Robust SE               LL
(Intercept)     0.0155566784084 0.0100821945101 0.00436765044896
LanguageGerman  0.4896571063601 0.1462322998451 0.27269843575906
LanguageRussian 0.3382875026084 0.1086065794408 0.18030353649622
Alcohol         1.0726716412682 0.0111935052470 1.05095521026088
                             UL
(Intercept)     0.0554097096208
LanguageGerman  0.8792279322820
LanguageRussian 0.6346987787641
Alcohol         1.0948368101199</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb182"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb182-1"><a href="#cb182-1" aria-hidden="true" tabindex="-1"></a><span class="co"># extract predicted values</span></span>
<span id="cb182-2"><a href="#cb182-2" aria-hidden="true" tabindex="-1"></a>(s1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Alcohol =</span> <span class="fu">mean</span>(poissondata<span class="sc">$</span>Alcohol),</span>
<span id="cb182-3"><a href="#cb182-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Language =</span> <span class="fu">factor</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">levels =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">labels =</span> <span class="fu">names</span>(<span class="fu">table</span>(poissondata<span class="sc">$</span>Language)))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Alcohol Language
1  52.645  English
2  52.645   German
3  52.645  Russian</code></pre>
</div>
<div class="sourceCode cell-code" id="cb184"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb184-1"><a href="#cb184-1" aria-hidden="true" tabindex="-1"></a><span class="co"># show results</span></span>
<span id="cb184-2"><a href="#cb184-2" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(m1.poisson, s1, <span class="at">type=</span><span class="st">"response"</span>, <span class="at">se.fit=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$fit
             1              2              3 
0.624944591447 0.306008560283 0.211410945109 

$se.fit
              1               2               3 
0.0862811728183 0.0883370633684 0.0705010813453 

$residual.scale
[1] 1</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb186"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb186-1"><a href="#cb186-1" aria-hidden="true" tabindex="-1"></a><span class="do">## calculate and store predicted values</span></span>
<span id="cb186-2"><a href="#cb186-2" aria-hidden="true" tabindex="-1"></a>poissondata<span class="sc">$</span>Predicted <span class="ot">&lt;-</span> <span class="fu">predict</span>(m1.poisson, <span class="at">type=</span><span class="st">"response"</span>)</span>
<span id="cb186-3"><a href="#cb186-3" aria-hidden="true" tabindex="-1"></a><span class="do">## order by program and then by math</span></span>
<span id="cb186-4"><a href="#cb186-4" aria-hidden="true" tabindex="-1"></a>poissondata <span class="ot">&lt;-</span> poissondata[<span class="fu">with</span>(poissondata, <span class="fu">order</span>(Language, Alcohol)), ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb187"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb187-1"><a href="#cb187-1" aria-hidden="true" tabindex="-1"></a><span class="do">## create the plot</span></span>
<span id="cb187-2"><a href="#cb187-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(poissondata, <span class="fu">aes</span>(<span class="at">x =</span> Alcohol, <span class="at">y =</span> Predicted, <span class="at">colour =</span> Language)) <span class="sc">+</span></span>
<span id="cb187-3"><a href="#cb187-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> Pauses), <span class="at">alpha=</span>.<span class="dv">5</span>, </span>
<span id="cb187-4"><a href="#cb187-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">position=</span><span class="fu">position_jitter</span>(<span class="at">h=</span>.<span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb187-5"><a href="#cb187-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb187-6"><a href="#cb187-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Alcohol (ml)"</span>, <span class="at">y =</span> <span class="st">"Expected number of pauses"</span>) <span class="sc">+</span></span>
<span id="cb187-7"><a href="#cb187-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"gray30"</span>, <span class="st">"gray50"</span>, <span class="st">"gray70"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="fixreg_files/figure-html/pr16-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>That’s it for this tutorial. We hope that you have enjoyed this tutorial and learned how to perform regression analysis including model fitting and model diagnostics as well as reporting regression results.</p>
</section>
</section>
<section id="citation-session-info" class="level1 unnumbered">
<h1 class="unnumbered">Citation &amp; Session Info</h1>
<p>Schweinberger, Martin. 2022. <em>Fixed-Effects Regression Modelling in R</em>. Brisbane: The University of Queensland. url: https://slcladal.github.io/fixreg.html (Version 2022.08.31).</p>
<pre><code>@manual{schweinberger2022fixreg,
  author = {Schweinberger, Martin},
  title = {Fixed-Effects Regression Modelling in R},
  note = {https://slcladal.github.io/fixreg.html},
  year = {2022},
  organization = "The University of Queensland, Australia. School of Languages and Cultures},
  address = {Brisbane},
  edition = {2022.08.31}
}</code></pre>
<div class="cell">
<div class="sourceCode cell-code" id="cb189"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb189-1"><a href="#cb189-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sessionInfo</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R version 4.2.1 (2022-06-23)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 22.04.1 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.10.0
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.10.0

locale:
 [1] LC_CTYPE=en_AU.UTF-8          LC_NUMERIC=C                 
 [3] LC_TIME=en_AU.UTF-8           LC_COLLATE=en_AU.UTF-8       
 [5] LC_MONETARY=en_AU.UTF-8       LC_MESSAGES=en_AU.UTF-8      
 [7] LC_PAPER=en_AU.UTF-8          LC_NAME=en_AU.UTF-8          
 [9] LC_ADDRESS=en_AU.UTF-8        LC_TELEPHONE=en_AU.UTF-8     
[11] LC_MEASUREMENT=en_AU.UTF-8    LC_IDENTIFICATION=en_AU.UTF-8

attached base packages:
[1] grid      stats     graphics  grDevices utils     datasets  methods  
[8] base     

other attached packages:
 [1] dplyr_1.0.9        report_0.5.1       performance_0.9.1  glmulti_1.0.8     
 [5] leaps_3.1          rJava_1.0-6        vip_0.3.2          vcd_1.4-10        
 [9] stringr_1.4.0      sjPlot_2.8.10      rms_6.3-0          SparseM_1.81      
[13] ordinal_2019.12-10 MASS_7.3-58.1      Hmisc_4.7-1        Formula_1.2-4     
[17] survival_3.4-0     lattice_0.20-45    ggpubr_0.4.0       ggfortify_0.4.14  
[21] ggplot2_3.3.6      flextable_0.7.3    car_3.1-0          carData_3.0-5     

loaded via a namespace (and not attached):
  [1] uuid_1.1-0           backports_1.4.1      systemfonts_1.0.4   
  [4] plyr_1.8.7           splines_4.2.1        listenv_0.8.0       
  [7] TH.data_1.1-1        digest_0.6.29        foreach_1.5.2       
 [10] htmltools_0.5.2      fansi_1.0.3          magrittr_2.0.3      
 [13] checkmate_2.1.0      cluster_2.1.3        globals_0.15.1      
 [16] recipes_1.0.1        gower_1.0.0          modelr_0.1.8        
 [19] officer_0.4.3        sandwich_3.0-2       hardhat_1.2.0       
 [22] jpeg_0.1-9           colorspace_2.0-3     xfun_0.31           
 [25] crayon_1.5.1         jsonlite_1.8.0       lme4_1.1-30         
 [28] iterators_1.0.14     zoo_1.8-10           glue_1.6.2          
 [31] gtable_0.3.0         ipred_0.9-13         emmeans_1.7.5       
 [34] MatrixModels_0.5-0   sjstats_0.18.1       sjmisc_2.8.9        
 [37] future.apply_1.9.0   DEoptimR_1.0-11      abind_1.4-5         
 [40] scales_1.2.0         mvtnorm_1.1-3        DBI_1.1.3           
 [43] rstatix_0.7.0        ggeffects_1.1.2      Rcpp_1.0.8.3        
 [46] xtable_1.8-4         htmlTable_2.4.1      klippy_0.0.0.9500   
 [49] proxy_0.4-27         foreign_0.8-82       stats4_4.2.1        
 [52] lava_1.6.10          prodlim_2019.11.13   datawizard_0.4.1    
 [55] htmlwidgets_1.5.4    RColorBrewer_1.1-3   ellipsis_0.3.2      
 [58] pkgconfig_2.0.3      farver_2.1.1         nnet_7.3-17         
 [61] deldir_1.0-6         utf8_1.2.2           caret_6.0-93        
 [64] reshape2_1.4.4       tidyselect_1.1.2     labeling_0.4.2      
 [67] rlang_1.0.4          effectsize_0.7.0     munsell_0.5.0       
 [70] tools_4.2.1          cli_3.3.0            generics_0.1.3      
 [73] sjlabelled_1.2.0     broom_1.0.0          evaluate_0.15       
 [76] fastmap_1.1.0        yaml_2.3.5           ModelMetrics_1.2.2.2
 [79] knitr_1.39           zip_2.2.0            robustbase_0.95-0   
 [82] purrr_0.3.4          future_1.26.1        nlme_3.1-158        
 [85] quantreg_5.93        xml2_1.3.3           compiler_4.2.1      
 [88] rstudioapi_0.13      png_0.1-7            e1071_1.7-11        
 [91] ggsignif_0.6.3       tibble_3.1.7         stringi_1.7.8       
 [94] parameters_0.18.1    gdtools_0.2.4        Matrix_1.4-1        
 [97] nloptr_2.0.3         vctrs_0.4.1          msm_1.6.9           
[100] pillar_1.7.0         lifecycle_1.0.1      lmtest_0.9-40       
[103] ucminf_1.1-4         estimability_1.4     data.table_1.14.2   
[106] cowplot_1.1.1        insight_0.18.0       R6_2.5.1            
[109] latticeExtra_0.6-30  gridExtra_2.3        parallelly_1.32.0   
[112] codetools_0.2-18     polspline_1.1.20     boot_1.3-28         
[115] assertthat_0.2.1     withr_2.5.0          multcomp_1.4-19     
[118] expm_0.999-6         parallel_4.2.1       mgcv_1.8-40         
[121] bayestestR_0.12.1    timeDate_3043.102    rpart_4.1.16        
[124] class_7.3-20         tidyr_1.2.0          coda_0.19-4         
[127] minqa_1.2.4          rmarkdown_2.14       pROC_1.18.0         
[130] lubridate_1.8.0      numDeriv_2016.8-1.1  base64enc_0.1-3     
[133] interp_1.1-2        </code></pre>
</div>
</div>
<hr>
<p><a href="#introduction">Back to top</a></p>
<p><a href="https://slcladal.github.io/index.html">Back to HOME</a></p>
<hr>
</section>
<section id="references" class="level1 unnumbered">




</section>


<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body" role="doc-bibliography">
<div id="ref-achen1982interpreting" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">1. </div><div class="csl-right-inline">Achen, C.H.: Interpreting and using regression. Sage (1982).</div>
</div>
<div id="ref-bortz2006statistik" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">2. </div><div class="csl-right-inline">Bortz, J.: Statistik: F<span>ü</span>r human-und sozialwissenschaftler. Springer-Verlag (2006).</div>
</div>
<div id="ref-crawley2005statistics" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">3. </div><div class="csl-right-inline">Crawley, M.J.: Statistics: An introduction using r. 2005. John Wiley &amp; Sons, Chichester, West Sussex (2005).</div>
</div>
<div id="ref-faraway2002practical" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">4. </div><div class="csl-right-inline">Faraway, J.J.: Practical regression and ANOVA using r. University of Bath (2002).</div>
</div>
<div id="ref-field2012discovering" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">5. </div><div class="csl-right-inline">Field, A., Miles, J., Field, Z.: Discovering statistics using r. Sage (2012).</div>
</div>
<div id="ref-gries2021statistics" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">6. </div><div class="csl-right-inline">Gries, S.T.: Statistics for linguistics using r: A practical introduction. Mouton de Gruyter, Berlin &amp; New York (2021).</div>
</div>
<div id="ref-levshina2015linguistics" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">7. </div><div class="csl-right-inline">Levshina, N.: How to do linguistics with r: Data exploration and statistical analysis. John Benjamins Publishing Company, Amsterdam (2015).</div>
</div>
<div id="ref-winter2019statistics" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">8. </div><div class="csl-right-inline">Winter, B.: Statistics for linguists: An introduction using r. Routledge (2019).</div>
</div>
<div id="ref-wilcox2009basic" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">9. </div><div class="csl-right-inline">Wilcox, R.R.: Basic statistics: Understanding conventional methods and modern insights. Oxford University Press (2009).</div>
</div>
<div id="ref-baayen2008analyzing" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">10. </div><div class="csl-right-inline">Baayen, R.H.: Analyzing linguistic data. A practical introduction to statistics using r. Cambridge University press, Cambridge (2008).</div>
</div>
<div id="ref-crawley2012r" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">11. </div><div class="csl-right-inline">Crawley, M.J.: The r book. John Wiley &amp; Sons (2012).</div>
</div>
<div id="ref-green1991many" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">12. </div><div class="csl-right-inline">Green, S.B.: How many subjects does it take to do a regression analysis. Multivariate behavioral research. 26, 499–510 (1991).</div>
</div>
<div id="ref-calcagno2020glmulti" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">13. </div><div class="csl-right-inline">Calcagno, V.: <a href="https://CRAN.R-project.org/package=glmulti">Glmulti: Model selection and multimodel inference made easy</a>. (2020).</div>
</div>
<div id="ref-szmrecsanyi2006morphosyntactic" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">14. </div><div class="csl-right-inline">Szmrecsanyi, B.: Morphosyntactic persistence in spoken english: A corpus study at the intersection of variationist sociolinguistics, psycholinguistics, and discourse analysis. Walter de Gruyter, Berlin &amp; New York (2006).</div>
</div>
<div id="ref-myers1990classical" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">15. </div><div class="csl-right-inline">Myers, R.H.: Classical and modern regression with applications. Duxbury Press Belmont, CA (1990).</div>
</div>
<div id="ref-zuur2010protocol" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">16. </div><div class="csl-right-inline">Zuur, A.F., Ieno, E.N., Elphick, C.S.: A protocol for data exploration to avoid common statistical problems. Methods in Ecology and Evolution. 1, 3–14 (2010).</div>
</div>
<div id="ref-bowerman1990linear" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">17. </div><div class="csl-right-inline">Bowerman, B.L., O’Connell, R.T.: Linear statistical models: An applied approach. PWS-Kent, Boston (1990).</div>
</div>
<div id="ref-report" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">18. </div><div class="csl-right-inline">Makowski, D., Ben-Shachar, M.S., Patil, I., Lüdecke, D.: <a href="https://github.com/easystats/report">Automated results reporting as a practical tool to improve reproducibility and methodological best practices adoption</a>. CRAN. (2021).</div>
</div>
<div id="ref-rousseeuw2005robust" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">19. </div><div class="csl-right-inline">Rousseeuw, P.J., Leroy, A.M.: Robust regression and outlier detection. John wiley &amp; sons (2005).</div>
</div>
<div id="ref-harrell2015regression" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">20. </div><div class="csl-right-inline">Harrell Jr, F.E.: Regression modeling strategies: With applications to linear models, logistic and ordinal regression, and survival analysis. Springer (2015).</div>
</div>
<div id="ref-agresti1996introduction" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">21. </div><div class="csl-right-inline">Agresti, A.: An introduction to categorical data analysis. JohnWiley &amp; Sons, Hoboken, NJ (1996).</div>
</div>
<div id="ref-agresti2011categorical" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">22. </div><div class="csl-right-inline">Agresti, A., Kateri, M.: Categorical data analysis. Springer (2011).</div>
</div>
<div id="ref-rms" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">23. </div><div class="csl-right-inline">Harrell Jr, F.E.: <a href="https://CRAN.R-project.org/package=rms">Rms: Regression modeling strategies</a>. (2021).</div>
</div>
<div id="ref-menard1995applied" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">24. </div><div class="csl-right-inline">Menard, S.: Applied logistic regression analysis: Sage university series on quantitative applications in the social sciences. Sage, Thousand Oaks, CA (1995).</div>
</div>
<div id="ref-caret" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">25. </div><div class="csl-right-inline">Kuhn, M.: <a href="https://CRAN.R-project.org/package=caret">Caret: Classification and regression training</a>. (2021).</div>
</div>
<div id="ref-sjPlot" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">26. </div><div class="csl-right-inline">Lüdecke, D.: <a href="https://CRAN.R-project.org/package=sjPlot">sjPlot: Data visualization for statistics in social science</a>. (2021).</div>
</div>
<div id="ref-agresti2010analysis" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">27. </div><div class="csl-right-inline">Agresti, A.: Analysis of ordinal categorical data. John Wiley &amp; Sons (2010).</div>
</div>
<div id="ref-msm" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">28. </div><div class="csl-right-inline">Jackson, C.H.: <a href="https://www.jstatsoft.org/v38/i08/">Multi-state models for panel data: The <span class="nocase">msm</span> package for <span>R</span></a>. Journal of Statistical Software. 38, 1–29 (2011).</div>
</div>
</div></section><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>I’m extremely grateful to Stefan Thomas Gries who provided very helpful feedback and pointed out many errors in previous versions of this tutorial. All remaining errors are, of course, my own.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>