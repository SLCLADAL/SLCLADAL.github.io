<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.165">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Erich Round">
<meta name="dcterms.date" content="2022-08-31">

<title>Practical phylogenetic methods for linguistic typology</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-VSGK4KYDQZ"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-VSGK4KYDQZ', { 'anonymize_ip': true});
</script>
<script src="site_libs/clipboard-1.7.1/clipboard.min.js"></script>
<link href="site_libs/primer-tooltips-1.4.0/build.css" rel="stylesheet">
<link href="site_libs/klippy-0.0.0.9500/css/klippy.min.css" rel="stylesheet">
<script src="site_libs/klippy-0.0.0.9500/js/klippy.min.js"></script>


</head>

<body class="floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a href="./index.html" class="navbar-brand navbar-brand-logo">
    <img src="./ladal_icon_cas_tran_white_trimed.png" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Language Technology and Data Analysis Laboratory</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html">HOME</a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-about-ladal" role="button" data-bs-toggle="dropdown" aria-expanded="false">ABOUT LADAL</a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-about-ladal">    
        <li>
    <a class="dropdown-item" href="./people.html">
 <span class="dropdown-text">People | Collabs</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./news.html">
 <span class="dropdown-text">News</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-events" role="button" data-bs-toggle="dropdown" aria-expanded="false">EVENTS</a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-events">    
        <li>
    <a class="dropdown-item" href="./workshops.html">
 <span class="dropdown-text">Workshops</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./compthinking.html">
 <span class="dropdown-text">Computational Thinking in HASS</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./webinars2022.html">
 <span class="dropdown-text">LADAL Webinar Series 2022</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./opening.html">
 <span class="dropdown-text">LADAL Webinar Series 2021</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./atapevents.html">
 <span class="dropdown-text">ATAP Events</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="./tutorials.html">TUTORIALS</a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-resources" role="button" data-bs-toggle="dropdown" aria-expanded="false">RESOURCES</a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-resources">    
        <li>
    <a class="dropdown-item" href="./links.html">
 <span class="dropdown-text">Links</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./base.html">
 <span class="dropdown-text">Tutorial stylesheet</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="./contact.html">CONTACT</a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a>
  <ul class="collapse">
  <li><a href="#an-intuitive-introduction-to-the-challenge-of-genealogy" id="toc-an-intuitive-introduction-to-the-challenge-of-genealogy" class="nav-link" data-scroll-target="#an-intuitive-introduction-to-the-challenge-of-genealogy">An intuitive introduction to the challenge of genealogy</a></li>
  </ul></li>
  <li><a href="#r-trees" id="toc-r-trees" class="nav-link" data-scroll-target="#r-trees"><span class="toc-section-number">1</span>  Trees in R</a></li>
  <li><a href="#averages" id="toc-averages" class="nav-link" data-scroll-target="#averages"><span class="toc-section-number">2</span>  Genealogically-sensitive averages and proportions</a></li>
  <li><a href="#glottolog" id="toc-glottolog" class="nav-link" data-scroll-target="#glottolog"><span class="toc-section-number">3</span>  Using and adapting trees from glottolog.com</a>
  <ul class="collapse">
  <li><a href="#glottolog-genealogical" id="toc-glottolog-genealogical" class="nav-link" data-scroll-target="#glottolog-genealogical"><span class="toc-section-number">3.1</span>  Glottolog’s genealogical data</a></li>
  <li><a href="#combining-trees" id="toc-combining-trees" class="nav-link" data-scroll-target="#combining-trees"><span class="toc-section-number">3.2</span>  How to combine trees</a></li>
  <li><a href="#filter-tips" id="toc-filter-tips" class="nav-link" data-scroll-target="#filter-tips"><span class="toc-section-number">3.3</span>  How to modify trees</a>
  <ul class="collapse">
  <li><a href="#how-to-remove-tips" id="toc-how-to-remove-tips" class="nav-link" data-scroll-target="#how-to-remove-tips"><span class="toc-section-number">3.3.1</span>  How to remove tips</a></li>
  <li><a href="#how-to-remove-tips-and-convert-nodes-to-tips" id="toc-how-to-remove-tips-and-convert-nodes-to-tips" class="nav-link" data-scroll-target="#how-to-remove-tips-and-convert-nodes-to-tips"><span class="toc-section-number">3.3.2</span>  How to remove tips and convert nodes to tips</a></li>
  <li><a href="#how-to-remove-internal-nodes" id="toc-how-to-remove-internal-nodes" class="nav-link" data-scroll-target="#how-to-remove-internal-nodes"><span class="toc-section-number">3.3.3</span>  How to remove internal nodes</a></li>
  <li><a href="#how-to-add-tips" id="toc-how-to-add-tips" class="nav-link" data-scroll-target="#how-to-add-tips"><span class="toc-section-number">3.3.4</span>  How to add tips</a></li>
  <li><a href="#how-to-clone-tips" id="toc-how-to-clone-tips" class="nav-link" data-scroll-target="#how-to-clone-tips"><span class="toc-section-number">3.3.5</span>  How to clone tips</a></li>
  <li><a href="#how-to-move-a-tip" id="toc-how-to-move-a-tip" class="nav-link" data-scroll-target="#how-to-move-a-tip"><span class="toc-section-number">3.3.6</span>  How to move a tip</a></li>
  <li><a href="#how-to-move-a-node-and-its-descendants" id="toc-how-to-move-a-node-and-its-descendants" class="nav-link" data-scroll-target="#how-to-move-a-node-and-its-descendants"><span class="toc-section-number">3.3.7</span>  How to move a node and its descendants</a></li>
  <li><a href="#summary-a-general-purpose-toolkit-for-curating-trees-topology" id="toc-summary-a-general-purpose-toolkit-for-curating-trees-topology" class="nav-link" data-scroll-target="#summary-a-general-purpose-toolkit-for-curating-trees-topology"><span class="toc-section-number">3.3.8</span>  Summary: a general-purpose toolkit for curating trees’ topology</a></li>
  </ul></li>
  <li><a href="#add-lengths" id="toc-add-lengths" class="nav-link" data-scroll-target="#add-lengths"><span class="toc-section-number">3.4</span>  How to add branch lengths</a></li>
  <li><a href="#exporting" id="toc-exporting" class="nav-link" data-scroll-target="#exporting"><span class="toc-section-number">3.5</span>  Exporting trees for use with other software</a></li>
  </ul></li>
  <li><a href="#example" id="toc-example" class="nav-link" data-scroll-target="#example"><span class="toc-section-number">4</span>  Putting it together: A worked example</a>
  <ul class="collapse">
  <li><a href="#preparing-a-tree" id="toc-preparing-a-tree" class="nav-link" data-scroll-target="#preparing-a-tree"><span class="toc-section-number">4.1</span>  Preparing a tree</a></li>
  <li><a href="#preparing-the-dataframe-of-typological-data" id="toc-preparing-the-dataframe-of-typological-data" class="nav-link" data-scroll-target="#preparing-the-dataframe-of-typological-data"><span class="toc-section-number">4.2</span>  Preparing the dataframe of typological data</a></li>
  <li><a href="#calculating-genealogically-sensitive-proportions" id="toc-calculating-genealogically-sensitive-proportions" class="nav-link" data-scroll-target="#calculating-genealogically-sensitive-proportions"><span class="toc-section-number">4.3</span>  Calculating genealogically-sensitive proportions</a></li>
  </ul></li>
  <li><a href="#using-these-methods-in-typological-research" id="toc-using-these-methods-in-typological-research" class="nav-link" data-scroll-target="#using-these-methods-in-typological-research"><span class="toc-section-number">5</span>  Using these methods in typological research</a></li>
  <li><a href="#citation-session-info" id="toc-citation-session-info" class="nav-link" data-scroll-target="#citation-session-info">Citation &amp; Session Info</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul>
</nav>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Practical phylogenetic methods for linguistic typology</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Erich Round </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">August 31, 2022</p>
    </div>
  </div>
    
  </div>
  

</header>

<div class="cell">
<div class="cell-output-display">
<p><img src="https://slcladal.github.io/images/uq1.jpg" class="img-fluid" style="width:100.0%"></p>
</div>
</div>
<section id="introduction" class="level1 unnumbered">
<h1 class="unnumbered">Introduction</h1>
<p>A perennial task in typology is the characterization of frequencies of traits of interest among the world’s languages. The scientific interest of such questions typically lies not merely in the contingent facts of today’s particular languages and language families, rather the goal is to characterize the nature of human language in general, using today’s contingent empirical data as evidence. One of the key challenges that makes this task difficult to carry out in a principled way is that languages are historically related to each other. This document is a practical introduction to the use of <em>phylogenetic comparative methods</em>, which will help to meet this challenge in a principled way.</p>
<p><strong>Preparation and session set up</strong></p>
<p>This tutorial is based on R. If you have not installed R or are new to it, you will find an introduction to and more information how to use R <a href="https://slcladal.github.io/intror.html">here</a>. For this tutorials, we need to install certain <em>packages</em> from an R <em>library</em> so that the scripts shown below are executed without errors. Before turning to the code in subsequent sections, please first install the packages by running the code below this paragraph. If you have already installed the packages mentioned below, then you can skip ahead and ignore this section. To install the necessary packages, simply run the following code - it may take some time (between 1 and 5 minutes to install all of the libraries so you do not need to worry if it takes some time).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set options</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">stringsAsFactors =</span> F)         <span class="co"># no automatic data transformation</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="st">"scipen"</span> <span class="ot">=</span> <span class="dv">100</span>, <span class="st">"digits"</span> <span class="ot">=</span> <span class="dv">4</span>) <span class="co"># suppress math annotation</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># install packages</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"tidyverse"</span>)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"flextable"</span>)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"devtools"</span>)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"phangorn"</span>)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co"># install klippy for copy-to-clipboard button in code chunks</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>devtools<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">"rlesur/klippy"</span>)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>devtools<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">"erichround/phyloWeights"</span>, </span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>                         <span class="at">dependencies =</span> T, </span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>                         <span class="at">INSTALL_opts =</span> <span class="fu">c</span>(<span class="st">"--no-multiarch"</span>))</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>devtools<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">"erichround/glottoTrees"</span>, </span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>                         <span class="at">dependencies =</span> T, </span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>                         <span class="at">INSTALL_opts =</span> <span class="fu">c</span>(<span class="st">"--no-multiarch"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Next, we activate the packages.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># activate packages</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(flextable)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(phyloWeights)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(glottoTrees)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ape)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="co"># activate klippy for copy-to-clipboard button</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>klippy<span class="sc">::</span><span class="fu">klippy</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<script>
  addClassKlippyTo("pre.r, pre.markdown");
  addKlippy('left', 'top', 'auto', '1', 'Copy code', 'Copied!');
</script>
</div>
</div>
<p>Once you have installed R, RStudio, and have also initiated the session by executing the code shown above, you are good to go.</p>
<section id="an-intuitive-introduction-to-the-challenge-of-genealogy" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="an-intuitive-introduction-to-the-challenge-of-genealogy">An intuitive introduction to the challenge of genealogy</h2>
<p>To get an intuitive notion of the challenge that is presented by the genealogical relatedness of languages, consider the small language family pictured in the figure below. It contains four languages, which are either SOV or SVO. The question is: What proportion of this family is SOV? Should you just count the languages, in which case the answer is literally 75%? This answer may seem not quite right, because now one half of the family is counting three times as much as the other half, just because it had the fortune of containing more languages. Put another way, the figure of 75% is strongly influenced by contingencies of history.</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="phylo_files/figure-html/SOV-tree-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>In a LADAL seminar on 4 November, 2021 <span class="citation" data-cites="macklin-cordes_phylogenetic_2021">[<a href="#ref-macklin-cordes_phylogenetic_2021" role="doc-biblioref">1</a>]</span> and in a related journal article <span class="citation" data-cites="macklin-cordes_challenges_nodate">[<a href="#ref-macklin-cordes_challenges_nodate" role="doc-biblioref">2</a>]</span>, Jayden Macklin-Cordes and I review some of history of thinking in linguists’ attempts to account for historical relatedness of exactly this kind when comparing across languages. We also explain how <em>phylogenetic comparative methods</em> present the most principled response to it developed so far. We recommend reviewing either of these sources, since they cover the scientific content which corresponds to the practical, technical content in this tutorial. Here, we will not review the scientific content at any length.</p>
<p>This document provides a guide to the practical use of phylogenetic comparative methods for linguistic typology, specifically, the calculation of genealogically-sensitive proportions and averages. These are methods which provide an answer to the question: “When characterising the frequencies of traits among the world’s languages, how can we take genealogy into account?” Here we cover two methods for calculating genealogically-sensitive proportions and averages: the ‘ACL’ method <span class="citation" data-cites="altschul_weights_1989">[<a href="#ref-altschul_weights_1989" role="doc-biblioref">3</a>]</span> and the ‘BM’ method <span class="citation" data-cites="stone_constructing_2007">[<a href="#ref-stone_constructing_2007" role="doc-biblioref">4</a>]</span>.</p>
<p>Because a key part of this kind of analysis is the preparation of a phylogenetic tree, an important component of the tutorial will be about how such trees can be prepared.</p>
<p>The tutorial is divided into four main sections. Section <a href="#Trees-in-R">Trees in R</a> is an introduction to how trees are represented in R. Section <a href="#Genealogically-sensitive-averages-and-proportions">Genealogically-sensitive averages and proportions</a> discusses the calculation of genealogically-sensitive proportions and averages. Section <a href="#Using-and-adapting-trees-from-glottolog.com">Using and adapting trees from glottolog.com</a> explains how typologists can prepare phylogenetic trees by adapting resources freely available from glottolog.com <span class="citation" data-cites="glottolog">[<a href="#ref-glottolog" role="doc-biblioref">5</a>]</span>. And Section <a href="#Putting-it-together:-A-worked-example">Putting it together: A worked example</a> provides a worked example used in a typological investigation of sonority sequencing by <span class="citation" data-cites="yin_violations_2020">[<a href="#ref-yin_violations_2020" role="doc-biblioref">6</a>]</span>.</p>
<p>Much of the discussion below is an introduction to the functionality of two R packages, <code>glottoTrees</code> <span class="citation" data-cites="glottoTrees">[<a href="#ref-glottoTrees" role="doc-biblioref">7</a>]</span> and <code>phyloWeights</code> <span class="citation" data-cites="phyloWeights">[<a href="#ref-phyloWeights" role="doc-biblioref">8</a>]</span>, which have been specifically written for these tasks. The text of this tutorial is taken largely from the Supplementary Materials section S1 of <span class="citation" data-cites="macklin-cordes_challenges_nodate">[<a href="#ref-macklin-cordes_challenges_nodate" role="doc-biblioref">2</a>]</span>.</p>
<!-- This document represents an empty R Markdown file (or Rmd file) for a LADAL tutorial. The R Markdown document for this tutorial can be downloaded [here](https://slcladal.github.io/content/base.Rmd). -->
<!-- You will also have to download the bibliography file from https://slcladal.github.io/content/bibliography.bib for the tutorial to be knitted correctly. Although the knitted (or rendered) html file will look different from the LADAL design (because we have modified the theme for the LADAL page), it will be just like a proper LADAL tutorial once we have knitted the Rmd file on our machines and integrated your tutorial into the LADAL website. -->
</section>
</section>
<section id="r-trees" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Trees in R</h1>
<p>This section discusses how trees are created, manipulated and plotted in R. Terminology we will use includes: <em>tips</em> at the ends of trees, which in a linguistic tree would usually be the languages or lects; the <em>branches</em> of a tree; the <em>interior nodes</em> or just <em>nodes</em> of a tree, where branches join together; and the <em>root</em> of the tree, its deepest node. R will represent trees as complex objects, in which the tips, nodes and branches all appear, along with labels for the tips and nodes.</p>
<p>One of the simplest methods of constructing a tree in R begins with a description of the tree using a form a bracketing notation known as the <em>Newick</em> standard <span class="citation" data-cites="Newick">[<a href="#ref-Newick" role="doc-biblioref">9</a>]</span>. In its simplest form, a tree is represented in Newick format by a set of tip labels grouped by parentheses, separated by commas, and ending with a semicolon. For example, here is a string that represents a tree with four tips, <code>A</code>, <code>B</code>, <code>C</code> and <code>D</code>, which we assign to the object <code>my_newick</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>my_newick <span class="ot">&lt;-</span> <span class="st">"(((A,B),C),D);"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>A Newick-formatted string can then be converted to a tree object by supplying it as the <code>text</code> argument of the function <code>read.tree()</code>, from the <code>ape</code> package:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>my_tree <span class="ot">&lt;-</span> <span class="fu">read.tree</span>(<span class="at">text =</span> my_newick)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can plot the tree using the <code>plot()</code> function:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(my_tree)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="phylo_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" style="width:70.0%"></p>
</figure>
</div>
</div>
</div>
<p>By default, trees in R are plotted horizontally following the convention in biology. The <code>glottoTrees</code> package provides a function <code>plot_glotto()</code> which plots trees in a more typical, downward-running linguistic format, as below.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_glotto</span>(my_tree)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="phylo_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" style="width:70.0%"></p>
</figure>
</div>
</div>
</div>
<p>The tree object <code>my_tree</code> which we defined above did not include information about branch lengths. In Newick format, branch lengths are written with a preceding colon and appear directly after a language or the closing bracket for a subgroup:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>my_newick2 <span class="ot">&lt;-</span> <span class="st">"(((A:4,B:4):1,C:5):3,D:8);"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Converting this to a tree object and plotting it:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>my_tree2 <span class="ot">&lt;-</span> <span class="fu">read.tree</span>(<span class="at">text =</span> my_newick2)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_glotto</span>(my_tree2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="phylo_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" style="width:70.0%"></p>
</figure>
</div>
</div>
</div>
<p>Trees can have labels not only for their tips, but also for their internal nodes. In linguistics, an internal node of a tree may be interpreted taxonomically, as representing a subgroup and labeled accordingly, or genealogically, as a proto-language from which the subgroup descends and labeled accordingly. In Newick format, labels for internal nodes are placed directly after a closing parenthesis. For example, here we add labels that reflect a genealogical interpretation of the nodes:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>my_newick3 <span class="ot">&lt;-</span> <span class="st">"(((A:4,B:4)proto-AB:1,C:5)proto-ABC:3,D:8)proto-ABCD;"</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>my_tree3 <span class="ot">&lt;-</span> <span class="fu">read.tree</span>(<span class="at">text =</span> my_newick3)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_glotto</span>(my_tree3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="phylo_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" style="width:70.0%"></p>
</figure>
</div>
</div>
</div>
<p>Technically speaking, trees are represented by R as objects with a customised class called <code>phylo</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(my_tree3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "phylo"</code></pre>
</div>
</div>
<p>A <code>phylo</code> object stores information about the tree <em>topology</em> (i.e., its branching structure), the branch lengths, and the labels of the tips and nodes. In R we often use the <code>$</code> operator to access one object that is contained inside another. For instance, the object <code>y</code> contained within the larger object <code>x</code> would be referred to as <code>x$y</code>. Here are some examples:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>my_tree3<span class="sc">$</span>edge.length</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3 1 4 4 5 8</code></pre>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>my_tree3<span class="sc">$</span>tip.label</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "A" "B" "C" "D"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>my_tree3<span class="sc">$</span>node.label</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "proto-ABCD" "proto-ABC"  "proto-AB"  </code></pre>
</div>
</div>
<p>Another object class in R, related to the <code>phylo</code> class, is the <code>multiPhylo</code> class. Objects of the <code>multiPhylo</code> class are used to store multiple <code>phylo</code> trees in a single, larger object.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>newick_a <span class="ot">&lt;-</span> <span class="st">"(((A:4,B:4):1,C:5):3,D:8);"</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>newick_b <span class="ot">&lt;-</span> <span class="st">"((A:2,B:2):1,(C:1,D:1,E:1):2);"</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>tree_a <span class="ot">&lt;-</span> <span class="fu">read.tree</span>(<span class="at">text =</span> newick_a)</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>tree_b <span class="ot">&lt;-</span> <span class="fu">read.tree</span>(<span class="at">text =</span> newick_b)</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>my_multiPhylo <span class="ot">&lt;-</span> <span class="fu">c</span>(tree_a, tree_b)</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(my_multiPhylo)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "multiPhylo"</code></pre>
</div>
</div>
<p>For reasons we won’t go into here, the <code>phylo</code> trees inside a <code>multiPhylo</code> object are not accessed using the <code>$</code> operator but using double square brackets. For example, here we refer to the second tree inside the object <code>my_multiPhylo</code> by writing <code>my_multiPhylo[[2]]</code>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_glotto</span>(my_multiPhylo[[<span class="dv">2</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="phylo_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" style="width:85.0%"></p>
</figure>
</div>
</div>
</div>
<p>Before concluding this section, a final word is in order about the irrelevance of the left-to-right arrangement of trees. In a tree, there is no meaningful difference between (A,B) and (B,A): in both, A and B are sisters under a shared parent node. Similarly, these are all equivalent: (A,B,C), (A,C,B), (B,A,C), (B,C,A), (C,A,B) and (C,B,A). And likewise, these are all equivalent: (A,(B,C)), (A,(C,B)), ((B,C),A) and ((C,B),A).</p>
</section>
<section id="averages" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Genealogically-sensitive averages and proportions</h1>
<p>We now turn to the calculation of genealogically-sensitive proportions and averages. To begin, consider these six trees, which represent six different hypotheses about the genealogical relationships between languages <code>A</code>, <code>B</code>, <code>C</code> and <code>D</code>. Also plotted here are the languages’ dominant word orders and their numbers of consonant phonemes.</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="phylo_files/figure-html/unnamed-chunk-12-1.png" style="height:20.0%" width="672"></p>
</div>
</div>
<p>Questions that we seek to answer are: what is the proportion of this set of languages that is SOV?; and what is the average number of consonant phonemes in this set of languages? Moreover, we want the answers to be sensitive to genealogy, and we’re interested in how the answers may vary according to which of these six genealogical hypotheses is adopted.</p>
<p>Calculating genealogically-sensitive averages and proportions will require two key components:</p>
<ol type="1">
<li>A <code>phylo</code> or <code>multiPhylo</code> object containing one or more trees.</li>
<li>A dataframe, which (i) contains the typological data to be averaged and (ii) relates that data to the tips of the trees.</li>
</ol>
<p>The <code>phylo</code> or <code>multiPhylo</code> object can be manually defined, as described in Section <a href="#Trees-in-R">Trees in R</a>, can be read from a file,<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> or it can be constructed by using and adjusting materials freely available from glottolog.com, as described below in Section <a href="#Using-and-adapting-trees-from-glottolog.com">Using and adapting trees from glottolog.com</a>. In this example, our six trees can be manually defined using the code below, which places them inside a single <code>multiPhylo</code> object named <code>multi_phylo_ABCD</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>multiPhylo_ABCD <span class="ot">&lt;-</span> </span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="fu">read.tree</span>(<span class="at">text =</span> <span class="st">"(((A:0.2,B:0.2,C:0.2):1.8,D:2):0.3);"</span>),</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">read.tree</span>(<span class="at">text =</span> <span class="st">"(((A:1,B:1,C:1):1,D:2):0.3);"</span>), </span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">read.tree</span>(<span class="at">text =</span> <span class="st">"(((A:1.8,B:1.8,C:1.8):0.2,D:2):0.3);"</span>), </span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">read.tree</span>(<span class="at">text =</span> <span class="st">"((((A:1,B:1):0.8,C:1.8):0.2,D:2):0.3);"</span>),</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">read.tree</span>(<span class="at">text =</span> <span class="st">"(((A:1.8,(B:1,C:1):0.8):0.2,D:2):0.3);"</span>),</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">read.tree</span>(<span class="at">text =</span> <span class="st">"(((A:1,B:1):1,(C:1.8,D:1.8):0.2):0.3);"</span>)</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The dataframe can be manually defined or be read from a file. Perhaps the easiest method is to read from a file that you have created and saved in “CSV” (comma separated value) format. CSV files can be created in commercial spreadsheet software like Excel, and then read by R using the <code>read.csv()</code> function like this:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>my_dataframe <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"my_csv_file.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The dataframe must contain one column named <code>tip</code> (note that in R, names of columns and other objects are case sensitive) plus at least one column containing numerical data. The contents of the <code>tip</code> column must be the same as the tip labels of the tree(s) in the <code>phylo</code> or <code>multiPhylo</code> object. The contents of the numerical columns will depend on whether a proportion or an average is desired. To calculate a proportion, fill a numerical column with 1 if the language possesses the property and 0 if it does not. To calculate an average, fill a numerical column with the values of the variable for each language.</p>
<p>For this example, the dataframe required is defined in the code below. In addition to the <code>tip</code> column, it contains two numerical columns, <code>is_SOV</code> and <code>n_consonants</code>. As good housekeeping, we recommend using column names of the form <code>is_X</code> or <code>has_X</code> for columns that contain data for proportions, and names of the form <code>n_X</code> for columns that contain counts to be averaged.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>data_ABCD <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">tip =</span> <span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>, <span class="st">"D"</span>), </span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>                        <span class="at">is_SOV =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>), </span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>                        <span class="at">n_consonants =</span> <span class="fu">c</span>(<span class="dv">18</span>, <span class="dv">20</span>, <span class="dv">22</span>, <span class="dv">40</span>),</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>                        <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Genealogically-sensitive averages and proportions are obtained using the <code>phyloWeights</code> function <code>phylo_average()</code>, specifying its arguments <code>phy</code> and <code>data</code> as in the example below. Here we have assigned the output of this function to a new object <code>results_ABCD</code>. We recommend always assigning the output of <code>phylo_average()</code> to an object. We will see below how to extract from it the various parts of the results.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>results_ABCD <span class="ot">&lt;-</span> <span class="fu">phylo_average</span>(<span class="at">phy =</span> multiPhylo_ABCD, <span class="at">data =</span> data_ABCD)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The function <code>phylo_average()</code> may take up to several minutes to run if the tree is large, or many trees are provided. It will return error messages if the inputs provided to it are not what is required.</p>
<p>The results object will contain several parts, which can be accessed using the <code>$</code> operator. In <code>$phy</code> will be the tree(s) that were supplied and in <code>$data</code> will be the dataframe that was supplied, e.g.:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>results_ABCD<span class="sc">$</span>data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  tip is_SOV n_consonants
1   A      1           18
2   B      1           20
3   C      1           22
4   D      0           40</code></pre>
</div>
</div>
<p>In <code>$ACL_averages</code> is a dataframe containing the genealogically-sensitive averages/proportions according to the ACL method. The dataframe has one row per tree and one column for each of the numerical columns in the <code>data</code> dataframe. Here you can see how the answer to our questions changes as the hypotheses about the tree changes.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>results_ABCD<span class="sc">$</span>ACL_averages</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   tree    is_SOV n_consonants
1 tree1 0.5172414     29.65517
2 tree2 0.6000000     28.00000
3 tree3 0.7142857     25.71429
4 tree4 0.6768559     26.63755
5 tree5 0.6768559     26.28821
6 tree6 0.7115385     25.92308</code></pre>
</div>
</div>
<p>In <code>$BM_averages</code> appear the genealogically-sensitive averages or proportions obtained using the BM method:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>results_ABCD<span class="sc">$</span>BM_averages</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   tree    is_SOV n_consonants
1 tree1 0.5568599     28.86280
2 tree2 0.6952381     26.09524
3 tree3 0.7468354     25.06329
4 tree4 0.7256904     25.56443
5 tree5 0.7256904     25.40796
6 tree6 0.7288732     25.50704</code></pre>
</div>
</div>
<p>In terms of their inner workings, both methods work by assigning weights to languages, and those weights then reflect how much each language contributes to the final result. These weights can be found in <code>$ACL_weights</code> and <code>$BM_weights</code>. You might like to compare, for each tree, the weights for languages <code>A</code>, <code>B</code>, <code>C</code>, <code>D</code> with the positions of the languages in the tree, in order to get an idea of how the weights relate to the tree shape.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>results_ABCD<span class="sc">$</span>ACL_weights</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  tip     tree1 tree2     tree3     tree4     tree5     tree6
1   A 0.1724138   0.2 0.2380952 0.1965066 0.2838428 0.2115385
2   B 0.1724138   0.2 0.2380952 0.1965066 0.1965066 0.2115385
3   C 0.1724138   0.2 0.2380952 0.2838428 0.1965066 0.2884615
4   D 0.4827586   0.4 0.2857143 0.3231441 0.3231441 0.2884615</code></pre>
</div>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>results_ABCD<span class="sc">$</span>BM_weights</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  tip     tree1     tree2     tree3     tree4     tree5     tree6
1   A 0.1856200 0.2317460 0.2489451 0.2288579 0.2679747 0.2288732
2   B 0.1856200 0.2317460 0.2489451 0.2288579 0.2288579 0.2288732
3   C 0.1856200 0.2317460 0.2489451 0.2679747 0.2288579 0.2711268
4   D 0.4431401 0.3047619 0.2531646 0.2743096 0.2743096 0.2711268</code></pre>
</div>
</div>
<p>It is possible to save any of these dataframes to a file using the <code>write.csv()</code> function, for example:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(results_ABCD<span class="sc">$</span>ACL_averages, <span class="at">file =</span> <span class="st">"my_ACL_averages.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="glottolog" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Using and adapting trees from glottolog.com</h1>
<p>As we have seen, using phylogenetic comparative methods, such as methods for calculating genealogically-sensitive averages, requires us to have one or more trees, expressing hypotheses about genealogical relationships among the languages. In this section we address the questions, where can linguists obtain their trees from?; and how can linguists adapt those trees to reflect their own hypotheses about language relatedness?</p>
<p>Our starting point is glottolog.com <span class="citation" data-cites="glottolog">[<a href="#ref-glottolog" role="doc-biblioref">5</a>]</span>, a major online publication which contains many useful resources for quantitative typology. The R package <code>glottoTrees</code> <span class="citation" data-cites="glottoTrees">[<a href="#ref-glottoTrees" role="doc-biblioref">7</a>]</span> has been written to help linguists make the most of these resources, including by modifying them as they desire. This section covers the glottolog data itself and the functionality of <code>glottoTrees</code>. We introduce glottolog’s genealogical data in Section <a href="#Glottolog's-genealogical-data">Glottolog’s genealogical data</a>, discussing how to locate metadata about languages and families of interest, and how to view glottolog’s linguistic family trees. Since genealogically-sensitive averages and proportions require all of the languages in the study to be linked in a tree, we then discuss how glottolog’s individual trees can be combined into larger, composite trees in Section @ref(combining-trees). Since typological studies will often examine language varieties at a level of granularity that differs from glottolog’s own, in Section <a href="#How-to-modify-trees">How to modify trees</a> we discuss how to add and remove languages from trees. In Section <a href="#How-to-add-branch-lengths">How to add branch lengths</a> we discuss how to add branch lengths to trees, since branch lengths are necessary for the calculation of genealogically-sensitive averages and proportions. Section @ref(exporting) discusses how to export trees for use with other software.</p>
<section id="glottolog-genealogical" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="glottolog-genealogical"><span class="header-section-number">3.1</span> Glottolog’s genealogical data</h2>
<p>Glottolog provides metadata about the world’s language varieties, their division into language families and the hierarchical subgrouping of languages inside those families. Naturally, there are many points of contention in linguistics about what the world’s stock of languages and dialects actually is, how it groups into families, and how the families themselves are subgrouped. Glottolog provides one set of answers, and structures them in a way which provides typologists with a basis for carrying out changes to suit their own hypotheses. In later sections we will see how this can be done. In this section we describe glottolog’s own global linguistic metadata.</p>
<p>At time of writing, the current version of glottolog is v4.4. The <code>glottoTrees</code> package contains a copy of the v4.4 metadata covering language names, language identification codes, family names, geographical groupings, and family trees. The original metadata files that contain this information are currently available at https://glottolog.org/meta/downloads, where a file named <code>tree_glottolog_newick.txt</code><a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a> contains glottolog’s trees, and <code>languages_and_dialects_geo.csv</code> provides geographical metadata.</p>
<p>Language metadata can be accessed using the <code>glottoTrees</code> function <code>get_glottolog_languages()</code>. This function returns a dataframe of close to twenty-six thousand rows. To view it in full, we suggest saving it to a CSV file and opening it in spreadsheet software such as Excel:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>language_metadata <span class="ot">&lt;-</span> <span class="fu">get_glottolog_languages</span>()</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(language_metadata, <span class="st">"language_metadata.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Here are the first ten rows:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>language_metadata <span class="ot">&lt;-</span> <span class="fu">get_glottolog_languages</span>()</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(language_metadata, <span class="at">n =</span> <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   glottocode isocodes       name name_in_tree position tree
1    3adt1234          3Ad-Tekles   3Ad-Tekles      tip  391
2    aala1237              Aalawa       Aalawa      tip   94
3    aant1238          Aantantara   Aantantara      tip   90
4    aari1238     &lt;NA&gt;       &lt;NA&gt;   Aari-Gayil     node   22
5    aari1239      aiw       Aari         Aari      tip   22
6    aari1240      aay     Aariya       Aariya     &lt;NA&gt;   NA
7    aasa1238      aas      Aasax        Aasax      tip  391
8    aasd1234            Aasdring     Aasdring      tip  269
9    aata1238           Aatasaara    Aatasaara      tip   90
10   abaa1238              Rngaba       Rngaba      tip  345
               tree_name
1           Afro-Asiatic
2           Austronesian
3  NuclearTransNewGuinea
4            SouthOmotic
5            SouthOmotic
6                   &lt;NA&gt;
7           Afro-Asiatic
8          Indo-European
9  NuclearTransNewGuinea
10          Sino-Tibetan</code></pre>
</div>
</div>
<p>Listed here are glottolog’s languages, dialects, subgroups and families. These entities are identified by a name, an ISO-639-3 code if available (format: three letters) and a glottolog-specific <em>glottocode</em> (format: four letters followed by four digits<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a>). Also described is the entity’s relationship to a glottolog tree: the representation of its name in the tree (which may differ slightly from the name used elsewhere by glottolog<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a>), its position (as tip or node), and the tree’s number and name.</p>
<p>By default, the metadata functions in <code>glottoTrees</code>, such as <code>get_glottolog_languages()</code>, will return information about the most recent version of glottolog which the package contains. To access older versions, supply the version number via the <code>glottolog_version</code> argument:<a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>language_metadata_v4<span class="fl">.3</span> <span class="ot">&lt;-</span> <span class="fu">get_glottolog_languages</span>(<span class="at">glottolog_version =</span> <span class="st">"4.3"</span>)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(language_metadata_v4<span class="fl">.3</span>, <span class="at">n =</span> <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   glottocode isocodes       name name_in_tree position tree
1    3adt1234          3Ad-Tekles   3Ad-Tekles      tip  186
2    aala1237              Aalawa       Aalawa      tip  205
3    aant1238          Aantantara   Aantantara      tip  145
4    aari1238     &lt;NA&gt;       &lt;NA&gt;   Aari-Gayil     node   85
5    aari1239      aiw       Aari         Aari      tip   85
6    aari1240      aay     Aariya       Aariya     &lt;NA&gt;   NA
7    aasa1238      aas      Aasax        Aasax      tip  186
8    aasd1234            Aasdring     Aasdring      tip  179
9    aata1238           Aatasaara    Aatasaara      tip  145
10   abaa1238              Rngaba       Rngaba      tip  329
               tree_name
1           Afro-Asiatic
2           Austronesian
3  NuclearTransNewGuinea
4            SouthOmotic
5            SouthOmotic
6                   &lt;NA&gt;
7           Afro-Asiatic
8          Indo-European
9  NuclearTransNewGuinea
10          Sino-Tibetan</code></pre>
</div>
</div>
<p>Briefer metadata about glottolog’s language families can be accessed using the <code>glottoTrees</code> function <code>get_glottolog_families()</code>. This returns a dataframe of 420 rows, so to view it in full, we also suggest saving it to a CSV file and opening it in spreadsheet software. Here are the first ten rows:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>family_metadata <span class="ot">&lt;-</span> <span class="fu">get_glottolog_families</span>()</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(family_metadata, <span class="at">n =</span> <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   tree           tree_name n_tips n_nodes main_macroarea
1     1                 Yam     33      18      Papunesia
2     2     Mongolic-Khitan     66      25        Eurasia
3     3 Kol{PapuaNewGuinea}      2       1      Papunesia
4     4       Namla-Tofanma      2       1      Papunesia
5     5          Tanahmerah      1       1      Papunesia
6     6         Jarawa-Onge      2       1        Eurasia
7     7        Ta-Ne-Omotic     29      15         Africa
8     8              Pomoan     10       7  North America
9     9         WesternDaly     14       7      Australia
10   10           Yangmanic      3       1      Australia</code></pre>
</div>
</div>
<p>Glottolog v4.4 divides the world’s languages into 420 families, including 138 isolates, and it provides a tree for each. Together, the 420 trees contain 8,209 internal nodes and 17,008 tips, many of which represent varieties that would typically be considered dialects. Geographically, glottolog assigns each language variety to one of six <em>macroareas</em>: Africa, Australia, Eurasia, Papunesia, South America or North America. The <code>glottoTrees</code> metadata includes a column <code>main_macroarea</code>. This is the one macroarea which contains more of the family’s language varieties than any other. We will see how this information can be useful in Section @ref(combining-trees).</p>
<p>Glottolog’s 420 family trees are stored in a <code>multiPhylo</code> object named <code>glottolog_trees_v4.4</code>. For example, here is glottolog’s representation of the Great Andamanese family, which is tree 340 within the object <code>glottolog_trees_v4.4</code>. For readability, we plot this tree horizontally:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>tree_GA <span class="ot">&lt;-</span> glottolog_trees_v4<span class="fl">.4</span>[[<span class="dv">340</span>]]</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(tree_GA, <span class="at">x.lim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.3</span>, <span class="dv">14</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="phylo_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid figure-img" style="width:60.0%"></p>
</figure>
</div>
</div>
</div>
<p>Just above, we obtained the tree for Great Andamanese by referring to its tree number (340) in the <code>glottolog_trees_v4.4</code> object. The package <code>glottoTrees</code> also provides a function <code>get_glottolog_trees()</code> which enables trees to be obtained using the glottolog name for their families, for instance:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>tree_GA <span class="ot">&lt;-</span> <span class="fu">get_glottolog_trees</span>(<span class="st">"GreatAndamanese"</span>)</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(tree_GA, <span class="at">x.lim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.3</span>, <span class="dv">14</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="phylo_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid figure-img" style="width:60.0%"></p>
</figure>
</div>
</div>
</div>
<p>If you know the name of one or more families and would like to now the number of their trees, use <code>which_tree()</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">which_tree</span>(<span class="st">"GreatAndamanese"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>GreatAndamanese 
            340 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">which_tree</span>(<span class="fu">c</span>(<span class="st">"Turkic"</span>, <span class="st">"Tupian"</span>, <span class="st">"Tuu"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Turkic Tupian    Tuu 
   217     32     76 </code></pre>
</div>
</div>
<p>Both <code>get_glottolog_trees()</code> and <code>which_tree()</code> allow the usage of a <code>glottolog_version</code> argument, to refer to older versions of glottolog. For instance, here are the tree numbers of the same families in version 4.1:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">which_tree</span>(<span class="st">"GreatAndamanese"</span>, <span class="at">glottolog_version =</span> <span class="st">"4.1"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>GreatAndamanese 
              6 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">which_tree</span>(<span class="fu">c</span>(<span class="st">"Turkic"</span>, <span class="st">"Tupian"</span>, <span class="st">"Tuu"</span>), <span class="at">glottolog_version =</span> <span class="st">"4.1"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Turkic Tupian    Tuu 
    66    297     80 </code></pre>
</div>
</div>
<p>In glottolog’s trees, the tip labels are rather long, consisting of a name followed by a glottocode in angled brackets, an ISO code in angled brackets (if one exists) and possibly the string “-l-”. Node labels (not shown in the tree above) have the same structure. The <code>glottoTrees</code> function <code>abridge_labels()</code> will shorten labels to just the glottocode, for example:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>tree_GA_abr <span class="ot">&lt;-</span> <span class="fu">abridge_labels</span>(tree_GA)</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_glotto</span>(tree_GA_abr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="phylo_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid figure-img" style="width:70.0%"></p>
</figure>
</div>
</div>
</div>
<p>The function <code>abridge_labels()</code> will issue a warning if there are tip or node labels in which it is unable to identify a glottocode. We will see an example of this shortly below.</p>
<p>In glottolog’s trees, the branches are all of equal length. We will discuss how to assign more realistic branch lengths in Section <a href="#How-to-add-branch-lengths">How to add branch lengths</a>.</p>
</section>
<section id="combining-trees" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="combining-trees"><span class="header-section-number">3.2</span> How to combine trees</h2>
<p>As discussed <span class="citation" data-cites="macklin-cordes_challenges_nodate">[<a href="#ref-macklin-cordes_challenges_nodate" role="doc-biblioref">2</a>]</span>, the comparison of languages across language families unavoidably carries a commitment to a genealogical hypothesis, even if that hypotheses is, tacitly, that all families are equally (un)related. Given that making such hypotheses is unavoidable, it will be most beneficial for progress in the field to make them explicit. To enable typologists to explore genealogical hypotheses and to make those hypotheses explicit, <code>glottoTrees</code> provides tools for combining multiple glottolog trees into one.</p>
<p>To begin with a small example, here we combine five glottolog families to represent the hypothesised Arnhem group in northern Australia <span class="citation" data-cites="green_proto_2003">[<a href="#ref-green_proto_2003" role="doc-biblioref">10</a>]</span>. First we create a <code>multiPhylo</code> object containing the five glottolog language families (Gunwinyguan, Mangarrayi-Maran, Maningrida, and the isolates Kungarakany and Gaagudju):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>arnhem_family_names <span class="ot">&lt;-</span> </span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="st">"Gunwinyguan"</span>, <span class="st">"Mangarrayi-Maran"</span>, <span class="st">"Maningrida"</span>, <span class="st">"Kungarakany"</span>, <span class="st">"Gaagudju"</span>)</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>multiPhylo_arnhem <span class="ot">&lt;-</span> <span class="fu">get_glottolog_trees</span>(arnhem_family_names)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The <code>glottoTrees</code> function <code>assemble_rake()</code> enables the trees in a <code>multiPhylo</code> object to be assembled into a single tree with a rake structure at its root. Here we apply <code>assemble_rake()</code> to our <code>multiPhylo</code> object and assign the resulting, single tree to the object <code>tree_arnhem</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>tree_arnhem <span class="ot">&lt;-</span> <span class="fu">assemble_rake</span>(multiPhylo_arnhem)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>For plotting, it will be convenient to shorten the labels in the tree to just the glottocodes, using <code>abridge_labels()</code>. However, the root node in our newly created tree <code>tree_arnhem</code> has no label. Accordingly, the function <code>abridge_labels()</code> will issue a warning, that it encountered one node without a glottocode. This is not an error message, and <code>abridge_labels()</code> still shortens all labels to glottocodes where it can; it is just flagging the fact that it was not able to do so in all cases.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>tree_arnhem_abr <span class="ot">&lt;-</span> <span class="fu">abridge_labels</span>(tree_arnhem)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in abridge_labels(tree_arnhem): Labels without glottocodes were detected
and left unchanged for: 0 tip(s); 1 node(s):</code></pre>
</div>
</div>
<p>Plotting the resulting tree enables us to inspect our newly created Arnhem tree. Note how all five families are joined to the root in a rake-like structure, without any additional subgrouping.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_glotto</span>(tree_arnhem_abr, <span class="at">nodelabels =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="phylo_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid figure-img" style="width:75.0%"></p>
</figure>
</div>
</div>
</div>
<p>It is possible to give a combined tree more structure, by using <code>assemble_rake()</code> iteratively. For instance, suppose we wished to hypothesise that Gunwinyguan, Mangarrayi-Maran and Maningrida form their own subgroup. First, we create a <code>multiPhylo</code> object containing those three trees, and combine it into a single rake tree, which we call <code>tree_A</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>multiPhylo_A <span class="ot">&lt;-</span> <span class="fu">get_glottolog_trees</span>(<span class="fu">c</span>(<span class="st">"Gunwinyguan"</span>, <span class="st">"Mangarrayi-Maran"</span>, <span class="st">"Maningrida"</span>))</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>tree_A <span class="ot">&lt;-</span> <span class="fu">assemble_rake</span>(multiPhylo_A)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Then we create the final tree by combining <code>tree_A</code> with the two isolate family trees:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>multiPhylo_arnhem2 <span class="ot">&lt;-</span> <span class="fu">c</span>(tree_A, <span class="fu">get_glottolog_trees</span>(<span class="fu">c</span>(<span class="st">"Kungarakany"</span>, <span class="st">"Gaagudju"</span>)))</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>tree_arnhem2 <span class="ot">&lt;-</span> <span class="fu">assemble_rake</span>(multiPhylo_arnhem2)</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>tree_arnhem2_abr <span class="ot">&lt;-</span> <span class="fu">abridge_labels</span>(tree_arnhem2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in abridge_labels(tree_arnhem2): Labels without glottocodes were
detected and left unchanged for: 0 tip(s); 2 node(s): ,</code></pre>
</div>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_glotto</span>(tree_arnhem2_abr, <span class="at">nodelabels =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="phylo_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid figure-img" style="width:75.0%"></p>
</figure>
</div>
</div>
</div>
<p>Typological studies often examine languages from very many families. To group all 420 families into a single ‘supertree’, <code>glottoTrees</code> provides the function <code>assemble_supertree()</code>. By default, the function returns a supertree that divides first into glottolog’s six macroareas, with an internal node for each, and directly below these macroarea nodes appear all of the glottolog families, grouped by their <code>main_macroarea</code> mentioned in Section <a href="#Glottolog's-genealogical-data">Glottolog’s genealogical data</a> above. This tree is enormous, so we do not plot it here. It is obtained like this:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>my_supertree <span class="ot">&lt;-</span> <span class="fu">assemble_supertree</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The highest-level, macroarea groupings can also be controlled through the function’s argument <code>macro_groups</code>. For instance, to group all of the world’s families directly into a 420-pronged rake structure, set <code>macro_groups = NULL</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>my_supertree <span class="ot">&lt;-</span> <span class="fu">assemble_supertree</span>(<span class="at">macro_groups =</span> <span class="cn">NULL</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>It is also possible to group macroareas together, for example, to combine North and South America into a single group. Grouping of macroareas is achieved by setting the <code>macro_groups</code> argument to a <em>list</em> whose items are the desired groups of macroareas. Each group will then appear as one of the highest-level nodes of the tree, and all of its families below it. For instance, to keep all of glottolog’s macroareas separate, but to combine North and South America into a single group, the following code would be used. First we define a list, which we’ve called <code>my_list</code>, within which any groupings containing more than one macroarea are represented as a vector, using the <code>c()</code> function:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>my_list <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">"Africa"</span>, <span class="st">"Australia"</span>, <span class="st">"Eurasia"</span>, <span class="st">"Papunesia"</span>,</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>                <span class="fu">c</span>(<span class="st">"South America"</span>, <span class="st">"North America"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We then use that list as the <code>macro_groups</code> argument of <code>assemble_supertree()</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>my_supertree <span class="ot">&lt;-</span> <span class="fu">assemble_supertree</span>(<span class="at">macro_groups =</span> my_list)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Taking a second example, to create a supertree containing only the families whose <code>main_macroarea</code> is either Africa or Eurasia, and to place Africa and Eurasia under separate, highest-level nodes, we would use:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>my_list <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">"Africa"</span>, <span class="st">"Eurasia"</span>)</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>my_supertree <span class="ot">&lt;-</span> <span class="fu">assemble_supertree</span>(<span class="at">macro_groups =</span> my_list)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="filter-tips" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="filter-tips"><span class="header-section-number">3.3</span> How to modify trees</h2>
<p>There are several reasons why typologists may wish to use a tree that departs from the glottolog trees. Most commonly, a typological study will cover a set of languages that differs from the set of tips in any single glottolog tree, either through the exclusion of some of the lects that glottolog represents as tips or through the distinction of additional lects. A third case that can arise is when glottolog places one or more dialects at the tree’s tips and more a general, language node above them. The typologist may have data that applies to the language (an internal node) rather than the dialects (the tips), yet the calculation of genealogically-sensitive averages and proportions requires one’s typological variables to be related to the tips of trees, not to internal nodes. In these cases and many others, the typologist may wish to alter the glottolog tree to suit the purposes of the research. The <code>glottoTrees</code> package supplies a set of functions to aid in performing each of these tree manipulations. In this section we introduce them and illustrate their use.</p>
<p>In the following examples, we will make use glottolog’s representation of the Great Andamanese family, whose labels we shorten to just the glottocodes using <code>abridge_labels()</code>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>tree_GA <span class="ot">&lt;-</span> <span class="fu">get_glottolog_trees</span>(<span class="st">"GreatAndamanese"</span>)</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>tree_GA_abr <span class="ot">&lt;-</span> <span class="fu">abridge_labels</span>(tree_GA)</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_glotto</span>(tree_GA_abr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="phylo_files/figure-html/unnamed-chunk-37-1.png" class="img-fluid figure-img" style="width:70.0%"></p>
</figure>
</div>
</div>
</div>
<section id="how-to-remove-tips" class="level3" data-number="3.3.1">
<h3 data-number="3.3.1" class="anchored" data-anchor-id="how-to-remove-tips"><span class="header-section-number">3.3.1</span> How to remove tips</h3>
<p>Firstly, we illustrate the removal of tips from a tree. There are two functions in <code>glottoTrees</code> for doing this. The function <code>remove_tip()</code> works by specifying which tips are to be removed, while the function <code>keep_tip()</code> works by specifying which tips are to be retained. First we will remove three of the original ten tips in the Great Andamanese tree. We do this by setting the <code>label</code> argument of <code>remove_tip()</code> to a vector containing the labels of the tips to be removed. Within the vector, the labels can appear in any order.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>tree_GAa <span class="ot">&lt;-</span> <span class="fu">remove_tip</span>(tree_GA_abr, <span class="at">label =</span> <span class="fu">c</span>(<span class="st">"akab1249"</span>, <span class="st">"akak1251"</span>, <span class="st">"apuc1241"</span>))</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_glotto</span>(tree_GAa)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="phylo_files/figure-html/unnamed-chunk-38-1.png" class="img-fluid figure-img" style="width:70.0%"></p>
</figure>
</div>
</div>
</div>
<p>In this next example, we remove the tips <code>akab1249</code> and <code>akar1243</code>. These tips are the only tips that sit below the internal node <code>sout2683</code>. This is significant, because it triggers a convention in tree manipulation, that if all tips below a node are removed, then the node is removed also. We see that here:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>tree_GAb <span class="ot">&lt;-</span> <span class="fu">remove_tip</span>(tree_GA_abr, <span class="at">label =</span> <span class="fu">c</span>(<span class="st">"akab1249"</span>, <span class="st">"akar1243"</span>))</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_glotto</span>(tree_GAb)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="phylo_files/figure-html/unnamed-chunk-39-1.png" class="img-fluid figure-img" style="width:70.0%"></p>
</figure>
</div>
</div>
</div>
<p>We now illustrate the usage of the <code>glottoTrees</code> function <code>keep_tip()</code>. Here we use it to retain six of the original ten tips in the Great Andamanese. We do this by setting the <code>label</code> argument to a vector containing the labels of the six desired tips.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>tree_GAc <span class="ot">&lt;-</span> <span class="fu">keep_tip</span>(tree_GA_abr, <span class="at">label =</span> <span class="fu">c</span>(<span class="st">"akar1243"</span>, <span class="st">"akak1251"</span>, <span class="st">"akac1240"</span>,</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>                                            <span class="st">"akak1252"</span>, <span class="st">"apuc1241"</span>, <span class="st">"okoj1239"</span>))</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_glotto</span>(tree_GAc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="phylo_files/figure-html/unnamed-chunk-40-1.png" class="img-fluid figure-img" style="width:70.0%"></p>
</figure>
</div>
</div>
</div>
<p>As before, if our use of <code>keep_tip()</code> results in a node having all of the tips below it removed, then the node will also be removed automatically. This is illustrated here, where the node <code>boca1235</code> is removed automatically because neither of the tips below it are kept:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>tree_GAd <span class="ot">&lt;-</span> <span class="fu">keep_tip</span>(tree_GA_abr, <span class="at">label =</span> <span class="fu">c</span>(<span class="st">"akar1243"</span>, <span class="st">"akak1251"</span>, <span class="st">"akak1252"</span>,</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>                                            <span class="st">"apuc1241"</span>, <span class="st">"okoj1239"</span>))</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_glotto</span>(tree_GAd)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="phylo_files/figure-html/unnamed-chunk-41-1.png" class="img-fluid figure-img" style="width:70.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="how-to-remove-tips-and-convert-nodes-to-tips" class="level3" data-number="3.3.2">
<h3 data-number="3.3.2" class="anchored" data-anchor-id="how-to-remove-tips-and-convert-nodes-to-tips"><span class="header-section-number">3.3.2</span> How to remove tips and convert nodes to tips</h3>
<p>As mentioned earlier, many of the tips in glottolog’s trees correspond to dialects, with languages represented as nodes above the dialectal tips. One usage case we foresee is that a typologist will wish to study a set of language varieties, some of which correspond to glottolog’s tips and some of which correspond to nodes. The <code>glottoTrees</code> function <code>keep_as_tips()</code> takes an argument <code>label</code> which can contain both tip labels and node labels. Any tips will be kept, and any nodes will be converted into tips, with all of the structure below them being removed. Be mindful when using <code>keep_as_tips()</code> that it is not possible to both convert a node into a tip and also retain the structure below it, such as tips that it dominates. Here we keep the same tips as in the tree above, while also converting the node <code>boca1235</code> into a tip:<a href="#fn6" class="footnote-ref" id="fnref6" role="doc-noteref"><sup>6</sup></a></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>tree_GAe <span class="ot">&lt;-</span> <span class="fu">keep_as_tip</span>(tree_GA_abr, <span class="at">label =</span> <span class="fu">c</span>(<span class="st">"akar1243"</span>, <span class="st">"akak1251"</span>, <span class="st">"akak1252"</span>,</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>                                               <span class="st">"apuc1241"</span>, <span class="st">"okoj1239"</span>, <span class="st">"boca1235"</span>))</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_glotto</span>(tree_GAe)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="phylo_files/figure-html/unnamed-chunk-42-1.png" class="img-fluid figure-img" style="width:70.0%"></p>
</figure>
</div>
</div>
</div>
<p>One workflow that we envision for <code>keep_as_tip()</code> is that the typologist has prepared a CSV file, one of whose columns is named <code>tip</code> and contains the glottocodes of all the language varieties in the study. This CSV file can be loaded in R and assigned to a dataframe, and then its <code>tip</code> column can be passed to <code>keep_as_tip()</code> as the value of the <code>labels</code> argument, like this:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>my_dataframe <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"my_data_file.csv"</span>, <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>)</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>my_new_tree <span class="ot">&lt;-</span> <span class="fu">keep_as_tip</span>(my_old_tree, <span class="at">label =</span> my_dataframe<span class="sc">$</span>tip)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>To just convert one or more nodes into tips, use <code>convert_to_tip()</code>, as we do here to convert the nodes <code>okol1242</code> and <code>sout2683</code> to tips:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>tree_GAf <span class="ot">&lt;-</span> <span class="fu">convert_to_tip</span>(tree_GA_abr, <span class="at">label =</span> <span class="fu">c</span>(<span class="st">"okol1242"</span>, <span class="st">"sout2683"</span>))</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_glotto</span>(tree_GAf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="phylo_files/figure-html/unnamed-chunk-44-1.png" class="img-fluid figure-img" style="width:70.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="how-to-remove-internal-nodes" class="level3" data-number="3.3.3">
<h3 data-number="3.3.3" class="anchored" data-anchor-id="how-to-remove-internal-nodes"><span class="header-section-number">3.3.3</span> How to remove internal nodes</h3>
<p>Sometimes, the removal of tips will cause one or more of the remaining tips to sit below a node which dominates only it. This reflects that fact that <code>remove_tip()</code>, <code>keep_tip()</code> and <code>keep_as_tip()</code> all preserve the original <em>depth</em> of any tips that remain in the tree (you may like to confirm this by reviewing the plots above). Depending on the researcher’s needs, this outcome may or may not be desirable. If it is undesirable, then non-branching, internal nodes can be removed using the <code>glottoTrees</code> function <code>collapse_node()</code>. For instance, here we remove two of the non-branching nodes from the tree <code>tree_GAc</code> above, by naming them in the <code>label</code> argument of <code>collapse_node()</code>. In the resulting tree, these nodes have been removed, thus reducing the depth of the tips below them:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>tree_GAg <span class="ot">&lt;-</span> <span class="fu">collapse_node</span>(tree_GAc, <span class="at">label =</span> <span class="fu">c</span>(<span class="st">"boca1235"</span>, <span class="st">"okol1242"</span>))</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_glotto</span>(tree_GAg)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="phylo_files/figure-html/unnamed-chunk-45-1.png" class="img-fluid figure-img" style="width:55.0%"></p>
</figure>
</div>
</div>
</div>
<p>When deciding whether to collapse nodes, in can be handy to know which nodes in a tree that have only one child below them. The function <code>nonbranching_nodes()</code> will return a vector of all such nodes, for example:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">nonbranching_nodes</span>(tree_GAc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "okol1242" "boca1235" "jeru1239" "sout2683"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">nonbranching_nodes</span>(tree_GAg)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "jeru1239" "sout2683"</code></pre>
</div>
</div>
<p>The function <code>collapse_node()</code> can also be used to alter a subgrouping hypothesis, and specifically, to remove a layer of subgrouping, converting a nested structure ((A,B),C) into a flat structure (A,B,C). For instance, here we remove the <code>okol1242</code> node of the original glottolog Great Andamanese tree, converting its two daughter languages into sisters of <code>okoj1239</code>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>tree_GAh <span class="ot">&lt;-</span> <span class="fu">collapse_node</span>(tree_GA_abr, <span class="at">label=</span> <span class="st">"okol1242"</span>)</span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_glotto</span>(tree_GAh)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="phylo_files/figure-html/unnamed-chunk-47-1.png" class="img-fluid figure-img" style="width:70.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="how-to-add-tips" class="level3" data-number="3.3.4">
<h3 data-number="3.3.4" class="anchored" data-anchor-id="how-to-add-tips"><span class="header-section-number">3.3.4</span> How to add tips</h3>
<p>The function <code>add_tip()</code> allows tips to be added to a tree. The <code>label</code> argument specifies the name of the new tip, while <code>parent_label</code> specifies the label of the node below which the new tip should appear. Here we add a tip <code>xxxx1234</code> below the node <code>sout2683</code>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>tree_GAi <span class="ot">&lt;-</span> <span class="fu">add_tip</span>(tree_GA_abr, <span class="at">label =</span> <span class="st">"xxxx1234"</span>, <span class="at">parent_label =</span> <span class="st">"sout2683"</span>)</span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_glotto</span>(tree_GAi)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="phylo_files/figure-html/unnamed-chunk-48-1.png" class="img-fluid figure-img" style="width:55.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="how-to-clone-tips" class="level3" data-number="3.3.5">
<h3 data-number="3.3.5" class="anchored" data-anchor-id="how-to-clone-tips"><span class="header-section-number">3.3.5</span> How to clone tips</h3>
<p>Next we illustrate the cloning of tips. Cloning tips may be useful when glottolog provides only one glottocode, and thus only one tree tip, corresponding to multiple lects in the typologist’s study. To clone a tip, use the function <code>clone_tip()</code> and in the <code>label</code> argument, provide a vector of the tips to be cloned. Here we clone tips <code>akar1243</code> and <code>akak1252</code>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>tree_GAj <span class="ot">&lt;-</span> <span class="fu">clone_tip</span>(tree_GA_abr, <span class="at">label =</span> <span class="fu">c</span>(<span class="st">"akar1243"</span>, <span class="st">"akak1252"</span>))</span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_glotto</span>(tree_GAj)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="phylo_files/figure-html/unnamed-chunk-49-1.png" class="img-fluid figure-img" style="width:70.0%"></p>
</figure>
</div>
</div>
</div>
<p>By default, clones are added to the tree as sisters directly beneath the parent node of the original tip. An alternative is to create a new subgroup for each set of sister clones, using the <code>subgroup</code> argument and setting it to <code>subgroup = TRUE</code>. Each newly created subgroup node is given a label that matches the cloned tips it dominates:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>tree_GAk <span class="ot">&lt;-</span> <span class="fu">clone_tip</span>(tree_GA_abr, <span class="at">label =</span> <span class="fu">c</span>(<span class="st">"akar1243"</span>, <span class="st">"akak1252"</span>), <span class="at">subgroup =</span> <span class="cn">TRUE</span>)</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_glotto</span>(tree_GAk)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="phylo_files/figure-html/unnamed-chunk-50-1.png" class="img-fluid figure-img" style="width:70.0%"></p>
</figure>
</div>
</div>
</div>
<p>It is also possible to make more than one clone using the <code>n</code> argument. Here we create three new clones of <code>akab1248</code> and place them in a subgroup:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>tree_GAl <span class="ot">&lt;-</span> <span class="fu">clone_tip</span>(tree_GA_abr, <span class="at">label =</span> <span class="st">"akab1248"</span>, <span class="at">n =</span> <span class="dv">3</span>, <span class="at">subgroup =</span> <span class="cn">TRUE</span>)</span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_glotto</span>(tree_GAl)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="phylo_files/figure-html/unnamed-chunk-51-1.png" class="img-fluid figure-img" style="width:70.0%"></p>
</figure>
</div>
</div>
</div>
<p>One of the consequences of cloning tips is that the in the resulting tree, not all tips will have distinct names. The function <code>apply_duplicate_suffixes()</code> will add a suffix to any tips with duplicate labels, to make them unique.<a href="#fn7" class="footnote-ref" id="fnref7" role="doc-noteref"><sup>7</sup></a> The suffix will consist of a hyphen followed by a number. Here we add suffixes to the tree <code>tree_GAj</code>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>tree_GAm <span class="ot">&lt;-</span> <span class="fu">apply_duplicate_suffixes</span>(tree_GAj)</span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_glotto</span>(tree_GAm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="phylo_files/figure-html/unnamed-chunk-52-1.png" class="img-fluid figure-img" style="width:70.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="how-to-move-a-tip" class="level3" data-number="3.3.6">
<h3 data-number="3.3.6" class="anchored" data-anchor-id="how-to-move-a-tip"><span class="header-section-number">3.3.6</span> How to move a tip</h3>
<p>Using the function <code>move_tip()</code>, a tip can be moved to a new position, beneath a new parent node (one of the nodes already in the tree) which is specified with the <code>parent_label</code> argument:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>tree_GAn <span class="ot">&lt;-</span> <span class="fu">move_tip</span>(tree_GA_abr, <span class="at">label =</span> <span class="st">"apuc1241"</span>, <span class="at">parent_label =</span> <span class="st">"jeru1239"</span>)</span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_glotto</span>(tree_GAn)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="phylo_files/figure-html/unnamed-chunk-53-1.png" class="img-fluid figure-img" style="width:70.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="how-to-move-a-node-and-its-descendants" class="level3" data-number="3.3.7">
<h3 data-number="3.3.7" class="anchored" data-anchor-id="how-to-move-a-node-and-its-descendants"><span class="header-section-number">3.3.7</span> How to move a node and its descendants</h3>
<p>In a similar fashion, the function <code>move_node()</code> is used to move an internal node, along with all of the structure below it, to a position beneath a new parent node:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>tree_GAo <span class="ot">&lt;-</span> <span class="fu">move_node</span>(tree_GA_abr, <span class="at">label =</span> <span class="st">"jeru1239"</span>, <span class="at">parent_label =</span> <span class="st">"okol1242"</span>)</span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_glotto</span>(tree_GAo)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="phylo_files/figure-html/unnamed-chunk-54-1.png" class="img-fluid figure-img" style="width:70.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="summary-a-general-purpose-toolkit-for-curating-trees-topology" class="level3" data-number="3.3.8">
<h3 data-number="3.3.8" class="anchored" data-anchor-id="summary-a-general-purpose-toolkit-for-curating-trees-topology"><span class="header-section-number">3.3.8</span> Summary: a general-purpose toolkit for curating trees’ topology</h3>
<p>The functions <code>remove_tip()</code>, <code>keep_tip()</code>, <code>keep_as_tip()</code>, <code>convert_to_tip()</code>, <code>collapse_node()</code>, <code>add_tip()</code>, <code>clone_tip()</code>, <code>move_tip()</code> and <code>move_node()</code> provide a general-purpose toolkit for modifying a single glottolog tree, or a combined tree, or supertree, to make its set of tips, and the subgrouping of those tips, conform to the set of lects that a typologist is analysing in a typological study.</p>
</section>
</section>
<section id="add-lengths" class="level2" data-number="3.4">
<h2 data-number="3.4" class="anchored" data-anchor-id="add-lengths"><span class="header-section-number">3.4</span> How to add branch lengths</h2>
<p>Branch lengths in a tree convey information, and most phylogenetic comparative methods, including genealogically-sensitive averages and proportions, are sensitive to the information represented by the branch lengths. (To be specific, genealogically-sensitive averages and proportions are sensitive to the <em>relative</em> lengths of the branches, so multiplying all of the branch lengths in a tree by some constant amount would not affect the results.)</p>
<p>Glottolog’s trees contain informative subgrouping structure, but the branch lengths are all equal. Even without knowing what the true branch lengths are for a linguistic tree, we do know that a situation in which all are equal is highly unlikely. A good approximation to the most-likely<a href="#fn8" class="footnote-ref" id="fnref8" role="doc-noteref"><sup>8</sup></a> distribution of branch lengths in a phylogenetic tree, under a variety of assumptions, is exponential <span class="citation" data-cites="venditti2010phylogenies">[<a href="#ref-venditti2010phylogenies" role="doc-biblioref">11</a>]</span>, i.e., very long branches are rare, and very short ones are frequent. This notion is implemented in the <code>glottoTrees</code> package by the function <code>rescale_branches_exp()</code>, which sets the deepest branches to length 1/2, then next layer to length 1/4, then the next to 1/8 and so on. This will produce a more plausible set of branch lengths, even in the absence of firm knowledge of exact lengths, and on these grounds we advocate its use if additional information about branch lengths is not available.</p>
<p>Here is an example of the result of applying exponential branch lengths to glottolog’s Great Andamanese tree:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>tree_GAp <span class="ot">&lt;-</span> <span class="fu">rescale_branches_exp</span>(tree_GA_abr)</span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_glotto</span>(tree_GAp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="phylo_files/figure-html/unnamed-chunk-55-1.png" class="img-fluid figure-img" style="width:70.0%"></p>
</figure>
</div>
</div>
</div>
<p>Here is an example of the result of applying them to glottolog’s Eskimo-Aleut tree, of 30 tips:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>tree_EA <span class="ot">&lt;-</span> <span class="fu">get_glottolog_trees</span>(<span class="st">"Eskimo-Aleut"</span>)</span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>tree_EA_abr <span class="ot">&lt;-</span> <span class="fu">abridge_labels</span>(tree_EA)</span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>tree_EAa <span class="ot">&lt;-</span> <span class="fu">rescale_branches_exp</span>(tree_EA_abr)</span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_glotto</span>(tree_EAa, <span class="at">nodelabels =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="phylo_files/figure-html/unnamed-chunk-56-1.png" class="img-fluid figure-img" style="width:70.0%"></p>
</figure>
</div>
</div>
</div>
<p>An additional option is to stretch the terminal branches so that all tips are equidistant from the root, creating what is known as an <em>ultrametric</em> tree. This is done using the function <code>ultrametricize()</code>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>tree_EAb <span class="ot">&lt;-</span> <span class="fu">ultrametricize</span>(tree_EAa)</span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_glotto</span>(tree_EAb, <span class="at">nodelabels =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="phylo_files/figure-html/unnamed-chunk-57-1.png" class="img-fluid figure-img" style="width:70.0%"></p>
</figure>
</div>
</div>
</div>
<p>An additional function, <code>rescale_deepest_branches()</code>, can be used to adjust just the deepest layer of branches. This may be useful where multiple family trees have been joined together, and there is a desire to manipulate the implied closeness or distance between the first-order branches. For example, here we take the hypothesised Arnhem group from Section @ref(combining-trees). First we assign exponential branch lengths with <code>set_branch_lengths_exp()</code>, which sets the deepest branch length to 1/2. Then we triple the distance of the deepest level of relationships by changing the first branch length to 1.5 using <code>rescale_deepest_branches()</code>, before ultrametricising the tree:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>tree_arnhem_a <span class="ot">&lt;-</span> <span class="fu">rescale_branches_exp</span>(tree_arnhem_abr)</span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>tree_arnhem_b <span class="ot">&lt;-</span> <span class="fu">rescale_deepest_branches</span>(tree_arnhem_a, <span class="fl">1.5</span>)</span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a>tree_arnhem_c <span class="ot">&lt;-</span> <span class="fu">ultrametricize</span>(tree_arnhem_b)</span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_glotto</span>(tree_arnhem_c, <span class="at">nodelabels =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="phylo_files/figure-html/unnamed-chunk-58-1.png" class="img-fluid figure-img" style="width:70.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="exporting" class="level2" data-number="3.5">
<h2 data-number="3.5" class="anchored" data-anchor-id="exporting"><span class="header-section-number">3.5</span> Exporting trees for use with other software</h2>
<p>In R, trees can be saved to file in Newick format using the function <code>write.tree()</code> in the <code>ape</code> package. Files like this can be opened by other software such as FigTree<a href="#fn9" class="footnote-ref" id="fnref9" role="doc-noteref"><sup>9</sup></a>, which can be used to interactively generate tree plots that may be useful for publication and dissemination. For instance, here we write the tree <code>tree_arnhem_c</code> to a file whose filename ends in the standard file extension, <code>.tree</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write.tree</span>(tree_arnhem_c, <span class="st">"my_arnhem_tree.tree"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Often it will be desirable to reproduce a tree with labels that are more reader-friendly than glottocodes. <code>glottoTrees</code> provides the function <code>relabel_with_names()</code>, which will replace full glottolog labels, or labels consisting of just a glottocode, with glottolog’s corresponding language, dialect, subgroup or family name. Here we relabel the Arnhem tree by the languages’ names. As was the case with <code>abridge_labels()</code>, warnings are given by <code>relabel_with_names()</code> if a tree contains any nodes that cannot be relabeled in this way; these are not errors, just alerts.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>tree_arnhem_c_namelabels <span class="ot">&lt;-</span> <span class="fu">relabel_with_names</span>(tree_arnhem_c)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in relabel_with_names(tree_arnhem_c): Labels without glottocodes were
detected and left unchanged for: 0 tip(s); 1 node(s):</code></pre>
</div>
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_glotto</span>(tree_arnhem_c_namelabels, <span class="at">nodelabels =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="phylo_files/figure-html/unnamed-chunk-60-1.png" class="img-fluid figure-img" style="width:70.0%"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="example" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Putting it together: A worked example</h1>
<p>In this section we provide a real worked example of the use of the methods described above.</p>
<p><span class="citation" data-cites="yin_violations_2020">[<a href="#ref-yin_violations_2020" role="doc-biblioref">6</a>]</span> examined violations of the sonority sequencing principle in 496 languages, and calculated the genealogically-sensitive proportions of languages in which various violations occurred. The language sample consisted of 496 languages in the CLICS2 database <span class="citation" data-cites="anderson2018clics2">[<a href="#ref-anderson2018clics2" role="doc-biblioref">12</a>]</span> and the AusPhon-Lexicon database <span class="citation" data-cites="round_ausphon-lexicon_2017">[<a href="#ref-round_ausphon-lexicon_2017" role="doc-biblioref">13</a>]</span>. The language sample was not balanced in the traditional sense, and phylogenetic methods were used to help produce a principled interpretation of the data.</p>
<p>Yin’s raw data consisted of a table of languages’ names and glottocodes and indications of whether or not the languages had consonant clusters in word-initial onsets or word-final codas that contained sonority reversals, coded as 1 for yes and 0 for no. This dataset is provided with the <code>phyloWeights</code> package as a dataframe named <code>yin_2020_data</code> whose columns are <code>name</code>, <code>tip</code>, <code>has_onset_violation</code> and <code>has_coda_violation</code>. The first ten rows are shown here:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(yin_2020_data, <span class="at">n =</span> <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>               name      tip has_onset_violation has_coda_violation
1            Abkhaz abkh1244                   1                  1
2              Abui abui1241                   0                  0
3           Achagua acha1250                   0                  1
4             Adang adan1251                   0                  1
5     Adnyamathanha adny1235                   0                  0
6            Adyghe adyg1241                   1                  1
7      Hokkaidoainu ainu1240                   0                  0
8             Alawa alaw1244                   1                  0
9  Standardalbanian alba1267                   1                  1
10            Aleut aleu1260                   1                  1</code></pre>
</div>
</div>
<section id="preparing-a-tree" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="preparing-a-tree"><span class="header-section-number">4.1</span> Preparing a tree</h2>
<p>The tree for Yin’s study was constructed from a glottolog supertree, using glottolog version 4.2. Yin’s supertree made use of glottolog’s macroareas. Since the language sample covered relatively few families in the Americas, a single group was used for South America and North America. Additionally, the only African language available in the sample was Arabic, so Africa and Eurasia were grouped together:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>yin_macro <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="fu">c</span>(<span class="st">"South America"</span>, <span class="st">"North America"</span>), <span class="fu">c</span>(<span class="st">"Africa"</span>, <span class="st">"Eurasia"</span>),</span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"Papunesia"</span>, <span class="st">"Australia"</span>)</span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>supertree <span class="ot">&lt;-</span> <span class="fu">assemble_supertree</span>(<span class="at">macro_groups =</span> yin_macro, <span class="at">glottolog_version =</span> <span class="st">"4.2"</span>)</span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a>supertree_abr <span class="ot">&lt;-</span> <span class="fu">abridge_labels</span>(supertree)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in abridge_labels(supertree): Labels without glottocodes were detected
and left unchanged for: 0 tip(s); 5 node(s): World, SouthAmerica-NorthAmerica,
Africa-Eurasia, Papunesia, Australia</code></pre>
</div>
</div>
<p>Five tips were cloned, in cases where Yin had data for two varieties corresponding to just one tip in the glottolog supertree:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>supertree_a <span class="ot">&lt;-</span> <span class="fu">clone_tip</span>(supertree_abr, <span class="at">subgroup =</span> <span class="cn">TRUE</span>,</span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>                         <span class="at">label =</span> <span class="fu">c</span>(<span class="st">"ayab1239"</span>, <span class="st">"basu1242"</span>, <span class="st">"biri1256"</span>,</span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">"ikar1243"</span>, <span class="st">"peri1265"</span>))</span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a>supertree_b <span class="ot">&lt;-</span> <span class="fu">apply_duplicate_suffixes</span>(supertree_a)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Eight tips were added, in cases where for sister lects (A,B), glottolog placed A as a node above B. In such cases, in new tip A was placed below the existing glottolog node A:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>supertree_c <span class="ot">&lt;-</span> supertree_b</span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>nodes_to_add_as_tips <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"alor1249"</span>, <span class="st">"gami1243"</span>, <span class="st">"guri1247"</span>, <span class="st">"mand1415"</span>, </span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"sins1241"</span>, <span class="st">"wang1291"</span>, <span class="st">"warl1254"</span>, <span class="st">"yand1253"</span>)</span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop through these nodes, and use add_tip() to add the new tip:</span></span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (node_i <span class="cf">in</span> nodes_to_add_as_tips) {</span>
<span id="cb102-6"><a href="#cb102-6" aria-hidden="true" tabindex="-1"></a>  supertree_c <span class="ot">&lt;-</span> <span class="fu">add_tip</span>(supertree_c, <span class="at">label =</span> node_i, <span class="at">parent_label =</span> node_i)</span>
<span id="cb102-7"><a href="#cb102-7" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>From this supertree, the 496 languages in Yin’s dataset were kept. The internal node <code>mada1298</code> was collapsed, as were all non-branching internal nodes:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>supertree_d <span class="ot">&lt;-</span> <span class="fu">keep_as_tip</span>(supertree_c, <span class="at">label =</span> yin_2020_data<span class="sc">$</span>tip)</span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>supertree_e <span class="ot">&lt;-</span> <span class="fu">collapse_node</span>(supertree_d, <span class="at">label =</span> <span class="st">"mada1298"</span>)</span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a>supertree_f <span class="ot">&lt;-</span> <span class="fu">collapse_node</span>(supertree_e, <span class="at">label =</span> <span class="fu">nonbranching_nodes</span>(supertree_e))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Finally, branch lengths were assigned. Branches were first assigned exponential lengths. Then, in order to diminish the importance of the macro groups, the branches above them were shortened to a length of 1/40. The effect of this decision is that the implied distance between families in different macro groups is only marginally greater than between families within a single macro group.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a>supertree_g <span class="ot">&lt;-</span> <span class="fu">rescale_branches_exp</span>(supertree_f) </span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a>yin_2020_tree <span class="ot">&lt;-</span> <span class="fu">rescale_deepest_branches</span>(supertree_g, <span class="dv">1</span><span class="sc">/</span><span class="dv">40</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The resulting tree appears as in Figure @ref(fig:yin-tree), which is plotted with the following code:</p>
<div class="cell" data-layout-align="center" data-fig.dim="[10,10]">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>full_names <span class="ot">&lt;-</span> yin_2020_data<span class="sc">$</span>name[<span class="fu">match</span>(yin_2020_tree<span class="sc">$</span>tip.label, yin_2020_data<span class="sc">$</span>tip)]</span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>name_tree <span class="ot">&lt;-</span> yin_2020_tree</span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a>name_tree<span class="sc">$</span>tip.label <span class="ot">&lt;-</span> full_names</span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">ladderize</span>(name_tree, <span class="at">right =</span> <span class="cn">FALSE</span>), <span class="at">type =</span> <span class="st">"fan"</span>, </span>
<span id="cb105-5"><a href="#cb105-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">cex =</span> <span class="fl">0.3</span>, <span class="at">label.offset =</span> <span class="fl">0.002</span>, <span class="at">edge.width =</span> <span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="phylo_files/figure-html/yin-tree-1.png" class="img-fluid figure-img" width="960"></p>
<p></p><figcaption class="figure-caption">Supertree of 496 languages used in Yin (2020).</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section>
<section id="preparing-the-dataframe-of-typological-data" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="preparing-the-dataframe-of-typological-data"><span class="header-section-number">4.2</span> Preparing the dataframe of typological data</h2>
<p>In order to calculate phylogenetic weights and genealogically-sensitive proportions, in addition to the tree (or a set of trees) we require a dataframe with (a) one column <code>tip</code>, whose contents match the tip labels in the trees, and (b) other columns containing numerical data to be averaged. The dataframe <code>yin_2020_data</code> has a column <code>tip</code> and two columns of numerical data <code>has_onset_violation</code> and <code>has_coda_violation</code>, and thus it meets the requirements we need. It also contains a column, <code>names</code>, of non-numeric data. Columns of non-numeric data (other than <code>tip</code>) are ignored by <code>phylo_average()</code>, so we do not need to remove them.</p>
</section>
<section id="calculating-genealogically-sensitive-proportions" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="calculating-genealogically-sensitive-proportions"><span class="header-section-number">4.3</span> Calculating genealogically-sensitive proportions</h2>
<p>The results are calculated using <code>phylo_average()</code>, setting its <code>phy</code> argument to the tree we have constructed, <code>yin_2020_tree</code>, and its <code>data</code> argument to the dataframe we have prepared, <code>yin_2020_data</code>. A warning is issued alerting us that the dataframe contains a non-numeric column that gets ignored:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a>yin_2020_results <span class="ot">&lt;-</span> <span class="fu">phylo_average</span>(<span class="at">phy =</span> yin_2020_tree, <span class="at">data =</span> yin_2020_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in phylo_average(phy = yin_2020_tree, data = yin_2020_data): `data`
contains non-numeric columns other than `tip`, which have been ignored: name.</code></pre>
</div>
</div>
<p>Results are in the format described in Section @ref(averages). In this case, we are using only one tree, so the results are brief. The genealogically-sensitive proportions according to the ACL and BM methods are the following.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>yin_2020_results<span class="sc">$</span>ACL_averages</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   tree has_onset_violation has_coda_violation
1 tree1           0.3711102           0.409806</code></pre>
</div>
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a>yin_2020_results<span class="sc">$</span>BM_averages</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   tree has_onset_violation has_coda_violation
1 tree1           0.4014756          0.3847729</code></pre>
</div>
</div>
<p>The first ten rows of phylogenetic weights according to the ACL and BM methods are:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(yin_2020_results<span class="sc">$</span>ACL_weights, <span class="at">n =</span> <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>               name      tip        tree1
1            Abkhaz abkh1244 0.0069858330
2              Abui abui1241 0.0012637162
3           Achagua acha1250 0.0002456679
4             Adang adan1251 0.0002197767
5     Adnyamathanha adny1235 0.0000637717
6            Adyghe adyg1241 0.0069858330
7      Hokkaidoainu ainu1240 0.0174645825
8             Alawa alaw1244 0.0019652742
9  Standardalbanian alba1267 0.0023699724
10            Aleut aleu1260 0.0085266857</code></pre>
</div>
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(yin_2020_results<span class="sc">$</span>BM_weights, <span class="at">n =</span> <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>               name      tip        tree1
1            Abkhaz abkh1244 0.0049475265
2              Abui abui1241 0.0021424363
3           Achagua acha1250 0.0009109899
4             Adang adan1251 0.0009391784
5     Adnyamathanha adny1235 0.0008929209
6            Adyghe adyg1241 0.0049475265
7      Hokkaidoainu ainu1240 0.0064304759
8             Alawa alaw1244 0.0027423594
9  Standardalbanian alba1267 0.0040995307
10            Aleut aleu1260 0.0055527679</code></pre>
</div>
</div>
<p>As a point of comparison, the raw proportions, which are equal to the means of the columns <code>has_onset_violation</code> and <code>has_coda_violation</code>, are these:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(yin_2020_data<span class="sc">$</span>has_onset_violation)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.3649194</code></pre>
</div>
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(yin_2020_data<span class="sc">$</span>has_coda_violation)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.3145161</code></pre>
</div>
</div>
</section>
</section>
<section id="using-these-methods-in-typological-research" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Using these methods in typological research</h1>
<p>As we seek to analyse the empirical diversity of attested languages, there are fundamental reasons why genealogy must be part of picture <span class="citation" data-cites="macklin-cordes_challenges_nodate">[see <a href="#ref-macklin-cordes_challenges_nodate" role="doc-biblioref">2</a>]</span>. And since the genealogies of human languages are still incompletely known, it is imperative to make our phylogenetic hypotheses and assumptions as explicit and as testable as possible. In this document, we hope have shown that doing so is entirely feasible.</p>
<p>Through the use of <code>glottoTrees</code> and <code>phyloWeights</code>, we hope that in the future, linguistic trees and the code used to produce them can be published together with typological studies. This will enable subsequent researchers to replicate the study’s findings, and just as importantly, to modify its assumptions by modifying the trees, and thereby to test further hypotheses inspired by the initial research.</p>
<p>If you find these practical tools useful in your own research, please cite the packages as <span class="citation" data-cites="glottoTrees">[<a href="#ref-glottoTrees" role="doc-biblioref">7</a>]</span> and <span class="citation" data-cites="phyloWeights">[<a href="#ref-phyloWeights" role="doc-biblioref">8</a>]</span>. If you wish to cite the notion of genealogically-sensitive averages and proportions, please cite either <span class="citation" data-cites="macklin-cordes_challenges_nodate">[<a href="#ref-macklin-cordes_challenges_nodate" role="doc-biblioref">2</a>]</span> and/or the more specific references therein.</p>
<p>If you think you’ve encountered a bug or anomalous behaviour in <code>glottoTrees</code> and <code>phyloWeights</code>, please be in contact, either through the package github pages or by email: e.round@uq.edu.au. It’s important for the good of the science that linguists can use these methods without undue impediments.</p>
</section>
<section id="citation-session-info" class="level1 unnumbered">
<h1 class="unnumbered">Citation &amp; Session Info</h1>
<p>Round, Erich. 2022. <em>Practical phylogenetic comparative methods for linguistic typology</em>. Surrey Morphology Group, University of Surrey &amp; Ancient Language Lab, University of Queensland. url: https://slcladal.github.io/phylo_for_typology.html (Version 2022.08.31).</p>
<pre><code>@manual{Round2022net,
  author = {Round, Erich},
  title = {Practical phylogenetic comparative methods for linguistic typology},
  note = {https://slcladal.github.io/phylo_for_typology.html},
  year = {2022},
  organization = {{Surrey Morphology Group, University of Surrey} and {Ancient Language Lab, School of Languages and Cultures, University of Queensland}},
  address = {{Guildford, UK} and {St Lucia, QLD}},
  edition = {2022.08.31}
}</code></pre>
<div class="cell">
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sessionInfo</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R version 4.2.1 (2022-06-23)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 22.04.1 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.10.0
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.10.0

locale:
 [1] LC_CTYPE=en_AU.UTF-8       LC_NUMERIC=C              
 [3] LC_TIME=en_AU.UTF-8        LC_COLLATE=en_AU.UTF-8    
 [5] LC_MONETARY=en_AU.UTF-8    LC_MESSAGES=en_AU.UTF-8   
 [7] LC_PAPER=en_AU.UTF-8       LC_NAME=C                 
 [9] LC_ADDRESS=C               LC_TELEPHONE=C            
[11] LC_MEASUREMENT=en_AU.UTF-8 LC_IDENTIFICATION=C       

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
 [1] ape_5.6-2             glottoTrees_0.1.0008  phyloWeights_0.3.0005
 [4] flextable_0.7.3       forcats_0.5.1         stringr_1.4.0        
 [7] dplyr_1.0.9           purrr_0.3.4           readr_2.1.2          
[10] tidyr_1.2.0           tibble_3.1.7          ggplot2_3.3.6        
[13] tidyverse_1.3.2      

loaded via a namespace (and not attached):
 [1] nlme_3.1-158            fs_1.5.2                lubridate_1.8.0        
 [4] httr_1.4.3              numDeriv_2016.8-1.1     tools_4.2.1            
 [7] backports_1.4.1         utf8_1.2.2              R6_2.5.1               
[10] DBI_1.1.3               colorspace_2.0-3        withr_2.5.0            
[13] tidyselect_1.1.2        mnormt_2.1.0            phangorn_2.9.0         
[16] compiler_4.2.1          cli_3.3.0               rvest_1.0.2            
[19] expm_0.999-6            xml2_1.3.3              officer_0.4.3          
[22] scales_1.2.0            quadprog_1.5-8          systemfonts_1.0.4      
[25] digest_0.6.29           rmarkdown_2.14          base64enc_0.1-3        
[28] pkgconfig_2.0.3         htmltools_0.5.2         plotrix_3.8-2          
[31] dbplyr_2.2.1            fastmap_1.1.0           maps_3.4.0             
[34] htmlwidgets_1.5.4       rlang_1.0.4             readxl_1.4.0           
[37] rstudioapi_0.13         generics_0.1.3          combinat_0.0-8         
[40] jsonlite_1.8.0          zip_2.2.0               googlesheets4_1.0.0    
[43] magrittr_2.0.3          Matrix_1.4-1            Rcpp_1.0.8.3           
[46] munsell_0.5.0           fansi_1.0.3             gdtools_0.2.4          
[49] lifecycle_1.0.1         scatterplot3d_0.3-41    stringi_1.7.8          
[52] yaml_2.3.5              clusterGeneration_1.3.7 MASS_7.3-58.1          
[55] grid_4.2.1              parallel_4.2.1          crayon_1.5.1           
[58] lattice_0.20-45         haven_2.5.0             hms_1.1.1              
[61] klippy_0.0.0.9500       knitr_1.39              pillar_1.7.0           
[64] igraph_1.3.2            uuid_1.1-0              codetools_0.2-18       
[67] fastmatch_1.1-3         reprex_2.0.1            glue_1.6.2             
[70] evaluate_0.15           data.table_1.14.2       modelr_0.1.8           
[73] vctrs_0.4.1             tzdb_0.3.0              cellranger_1.1.0       
[76] gtable_0.3.0            assertthat_0.2.1        xfun_0.31              
[79] broom_1.0.0             phytools_1.0-3          coda_0.19-4            
[82] googledrive_2.0.0       gargle_1.2.0            ellipsis_0.3.2         </code></pre>
</div>
</div>
<hr>
<p><a href="#introduction">Back to top</a></p>
<p><a href="https://slcladal.github.io/index.html">Back to HOME</a></p>
<hr>
</section>
<section id="references" class="level1 unnumbered">




</section>


<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body" role="doc-bibliography">
<div id="ref-macklin-cordes_phylogenetic_2021" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">1. </div><div class="csl-right-inline">Macklin-Cordes, J., Round, E.R.: Phylogenetic comparative methods: <span>What</span> all the fuss is about, and how to use them in everyday research, (2021).</div>
</div>
<div id="ref-macklin-cordes_challenges_nodate" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">2. </div><div class="csl-right-inline">Macklin-Cordes, J., Round, E.R.: Challenges of sampling and how phylogenetic comparative methods help: <span>With</span> a case study of the <span>Pama</span>-<span>Nyungan</span> laminal contrast, (2021).</div>
</div>
<div id="ref-altschul_weights_1989" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">3. </div><div class="csl-right-inline">Altschul, S.F., Carroll, R.J., Lipman, D.J.: Weights for data related by a tree. Journal of Molecular Biology. 207, 647–653 (1989).</div>
</div>
<div id="ref-stone_constructing_2007" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">4. </div><div class="csl-right-inline">Stone, E.A., Sidow, A.: Constructing a meaningful evolutionary average at the phylogenetic center of mass. BMC bioinformatics. 8, 222 (2007).</div>
</div>
<div id="ref-glottolog" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">5. </div><div class="csl-right-inline">Hammarström, H., Forkel, R., Haspelmath, M., Bank, S.: <a href="https://doi.org/10.5281/zenodo.4761960">Glottolog 4.4</a>. Max Planck Institute for Evolutionary Anthropology, Leipzig (2021).</div>
</div>
<div id="ref-yin_violations_2020" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">6. </div><div class="csl-right-inline">Yin, R.: Violations of the sonority sequencing principle: <span>How</span>, and how often?, <a href="https://als.asn.au/Conference/Program">https://als.asn.au/Conference/Program</a>, (2020).</div>
</div>
<div id="ref-glottoTrees" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">7. </div><div class="csl-right-inline">Round, E.R.: <a href="https://github.com/erichround/glottoTrees"><span class="nocase">glottoTrees</span>: Phylogenetic trees in linguistics.</a> (2021).</div>
</div>
<div id="ref-phyloWeights" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">8. </div><div class="csl-right-inline">Round, E.R.: <a href="https://github.com/erichround/phyloWeights"><span class="nocase">phyloWeights</span>: Calculation of genealogically-sensitive proportions and averages</a>. (2021).</div>
</div>
<div id="ref-Newick" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">9. </div><div class="csl-right-inline">Felsenstein, J.: <a href="http://evolution.genetics.washington.edu/phylip/newicktree.html">The <span>Newick</span> tree format</a>.</div>
</div>
<div id="ref-green_proto_2003" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">10. </div><div class="csl-right-inline">Green, R.: Proto <span>Maningrida</span> with proto <span>Arnhem</span>: Evidence from verbal inflectional suffixes. In: Evans, N. (ed.) The non-<span>Pama</span>-<span>Nyungan</span> languages of northern <span>Australia</span> : Comparative studies of the continent’s most linguistically complex region. pp. 369–421. Pacific Linguistics (2003).</div>
</div>
<div id="ref-venditti2010phylogenies" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">11. </div><div class="csl-right-inline">Venditti, C., Meade, A., Pagel, M.: Phylogenies reveal new interpretation of speciation and the red queen. Nature. 463, 349–352 (2010).</div>
</div>
<div id="ref-anderson2018clics2" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">12. </div><div class="csl-right-inline">Anderson, C., Forkel, R., Greenhill, S.J., List, J.-M., Rzymski, C., Tresoldi, T.: <span>CLICS2</span>: An improved database of cross-linguistic colexifications assembling lexical data with the help of cross-linguistic data formats. Linguistic Typology. 22, 277–306 (2018).</div>
</div>
<div id="ref-round_ausphon-lexicon_2017" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">13. </div><div class="csl-right-inline">Round, E.R.: The <span>AusPhon</span>-<span>Lexicon</span> project: 2 million normalized segments across 300 <span>Australian</span> languages, (2017).</div>
</div>
</div></section><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>See online documentation of the <code>ape</code> package for reading trees from various common file formats.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>Although this file is named <code>tree_glottolog_newick.txt</code>, it is not in true Newick format due to its use of square brackets in node and tip labels <span class="citation" data-cites="Newick">[<a href="#ref-Newick" role="doc-biblioref">9</a>]</span>. In <code>glottoTrees</code>, the square brackets in glottolog’s file are converted to angled brackets (i.e., greater-than and less-than symbols), to bring them into conformity with the Newick standard.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>There are two exceptional glottocodes with numbers in the initial four characters: b10b1234 and 3adt1234.<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p>The differences are systematic and are made in order to conform with the permissible Newick format of tree labels: spaces and apostrophes are removed, parentheses are replaced by braces, and commas are replaced by forward slashes.<a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn5"><p><code>glottoTrees</code> currently contains information from glottolog versions 4.0, 4.1, 4.2, 4.3 and 4.4 (which is current at time of writing). Our intention is to update <code>glottoTrees</code> as glottolog updates in the future.<a href="#fnref5" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn6"><p>Converting nodes into tips may cause them to move to the left or right in the tree plot. The movement is meaningless, since a subgroup (A, B) is exactly the same as subgroup (B, A). Since the movement is meaningless, it’s also harmless.<a href="#fnref6" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn7"><p><code>apply_duplicate_suffixes()</code> will also add suffixes to any nodes with duplicate labels.<a href="#fnref7" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn8"><p>‘Most likely’ doesn’t mean that we expect to see trees with exactly these branch lengths. Compare this to flipping a coin two million times: although it is unlikely that the outcome will be exactly one million heads and one million tails, it remains true that one million heads and one million tails is the most likely outcome, in the strict sense that it is more likely than any other outcome. The branch lengths discussed here are ‘most likely’ is a similar sense.<a href="#fnref8" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn9"><p>https://github.com/rambaut/figtree/releases<a href="#fnref9" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>