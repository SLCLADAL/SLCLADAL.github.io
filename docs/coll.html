<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Martin Schweinberger" />

<meta name="date" content="2024-03-07" />

<title>Analyzing Co-Occurrences, N-grams, and Collocations in R</title>

<script src="site_libs/header-attrs-2.25/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<script src="site_libs/clipboard-1.7.1/clipboard.min.js"></script>
<link href="site_libs/primer-tooltips-1.4.0/build.css" rel="stylesheet" />
<link href="site_libs/klippy-0.0.0.9500/css/klippy.min.css" rel="stylesheet" />
<script src="site_libs/klippy-0.0.0.9500/js/klippy.min.js"></script>
<link href="site_libs/tabwid-1.1.3/tabwid.css" rel="stylesheet" />
<script src="site_libs/tabwid-1.1.3/tabwid.js"></script>
<link rel="stylesheet" href="styles.css" />

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-VSGK4KYDQZ"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-VSGK4KYDQZ');
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>





<style type="text/css">
/* for pandoc --citeproc since 2.11 */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">



<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  
  <!-- Added by SKC - LADAL image and thicker top with   -->
  <div class="container-fluid navbar-top" >
    <a href="index.html"> <!-- Make entire top row and text clickable home link  -->
        <div class="row">
            <div class="navbar-brand col-md-12">
              <img src="/content/ladal_icon_cas_tran_white_trimed.png" class="navbar-icon" alt="LADAL"/>
              <span class="navbar-title-note navbar-collapse collapse" >Language Technology and Data Analysis Laboratory</span>
            </div>
        </div>
    </a>
  </div>
  
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <!-- SKC removed  navbar brand -->
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">HOME</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    ABOUT LADAL
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="people.html">People | Collabs</a>
    </li>
    <li>
      <a href="news.html">News</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    EVENTS
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="workshops.html">Workshops</a>
    </li>
    <li>
      <a href="compthinking.html">Computational Thinking in HASS</a>
    </li>
    <li>
      <a href="webinars2022.html">LADAL Webinar Series 2022</a>
    </li>
    <li>
      <a href="opening.html">LADAL Webinar Series 2021</a>
    </li>
    <li>
      <a href="atapevents.html">ATAP Events</a>
    </li>
  </ul>
</li>
<li>
  <a href="tutorials.html">TUTORIALS</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    RESOURCES
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="links.html">Links</a>
    </li>
    <li>
      <a href="base.html">Tutorial stylesheet</a>
    </li>
  </ul>
</li>
<li>
  <a href="contact.html">CONTACT</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Analyzing Co-Occurrences, N-grams, and
Collocations in R</h1>
<h4 class="author">Martin Schweinberger</h4>
<h4 class="date">2024-03-07</h4>

</div>


<p><img src="https://slcladal.github.io/images/uq1.jpg" width="100%" /></p>
<div id="introduction" class="section level1 unnumbered">
<h1 class="unnumbered">Introduction</h1>
<p>This tutorial introduces collocation and co-occurrence analysis with
R and shows how to extract and visualize semantic links between
words.</p>
<p><img src="https://slcladal.github.io/images/gy_chili.jpg" width="15%" style="float:right; padding:10px" /></p>
<p>This tutorial is aimed at beginners and intermediate users of R with
the aim of showcasing how to extract and analyze collocations and
N-grams from textual data using R. The aim is not to provide a
fully-fledged analysis but rather to show and exemplify selected useful
methods associated with collocation analysis.</p>
<div class="warning"
style="padding:0.1em; background-color:#f2f2f2; color:#51247a">
<span>
<p style="margin-top:1em; text-align:center">
To be able to follow this tutorial, we suggest you check out and
familiarize yourself with the content of the following <strong>R
Basics</strong> tutorials:<br>
</p>
<p style="margin-top:1em; text-align:left">
<ul>
<li>
<a href="https://ladal.edu.au/intror.html">Getting started with R</a>
</li>
<li>
<a href="https://ladal.edu.au/load.html">Loading, saving, and generating
data in R</a>
</li>
<li>
<a href="https://ladal.edu.au/string.html">String Processing in R</a>
</li>
<li>
<a href="https://ladal.edu.au/regex.html">Regular Expressions in R</a>
</li>
</ul>
</p>
<p style="margin-top:1em; text-align:center">
Click <a
href="https://ladal.edu.au/content/coll.Rmd"><strong>here</strong></a><a
href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a> to
download the <strong>entire R Notebook</strong> for this
tutorial.<br><br> <a
href="https://binderhub.atap-binder.cloud.edu.au/v2/gh/SLCLADAL/interactive-notebooks-environment/main?urlpath=git-pull%3Frepo%3Dhttps%253A%252F%252Fgithub.com%252FSLCLADAL%252Finteractive-notebooks%26urlpath%3Dlab%252Ftree%252Finteractive-notebooks%252Fnotebooks%252Fcoll_cb.ipynb%26branch%3Dmain"><img
src="https://mybinder.org/badge_logo.svg" alt="Binder" /></a><br> Click
<a
href="https://binderhub.atap-binder.cloud.edu.au/v2/gh/SLCLADAL/interactive-notebooks-environment/main?urlpath=git-pull%3Frepo%3Dhttps%253A%252F%252Fgithub.com%252FSLCLADAL%252Finteractive-notebooks%26urlpath%3Dlab%252Ftree%252Finteractive-notebooks%252Fnotebooks%252Fcoll_cb.ipynb%26branch%3Dmain"><strong>here</strong></a>
to open an interactive Jupyter notebook that allows you to execute,
change, and edit the code as well as to upload your own data. <br>
</p>
<p style="margin-left:1em;">
</p>
<p></span></p>
</div>
<p><br></p>
<p>Parts of this tutorial build on and use materials from <a
href="https://tm4ss.github.io/docs/Tutorial_5_Co-occurrence.html">this
tutorial</a> on co-occurrence analysis with R by Andreas Niekler and
Gregor Wiedemann <span class="citation">(see <a
href="#ref-WN17">Wiedemann and Niekler 2017</a>)</span>.</p>
<p><br></p>
<div class="warning"
style="padding:0.1em; background-color:#51247a; color:#f2f2f2">
<span>
<p style="margin-top:1em; text-align:center">
<b> How can you determine if words occur more frequently together than
would be expected by chance?</b><br>
</p>
<p style="margin-left:1em;">
</p>
<p></span></p>
</div>
<p><br></p>
<p>This tutorial aims to show how you can answer this question.</p>
<p>So, how would you find words that are associated with a specific term
and how can you visualize such word nets? This tutorial focuses on
co-occurrence and collocations of words. Collocations are words that
occur very frequently together. For example, <em>Merry Christmas</em> is
a collocation because <em>merry</em> and <em>Christmas</em> occur more
frequently together than would be expected by chance. This means that if
you were to shuffle all words in a corpus and would then test the
frequency of how often <em>merry</em> and <em>Christmas</em>
co-occurred, they would occur significantly less often in the shuffled
or randomized corpus than in a corpus that contain non-shuffled natural
speech.</p>
<p><strong>Preparation and session set up</strong></p>
<p>This tutorial is based on R. If you have not installed R or are new
to it, you will find an introduction to and more information how to use
R <a href="https://slcladal.github.io/intror.html">here</a>. For this
tutorials, we need to install certain <em>packages</em> from an R
<em>library</em> so that the scripts shown below are executed without
errors. Before turning to the code below, please install the packages by
running the code below this paragraph. If you have already installed the
packages mentioned below, then you can skip ahead and ignore this
section. To install the necessary packages, simply run the following
code - it may take some time (between 1 and 5 minutes to install all of
the libraries so you do not need to worry if it takes some time).</p>
<pre class="r"><code># set options
options(stringsAsFactors = F)
options(scipen = 999)
options(max.print=1000)
# install packages
install.packages(&quot;FactoMineR&quot;)
install.packages(&quot;factoextra&quot;)
install.packages(&quot;flextable&quot;)
install.packages(&quot;GGally&quot;)
install.packages(&quot;ggdendro&quot;)
install.packages(&quot;igraph&quot;)
install.packages(&quot;network&quot;)
install.packages(&quot;Matrix&quot;)
install.packages(&quot;quanteda&quot;)
install.packages(&quot;quanteda.textstats&quot;)
install.packages(&quot;quanteda.textplots&quot;)
install.packages(&quot;dplyr&quot;)
install.packages(&quot;stringr&quot;)
install.packages(&quot;tm&quot;)
install.packages(&quot;sna&quot;)
install.packages(&quot;tidytext&quot;)
# install klippy for copy-to-clipboard button in code chunks
install.packages(&quot;remotes&quot;)
remotes::install_github(&quot;rlesur/klippy&quot;)</code></pre>
<p>Next, we load the packages.</p>
<pre class="r"><code># load packages
library(FactoMineR)
library(factoextra)
library(flextable)
library(GGally)
library(ggdendro)
library(igraph)
library(network)
library(Matrix)
library(quanteda)
library(quanteda.textstats)
library(quanteda.textplots)
library(dplyr)
library(stringr)
library(tm)
library(sna)
# activate klippy for copy-to-clipboard button
klippy::klippy()</code></pre>
<script>
  addClassKlippyTo("pre.r, pre.markdown");
  addKlippy('left', 'top', 'auto', '1', 'Copy code', 'Copied!');
</script>
<p>We will use the Charles Darwin’s <em>On the Origin of Species by
Means of Natural Selection</em> as a data source and begin by generating
a bi-gram list. As a first step, we load the data and split it into
individual words.</p>
<pre class="r"><code># read in text
text &lt;- base::readRDS(url(&quot;https://slcladal.github.io/data/cdo.rda&quot;, &quot;rb&quot;)) %&gt;%
  paste0(collapse = &quot; &quot;) %&gt;%
  stringr::str_squish() %&gt;%
  stringr::str_remove_all(&quot;- &quot;)</code></pre>
<div class="tabwid"><style>.cl-8342394c{table-layout:auto;width:50%;}.cl-83383d66{font-family:'Arial';font-size:12pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-83383d84{font-family:'Arial';font-size:12pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-833c1ab2{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-833c3fce{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-833c3fd8{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing='true' class='cl-8342394c'><caption style="display:table-caption;margin:0pt;text-align:center;border-bottom: 0.00pt solid transparent;border-top: 0.00pt solid transparent;border-left: 0.00pt solid transparent;border-right: 0.00pt solid transparent;padding-top:3pt;padding-bottom:3pt;padding-left:3pt;padding-right:3pt;line-height: 1;background-color:transparent;"><span>First 200 characters of Darwin's Origin of Species.</span></caption><thead><tr style="overflow-wrap:break-word;"><th class="cl-833c3fce"><p class="cl-833c1ab2"><span class="cl-83383d66">.</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-833c3fd8"><p class="cl-833c1ab2"><span class="cl-83383d84">THE ORIGIN OF SPECIES BY CHARLES DARWIN AN HISTORICAL SKETCH OF THE PROGRESS OF OPINION ON THE ORIGIN OF SPECIES INTRODUCTION When on board H.M.S. 'Beagle,' as naturalist, I was much struck with certa</span></p></td></tr></tbody></table></div>
<p>Once you have installed R, RStudio, and once you have initiated the
session by executing the code shown above, you are good to go.</p>
</div>
<div id="n-grams" class="section level1 unnumbered">
<h1 class="unnumbered">N-grams</h1>
<p>N-grams are contiguous sequences of N items (words, characters, or
symbols) in a given text. The term <em>N</em> in N-grams refers to the
number of items in the sequence. For example, a bigram (2-gram) consists
of two consecutive items, a trigram (3-gram) consists of three, and so
on. N-grams are widely used in natural language processing and text
analysis to capture patterns and dependencies within a linguistic
context. N-grams help analyze the frequency of word sequences in a
corpus. This information can reveal common phrases, expressions, or
patterns that occur frequently and that often represent multiword
expressions such as <em>New York</em>, <em>Prime Minister</em>, or
<em>New South Wales</em>. N-grams are fundamental in language modeling,
where they are used to estimate the likelihood of a word given its
context. This is especially important in predictive text applications
and machine translation.</p>
<p>We could create bi-grams (N-grams consisting of two elements) by
manually pasting every word together with the word that immediately
follows but using the <code>quanteda</code> package <span
class="citation">(see <a href="#ref-quanteda">Benoit et al.
2018</a>)</span> offers excellent and very fast functions for extracting
bigrams.</p>
<p>Below, we use the <code>textstat_collocations</code> function for
extracting N-grams. This function uses the following main arguments</p>
<ul>
<li><code>x</code>: a character, corpus, or tokens object.<br />
</li>
<li><code>method</code>: association measure for detecting collocations.
Currently this is limited to “lambda”.<br />
</li>
<li><code>size</code>: integer; the length of the ngram. The default is
2 - if you want to extract tri-grams set <code>size = 3</code> and if
you want to extract four-grams set <code>size = 4</code> and so
on.<br />
</li>
<li><code>min_count</code>: numeric; minimum frequency of collocations
that will be scored.<br />
</li>
<li><code>smoothing</code>: numeric; a smoothing parameter added to the
observed counts (default is 0.5).<br />
</li>
<li><code>tolower</code>: logical; if TRUE, tokens are transformed to
lower-case.</li>
</ul>
<pre class="r"><code># concatenate the elements in the &#39;text&#39; object
text %&gt;% 
  paste0(collapse = &quot; &quot;) %&gt;%
  # convert to lower case
  tolower() %&gt;%
  # convert the concatenated text into tokens
  quanteda::tokens() %&gt;%
  # identify and extract bigrams that occur at leats 10 times
  quanteda.textstats::textstat_collocations(size = 2, min_count = 10) %&gt;%
  # convert into a data frame and save results in an object called &#39;ngrams&#39;
  as.data.frame() %&gt;%
  # order by lambda
  dplyr::arrange(-lambda) -&gt; ngrams</code></pre>
<div class="tabwid"><style>.cl-86a39220{table-layout:auto;width:50%;}.cl-8698186e{font-family:'Arial';font-size:12pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-8698188c{font-family:'Arial';font-size:12pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-869ce650{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-869ce664{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-869d031a{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-869d0324{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-869d0325{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-869d032e{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-869d032f{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-869d0338{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-869d0339{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-869d0342{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-869d0343{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-869d034c{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-869d034d{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-869d0356{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing='true' class='cl-86a39220'><caption style="display:table-caption;margin:0pt;text-align:center;border-bottom: 0.00pt solid transparent;border-top: 0.00pt solid transparent;border-left: 0.00pt solid transparent;border-right: 0.00pt solid transparent;padding-top:3pt;padding-bottom:3pt;padding-left:3pt;padding-right:3pt;line-height: 1;background-color:transparent;"><span></span></caption><thead><tr style="overflow-wrap:break-word;"><th class="cl-869d031a"><p class="cl-869ce650"><span class="cl-8698186e">collocation</span></p></th><th class="cl-869d0324"><p class="cl-869ce664"><span class="cl-8698186e">count</span></p></th><th class="cl-869d0324"><p class="cl-869ce664"><span class="cl-8698186e">count_nested</span></p></th><th class="cl-869d0324"><p class="cl-869ce664"><span class="cl-8698186e">length</span></p></th><th class="cl-869d0324"><p class="cl-869ce664"><span class="cl-8698186e">lambda</span></p></th><th class="cl-869d0325"><p class="cl-869ce664"><span class="cl-8698186e">z</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-869d032e"><p class="cl-869ce650"><span class="cl-8698188c">la plata</span></p></td><td class="cl-869d032f"><p class="cl-869ce664"><span class="cl-8698188c">10</span></p></td><td class="cl-869d032f"><p class="cl-869ce664"><span class="cl-8698188c">0</span></p></td><td class="cl-869d032f"><p class="cl-869ce664"><span class="cl-8698188c">2</span></p></td><td class="cl-869d032f"><p class="cl-869ce664"><span class="cl-8698188c">14.172864</span></p></td><td class="cl-869d0338"><p class="cl-869ce664"><span class="cl-8698188c">8.972245</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-869d0339"><p class="cl-869ce650"><span class="cl-8698188c">asa gray</span></p></td><td class="cl-869d0342"><p class="cl-869ce664"><span class="cl-8698188c">10</span></p></td><td class="cl-869d0342"><p class="cl-869ce664"><span class="cl-8698188c">0</span></p></td><td class="cl-869d0342"><p class="cl-869ce664"><span class="cl-8698188c">2</span></p></td><td class="cl-869d0342"><p class="cl-869ce664"><span class="cl-8698188c">13.585078</span></p></td><td class="cl-869d0343"><p class="cl-869ce664"><span class="cl-8698188c">11.366068</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-869d032e"><p class="cl-869ce650"><span class="cl-8698188c">de candolle</span></p></td><td class="cl-869d032f"><p class="cl-869ce664"><span class="cl-8698188c">20</span></p></td><td class="cl-869d032f"><p class="cl-869ce664"><span class="cl-8698188c">0</span></p></td><td class="cl-869d032f"><p class="cl-869ce664"><span class="cl-8698188c">2</span></p></td><td class="cl-869d032f"><p class="cl-869ce664"><span class="cl-8698188c">13.232358</span></p></td><td class="cl-869d0338"><p class="cl-869ce664"><span class="cl-8698188c">9.069247</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-869d0339"><p class="cl-869ce650"><span class="cl-8698188c">malay archipelago</span></p></td><td class="cl-869d0342"><p class="cl-869ce664"><span class="cl-8698188c">11</span></p></td><td class="cl-869d0342"><p class="cl-869ce664"><span class="cl-8698188c">0</span></p></td><td class="cl-869d0342"><p class="cl-869ce664"><span class="cl-8698188c">2</span></p></td><td class="cl-869d0342"><p class="cl-869ce664"><span class="cl-8698188c">11.795572</span></p></td><td class="cl-869d0343"><p class="cl-869ce664"><span class="cl-8698188c">8.099588</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-869d032e"><p class="cl-869ce650"><span class="cl-8698188c">fritz miiller</span></p></td><td class="cl-869d032f"><p class="cl-869ce664"><span class="cl-8698188c">12</span></p></td><td class="cl-869d032f"><p class="cl-869ce664"><span class="cl-8698188c">0</span></p></td><td class="cl-869d032f"><p class="cl-869ce664"><span class="cl-8698188c">2</span></p></td><td class="cl-869d032f"><p class="cl-869ce664"><span class="cl-8698188c">11.782221</span></p></td><td class="cl-869d0338"><p class="cl-869ce664"><span class="cl-8698188c">14.799029</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-869d0339"><p class="cl-869ce650"><span class="cl-8698188c">close interbreeding</span></p></td><td class="cl-869d0342"><p class="cl-869ce664"><span class="cl-8698188c">11</span></p></td><td class="cl-869d0342"><p class="cl-869ce664"><span class="cl-8698188c">0</span></p></td><td class="cl-869d0342"><p class="cl-869ce664"><span class="cl-8698188c">2</span></p></td><td class="cl-869d0342"><p class="cl-869ce664"><span class="cl-8698188c">11.060737</span></p></td><td class="cl-869d0343"><p class="cl-869ce664"><span class="cl-8698188c">7.626784</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-869d032e"><p class="cl-869ce650"><span class="cl-8698188c">informs me</span></p></td><td class="cl-869d032f"><p class="cl-869ce664"><span class="cl-8698188c">14</span></p></td><td class="cl-869d032f"><p class="cl-869ce664"><span class="cl-8698188c">0</span></p></td><td class="cl-869d032f"><p class="cl-869ce664"><span class="cl-8698188c">2</span></p></td><td class="cl-869d032f"><p class="cl-869ce664"><span class="cl-8698188c">10.547477</span></p></td><td class="cl-869d0338"><p class="cl-869ce664"><span class="cl-8698188c">7.319180</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-869d0339"><p class="cl-869ce650"><span class="cl-8698188c">new zealand</span></p></td><td class="cl-869d0342"><p class="cl-869ce664"><span class="cl-8698188c">27</span></p></td><td class="cl-869d0342"><p class="cl-869ce664"><span class="cl-8698188c">0</span></p></td><td class="cl-869d0342"><p class="cl-869ce664"><span class="cl-8698188c">2</span></p></td><td class="cl-869d0342"><p class="cl-869ce664"><span class="cl-8698188c">10.530954</span></p></td><td class="cl-869d0343"><p class="cl-869ce664"><span class="cl-8698188c">7.372461</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-869d032e"><p class="cl-869ce650"><span class="cl-8698188c">reproductive systems</span></p></td><td class="cl-869d032f"><p class="cl-869ce664"><span class="cl-8698188c">12</span></p></td><td class="cl-869d032f"><p class="cl-869ce664"><span class="cl-8698188c">0</span></p></td><td class="cl-869d032f"><p class="cl-869ce664"><span class="cl-8698188c">2</span></p></td><td class="cl-869d032f"><p class="cl-869ce664"><span class="cl-8698188c">10.078755</span></p></td><td class="cl-869d0338"><p class="cl-869ce664"><span class="cl-8698188c">15.838490</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-869d0339"><p class="cl-869ce650"><span class="cl-8698188c">laws governing</span></p></td><td class="cl-869d0342"><p class="cl-869ce664"><span class="cl-8698188c">14</span></p></td><td class="cl-869d0342"><p class="cl-869ce664"><span class="cl-8698188c">0</span></p></td><td class="cl-869d0342"><p class="cl-869ce664"><span class="cl-8698188c">2</span></p></td><td class="cl-869d0342"><p class="cl-869ce664"><span class="cl-8698188c">10.076533</span></p></td><td class="cl-869d0343"><p class="cl-869ce664"><span class="cl-8698188c">14.350195</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-869d032e"><p class="cl-869ce650"><span class="cl-8698188c">i am</span></p></td><td class="cl-869d032f"><p class="cl-869ce664"><span class="cl-8698188c">60</span></p></td><td class="cl-869d032f"><p class="cl-869ce664"><span class="cl-8698188c">0</span></p></td><td class="cl-869d032f"><p class="cl-869ce664"><span class="cl-8698188c">2</span></p></td><td class="cl-869d032f"><p class="cl-869ce664"><span class="cl-8698188c">10.063640</span></p></td><td class="cl-869d0338"><p class="cl-869ce664"><span class="cl-8698188c">7.084820</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-869d0339"><p class="cl-869ce650"><span class="cl-8698188c">systematic affinity</span></p></td><td class="cl-869d0342"><p class="cl-869ce664"><span class="cl-8698188c">12</span></p></td><td class="cl-869d0342"><p class="cl-869ce664"><span class="cl-8698188c">0</span></p></td><td class="cl-869d0342"><p class="cl-869ce664"><span class="cl-8698188c">2</span></p></td><td class="cl-869d0342"><p class="cl-869ce664"><span class="cl-8698188c">9.845041</span></p></td><td class="cl-869d0343"><p class="cl-869ce664"><span class="cl-8698188c">17.665000</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-869d032e"><p class="cl-869ce650"><span class="cl-8698188c">consecutive formations</span></p></td><td class="cl-869d032f"><p class="cl-869ce664"><span class="cl-8698188c">13</span></p></td><td class="cl-869d032f"><p class="cl-869ce664"><span class="cl-8698188c">0</span></p></td><td class="cl-869d032f"><p class="cl-869ce664"><span class="cl-8698188c">2</span></p></td><td class="cl-869d032f"><p class="cl-869ce664"><span class="cl-8698188c">9.293769</span></p></td><td class="cl-869d0338"><p class="cl-869ce664"><span class="cl-8698188c">13.332513</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-869d0339"><p class="cl-869ce650"><span class="cl-8698188c">reciprocal crosses</span></p></td><td class="cl-869d0342"><p class="cl-869ce664"><span class="cl-8698188c">15</span></p></td><td class="cl-869d0342"><p class="cl-869ce664"><span class="cl-8698188c">0</span></p></td><td class="cl-869d0342"><p class="cl-869ce664"><span class="cl-8698188c">2</span></p></td><td class="cl-869d0342"><p class="cl-869ce664"><span class="cl-8698188c">9.284930</span></p></td><td class="cl-869d0343"><p class="cl-869ce664"><span class="cl-8698188c">17.908294</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-869d034c"><p class="cl-869ce650"><span class="cl-8698188c">united states</span></p></td><td class="cl-869d034d"><p class="cl-869ce664"><span class="cl-8698188c">29</span></p></td><td class="cl-869d034d"><p class="cl-869ce664"><span class="cl-8698188c">0</span></p></td><td class="cl-869d034d"><p class="cl-869ce664"><span class="cl-8698188c">2</span></p></td><td class="cl-869d034d"><p class="cl-869ce664"><span class="cl-8698188c">9.058312</span></p></td><td class="cl-869d0356"><p class="cl-869ce664"><span class="cl-8698188c">26.395234</span></p></td></tr></tbody></table></div>
<p>Identifying n-grams that co-occur frequently is very important and
can help identify multiword expressions that one may want to fuse for
subsequent steps during an analysis (e.g., combining <em>wheel
chair</em> to <em>wheelchair</em> or <em>wheel-chair</em>).</p>
<p>However, when extracting n-grams, we are strictly speaking only
extracting sequences but not collocates as collocates do not necessarily
have to occur in direct adjacency. The following section shows how to
expand the extraction of n-grams to the extraction of collocates.</p>
</div>
<div id="collocations" class="section level1 unnumbered">
<h1 class="unnumbered">Collocations</h1>
<p>Collocations are combinations of words that frequently co-occur in a
language, appearing together more often than would be expected by
chance. Collocations can involve two or more words and may be based on
grammatical or semantic associations. These word pairings or groupings
exhibit a certain degree of naturalness and tend to form recurring
patterns. They play a crucial role in language acquisition, learning,
fluency, and usage and they contribute to the natural and idiomatic
expression of ideas. A typical example of a collocation is <em>Merry
Christmas</em> because the words <em>merry</em> and <em>Christmas</em>
occur together more frequently together than would be expected, if words
were just randomly stringed together. Other examples of collocations
include <em>strong coffee</em>, <em>make a decision</em>, or <em>take a
risk</em>. Recognizing and understanding collocations is essential for
language learners, as it enhances their ability to produce authentic and
contextually appropriate language.</p>
<p>Identifying words pairs (w1 and w2) that collocate
(i.e. collocations) and determining their association strength (a
measure of how strongly attracted words are to each other) is based on
the co-occurrence frequencies of word pairs in a contingency table (see
below, <em>O</em> is short for <em>observed frequency</em>).</p>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="center">w<sub>2</sub> present</th>
<th align="right">w<sub>2</sub> absent</th>
<th></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><strong>w<sub>1</sub> present</strong></td>
<td align="center">O<sub>11</sub></td>
<td align="right">O<sub>12</sub></td>
<td>= R<sub>1</sub></td>
</tr>
<tr class="even">
<td align="left"><strong>w<sub>1</sub> absent</strong></td>
<td align="center">O<sub>21</sub></td>
<td align="right">O<sub>22</sub></td>
<td>= R<sub>2</sub></td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="center">= C<sub>1</sub></td>
<td align="right">= C<sub>2</sub></td>
<td>= N</td>
</tr>
</tbody>
</table>
<p>From this contingency table, we can calculate the frequencies that
would be expected if the words did not show any attraction or repulsion
(see below, <em>E</em> is short for <em>expected frequency</em>).</p>
<table>
<colgroup>
<col width="32%" />
<col width="29%" />
<col width="29%" />
<col width="8%" />
</colgroup>
<thead>
<tr class="header">
<th align="left"></th>
<th align="center">w<sub>2</sub> present</th>
<th align="center">w<sub>2</sub> absent</th>
<th></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><strong>w<sub>1</sub> present</strong></td>
<td align="center">E<sub>11</sub> = (R<sub>1</sub> * C<sub>1</sub>) /
(N)</td>
<td align="center">E<sub>12</sub> = (R<sub>1</sub> * C<sub>2</sub>) /
(N)</td>
<td>= R<sub>1</sub></td>
</tr>
<tr class="even">
<td align="left"><strong>w<sub>1</sub> absent</strong></td>
<td align="center">E<sub>21</sub> = (R<sub>2</sub> * C<sub>1</sub>) /
(N)</td>
<td align="center">E<sub>22</sub> = (R<sub>2</sub> * C<sub>2</sub>) /
(N)</td>
<td>= R<sub>2</sub></td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="center">= C<sub>1</sub></td>
<td align="center">= C<sub>2</sub></td>
<td>= N</td>
</tr>
</tbody>
</table>
<div id="association-measures" class="section level3 unnumbered">
<h3 class="unnumbered">Association measures</h3>
<p><strong>Association measures</strong> use the frequency information
in the above contingency tables to evaluate the strength of attraction
or repulsion between words. As such, association measures are
statistical metrics used to quantify the strength and significance of
the relationship between words within a collocation. These measures help
assess how likely it is for two words to appear together more frequently
than expected by chance. Several association measures are commonly used
in collocation analysis, including:</p>
<ul>
<li><strong>Pointwise Mutual Information (PMI)</strong>: PMI measures
the likelihood of two words occurring together compared to their
individual likelihoods of occurring separately. A higher PMI score
suggests a stronger association.</li>
</ul>
<p><span class="math display">\[ \text{PMI}(w_1, w_2) = \log_2 \left(
\frac{P(w_1 \cap w_2)}{P(w_1) \cdot P(w_2)} \right) \]</span></p>
<ul>
<li><strong>Log-Likelihood Ratio (LLR)</strong>: LLR compares the
likelihood of the observed word combination occurring with the expected
likelihood based on the individual frequencies of the words. Higher LLR
values indicate a more significant association.</li>
</ul>
<p><span class="math display">\[ \text{LLR}(w_1, w_2) = 2 \sum_{i=1}^4
\frac{(O_i - E_i)^2}{E_i} \]</span></p>
<p>where <span class="math inline">\(O_i\)</span> is the observed
frequency and <span class="math inline">\(E_i\)</span> is the expected
frequency for each combination.</p>
<ul>
<li><strong>Dice Coefficient</strong>: This measure considers the
co-occurrence of words and calculates the ratio of the overlap between
the two words to the sum of their individual frequencies. The Dice
coefficient ranges from 0 to 1, with higher values indicating stronger
association.</li>
</ul>
<p><span class="math display">\[ \text{Dice}(w_1, w_2) = \frac{2 \times
\text{freq}(w_1 \cap w_2)}{\text{freq}(w_1) + \text{freq}(w_2)}
\]</span></p>
<ul>
<li><strong>Chi-Square</strong>: Chi-square measures the difference
between the observed and expected frequencies of word co-occurrence. A
higher chi-square value signifies a more significant association.</li>
</ul>
<p><span class="math display">\[ \chi^2(w_1, w_2) = \sum \frac{(O_i -
E_i)^2}{E_i} \]</span></p>
<p>where <span class="math inline">\(O_i\)</span> is the observed
frequency and <span class="math inline">\(E_i\)</span> is the expected
frequency for each combination.</p>
<ul>
<li><strong>t-Score</strong>: The t-score is based on the difference
between the observed and expected frequencies, normalized by the
standard deviation. Higher T-scores indicate a stronger
association.</li>
</ul>
<p><span class="math display">\[ \text{t-Score}(w_1, w_2) =
\frac{\text{freq}(w_1 \cap w_2) - \text{expected\_freq}(w_1 \cap
w_2)}{\sqrt{\text{freq}(w_1 \cap w_2)}} \]</span></p>
<ul>
<li><strong>Mutual Information (MI)</strong>: MI measures the reduction
in uncertainty about one word’s occurrence based on the knowledge of
another word’s occurrence. Higher MI values indicate a stronger
association.</li>
</ul>
<p><span class="math display">\[ \text{MI}(w_1, w_2) = \log_2 \left(
\frac{P(w_1 \cap w_2)}{P(w_1) \cdot P(w_2)} \right) \]</span></p>
<p>where <span class="math inline">\(P(w_1 \cap w_2)\)</span> is the
joint probability, and <span class="math inline">\(P(w_1)\)</span> and
<span class="math inline">\(P(w_2)\)</span> are the individual
probabilities.</p>
<ul>
<li><strong>Minimum Sensitivity (MS)</strong>: The minimum sensitivity
is 1 when W1 and W2 always occur together and never apart. It is 0 when
W1 and W2 never occur together. A higher minimum sensitivity indicates a
stronger dependence between the two words in a bigram <span
class="citation">(<a href="#ref-pedersen1998dependent">Pedersen
1998</a>)</span>.</li>
</ul>
<p><span class="math display">\[ \text{MS} = min\left( P(w_1 | w_2)
,  P(w_2 | w_1) \right) \]</span></p>
<ul>
<li><strong>delta P (ΔP)</strong>: ΔP is an association measure based on
conditional probabilities that is implied in MS <span
class="citation">(<a href="#ref-gries201350">Gries 2013,
141</a>)</span>. ΔP has two advantages: it takes into account that the
association between word_1 and word_2 is not symmetric (word_1 may be
more strongly attracted with word_2 than vice verse) and it is not
affected by frequency as other association measures (which is a serious
issue as association measures should reflect association strength and
not frequency) <span class="citation">(see <a
href="#ref-gries2022some">Gries 2022</a>)</span>.</li>
</ul>
<p><span class="math display">\[ \Delta P_1 =  P(w_1 | w_2) = \left(
\frac{O11}{R1} \right)- \left(\frac{O21} {R2} \right) \]</span></p>
<p><span class="math display">\[ \Delta P_2 =  P(w_2 | w_1)  = \left(
\frac{O11}{C1} \right) -\left( \frac{O21}{C2} \right) \]</span></p>
<p>These association measures help researchers and language analysts
identify meaningful and statistically significant collocations,
assisting in the extraction of relevant information from corpora and
improving the accuracy of collocation analysis in linguistic
studies.</p>
</div>
<div id="identifying-collocations" class="section level2 unnumbered">
<h2 class="unnumbered">Identifying Collocations</h2>
<p>As collocates do not have to be immediately adjacent but can be
separated by several slots, their retrieval is substantially more
difficult compared with n-grams. Nonetheless, there are various ways of
finding collocations depending on the data provided, the context, and
the association measure (which represents information of how strong the
association between the words is). Below, you will see how to detect
collocations in two different data structures:</p>
<ul>
<li><p>a list of sentences</p></li>
<li><p>concordances</p></li>
</ul>
<p>In the following, we will extract collocations from the sentences in
Charles Darwin’s <em>On the Origin of Species by Means of Natural
Selection</em></p>
<div id="identifying-collocations-in-sentences"
class="section level3 unnumbered">
<h3 class="unnumbered">Identifying collocations in sentences</h3>
<p><strong>Data preparation</strong></p>
<p>In a first step, we split our example text into sentences and clean
the data (removing punctuation, converting to lower case, etc.).</p>
<pre class="r"><code>text %&gt;% 
  # concatenate the elements in the &#39;text&#39; object
  paste0(collapse = &quot; &quot;) %&gt;%
  # separate possessives and contractions
  stringr::str_replace_all(fixed(&quot;&#39;&quot;), fixed(&quot; &#39;&quot;)) %&gt;%
  stringr::str_replace_all(fixed(&quot;’&quot;), fixed(&quot; &#39;&quot;)) %&gt;%
  # split text into sentences
  tokenizers::tokenize_sentences() %&gt;%
  # unlist sentences
  unlist() %&gt;%
  # remove non-word characters
  stringr::str_replace_all(&quot;\\W&quot;, &quot; &quot;) %&gt;%
  stringr::str_replace_all(&quot;[^[:alnum:] ]&quot;, &quot; &quot;) %&gt;%
  # remove superfluous white spaces
  stringr::str_squish() %&gt;%
  # convert to lower case and save in &#39;sentences&#39; object
  tolower() -&gt; sentences
# inspect first 10 sentences
head(sentences, 10)</code></pre>
<pre><code>##  [1] &quot;the origin of species by charles darwin an historical sketch of the progress of opinion on the origin of species introduction when on board h m s&quot;                                                                                                                     
##  [2] &quot;beagle as naturalist i was much struck with certain facts in the distribution of the organic beings inhabiting south america and in the geological relations of the present to the past inhabitants of that continent&quot;                                                 
##  [3] &quot;these facts as will be seen in the latter chapters of this volume seemed to throw some light on the origin of species that mystery of mysteries as it has been called by one of our greatest philosophers&quot;                                                             
##  [4] &quot;on my return home it occurred to me in 1837 that something might perhaps be made out on this question by patiently accumulating and reflecting on all sorts of facts which could possibly have any bearing on it&quot;                                                      
##  [5] &quot;after five years work i allowed myself to speculate on the subject and drew up some short notes these i enlarged in 1844 into a sketch of the conclusions which then seemed to me probable from that period to the present day i have steadily pursued the same object&quot;
##  [6] &quot;i hope that i may be excused for entering on these personal details as i give them to show that i have not been hasty in coming to a decision&quot;                                                                                                                         
##  [7] &quot;my work is now 1859 nearly finished but as it will take me many more years to complete it and as my health is far from strong i have been urged to publish this abstract&quot;                                                                                              
##  [8] &quot;i have more especially been induced to do this as mr&quot;                                                                                                                                                                                                                  
##  [9] &quot;wallace who is now studying the natural history of the malay archipelago has arrived at almost exactly the same general conclusions that i have on the origin of species&quot;                                                                                              
## [10] &quot;in 1858 he sent me a memoir on this subject with a request that i would forward it to sir charles lyell who sent it to the linnean society and it is published in the third volume of the journal of that society&quot;</code></pre>
<p>Next, we tabulate the data and reformat it so that we have the
relevant information to calculate the association statistics (word 1 and
word 2 as well as O11, O12, O21, and O22).</p>
<pre class="r"><code># tokenize the &#39;sentences&#39; data using quanteda package
sentences %&gt;%
  quanteda::tokens() %&gt;%

  # create a document-feature matrix (dfm) using quanteda
  quanteda::dfm() %&gt;%

  # create a feature co-occurrence matrix (fcm) without considering trigrams
  quanteda::fcm(tri = FALSE) %&gt;%

  # tidy the data using tidytext package
  tidytext::tidy() %&gt;%

  # rearrange columns for better readability
  dplyr::relocate(term, document, count) %&gt;%

  # rename columns for better interpretation
  dplyr::rename(w1 = 1,
                w2 = 2,
                O11 = 3) -&gt; coll_basic</code></pre>
<div class="tabwid"><style>.cl-8771201e{table-layout:auto;width:50%;}.cl-8764227e{font-family:'Arial';font-size:12pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-87642292{font-family:'Arial';font-size:12pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-87687180{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-8768719e{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-87688e68{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-87688e72{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-87688e7c{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-87688e7d{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-87688e86{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-87688e87{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-87688e90{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-87688e9a{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-87688ea4{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-87688eae{background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-87688eaf{background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-87688eb8{background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing='true' class='cl-8771201e'><caption style="display:table-caption;margin:0pt;text-align:center;border-bottom: 0.00pt solid transparent;border-top: 0.00pt solid transparent;border-left: 0.00pt solid transparent;border-right: 0.00pt solid transparent;padding-top:3pt;padding-bottom:3pt;padding-left:3pt;padding-right:3pt;line-height: 1;background-color:transparent;"><span>First 10 rows of basic collocation table</span></caption><thead><tr style="overflow-wrap:break-word;"><th class="cl-87688e68"><p class="cl-87687180"><span class="cl-8764227e">w1</span></p></th><th class="cl-87688e72"><p class="cl-87687180"><span class="cl-8764227e">w2</span></p></th><th class="cl-87688e7c"><p class="cl-8768719e"><span class="cl-8764227e">O11</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-87688e7d"><p class="cl-87687180"><span class="cl-87642292">the</span></p></td><td class="cl-87688e86"><p class="cl-87687180"><span class="cl-87642292">the</span></p></td><td class="cl-87688e87"><p class="cl-8768719e"><span class="cl-87642292">24,287</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-87688e90"><p class="cl-87687180"><span class="cl-87642292">the</span></p></td><td class="cl-87688e9a"><p class="cl-87687180"><span class="cl-87642292">origin</span></p></td><td class="cl-87688ea4"><p class="cl-8768719e"><span class="cl-87642292">170</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-87688e7d"><p class="cl-87687180"><span class="cl-87642292">the</span></p></td><td class="cl-87688e86"><p class="cl-87687180"><span class="cl-87642292">of</span></p></td><td class="cl-87688e87"><p class="cl-8768719e"><span class="cl-87642292">37,291</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-87688e90"><p class="cl-87687180"><span class="cl-87642292">the</span></p></td><td class="cl-87688e9a"><p class="cl-87687180"><span class="cl-87642292">species</span></p></td><td class="cl-87688ea4"><p class="cl-8768719e"><span class="cl-87642292">6,222</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-87688e7d"><p class="cl-87687180"><span class="cl-87642292">the</span></p></td><td class="cl-87688e86"><p class="cl-87687180"><span class="cl-87642292">by</span></p></td><td class="cl-87688e87"><p class="cl-8768719e"><span class="cl-87642292">5,415</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-87688e90"><p class="cl-87687180"><span class="cl-87642292">the</span></p></td><td class="cl-87688e9a"><p class="cl-87687180"><span class="cl-87642292">charles</span></p></td><td class="cl-87688ea4"><p class="cl-8768719e"><span class="cl-87642292">28</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-87688e7d"><p class="cl-87687180"><span class="cl-87642292">the</span></p></td><td class="cl-87688e86"><p class="cl-87687180"><span class="cl-87642292">darwin</span></p></td><td class="cl-87688e87"><p class="cl-8768719e"><span class="cl-87642292">11</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-87688e90"><p class="cl-87687180"><span class="cl-87642292">the</span></p></td><td class="cl-87688e9a"><p class="cl-87687180"><span class="cl-87642292">an</span></p></td><td class="cl-87688ea4"><p class="cl-8768719e"><span class="cl-87642292">2,049</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-87688e7d"><p class="cl-87687180"><span class="cl-87642292">the</span></p></td><td class="cl-87688e86"><p class="cl-87687180"><span class="cl-87642292">historical</span></p></td><td class="cl-87688e87"><p class="cl-8768719e"><span class="cl-87642292">7</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-87688eae"><p class="cl-87687180"><span class="cl-87642292">the</span></p></td><td class="cl-87688eaf"><p class="cl-87687180"><span class="cl-87642292">sketch</span></p></td><td class="cl-87688eb8"><p class="cl-8768719e"><span class="cl-87642292">8</span></p></td></tr></tbody></table></div>
<p>We now enhance our table by calculating all observed frequencies
(O11, O12, O21, O22) as well as row totals (R1, R2), column totals (C1,
C2), and the overall total (N).</p>
<pre class="r"><code>  # calculate the total number of observations (N)
coll_basic %&gt;%  dplyr::mutate(N = sum(O11)) %&gt;%

  # calculate R1, O12, and R2
  dplyr::group_by(w1) %&gt;%
  dplyr::mutate(R1 = sum(O11),
                O12 = R1 - O11,
                R2 = N - R1) %&gt;%
  dplyr::ungroup(w1) %&gt;%

  # calculate C1, O21, C2, and O22
  dplyr::group_by(w2) %&gt;%
  dplyr::mutate(C1 = sum(O11),
                O21 = C1 - O11,
                C2 = N - C1,
                O22 = R2 - O21) -&gt; colldf</code></pre>
<div class="tabwid"><style>.cl-886d3f7a{table-layout:auto;width:50%;}.cl-886371fc{font-family:'Arial';font-size:12pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-88637206{font-family:'Arial';font-size:12pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-886684c8{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-886684d2{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-88669ef4{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-88669ef5{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-88669efe{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-88669f08{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-88669f09{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-88669f0a{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-88669f12{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-88669f13{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-88669f14{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-88669f1c{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-88669f1d{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-88669f26{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-88669f27{background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-88669f30{background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-88669f31{background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-88669f3a{background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing='true' class='cl-886d3f7a'><caption style="display:table-caption;margin:0pt;text-align:center;border-bottom: 0.00pt solid transparent;border-top: 0.00pt solid transparent;border-left: 0.00pt solid transparent;border-right: 0.00pt solid transparent;padding-top:3pt;padding-bottom:3pt;padding-left:3pt;padding-right:3pt;line-height: 1;background-color:transparent;"><span>First 10 rows of collocation table</span></caption><thead><tr style="overflow-wrap:break-word;"><th class="cl-88669ef4"><p class="cl-886684c8"><span class="cl-886371fc">w1</span></p></th><th class="cl-88669ef5"><p class="cl-886684c8"><span class="cl-886371fc">w2</span></p></th><th class="cl-88669efe"><p class="cl-886684d2"><span class="cl-886371fc">O11</span></p></th><th class="cl-88669efe"><p class="cl-886684d2"><span class="cl-886371fc">N</span></p></th><th class="cl-88669efe"><p class="cl-886684d2"><span class="cl-886371fc">R1</span></p></th><th class="cl-88669efe"><p class="cl-886684d2"><span class="cl-886371fc">O12</span></p></th><th class="cl-88669efe"><p class="cl-886684d2"><span class="cl-886371fc">R2</span></p></th><th class="cl-88669efe"><p class="cl-886684d2"><span class="cl-886371fc">C1</span></p></th><th class="cl-88669efe"><p class="cl-886684d2"><span class="cl-886371fc">O21</span></p></th><th class="cl-88669efe"><p class="cl-886684d2"><span class="cl-886371fc">C2</span></p></th><th class="cl-88669f08"><p class="cl-886684d2"><span class="cl-886371fc">O22</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-88669f09"><p class="cl-886684c8"><span class="cl-88637206">the</span></p></td><td class="cl-88669f0a"><p class="cl-886684c8"><span class="cl-88637206">the</span></p></td><td class="cl-88669f12"><p class="cl-886684d2"><span class="cl-88637206">24,287</span></p></td><td class="cl-88669f12"><p class="cl-886684d2"><span class="cl-88637206">9,405,996</span></p></td><td class="cl-88669f12"><p class="cl-886684d2"><span class="cl-88637206">643,895</span></p></td><td class="cl-88669f12"><p class="cl-886684d2"><span class="cl-88637206">619,608</span></p></td><td class="cl-88669f12"><p class="cl-886684d2"><span class="cl-88637206">8,762,101</span></p></td><td class="cl-88669f12"><p class="cl-886684d2"><span class="cl-88637206">643,895</span></p></td><td class="cl-88669f12"><p class="cl-886684d2"><span class="cl-88637206">619,608</span></p></td><td class="cl-88669f12"><p class="cl-886684d2"><span class="cl-88637206">8,762,101</span></p></td><td class="cl-88669f13"><p class="cl-886684d2"><span class="cl-88637206">8,142,493</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-88669f14"><p class="cl-886684c8"><span class="cl-88637206">the</span></p></td><td class="cl-88669f1c"><p class="cl-886684c8"><span class="cl-88637206">origin</span></p></td><td class="cl-88669f1d"><p class="cl-886684d2"><span class="cl-88637206">170</span></p></td><td class="cl-88669f1d"><p class="cl-886684d2"><span class="cl-88637206">9,405,996</span></p></td><td class="cl-88669f1d"><p class="cl-886684d2"><span class="cl-88637206">643,895</span></p></td><td class="cl-88669f1d"><p class="cl-886684d2"><span class="cl-88637206">643,725</span></p></td><td class="cl-88669f1d"><p class="cl-886684d2"><span class="cl-88637206">8,762,101</span></p></td><td class="cl-88669f1d"><p class="cl-886684d2"><span class="cl-88637206">2,884</span></p></td><td class="cl-88669f1d"><p class="cl-886684d2"><span class="cl-88637206">2,714</span></p></td><td class="cl-88669f1d"><p class="cl-886684d2"><span class="cl-88637206">9,403,112</span></p></td><td class="cl-88669f26"><p class="cl-886684d2"><span class="cl-88637206">8,759,387</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-88669f09"><p class="cl-886684c8"><span class="cl-88637206">the</span></p></td><td class="cl-88669f0a"><p class="cl-886684c8"><span class="cl-88637206">of</span></p></td><td class="cl-88669f12"><p class="cl-886684d2"><span class="cl-88637206">37,291</span></p></td><td class="cl-88669f12"><p class="cl-886684d2"><span class="cl-88637206">9,405,996</span></p></td><td class="cl-88669f12"><p class="cl-886684d2"><span class="cl-88637206">643,895</span></p></td><td class="cl-88669f12"><p class="cl-886684d2"><span class="cl-88637206">606,604</span></p></td><td class="cl-88669f12"><p class="cl-886684d2"><span class="cl-88637206">8,762,101</span></p></td><td class="cl-88669f12"><p class="cl-886684d2"><span class="cl-88637206">450,460</span></p></td><td class="cl-88669f12"><p class="cl-886684d2"><span class="cl-88637206">413,169</span></p></td><td class="cl-88669f12"><p class="cl-886684d2"><span class="cl-88637206">8,955,536</span></p></td><td class="cl-88669f13"><p class="cl-886684d2"><span class="cl-88637206">8,348,932</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-88669f14"><p class="cl-886684c8"><span class="cl-88637206">the</span></p></td><td class="cl-88669f1c"><p class="cl-886684c8"><span class="cl-88637206">species</span></p></td><td class="cl-88669f1d"><p class="cl-886684d2"><span class="cl-88637206">6,222</span></p></td><td class="cl-88669f1d"><p class="cl-886684d2"><span class="cl-88637206">9,405,996</span></p></td><td class="cl-88669f1d"><p class="cl-886684d2"><span class="cl-88637206">643,895</span></p></td><td class="cl-88669f1d"><p class="cl-886684d2"><span class="cl-88637206">637,673</span></p></td><td class="cl-88669f1d"><p class="cl-886684d2"><span class="cl-88637206">8,762,101</span></p></td><td class="cl-88669f1d"><p class="cl-886684d2"><span class="cl-88637206">89,994</span></p></td><td class="cl-88669f1d"><p class="cl-886684d2"><span class="cl-88637206">83,772</span></p></td><td class="cl-88669f1d"><p class="cl-886684d2"><span class="cl-88637206">9,316,002</span></p></td><td class="cl-88669f26"><p class="cl-886684d2"><span class="cl-88637206">8,678,329</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-88669f09"><p class="cl-886684c8"><span class="cl-88637206">the</span></p></td><td class="cl-88669f0a"><p class="cl-886684c8"><span class="cl-88637206">by</span></p></td><td class="cl-88669f12"><p class="cl-886684d2"><span class="cl-88637206">5,415</span></p></td><td class="cl-88669f12"><p class="cl-886684d2"><span class="cl-88637206">9,405,996</span></p></td><td class="cl-88669f12"><p class="cl-886684d2"><span class="cl-88637206">643,895</span></p></td><td class="cl-88669f12"><p class="cl-886684d2"><span class="cl-88637206">638,480</span></p></td><td class="cl-88669f12"><p class="cl-886684d2"><span class="cl-88637206">8,762,101</span></p></td><td class="cl-88669f12"><p class="cl-886684d2"><span class="cl-88637206">80,785</span></p></td><td class="cl-88669f12"><p class="cl-886684d2"><span class="cl-88637206">75,370</span></p></td><td class="cl-88669f12"><p class="cl-886684d2"><span class="cl-88637206">9,325,211</span></p></td><td class="cl-88669f13"><p class="cl-886684d2"><span class="cl-88637206">8,686,731</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-88669f14"><p class="cl-886684c8"><span class="cl-88637206">the</span></p></td><td class="cl-88669f1c"><p class="cl-886684c8"><span class="cl-88637206">charles</span></p></td><td class="cl-88669f1d"><p class="cl-886684d2"><span class="cl-88637206">28</span></p></td><td class="cl-88669f1d"><p class="cl-886684d2"><span class="cl-88637206">9,405,996</span></p></td><td class="cl-88669f1d"><p class="cl-886684d2"><span class="cl-88637206">643,895</span></p></td><td class="cl-88669f1d"><p class="cl-886684d2"><span class="cl-88637206">643,867</span></p></td><td class="cl-88669f1d"><p class="cl-886684d2"><span class="cl-88637206">8,762,101</span></p></td><td class="cl-88669f1d"><p class="cl-886684d2"><span class="cl-88637206">451</span></p></td><td class="cl-88669f1d"><p class="cl-886684d2"><span class="cl-88637206">423</span></p></td><td class="cl-88669f1d"><p class="cl-886684d2"><span class="cl-88637206">9,405,545</span></p></td><td class="cl-88669f26"><p class="cl-886684d2"><span class="cl-88637206">8,761,678</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-88669f09"><p class="cl-886684c8"><span class="cl-88637206">the</span></p></td><td class="cl-88669f0a"><p class="cl-886684c8"><span class="cl-88637206">darwin</span></p></td><td class="cl-88669f12"><p class="cl-886684d2"><span class="cl-88637206">11</span></p></td><td class="cl-88669f12"><p class="cl-886684d2"><span class="cl-88637206">9,405,996</span></p></td><td class="cl-88669f12"><p class="cl-886684d2"><span class="cl-88637206">643,895</span></p></td><td class="cl-88669f12"><p class="cl-886684d2"><span class="cl-88637206">643,884</span></p></td><td class="cl-88669f12"><p class="cl-886684d2"><span class="cl-88637206">8,762,101</span></p></td><td class="cl-88669f12"><p class="cl-886684d2"><span class="cl-88637206">179</span></p></td><td class="cl-88669f12"><p class="cl-886684d2"><span class="cl-88637206">168</span></p></td><td class="cl-88669f12"><p class="cl-886684d2"><span class="cl-88637206">9,405,817</span></p></td><td class="cl-88669f13"><p class="cl-886684d2"><span class="cl-88637206">8,761,933</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-88669f14"><p class="cl-886684c8"><span class="cl-88637206">the</span></p></td><td class="cl-88669f1c"><p class="cl-886684c8"><span class="cl-88637206">an</span></p></td><td class="cl-88669f1d"><p class="cl-886684d2"><span class="cl-88637206">2,049</span></p></td><td class="cl-88669f1d"><p class="cl-886684d2"><span class="cl-88637206">9,405,996</span></p></td><td class="cl-88669f1d"><p class="cl-886684d2"><span class="cl-88637206">643,895</span></p></td><td class="cl-88669f1d"><p class="cl-886684d2"><span class="cl-88637206">641,846</span></p></td><td class="cl-88669f1d"><p class="cl-886684d2"><span class="cl-88637206">8,762,101</span></p></td><td class="cl-88669f1d"><p class="cl-886684d2"><span class="cl-88637206">33,809</span></p></td><td class="cl-88669f1d"><p class="cl-886684d2"><span class="cl-88637206">31,760</span></p></td><td class="cl-88669f1d"><p class="cl-886684d2"><span class="cl-88637206">9,372,187</span></p></td><td class="cl-88669f26"><p class="cl-886684d2"><span class="cl-88637206">8,730,341</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-88669f09"><p class="cl-886684c8"><span class="cl-88637206">the</span></p></td><td class="cl-88669f0a"><p class="cl-886684c8"><span class="cl-88637206">historical</span></p></td><td class="cl-88669f12"><p class="cl-886684d2"><span class="cl-88637206">7</span></p></td><td class="cl-88669f12"><p class="cl-886684d2"><span class="cl-88637206">9,405,996</span></p></td><td class="cl-88669f12"><p class="cl-886684d2"><span class="cl-88637206">643,895</span></p></td><td class="cl-88669f12"><p class="cl-886684d2"><span class="cl-88637206">643,888</span></p></td><td class="cl-88669f12"><p class="cl-886684d2"><span class="cl-88637206">8,762,101</span></p></td><td class="cl-88669f12"><p class="cl-886684d2"><span class="cl-88637206">185</span></p></td><td class="cl-88669f12"><p class="cl-886684d2"><span class="cl-88637206">178</span></p></td><td class="cl-88669f12"><p class="cl-886684d2"><span class="cl-88637206">9,405,811</span></p></td><td class="cl-88669f13"><p class="cl-886684d2"><span class="cl-88637206">8,761,923</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-88669f27"><p class="cl-886684c8"><span class="cl-88637206">the</span></p></td><td class="cl-88669f30"><p class="cl-886684c8"><span class="cl-88637206">sketch</span></p></td><td class="cl-88669f31"><p class="cl-886684d2"><span class="cl-88637206">8</span></p></td><td class="cl-88669f31"><p class="cl-886684d2"><span class="cl-88637206">9,405,996</span></p></td><td class="cl-88669f31"><p class="cl-886684d2"><span class="cl-88637206">643,895</span></p></td><td class="cl-88669f31"><p class="cl-886684d2"><span class="cl-88637206">643,887</span></p></td><td class="cl-88669f31"><p class="cl-886684d2"><span class="cl-88637206">8,762,101</span></p></td><td class="cl-88669f31"><p class="cl-886684d2"><span class="cl-88637206">152</span></p></td><td class="cl-88669f31"><p class="cl-886684d2"><span class="cl-88637206">144</span></p></td><td class="cl-88669f31"><p class="cl-886684d2"><span class="cl-88637206">9,405,844</span></p></td><td class="cl-88669f3a"><p class="cl-886684d2"><span class="cl-88637206">8,761,957</span></p></td></tr></tbody></table></div>
<p>To determine which terms collocate significantly and with what
association strength, we use the following information (that is provided
by the table above):</p>
<ul>
<li><p>O<sub>11</sub> = Number of times <em>word<sub>1</sub></em> occurs
<em>with</em> <em>word<sub>2</sub></em></p></li>
<li><p>O<sub>12</sub> = Number of times <em>word<sub>1</sub></em> occurs
<em>without</em> <em>word<sub>2</sub></em></p></li>
<li><p>O<sub>21</sub> = Number of times <code>CoocTerm</code> occurs
without <code>Term</code></p></li>
<li><p>O<sub>22</sub> = Number of terms that are not
<code>coocTerm</code> or <code>Term</code></p></li>
</ul>
<p>Example:</p>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="center">w<sub>2</sub> present</th>
<th align="right">w<sub>2</sub> absent</th>
<th></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><strong>w<sub>1</sub> present</strong></td>
<td align="center">O<sub>11</sub></td>
<td align="right">O<sub>12</sub></td>
<td>= R<sub>1</sub></td>
</tr>
<tr class="even">
<td align="left"><strong>w<sub>1</sub> absent</strong></td>
<td align="center">O<sub>21</sub></td>
<td align="right">O<sub>22</sub></td>
<td>= R<sub>2</sub></td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="center">= C<sub>1</sub></td>
<td align="right">= C<sub>2</sub></td>
<td>= N</td>
</tr>
</tbody>
</table>
<p>We could calculate all collocations in the corpus (based on
co-occurrence within the same sentence) or we can find collocations of a
specific term - here, we will find collocations fo the term
<em>selection</em>.</p>
<p>Now that we have all the relevant information, we will reduce the
data and add additional information to the data so that the computing of
the association measures runs smoothly.</p>
<pre class="r"><code># reduce and complement data
colldf %&gt;%
# determine Term
  dplyr::filter(w1 == &quot;selection&quot;,
                # set minimum number of occurrences of w2
                (O11+O21) &gt; 10,
                # set minimum number of co-occurrences of w1 and w2
                O11 &gt; 5)  %&gt;%
  dplyr::rowwise() %&gt;%
  dplyr::mutate(E11 = R1 * C1 / N, 
                E12 = R1 * C2 / N,
                E21 = R2 * C1 / N, 
                E22 = R2 * C2 / N)  -&gt; colldf_redux</code></pre>
<div class="tabwid"><style>.cl-88e4674e{table-layout:auto;width:50%;}.cl-88d72462{font-family:'Arial';font-size:12pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-88d72476{font-family:'Arial';font-size:12pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-88dc167a{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-88dc1684{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-88dc3704{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-88dc370e{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-88dc370f{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-88dc3718{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-88dc3719{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-88dc371a{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-88dc3722{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-88dc3723{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-88dc372c{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-88dc3736{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-88dc3737{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-88dc3738{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-88dc3740{background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-88dc374a{background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-88dc374b{background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-88dc3754{background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing='true' class='cl-88e4674e'><caption style="display:table-caption;margin:0pt;text-align:center;border-bottom: 0.00pt solid transparent;border-top: 0.00pt solid transparent;border-left: 0.00pt solid transparent;border-right: 0.00pt solid transparent;padding-top:3pt;padding-bottom:3pt;padding-left:3pt;padding-right:3pt;line-height: 1;background-color:transparent;"><span>First 10 rows of reduced collocation data frame</span></caption><thead><tr style="overflow-wrap:break-word;"><th class="cl-88dc3704"><p class="cl-88dc167a"><span class="cl-88d72462">w1</span></p></th><th class="cl-88dc370e"><p class="cl-88dc167a"><span class="cl-88d72462">w2</span></p></th><th class="cl-88dc370f"><p class="cl-88dc1684"><span class="cl-88d72462">O11</span></p></th><th class="cl-88dc370f"><p class="cl-88dc1684"><span class="cl-88d72462">N</span></p></th><th class="cl-88dc370f"><p class="cl-88dc1684"><span class="cl-88d72462">R1</span></p></th><th class="cl-88dc370f"><p class="cl-88dc1684"><span class="cl-88d72462">O12</span></p></th><th class="cl-88dc370f"><p class="cl-88dc1684"><span class="cl-88d72462">R2</span></p></th><th class="cl-88dc370f"><p class="cl-88dc1684"><span class="cl-88d72462">C1</span></p></th><th class="cl-88dc370f"><p class="cl-88dc1684"><span class="cl-88d72462">O21</span></p></th><th class="cl-88dc370f"><p class="cl-88dc1684"><span class="cl-88d72462">C2</span></p></th><th class="cl-88dc370f"><p class="cl-88dc1684"><span class="cl-88d72462">O22</span></p></th><th class="cl-88dc370f"><p class="cl-88dc1684"><span class="cl-88d72462">E11</span></p></th><th class="cl-88dc370f"><p class="cl-88dc1684"><span class="cl-88d72462">E12</span></p></th><th class="cl-88dc370f"><p class="cl-88dc1684"><span class="cl-88d72462">E21</span></p></th><th class="cl-88dc3718"><p class="cl-88dc1684"><span class="cl-88d72462">E22</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-88dc3719"><p class="cl-88dc167a"><span class="cl-88d72476">selection</span></p></td><td class="cl-88dc371a"><p class="cl-88dc167a"><span class="cl-88d72476">the</span></p></td><td class="cl-88dc3722"><p class="cl-88dc1684"><span class="cl-88d72476">1,783</span></p></td><td class="cl-88dc3722"><p class="cl-88dc1684"><span class="cl-88d72476">9,405,996</span></p></td><td class="cl-88dc3722"><p class="cl-88dc1684"><span class="cl-88d72476">26,793</span></p></td><td class="cl-88dc3722"><p class="cl-88dc1684"><span class="cl-88d72476">25,010</span></p></td><td class="cl-88dc3722"><p class="cl-88dc1684"><span class="cl-88d72476">9,379,203</span></p></td><td class="cl-88dc3722"><p class="cl-88dc1684"><span class="cl-88d72476">643,895</span></p></td><td class="cl-88dc3722"><p class="cl-88dc1684"><span class="cl-88d72476">642,112</span></p></td><td class="cl-88dc3722"><p class="cl-88dc1684"><span class="cl-88d72476">8,762,101</span></p></td><td class="cl-88dc3722"><p class="cl-88dc1684"><span class="cl-88d72476">8,737,091</span></p></td><td class="cl-88dc3722"><p class="cl-88dc1684"><span class="cl-88d72476">1,834.13630</span></p></td><td class="cl-88dc3722"><p class="cl-88dc1684"><span class="cl-88d72476">24,958.86</span></p></td><td class="cl-88dc3722"><p class="cl-88dc1684"><span class="cl-88d72476">642,060.864</span></p></td><td class="cl-88dc3723"><p class="cl-88dc1684"><span class="cl-88d72476">8,737,142</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-88dc372c"><p class="cl-88dc167a"><span class="cl-88d72476">selection</span></p></td><td class="cl-88dc3736"><p class="cl-88dc167a"><span class="cl-88d72476">origin</span></p></td><td class="cl-88dc3737"><p class="cl-88dc1684"><span class="cl-88d72476">19</span></p></td><td class="cl-88dc3737"><p class="cl-88dc1684"><span class="cl-88d72476">9,405,996</span></p></td><td class="cl-88dc3737"><p class="cl-88dc1684"><span class="cl-88d72476">26,793</span></p></td><td class="cl-88dc3737"><p class="cl-88dc1684"><span class="cl-88d72476">26,774</span></p></td><td class="cl-88dc3737"><p class="cl-88dc1684"><span class="cl-88d72476">9,379,203</span></p></td><td class="cl-88dc3737"><p class="cl-88dc1684"><span class="cl-88d72476">2,884</span></p></td><td class="cl-88dc3737"><p class="cl-88dc1684"><span class="cl-88d72476">2,865</span></p></td><td class="cl-88dc3737"><p class="cl-88dc1684"><span class="cl-88d72476">9,403,112</span></p></td><td class="cl-88dc3737"><p class="cl-88dc1684"><span class="cl-88d72476">9,376,338</span></p></td><td class="cl-88dc3737"><p class="cl-88dc1684"><span class="cl-88d72476">8.21508</span></p></td><td class="cl-88dc3737"><p class="cl-88dc1684"><span class="cl-88d72476">26,784.78</span></p></td><td class="cl-88dc3737"><p class="cl-88dc1684"><span class="cl-88d72476">2,875.785</span></p></td><td class="cl-88dc3738"><p class="cl-88dc1684"><span class="cl-88d72476">9,376,327</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-88dc3719"><p class="cl-88dc167a"><span class="cl-88d72476">selection</span></p></td><td class="cl-88dc371a"><p class="cl-88dc167a"><span class="cl-88d72476">of</span></p></td><td class="cl-88dc3722"><p class="cl-88dc1684"><span class="cl-88d72476">1,556</span></p></td><td class="cl-88dc3722"><p class="cl-88dc1684"><span class="cl-88d72476">9,405,996</span></p></td><td class="cl-88dc3722"><p class="cl-88dc1684"><span class="cl-88d72476">26,793</span></p></td><td class="cl-88dc3722"><p class="cl-88dc1684"><span class="cl-88d72476">25,237</span></p></td><td class="cl-88dc3722"><p class="cl-88dc1684"><span class="cl-88d72476">9,379,203</span></p></td><td class="cl-88dc3722"><p class="cl-88dc1684"><span class="cl-88d72476">450,460</span></p></td><td class="cl-88dc3722"><p class="cl-88dc1684"><span class="cl-88d72476">448,904</span></p></td><td class="cl-88dc3722"><p class="cl-88dc1684"><span class="cl-88d72476">8,955,536</span></p></td><td class="cl-88dc3722"><p class="cl-88dc1684"><span class="cl-88d72476">8,930,299</span></p></td><td class="cl-88dc3722"><p class="cl-88dc1684"><span class="cl-88d72476">1,283.13629</span></p></td><td class="cl-88dc3722"><p class="cl-88dc1684"><span class="cl-88d72476">25,509.86</span></p></td><td class="cl-88dc3722"><p class="cl-88dc1684"><span class="cl-88d72476">449,176.864</span></p></td><td class="cl-88dc3723"><p class="cl-88dc1684"><span class="cl-88d72476">8,930,026</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-88dc372c"><p class="cl-88dc167a"><span class="cl-88d72476">selection</span></p></td><td class="cl-88dc3736"><p class="cl-88dc167a"><span class="cl-88d72476">species</span></p></td><td class="cl-88dc3737"><p class="cl-88dc1684"><span class="cl-88d72476">175</span></p></td><td class="cl-88dc3737"><p class="cl-88dc1684"><span class="cl-88d72476">9,405,996</span></p></td><td class="cl-88dc3737"><p class="cl-88dc1684"><span class="cl-88d72476">26,793</span></p></td><td class="cl-88dc3737"><p class="cl-88dc1684"><span class="cl-88d72476">26,618</span></p></td><td class="cl-88dc3737"><p class="cl-88dc1684"><span class="cl-88d72476">9,379,203</span></p></td><td class="cl-88dc3737"><p class="cl-88dc1684"><span class="cl-88d72476">89,994</span></p></td><td class="cl-88dc3737"><p class="cl-88dc1684"><span class="cl-88d72476">89,819</span></p></td><td class="cl-88dc3737"><p class="cl-88dc1684"><span class="cl-88d72476">9,316,002</span></p></td><td class="cl-88dc3737"><p class="cl-88dc1684"><span class="cl-88d72476">9,289,384</span></p></td><td class="cl-88dc3737"><p class="cl-88dc1684"><span class="cl-88d72476">256.34810</span></p></td><td class="cl-88dc3737"><p class="cl-88dc1684"><span class="cl-88d72476">26,536.65</span></p></td><td class="cl-88dc3737"><p class="cl-88dc1684"><span class="cl-88d72476">89,737.652</span></p></td><td class="cl-88dc3738"><p class="cl-88dc1684"><span class="cl-88d72476">9,289,465</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-88dc3719"><p class="cl-88dc167a"><span class="cl-88d72476">selection</span></p></td><td class="cl-88dc371a"><p class="cl-88dc167a"><span class="cl-88d72476">by</span></p></td><td class="cl-88dc3722"><p class="cl-88dc1684"><span class="cl-88d72476">334</span></p></td><td class="cl-88dc3722"><p class="cl-88dc1684"><span class="cl-88d72476">9,405,996</span></p></td><td class="cl-88dc3722"><p class="cl-88dc1684"><span class="cl-88d72476">26,793</span></p></td><td class="cl-88dc3722"><p class="cl-88dc1684"><span class="cl-88d72476">26,459</span></p></td><td class="cl-88dc3722"><p class="cl-88dc1684"><span class="cl-88d72476">9,379,203</span></p></td><td class="cl-88dc3722"><p class="cl-88dc1684"><span class="cl-88d72476">80,785</span></p></td><td class="cl-88dc3722"><p class="cl-88dc1684"><span class="cl-88d72476">80,451</span></p></td><td class="cl-88dc3722"><p class="cl-88dc1684"><span class="cl-88d72476">9,325,211</span></p></td><td class="cl-88dc3722"><p class="cl-88dc1684"><span class="cl-88d72476">9,298,752</span></p></td><td class="cl-88dc3722"><p class="cl-88dc1684"><span class="cl-88d72476">230.11625</span></p></td><td class="cl-88dc3722"><p class="cl-88dc1684"><span class="cl-88d72476">26,562.88</span></p></td><td class="cl-88dc3722"><p class="cl-88dc1684"><span class="cl-88d72476">80,554.884</span></p></td><td class="cl-88dc3723"><p class="cl-88dc1684"><span class="cl-88d72476">9,298,648</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-88dc372c"><p class="cl-88dc167a"><span class="cl-88d72476">selection</span></p></td><td class="cl-88dc3736"><p class="cl-88dc167a"><span class="cl-88d72476">an</span></p></td><td class="cl-88dc3737"><p class="cl-88dc1684"><span class="cl-88d72476">90</span></p></td><td class="cl-88dc3737"><p class="cl-88dc1684"><span class="cl-88d72476">9,405,996</span></p></td><td class="cl-88dc3737"><p class="cl-88dc1684"><span class="cl-88d72476">26,793</span></p></td><td class="cl-88dc3737"><p class="cl-88dc1684"><span class="cl-88d72476">26,703</span></p></td><td class="cl-88dc3737"><p class="cl-88dc1684"><span class="cl-88d72476">9,379,203</span></p></td><td class="cl-88dc3737"><p class="cl-88dc1684"><span class="cl-88d72476">33,809</span></p></td><td class="cl-88dc3737"><p class="cl-88dc1684"><span class="cl-88d72476">33,719</span></p></td><td class="cl-88dc3737"><p class="cl-88dc1684"><span class="cl-88d72476">9,372,187</span></p></td><td class="cl-88dc3737"><p class="cl-88dc1684"><span class="cl-88d72476">9,345,484</span></p></td><td class="cl-88dc3737"><p class="cl-88dc1684"><span class="cl-88d72476">96.30501</span></p></td><td class="cl-88dc3737"><p class="cl-88dc1684"><span class="cl-88d72476">26,696.69</span></p></td><td class="cl-88dc3737"><p class="cl-88dc1684"><span class="cl-88d72476">33,712.695</span></p></td><td class="cl-88dc3738"><p class="cl-88dc1684"><span class="cl-88d72476">9,345,490</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-88dc3719"><p class="cl-88dc167a"><span class="cl-88d72476">selection</span></p></td><td class="cl-88dc371a"><p class="cl-88dc167a"><span class="cl-88d72476">on</span></p></td><td class="cl-88dc3722"><p class="cl-88dc1684"><span class="cl-88d72476">200</span></p></td><td class="cl-88dc3722"><p class="cl-88dc1684"><span class="cl-88d72476">9,405,996</span></p></td><td class="cl-88dc3722"><p class="cl-88dc1684"><span class="cl-88d72476">26,793</span></p></td><td class="cl-88dc3722"><p class="cl-88dc1684"><span class="cl-88d72476">26,593</span></p></td><td class="cl-88dc3722"><p class="cl-88dc1684"><span class="cl-88d72476">9,379,203</span></p></td><td class="cl-88dc3722"><p class="cl-88dc1684"><span class="cl-88d72476">71,209</span></p></td><td class="cl-88dc3722"><p class="cl-88dc1684"><span class="cl-88d72476">71,009</span></p></td><td class="cl-88dc3722"><p class="cl-88dc1684"><span class="cl-88d72476">9,334,787</span></p></td><td class="cl-88dc3722"><p class="cl-88dc1684"><span class="cl-88d72476">9,308,194</span></p></td><td class="cl-88dc3722"><p class="cl-88dc1684"><span class="cl-88d72476">202.83899</span></p></td><td class="cl-88dc3722"><p class="cl-88dc1684"><span class="cl-88d72476">26,590.16</span></p></td><td class="cl-88dc3722"><p class="cl-88dc1684"><span class="cl-88d72476">71,006.161</span></p></td><td class="cl-88dc3723"><p class="cl-88dc1684"><span class="cl-88d72476">9,308,197</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-88dc372c"><p class="cl-88dc167a"><span class="cl-88d72476">selection</span></p></td><td class="cl-88dc3736"><p class="cl-88dc167a"><span class="cl-88d72476">when</span></p></td><td class="cl-88dc3737"><p class="cl-88dc1684"><span class="cl-88d72476">63</span></p></td><td class="cl-88dc3737"><p class="cl-88dc1684"><span class="cl-88d72476">9,405,996</span></p></td><td class="cl-88dc3737"><p class="cl-88dc1684"><span class="cl-88d72476">26,793</span></p></td><td class="cl-88dc3737"><p class="cl-88dc1684"><span class="cl-88d72476">26,730</span></p></td><td class="cl-88dc3737"><p class="cl-88dc1684"><span class="cl-88d72476">9,379,203</span></p></td><td class="cl-88dc3737"><p class="cl-88dc1684"><span class="cl-88d72476">26,607</span></p></td><td class="cl-88dc3737"><p class="cl-88dc1684"><span class="cl-88d72476">26,544</span></p></td><td class="cl-88dc3737"><p class="cl-88dc1684"><span class="cl-88d72476">9,379,389</span></p></td><td class="cl-88dc3737"><p class="cl-88dc1684"><span class="cl-88d72476">9,352,659</span></p></td><td class="cl-88dc3737"><p class="cl-88dc1684"><span class="cl-88d72476">75.79010</span></p></td><td class="cl-88dc3737"><p class="cl-88dc1684"><span class="cl-88d72476">26,717.21</span></p></td><td class="cl-88dc3737"><p class="cl-88dc1684"><span class="cl-88d72476">26,531.210</span></p></td><td class="cl-88dc3738"><p class="cl-88dc1684"><span class="cl-88d72476">9,352,672</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-88dc3719"><p class="cl-88dc167a"><span class="cl-88d72476">selection</span></p></td><td class="cl-88dc371a"><p class="cl-88dc167a"><span class="cl-88d72476">s</span></p></td><td class="cl-88dc3722"><p class="cl-88dc1684"><span class="cl-88d72476">38</span></p></td><td class="cl-88dc3722"><p class="cl-88dc1684"><span class="cl-88d72476">9,405,996</span></p></td><td class="cl-88dc3722"><p class="cl-88dc1684"><span class="cl-88d72476">26,793</span></p></td><td class="cl-88dc3722"><p class="cl-88dc1684"><span class="cl-88d72476">26,755</span></p></td><td class="cl-88dc3722"><p class="cl-88dc1684"><span class="cl-88d72476">9,379,203</span></p></td><td class="cl-88dc3722"><p class="cl-88dc1684"><span class="cl-88d72476">5,975</span></p></td><td class="cl-88dc3722"><p class="cl-88dc1684"><span class="cl-88d72476">5,937</span></p></td><td class="cl-88dc3722"><p class="cl-88dc1684"><span class="cl-88d72476">9,400,021</span></p></td><td class="cl-88dc3722"><p class="cl-88dc1684"><span class="cl-88d72476">9,373,266</span></p></td><td class="cl-88dc3722"><p class="cl-88dc1684"><span class="cl-88d72476">17.01980</span></p></td><td class="cl-88dc3722"><p class="cl-88dc1684"><span class="cl-88d72476">26,775.98</span></p></td><td class="cl-88dc3722"><p class="cl-88dc1684"><span class="cl-88d72476">5,957.980</span></p></td><td class="cl-88dc3723"><p class="cl-88dc1684"><span class="cl-88d72476">9,373,245</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-88dc3740"><p class="cl-88dc167a"><span class="cl-88d72476">selection</span></p></td><td class="cl-88dc374a"><p class="cl-88dc167a"><span class="cl-88d72476">as</span></p></td><td class="cl-88dc374b"><p class="cl-88dc1684"><span class="cl-88d72476">296</span></p></td><td class="cl-88dc374b"><p class="cl-88dc1684"><span class="cl-88d72476">9,405,996</span></p></td><td class="cl-88dc374b"><p class="cl-88dc1684"><span class="cl-88d72476">26,793</span></p></td><td class="cl-88dc374b"><p class="cl-88dc1684"><span class="cl-88d72476">26,497</span></p></td><td class="cl-88dc374b"><p class="cl-88dc1684"><span class="cl-88d72476">9,379,203</span></p></td><td class="cl-88dc374b"><p class="cl-88dc1684"><span class="cl-88d72476">103,198</span></p></td><td class="cl-88dc374b"><p class="cl-88dc1684"><span class="cl-88d72476">102,902</span></p></td><td class="cl-88dc374b"><p class="cl-88dc1684"><span class="cl-88d72476">9,302,798</span></p></td><td class="cl-88dc374b"><p class="cl-88dc1684"><span class="cl-88d72476">9,276,301</span></p></td><td class="cl-88dc374b"><p class="cl-88dc1684"><span class="cl-88d72476">293.95973</span></p></td><td class="cl-88dc374b"><p class="cl-88dc1684"><span class="cl-88d72476">26,499.04</span></p></td><td class="cl-88dc374b"><p class="cl-88dc1684"><span class="cl-88d72476">102,904.040</span></p></td><td class="cl-88dc3754"><p class="cl-88dc1684"><span class="cl-88d72476">9,276,299</span></p></td></tr></tbody></table></div>
<p>Now we can calculate the collocation statistics (the association
strength).</p>
<pre class="r"><code>colldf_redux %&gt;%
    # work row-wise
    dplyr::rowwise() %&gt;%
    # calculate fishers&#39; exact test
    dplyr::mutate(p = as.vector(unlist(fisher.test(matrix(c(O11, O12, O21, O22), 
                                                        ncol = 2, byrow = T))[1]))) %&gt;%

    # extract x2 statistics
    dplyr::mutate(X2 = (O11-E11)^2/E11 + (O12-E12)^2/E12 + (O21-E21)^2/E21 + (O22-E22)^2/E22) %&gt;%

    # extract association measures
    dplyr::mutate(phi = sqrt((X2 / N)),
                Dice = (2 * O11) / (R1 + C1),
                MI = log2(O11 / E11),
                MS = min((O11/C1), (O11/R1)),
                t.score = (O11 - E11) / sqrt(O11),
                z.score = (O11 - E11) / sqrt(E11),
                PMI = log2( (O11 / N) / ((O11+O12) / N) * 
                              ((O11+O21) / N) ),
                DeltaP12 = (O11 / (O11 + O12)) - (O21 / (O21 + O22)),
                DeltaP21 =  (O11 / (O11 + O21)) - (O21 / (O12 + O22)),
                DP = (O11 / R1) - (O21 / R2),
                OddsRatio = log(((O11 + 0.5) * (O22 + 0.5))  / ( (O12 + 0.5) * (O21 + 0.5) )),
                # calculate LL aka G2
                G2 = 2 * (O11 * log(O11 / E11) + O12 * log(O12 / E12) + O21 * log(O21 / E21) + O22 * log(O22 / E22))) %&gt;%

    # simplify significance
    dplyr::mutate(Significance = dplyr::case_when(p &lt;= .001 ~ &quot;p&lt;.001&quot;,
                                                p &lt;= .01 ~ &quot;p&lt;.01&quot;,
                                                p &lt;= .05 ~ &quot;p&lt;.05&quot;, 
                                                TRUE ~ &quot;n.s.&quot;)) %&gt;%
    # round p-value

    dplyr::mutate(p = round(p, 5)) %&gt;%
    # filter out non significant results
    dplyr::filter(Significance != &quot;n.s.&quot;,
                # filter out instances where the w1 and w2 repel each other
                E11 &lt; O11) %&gt;%
    # arrange by phi (association measure)
    dplyr::arrange(-phi) %&gt;%
    # remove superfluous columns
    dplyr::select(-any_of(c(&quot;TermCoocFreq&quot;, &quot;AllFreq&quot;, &quot;NRows&quot;, &quot;E12&quot;, &quot;E21&quot;, 
                            &quot;E22&quot;, &quot;O12&quot;, &quot;O21&quot;, &quot;O22&quot;, &quot;R1&quot;, &quot;R2&quot;, &quot;C1&quot;, &quot;C2&quot;))) -&gt; assoc_tb</code></pre>
<div class="tabwid"><style>.cl-8ded2820{table-layout:auto;width:50%;}.cl-8ddfa09c{font-family:'Arial';font-size:12pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-8ddfa0b0{font-family:'Arial';font-size:12pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-8de47f9a{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-8de47fae{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-8de4a600{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8de4a614{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8de4a61e{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8de4a61f{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8de4a628{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8de4a629{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8de4a632{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8de4a633{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8de4a63c{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8de4a63d{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8de4a650{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8de4a651{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8de4a65a{background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8de4a65b{background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8de4a664{background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8de4a665{background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing='true' class='cl-8ded2820'><caption style="display:table-caption;margin:0pt;text-align:center;border-bottom: 0.00pt solid transparent;border-top: 0.00pt solid transparent;border-left: 0.00pt solid transparent;border-right: 0.00pt solid transparent;padding-top:3pt;padding-bottom:3pt;padding-left:3pt;padding-right:3pt;line-height: 1;background-color:transparent;"><span>First 10 rows of association statistics table</span></caption><thead><tr style="overflow-wrap:break-word;"><th class="cl-8de4a600"><p class="cl-8de47f9a"><span class="cl-8ddfa09c">w1</span></p></th><th class="cl-8de4a614"><p class="cl-8de47f9a"><span class="cl-8ddfa09c">w2</span></p></th><th class="cl-8de4a61e"><p class="cl-8de47fae"><span class="cl-8ddfa09c">O11</span></p></th><th class="cl-8de4a61e"><p class="cl-8de47fae"><span class="cl-8ddfa09c">N</span></p></th><th class="cl-8de4a61e"><p class="cl-8de47fae"><span class="cl-8ddfa09c">E11</span></p></th><th class="cl-8de4a61e"><p class="cl-8de47fae"><span class="cl-8ddfa09c">p</span></p></th><th class="cl-8de4a61e"><p class="cl-8de47fae"><span class="cl-8ddfa09c">X2</span></p></th><th class="cl-8de4a61e"><p class="cl-8de47fae"><span class="cl-8ddfa09c">phi</span></p></th><th class="cl-8de4a61e"><p class="cl-8de47fae"><span class="cl-8ddfa09c">Dice</span></p></th><th class="cl-8de4a61e"><p class="cl-8de47fae"><span class="cl-8ddfa09c">MI</span></p></th><th class="cl-8de4a61e"><p class="cl-8de47fae"><span class="cl-8ddfa09c">MS</span></p></th><th class="cl-8de4a61e"><p class="cl-8de47fae"><span class="cl-8ddfa09c">t.score</span></p></th><th class="cl-8de4a61e"><p class="cl-8de47fae"><span class="cl-8ddfa09c">z.score</span></p></th><th class="cl-8de4a61e"><p class="cl-8de47fae"><span class="cl-8ddfa09c">PMI</span></p></th><th class="cl-8de4a61e"><p class="cl-8de47fae"><span class="cl-8ddfa09c">DeltaP12</span></p></th><th class="cl-8de4a61e"><p class="cl-8de47fae"><span class="cl-8ddfa09c">DeltaP21</span></p></th><th class="cl-8de4a61e"><p class="cl-8de47fae"><span class="cl-8ddfa09c">DP</span></p></th><th class="cl-8de4a61e"><p class="cl-8de47fae"><span class="cl-8ddfa09c">OddsRatio</span></p></th><th class="cl-8de4a61e"><p class="cl-8de47fae"><span class="cl-8ddfa09c">G2</span></p></th><th class="cl-8de4a61f"><p class="cl-8de47f9a"><span class="cl-8ddfa09c">Significance</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-8de4a628"><p class="cl-8de47f9a"><span class="cl-8ddfa0b0">selection</span></p></td><td class="cl-8de4a629"><p class="cl-8de47f9a"><span class="cl-8ddfa0b0">natural</span></p></td><td class="cl-8de4a632"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">515</span></p></td><td class="cl-8de4a632"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">9,405,996</span></p></td><td class="cl-8de4a632"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">72.4117736</span></p></td><td class="cl-8de4a632"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">0</span></p></td><td class="cl-8de4a632"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">2,720.2243</span></p></td><td class="cl-8de4a632"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">0.017005913</span></p></td><td class="cl-8de4a632"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">0.0197265101</span></p></td><td class="cl-8de4a632"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">2.830276</span></p></td><td class="cl-8de4a632"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">0.0192214384</span></p></td><td class="cl-8de4a632"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">19.502767</span></p></td><td class="cl-8de4a632"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">52.01101</span></p></td><td class="cl-8de4a632"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">-14.23256</span></p></td><td class="cl-8de4a632"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">0.0165659889</span></p></td><td class="cl-8de4a632"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">0.017603780</span></p></td><td class="cl-8de4a632"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">0.0165659889</span></p></td><td class="cl-8de4a632"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">1.997093</span></p></td><td class="cl-8de4a632"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">1,150.64107</span></p></td><td class="cl-8de4a633"><p class="cl-8de47f9a"><span class="cl-8ddfa0b0">p&lt;.001</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-8de4a63c"><p class="cl-8de47f9a"><span class="cl-8ddfa0b0">selection</span></p></td><td class="cl-8de4a63d"><p class="cl-8de47f9a"><span class="cl-8ddfa0b0">through</span></p></td><td class="cl-8de4a650"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">149</span></p></td><td class="cl-8de4a650"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">9,405,996</span></p></td><td class="cl-8de4a650"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">38.8564181</span></p></td><td class="cl-8de4a650"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">0</span></p></td><td class="cl-8de4a650"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">313.5630</span></p></td><td class="cl-8de4a650"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">0.005773777</span></p></td><td class="cl-8de4a650"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">0.0073700351</span></p></td><td class="cl-8de4a650"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">1.939088</span></p></td><td class="cl-8de4a650"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">0.0055611540</span></p></td><td class="cl-8de4a650"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">9.023314</span></p></td><td class="cl-8de4a650"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">17.66964</span></p></td><td class="cl-8de4a650"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">-16.91989</span></p></td><td class="cl-8de4a650"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">0.0041226523</span></p></td><td class="cl-8de4a650"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">0.009486465</span></p></td><td class="cl-8de4a650"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">0.0041226523</span></p></td><td class="cl-8de4a650"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">1.359635</span></p></td><td class="cl-8de4a650"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">181.59628</span></p></td><td class="cl-8de4a651"><p class="cl-8de47f9a"><span class="cl-8ddfa0b0">p&lt;.001</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-8de4a628"><p class="cl-8de47f9a"><span class="cl-8ddfa0b0">selection</span></p></td><td class="cl-8de4a629"><p class="cl-8de47f9a"><span class="cl-8ddfa0b0">unconscious</span></p></td><td class="cl-8de4a632"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">25</span></p></td><td class="cl-8de4a632"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">9,405,996</span></p></td><td class="cl-8de4a632"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">2.4724999</span></p></td><td class="cl-8de4a632"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">0</span></p></td><td class="cl-8de4a632"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">205.8584</span></p></td><td class="cl-8de4a632"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">0.004678234</span></p></td><td class="cl-8de4a632"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">0.0018075991</span></p></td><td class="cl-8de4a632"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">3.337886</span></p></td><td class="cl-8de4a632"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">0.0009330795</span></p></td><td class="cl-8de4a632"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">4.505500</span></p></td><td class="cl-8de4a632"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">14.32666</span></p></td><td class="cl-8de4a632"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">-23.46931</span></p></td><td class="cl-8de4a632"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">0.0008431998</span></p></td><td class="cl-8de4a632"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">0.028712211</span></p></td><td class="cl-8de4a632"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">0.0008431998</span></p></td><td class="cl-8de4a632"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">2.360053</span></p></td><td class="cl-8de4a632"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">71.23779</span></p></td><td class="cl-8de4a633"><p class="cl-8de47f9a"><span class="cl-8ddfa0b0">p&lt;.001</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-8de4a63c"><p class="cl-8de47f9a"><span class="cl-8ddfa0b0">selection</span></p></td><td class="cl-8de4a63d"><p class="cl-8de47f9a"><span class="cl-8ddfa0b0">theory</span></p></td><td class="cl-8de4a650"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">82</span></p></td><td class="cl-8de4a650"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">9,405,996</span></p></td><td class="cl-8de4a650"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">20.7826718</span></p></td><td class="cl-8de4a650"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">0</span></p></td><td class="cl-8de4a650"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">180.9769</span></p></td><td class="cl-8de4a650"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">0.004386410</span></p></td><td class="cl-8de4a650"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">0.0048109361</span></p></td><td class="cl-8de4a650"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">1.980243</span></p></td><td class="cl-8de4a650"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">0.0030605009</span></p></td><td class="cl-8de4a650"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">6.760323</span></p></td><td class="cl-8de4a650"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">13.42838</span></p></td><td class="cl-8de4a650"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">-18.68428</span></p></td><td class="cl-8de4a650"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">0.0022913524</span></p></td><td class="cl-8de4a650"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">0.010471482</span></p></td><td class="cl-8de4a650"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">0.0022913524</span></p></td><td class="cl-8de4a650"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">1.389337</span></p></td><td class="cl-8de4a650"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">103.32874</span></p></td><td class="cl-8de4a651"><p class="cl-8de47f9a"><span class="cl-8ddfa0b0">p&lt;.001</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-8de4a628"><p class="cl-8de47f9a"><span class="cl-8ddfa0b0">selection</span></p></td><td class="cl-8de4a629"><p class="cl-8de47f9a"><span class="cl-8ddfa0b0">power</span></p></td><td class="cl-8de4a632"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">63</span></p></td><td class="cl-8de4a632"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">9,405,996</span></p></td><td class="cl-8de4a632"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">13.6072949</span></p></td><td class="cl-8de4a632"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">0</span></p></td><td class="cl-8de4a632"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">179.8926</span></p></td><td class="cl-8de4a632"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">0.004373250</span></p></td><td class="cl-8de4a632"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">0.0039911308</span></p></td><td class="cl-8de4a632"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">2.210972</span></p></td><td class="cl-8de4a632"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">0.0023513604</span></p></td><td class="cl-8de4a632"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">6.222896</span></p></td><td class="cl-8de4a632"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">13.38989</span></p></td><td class="cl-8de4a632"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">-19.67555</span></p></td><td class="cl-8de4a632"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">0.0018487591</span></p></td><td class="cl-8de4a632"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">0.012686769</span></p></td><td class="cl-8de4a632"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">0.0018487591</span></p></td><td class="cl-8de4a632"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">1.552584</span></p></td><td class="cl-8de4a632"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">94.91857</span></p></td><td class="cl-8de4a633"><p class="cl-8de47f9a"><span class="cl-8ddfa0b0">p&lt;.001</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-8de4a63c"><p class="cl-8de47f9a"><span class="cl-8ddfa0b0">selection</span></p></td><td class="cl-8de4a63d"><p class="cl-8de47f9a"><span class="cl-8ddfa0b0">sexual</span></p></td><td class="cl-8de4a650"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">45</span></p></td><td class="cl-8de4a650"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">9,405,996</span></p></td><td class="cl-8de4a650"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">7.7536229</span></p></td><td class="cl-8de4a650"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">0</span></p></td><td class="cl-8de4a650"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">179.4849</span></p></td><td class="cl-8de4a650"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">0.004368291</span></p></td><td class="cl-8de4a650"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">0.0030492970</span></p></td><td class="cl-8de4a650"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">2.536983</span></p></td><td class="cl-8de4a650"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">0.0016795432</span></p></td><td class="cl-8de4a650"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">5.552362</span></p></td><td class="cl-8de4a650"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">13.37617</span></p></td><td class="cl-8de4a650"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">-20.97241</span></p></td><td class="cl-8de4a650"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">0.0013941245</span></p></td><td class="cl-8de4a650"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">0.016247274</span></p></td><td class="cl-8de4a650"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">0.0013941245</span></p></td><td class="cl-8de4a650"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">1.784560</span></p></td><td class="cl-8de4a650"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">84.33789</span></p></td><td class="cl-8de4a651"><p class="cl-8de47f9a"><span class="cl-8ddfa0b0">p&lt;.001</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-8de4a628"><p class="cl-8de47f9a"><span class="cl-8ddfa0b0">selection</span></p></td><td class="cl-8de4a629"><p class="cl-8de47f9a"><span class="cl-8ddfa0b0">methodical</span></p></td><td class="cl-8de4a632"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">16</span></p></td><td class="cl-8de4a632"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">9,405,996</span></p></td><td class="cl-8de4a632"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">1.3758265</span></p></td><td class="cl-8de4a632"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">0</span></p></td><td class="cl-8de4a632"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">155.8979</span></p></td><td class="cl-8de4a632"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">0.004071155</span></p></td><td class="cl-8de4a632"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">0.0011731926</span></p></td><td class="cl-8de4a632"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">3.539701</span></p></td><td class="cl-8de4a632"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">0.0005971709</span></p></td><td class="cl-8de4a632"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">3.656043</span></p></td><td class="cl-8de4a632"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">12.46779</span></p></td><td class="cl-8de4a632"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">-24.95884</span></p></td><td class="cl-8de4a632"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">0.0005473799</span></p></td><td class="cl-8de4a632"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">0.033076642</span></p></td><td class="cl-8de4a632"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">0.0005473799</span></p></td><td class="cl-8de4a632"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">2.514599</span></p></td><td class="cl-8de4a632"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">49.72137</span></p></td><td class="cl-8de4a633"><p class="cl-8de47f9a"><span class="cl-8ddfa0b0">p&lt;.001</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-8de4a63c"><p class="cl-8de47f9a"><span class="cl-8ddfa0b0">selection</span></p></td><td class="cl-8de4a63d"><p class="cl-8de47f9a"><span class="cl-8ddfa0b0">fittest</span></p></td><td class="cl-8de4a650"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">19</span></p></td><td class="cl-8de4a650"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">9,405,996</span></p></td><td class="cl-8de4a650"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">2.0252850</span></p></td><td class="cl-8de4a650"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">0</span></p></td><td class="cl-8de4a650"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">142.6890</span></p></td><td class="cl-8de4a650"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">0.003894869</span></p></td><td class="cl-8de4a650"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">0.0013816172</span></p></td><td class="cl-8de4a650"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">3.229803</span></p></td><td class="cl-8de4a650"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">0.0007091404</span></p></td><td class="cl-8de4a650"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">3.894267</span></p></td><td class="cl-8de4a650"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">11.92777</span></p></td><td class="cl-8de4a650"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">-24.15308</span></p></td><td class="cl-8de4a650"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">0.0006353602</span></p></td><td class="cl-8de4a650"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">0.026649350</span></p></td><td class="cl-8de4a650"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">0.0006353602</span></p></td><td class="cl-8de4a650"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">2.288833</span></p></td><td class="cl-8de4a650"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">51.54274</span></p></td><td class="cl-8de4a651"><p class="cl-8de47f9a"><span class="cl-8ddfa0b0">p&lt;.001</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-8de4a628"><p class="cl-8de47f9a"><span class="cl-8ddfa0b0">selection</span></p></td><td class="cl-8de4a629"><p class="cl-8de47f9a"><span class="cl-8ddfa0b0">divergence</span></p></td><td class="cl-8de4a632"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">28</span></p></td><td class="cl-8de4a632"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">9,405,996</span></p></td><td class="cl-8de4a632"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">4.0505701</span></p></td><td class="cl-8de4a632"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">0</span></p></td><td class="cl-8de4a632"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">142.0296</span></p></td><td class="cl-8de4a632"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">0.003885858</span></p></td><td class="cl-8de4a632"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">0.0019847599</span></p></td><td class="cl-8de4a632"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">2.789230</span></p></td><td class="cl-8de4a632"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">0.0010450491</span></p></td><td class="cl-8de4a632"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">4.526017</span></p></td><td class="cl-8de4a632"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">11.89973</span></p></td><td class="cl-8de4a632"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">-22.59366</span></p></td><td class="cl-8de4a632"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">0.0008964224</span></p></td><td class="cl-8de4a632"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">0.019542351</span></p></td><td class="cl-8de4a632"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">0.0008964224</span></p></td><td class="cl-8de4a632"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">1.968601</span></p></td><td class="cl-8de4a632"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">60.79685</span></p></td><td class="cl-8de4a633"><p class="cl-8de47f9a"><span class="cl-8ddfa0b0">p&lt;.001</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-8de4a65a"><p class="cl-8de47f9a"><span class="cl-8ddfa0b0">selection</span></p></td><td class="cl-8de4a65b"><p class="cl-8de47f9a"><span class="cl-8ddfa0b0">iv</span></p></td><td class="cl-8de4a664"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">7</span></p></td><td class="cl-8de4a664"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">9,405,996</span></p></td><td class="cl-8de4a664"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">0.3532143</span></p></td><td class="cl-8de4a664"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">0</span></p></td><td class="cl-8de4a664"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">125.4382</span></p></td><td class="cl-8de4a664"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">0.003651846</span></p></td><td class="cl-8de4a664"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">0.0005201174</span></p></td><td class="cl-8de4a664"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">4.308739</span></p></td><td class="cl-8de4a664"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">0.0002612623</span></p></td><td class="cl-8de4a664"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">2.512249</span></p></td><td class="cl-8de4a664"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">11.18388</span></p></td><td class="cl-8de4a664"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">-28.11317</span></p></td><td class="cl-8de4a664"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">0.0002487879</span></p></td><td class="cl-8de4a664"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">0.056439174</span></p></td><td class="cl-8de4a664"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">0.0002487879</span></p></td><td class="cl-8de4a664"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">3.106804</span></p></td><td class="cl-8de4a664"><p class="cl-8de47fae"><span class="cl-8ddfa0b0">28.88424</span></p></td><td class="cl-8de4a665"><p class="cl-8de47f9a"><span class="cl-8ddfa0b0">p&lt;.001</span></p></td></tr></tbody></table></div>
</div>
<div id="identifying-collocations-using-kwics"
class="section level3 unnumbered">
<h3 class="unnumbered">Identifying collocations using kwics</h3>
<p>In this section, we will extract collocations and calculate
association measures based on concordances and the corpus the
concordances were extracted from.</p>
<p>We start by cleaning our corpus and splitting it into chapters.</p>
<pre class="r"><code># clean corpus
text %&gt;%
  # concatenate the elements in the &#39;text&#39; object
  paste0(collapse = &quot; &quot;) %&gt;%
  # separate possessives and contractions
  stringr::str_replace_all(fixed(&quot;&#39;&quot;), fixed(&quot; &#39;&quot;)) %&gt;%
  stringr::str_replace_all(fixed(&quot;’&quot;), fixed(&quot; &#39;&quot;)) %&gt;%
  # split text into different chapters
  stringr::str_split(&quot;CHAPTER [IVX]{1,4}&quot;) %&gt;%
  # unlist sentences
  unlist() %&gt;%
  # remove non-word characters
  stringr::str_replace_all(&quot;\\W&quot;, &quot; &quot;) %&gt;%
  stringr::str_replace_all(&quot;[^[:alpha:] ]&quot;, &quot; &quot;) %&gt;%
  # remove superfluous white spaces
  stringr::str_squish() %&gt;%
  # convert to lower case and save in &#39;sentences&#39; object
  tolower() -&gt; texts</code></pre>
<div class="tabwid"><style>.cl-8e351c3e{table-layout:auto;width:50%;}.cl-8e209bc4{font-family:'Arial';font-size:12pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-8e209bd8{font-family:'Arial';font-size:12pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-8e285b8e{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-8e28a0bc{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8e28a0d0{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8e28a0da{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8e28a0e4{background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing='true' class='cl-8e351c3e'><caption style="display:table-caption;margin:0pt;text-align:center;border-bottom: 0.00pt solid transparent;border-top: 0.00pt solid transparent;border-left: 0.00pt solid transparent;border-right: 0.00pt solid transparent;padding-top:3pt;padding-bottom:3pt;padding-left:3pt;padding-right:3pt;line-height: 1;background-color:transparent;"><span>First 200 characters of the first 10 chapters of the example text</span></caption><thead><tr style="overflow-wrap:break-word;"><th class="cl-8e28a0bc"><p class="cl-8e285b8e"><span class="cl-8e209bc4">.</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-8e28a0d0"><p class="cl-8e285b8e"><span class="cl-8e209bd8">the origin of species by charles darwin an historical sketch of the progress of opinion on the origi</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-8e28a0da"><p class="cl-8e285b8e"><span class="cl-8e209bd8">variation under domestication causes of variability effects of habit and the use or disuse of partsc</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-8e28a0d0"><p class="cl-8e285b8e"><span class="cl-8e209bd8">variation under nature variability individual differences doubtful species wide ranging much diffuse</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-8e28a0da"><p class="cl-8e285b8e"><span class="cl-8e209bd8">struggle for existence its bearing on natural selection the term used in a wide sense geometrical ra</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-8e28a0d0"><p class="cl-8e285b8e"><span class="cl-8e209bd8">natural selection or the survival of the fittest natural selection its power compared with man s sel</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-8e28a0da"><p class="cl-8e285b8e"><span class="cl-8e209bd8">f under changing conditions of life organic beings present individual differences in almost every pa</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-8e28a0d0"><p class="cl-8e285b8e"><span class="cl-8e209bd8">laws of variation effects of changed conditions use and disuse combined with natural selection organ</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-8e28a0da"><p class="cl-8e285b8e"><span class="cl-8e209bd8">difficulties of the theory difficulties of the theory of descent with modification absence or rarity</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-8e28a0d0"><p class="cl-8e285b8e"><span class="cl-8e209bd8">miscellaneous objections to the theory of natural selection longevity modifications not necessarily </span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-8e28a0e4"><p class="cl-8e285b8e"><span class="cl-8e209bd8">instinct instincts comparable with habits but different in their origin instincts graduated aphides </span></p></td></tr></tbody></table></div>
<div class="warning"
style="padding:0.1em; background-color: rgba(215,209,204,.3); color:#51247a">
<span>
<p style="margin-top:1em; text-align:center">
We split the corpus into chapter to mirror the fact that most text data
will come in the form of corpora which consist of different files
containing texts.
</p>
<p style="margin-left:1em;">
</p>
<p></span></p>
</div>
<p><br></p>
<p>Next, we generate a frequency list of words that occur around a
keyword (we use the keyword <em>selection</em> in this example but you
can also choose a different word).</p>
<p>for this we use the <code>tokens_select</code> function (from the
<code>quanteda</code> package) which has the following arguments:</p>
<ul>
<li><code>x</code>: a text or collection of texts. The text needs to be
tokenised, i.e. split it into individual words, which is why we use the
<em>text</em> in the <code>tokens()</code> function.</li>
<li><code>pattern</code>: a keyword defined by a search pattern<br />
</li>
<li><code>window</code>: the size of the context window (how many word
before and after)<br />
</li>
<li><code>valuetype</code>: the type of pattern matching
<ul>
<li>“glob” for “glob”-style wildcard expressions;<br />
</li>
<li>“regex” for regular expressions; or<br />
</li>
<li>“fixed” for exact matching<br />
</li>
</ul></li>
<li><code>selection</code>: a character to define if the key word should
be retained in the resulting frequency list or if it should be removed.
The argument offers two options
<ul>
<li>“keep”<br />
</li>
<li>“remove”<br />
</li>
</ul></li>
<li><code>case_insensitive</code>: logical; if TRUE, ignore case when
matching a pattern or dictionary values</li>
</ul>
<pre class="r"><code>kwic_words &lt;- quanteda::tokens_select(tokens(texts), 
                                      pattern = &quot;selection&quot;, 
                                      window = 5, 
                                      selection = &quot;keep&quot;) %&gt;%
  unlist() %&gt;%
  # tabulate results
  table() %&gt;%
  # convert into data frame
  as.data.frame() %&gt;%
  # rename columns
  dplyr::rename(token = 1,
                n = 2) %&gt;%
  # add a column with type
  dplyr::mutate(type = &quot;kwic&quot;)</code></pre>
<div class="tabwid"><style>.cl-8e70ff06{table-layout:auto;width:50%;}.cl-8e6429de{font-family:'Arial';font-size:12pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-8e6429f2{font-family:'Arial';font-size:12pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-8e6880e2{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-8e6880f6{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-8e68a4fa{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8e68a504{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8e68a50e{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8e68a518{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8e68a519{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8e68a522{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8e68a523{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8e68a524{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8e68a52c{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8e68a536{background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8e68a537{background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8e68a538{background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing='true' class='cl-8e70ff06'><caption style="display:table-caption;margin:0pt;text-align:center;border-bottom: 0.00pt solid transparent;border-top: 0.00pt solid transparent;border-left: 0.00pt solid transparent;border-right: 0.00pt solid transparent;padding-top:3pt;padding-bottom:3pt;padding-left:3pt;padding-right:3pt;line-height: 1;background-color:transparent;"><span>First 10 rows of the kwic table</span></caption><thead><tr style="overflow-wrap:break-word;"><th class="cl-8e68a4fa"><p class="cl-8e6880e2"><span class="cl-8e6429de">token</span></p></th><th class="cl-8e68a504"><p class="cl-8e6880f6"><span class="cl-8e6429de">n</span></p></th><th class="cl-8e68a50e"><p class="cl-8e6880e2"><span class="cl-8e6429de">type</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-8e68a518"><p class="cl-8e6880e2"><span class="cl-8e6429f2">a</span></p></td><td class="cl-8e68a519"><p class="cl-8e6880f6"><span class="cl-8e6429f2">54</span></p></td><td class="cl-8e68a522"><p class="cl-8e6880e2"><span class="cl-8e6429f2">kwic</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-8e68a523"><p class="cl-8e6880e2"><span class="cl-8e6429f2">able</span></p></td><td class="cl-8e68a524"><p class="cl-8e6880f6"><span class="cl-8e6429f2">2</span></p></td><td class="cl-8e68a52c"><p class="cl-8e6880e2"><span class="cl-8e6429f2">kwic</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-8e68a518"><p class="cl-8e6880e2"><span class="cl-8e6429f2">abounding</span></p></td><td class="cl-8e68a519"><p class="cl-8e6880f6"><span class="cl-8e6429f2">1</span></p></td><td class="cl-8e68a522"><p class="cl-8e6880e2"><span class="cl-8e6429f2">kwic</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-8e68a523"><p class="cl-8e6880e2"><span class="cl-8e6429f2">above</span></p></td><td class="cl-8e68a524"><p class="cl-8e6880f6"><span class="cl-8e6429f2">2</span></p></td><td class="cl-8e68a52c"><p class="cl-8e6880e2"><span class="cl-8e6429f2">kwic</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-8e68a518"><p class="cl-8e6880e2"><span class="cl-8e6429f2">absolute</span></p></td><td class="cl-8e68a519"><p class="cl-8e6880f6"><span class="cl-8e6429f2">1</span></p></td><td class="cl-8e68a522"><p class="cl-8e6880e2"><span class="cl-8e6429f2">kwic</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-8e68a523"><p class="cl-8e6880e2"><span class="cl-8e6429f2">absurd</span></p></td><td class="cl-8e68a524"><p class="cl-8e6880f6"><span class="cl-8e6429f2">1</span></p></td><td class="cl-8e68a52c"><p class="cl-8e6880e2"><span class="cl-8e6429f2">kwic</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-8e68a518"><p class="cl-8e6880e2"><span class="cl-8e6429f2">accordance</span></p></td><td class="cl-8e68a519"><p class="cl-8e6880f6"><span class="cl-8e6429f2">2</span></p></td><td class="cl-8e68a522"><p class="cl-8e6880e2"><span class="cl-8e6429f2">kwic</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-8e68a523"><p class="cl-8e6880e2"><span class="cl-8e6429f2">according</span></p></td><td class="cl-8e68a524"><p class="cl-8e6880f6"><span class="cl-8e6429f2">2</span></p></td><td class="cl-8e68a52c"><p class="cl-8e6880e2"><span class="cl-8e6429f2">kwic</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-8e68a518"><p class="cl-8e6880e2"><span class="cl-8e6429f2">account</span></p></td><td class="cl-8e68a519"><p class="cl-8e6880f6"><span class="cl-8e6429f2">4</span></p></td><td class="cl-8e68a522"><p class="cl-8e6880e2"><span class="cl-8e6429f2">kwic</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-8e68a536"><p class="cl-8e6880e2"><span class="cl-8e6429f2">accumulate</span></p></td><td class="cl-8e68a537"><p class="cl-8e6880f6"><span class="cl-8e6429f2">2</span></p></td><td class="cl-8e68a538"><p class="cl-8e6880e2"><span class="cl-8e6429f2">kwic</span></p></td></tr></tbody></table></div>
<p>Next, we create a frequency table of the entire clean corpus.</p>
<pre class="r"><code>corpus_words &lt;- texts %&gt;%
  # tokenize the corpus files
  quanteda::tokens() %&gt;%
  # unlist the tokens to create a data frame
  unlist() %&gt;%
  as.data.frame() %&gt;%
  # rename the column to &#39;token&#39;
  dplyr::rename(token = 1) %&gt;%
  # group by &#39;token&#39; and count the occurrences
  dplyr::group_by(token) %&gt;%
  dplyr::summarise(n = n()) %&gt;%
  # add column stating where the frequency list is &#39;from&#39;
  dplyr::mutate(type = &quot;corpus&quot;)</code></pre>
<div class="tabwid"><style>.cl-8ecc50e0{table-layout:auto;width:50%;}.cl-8ec1a3fc{font-family:'Arial';font-size:12pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-8ec1a406{font-family:'Arial';font-size:12pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-8ec5633e{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-8ec56348{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-8ec57fc2{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8ec57fc3{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8ec57fcc{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8ec57fcd{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8ec57fce{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8ec57fd6{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8ec57fe0{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8ec57fea{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8ec57feb{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8ec57fec{background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8ec57ff4{background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8ec57ffe{background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing='true' class='cl-8ecc50e0'><caption style="display:table-caption;margin:0pt;text-align:center;border-bottom: 0.00pt solid transparent;border-top: 0.00pt solid transparent;border-left: 0.00pt solid transparent;border-right: 0.00pt solid transparent;padding-top:3pt;padding-bottom:3pt;padding-left:3pt;padding-right:3pt;line-height: 1;background-color:transparent;"><span>First 10 rows of the corpus table</span></caption><thead><tr style="overflow-wrap:break-word;"><th class="cl-8ec57fc2"><p class="cl-8ec5633e"><span class="cl-8ec1a3fc">token</span></p></th><th class="cl-8ec57fc3"><p class="cl-8ec56348"><span class="cl-8ec1a3fc">n</span></p></th><th class="cl-8ec57fcc"><p class="cl-8ec5633e"><span class="cl-8ec1a3fc">type</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-8ec57fcd"><p class="cl-8ec5633e"><span class="cl-8ec1a406">a</span></p></td><td class="cl-8ec57fce"><p class="cl-8ec56348"><span class="cl-8ec1a406">3,163</span></p></td><td class="cl-8ec57fd6"><p class="cl-8ec5633e"><span class="cl-8ec1a406">corpus</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-8ec57fe0"><p class="cl-8ec5633e"><span class="cl-8ec1a406">abdomen</span></p></td><td class="cl-8ec57fea"><p class="cl-8ec56348"><span class="cl-8ec1a406">3</span></p></td><td class="cl-8ec57feb"><p class="cl-8ec5633e"><span class="cl-8ec1a406">corpus</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-8ec57fcd"><p class="cl-8ec5633e"><span class="cl-8ec1a406">aberrant</span></p></td><td class="cl-8ec57fce"><p class="cl-8ec56348"><span class="cl-8ec1a406">7</span></p></td><td class="cl-8ec57fd6"><p class="cl-8ec5633e"><span class="cl-8ec1a406">corpus</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-8ec57fe0"><p class="cl-8ec5633e"><span class="cl-8ec1a406">aberration</span></p></td><td class="cl-8ec57fea"><p class="cl-8ec56348"><span class="cl-8ec1a406">2</span></p></td><td class="cl-8ec57feb"><p class="cl-8ec5633e"><span class="cl-8ec1a406">corpus</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-8ec57fcd"><p class="cl-8ec5633e"><span class="cl-8ec1a406">abhorrent</span></p></td><td class="cl-8ec57fce"><p class="cl-8ec56348"><span class="cl-8ec1a406">1</span></p></td><td class="cl-8ec57fd6"><p class="cl-8ec5633e"><span class="cl-8ec1a406">corpus</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-8ec57fe0"><p class="cl-8ec5633e"><span class="cl-8ec1a406">abilities</span></p></td><td class="cl-8ec57fea"><p class="cl-8ec56348"><span class="cl-8ec1a406">1</span></p></td><td class="cl-8ec57feb"><p class="cl-8ec5633e"><span class="cl-8ec1a406">corpus</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-8ec57fcd"><p class="cl-8ec5633e"><span class="cl-8ec1a406">ability</span></p></td><td class="cl-8ec57fce"><p class="cl-8ec56348"><span class="cl-8ec1a406">3</span></p></td><td class="cl-8ec57fd6"><p class="cl-8ec5633e"><span class="cl-8ec1a406">corpus</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-8ec57fe0"><p class="cl-8ec5633e"><span class="cl-8ec1a406">abjectly</span></p></td><td class="cl-8ec57fea"><p class="cl-8ec56348"><span class="cl-8ec1a406">1</span></p></td><td class="cl-8ec57feb"><p class="cl-8ec5633e"><span class="cl-8ec1a406">corpus</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-8ec57fcd"><p class="cl-8ec5633e"><span class="cl-8ec1a406">able</span></p></td><td class="cl-8ec57fce"><p class="cl-8ec56348"><span class="cl-8ec1a406">54</span></p></td><td class="cl-8ec57fd6"><p class="cl-8ec5633e"><span class="cl-8ec1a406">corpus</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-8ec57fec"><p class="cl-8ec5633e"><span class="cl-8ec1a406">ably</span></p></td><td class="cl-8ec57ff4"><p class="cl-8ec56348"><span class="cl-8ec1a406">3</span></p></td><td class="cl-8ec57ffe"><p class="cl-8ec5633e"><span class="cl-8ec1a406">corpus</span></p></td></tr></tbody></table></div>
<p>Next, we combine the two frequency lists.</p>
<pre class="r"><code>freq_df &lt;- dplyr::left_join(corpus_words, kwic_words, by = c(&quot;token&quot;)) %&gt;%
  # rename columns and select relevant columns
  dplyr::rename(corpus = n.x,
                kwic = n.y) %&gt;%
  dplyr::select(-type.x, -type.y) %&gt;%
  # replace NA values with 0 in &#39;corpus&#39; and &#39;kwic&#39; columns
  tidyr::replace_na(list(corpus = 0, kwic = 0))</code></pre>
<div class="tabwid"><style>.cl-8eecfed0{table-layout:auto;width:50%;}.cl-8ee09f5a{font-family:'Arial';font-size:12pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-8ee09f6e{font-family:'Arial';font-size:12pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-8ee59690{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-8ee596a4{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-8ee5ba26{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8ee5ba30{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8ee5ba3a{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8ee5ba44{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8ee5ba4e{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8ee5ba4f{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8ee5ba58{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8ee5ba62{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8ee5ba63{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8ee5ba6c{background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8ee5ba76{background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8ee5ba80{background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing='true' class='cl-8eecfed0'><caption style="display:table-caption;margin:0pt;text-align:center;border-bottom: 0.00pt solid transparent;border-top: 0.00pt solid transparent;border-left: 0.00pt solid transparent;border-right: 0.00pt solid transparent;padding-top:3pt;padding-bottom:3pt;padding-left:3pt;padding-right:3pt;line-height: 1;background-color:transparent;"><span>First 10 rows of the combined frequency table</span></caption><thead><tr style="overflow-wrap:break-word;"><th class="cl-8ee5ba26"><p class="cl-8ee59690"><span class="cl-8ee09f5a">token</span></p></th><th class="cl-8ee5ba30"><p class="cl-8ee596a4"><span class="cl-8ee09f5a">corpus</span></p></th><th class="cl-8ee5ba3a"><p class="cl-8ee596a4"><span class="cl-8ee09f5a">kwic</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-8ee5ba44"><p class="cl-8ee59690"><span class="cl-8ee09f6e">a</span></p></td><td class="cl-8ee5ba4e"><p class="cl-8ee596a4"><span class="cl-8ee09f6e">3,163</span></p></td><td class="cl-8ee5ba4f"><p class="cl-8ee596a4"><span class="cl-8ee09f6e">54</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-8ee5ba58"><p class="cl-8ee59690"><span class="cl-8ee09f6e">abdomen</span></p></td><td class="cl-8ee5ba62"><p class="cl-8ee596a4"><span class="cl-8ee09f6e">3</span></p></td><td class="cl-8ee5ba63"><p class="cl-8ee596a4"><span class="cl-8ee09f6e">0</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-8ee5ba44"><p class="cl-8ee59690"><span class="cl-8ee09f6e">aberrant</span></p></td><td class="cl-8ee5ba4e"><p class="cl-8ee596a4"><span class="cl-8ee09f6e">7</span></p></td><td class="cl-8ee5ba4f"><p class="cl-8ee596a4"><span class="cl-8ee09f6e">0</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-8ee5ba58"><p class="cl-8ee59690"><span class="cl-8ee09f6e">aberration</span></p></td><td class="cl-8ee5ba62"><p class="cl-8ee596a4"><span class="cl-8ee09f6e">2</span></p></td><td class="cl-8ee5ba63"><p class="cl-8ee596a4"><span class="cl-8ee09f6e">0</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-8ee5ba44"><p class="cl-8ee59690"><span class="cl-8ee09f6e">abhorrent</span></p></td><td class="cl-8ee5ba4e"><p class="cl-8ee596a4"><span class="cl-8ee09f6e">1</span></p></td><td class="cl-8ee5ba4f"><p class="cl-8ee596a4"><span class="cl-8ee09f6e">0</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-8ee5ba58"><p class="cl-8ee59690"><span class="cl-8ee09f6e">abilities</span></p></td><td class="cl-8ee5ba62"><p class="cl-8ee596a4"><span class="cl-8ee09f6e">1</span></p></td><td class="cl-8ee5ba63"><p class="cl-8ee596a4"><span class="cl-8ee09f6e">0</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-8ee5ba44"><p class="cl-8ee59690"><span class="cl-8ee09f6e">ability</span></p></td><td class="cl-8ee5ba4e"><p class="cl-8ee596a4"><span class="cl-8ee09f6e">3</span></p></td><td class="cl-8ee5ba4f"><p class="cl-8ee596a4"><span class="cl-8ee09f6e">0</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-8ee5ba58"><p class="cl-8ee59690"><span class="cl-8ee09f6e">abjectly</span></p></td><td class="cl-8ee5ba62"><p class="cl-8ee596a4"><span class="cl-8ee09f6e">1</span></p></td><td class="cl-8ee5ba63"><p class="cl-8ee596a4"><span class="cl-8ee09f6e">0</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-8ee5ba44"><p class="cl-8ee59690"><span class="cl-8ee09f6e">able</span></p></td><td class="cl-8ee5ba4e"><p class="cl-8ee596a4"><span class="cl-8ee09f6e">54</span></p></td><td class="cl-8ee5ba4f"><p class="cl-8ee596a4"><span class="cl-8ee09f6e">2</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-8ee5ba6c"><p class="cl-8ee59690"><span class="cl-8ee09f6e">ably</span></p></td><td class="cl-8ee5ba76"><p class="cl-8ee596a4"><span class="cl-8ee09f6e">3</span></p></td><td class="cl-8ee5ba80"><p class="cl-8ee596a4"><span class="cl-8ee09f6e">0</span></p></td></tr></tbody></table></div>
<p>We now calculate the frequencies of the observed and expected
frequencies as well as the row and column totals.</p>
<pre class="r"><code>freq_df %&gt;%
  dplyr::filter(corpus &gt; 0) %&gt;%
  dplyr::mutate(corpus = as.numeric(corpus),
                kwic = as.numeric(kwic)) %&gt;%
  dplyr::mutate(corpus= corpus-kwic,
                C1 = sum(kwic),
                C2 = sum(corpus),
                N = C1 + C2) %&gt;%
  dplyr::rowwise() %&gt;%
  dplyr::mutate(R1 = corpus+kwic,
                R2 = N - R1,
                O11 = kwic,
                O12 = R1-O11,
                O21 = C1-O11,
                O22 = C2-O12) %&gt;%
  dplyr::mutate(E11 = (R1 * C1) / N,
                E12 = (R1 * C2) / N,
                E21 = (R2 * C1) / N,
                E22 = (R2 * C2) / N) %&gt;%
  dplyr::select(-corpus, -kwic) -&gt; stats_tb</code></pre>
<div class="tabwid"><style>.cl-8f664b46{table-layout:auto;width:50%;}.cl-8f50417a{font-family:'Arial';font-size:12pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-8f50418e{font-family:'Arial';font-size:12pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-8f5b02cc{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-8f5b02ea{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-8f5b3486{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8f5b3490{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8f5b349a{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8f5b34a4{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8f5b34a5{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8f5b34ae{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8f5b34b8{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8f5b34c2{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8f5b34cc{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8f5b34cd{background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8f5b34d6{background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8f5b34e0{background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing='true' class='cl-8f664b46'><caption style="display:table-caption;margin:0pt;text-align:center;border-bottom: 0.00pt solid transparent;border-top: 0.00pt solid transparent;border-left: 0.00pt solid transparent;border-right: 0.00pt solid transparent;padding-top:3pt;padding-bottom:3pt;padding-left:3pt;padding-right:3pt;line-height: 1;background-color:transparent;"><span>First 10 rows of the processed frequency table</span></caption><thead><tr style="overflow-wrap:break-word;"><th class="cl-8f5b3486"><p class="cl-8f5b02cc"><span class="cl-8f50417a">token</span></p></th><th class="cl-8f5b3490"><p class="cl-8f5b02ea"><span class="cl-8f50417a">C1</span></p></th><th class="cl-8f5b3490"><p class="cl-8f5b02ea"><span class="cl-8f50417a">C2</span></p></th><th class="cl-8f5b3490"><p class="cl-8f5b02ea"><span class="cl-8f50417a">N</span></p></th><th class="cl-8f5b3490"><p class="cl-8f5b02ea"><span class="cl-8f50417a">R1</span></p></th><th class="cl-8f5b3490"><p class="cl-8f5b02ea"><span class="cl-8f50417a">R2</span></p></th><th class="cl-8f5b3490"><p class="cl-8f5b02ea"><span class="cl-8f50417a">O11</span></p></th><th class="cl-8f5b3490"><p class="cl-8f5b02ea"><span class="cl-8f50417a">O12</span></p></th><th class="cl-8f5b3490"><p class="cl-8f5b02ea"><span class="cl-8f50417a">O21</span></p></th><th class="cl-8f5b3490"><p class="cl-8f5b02ea"><span class="cl-8f50417a">O22</span></p></th><th class="cl-8f5b3490"><p class="cl-8f5b02ea"><span class="cl-8f50417a">E11</span></p></th><th class="cl-8f5b3490"><p class="cl-8f5b02ea"><span class="cl-8f50417a">E12</span></p></th><th class="cl-8f5b3490"><p class="cl-8f5b02ea"><span class="cl-8f50417a">E21</span></p></th><th class="cl-8f5b349a"><p class="cl-8f5b02ea"><span class="cl-8f50417a">E22</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-8f5b34a4"><p class="cl-8f5b02cc"><span class="cl-8f50418e">a</span></p></td><td class="cl-8f5b34a5"><p class="cl-8f5b02ea"><span class="cl-8f50418e">5,830</span></p></td><td class="cl-8f5b34a5"><p class="cl-8f5b02ea"><span class="cl-8f50418e">188,275</span></p></td><td class="cl-8f5b34a5"><p class="cl-8f5b02ea"><span class="cl-8f50418e">194,105</span></p></td><td class="cl-8f5b34a5"><p class="cl-8f5b02ea"><span class="cl-8f50418e">3,163</span></p></td><td class="cl-8f5b34a5"><p class="cl-8f5b02ea"><span class="cl-8f50418e">190,942</span></p></td><td class="cl-8f5b34a5"><p class="cl-8f5b02ea"><span class="cl-8f50418e">54</span></p></td><td class="cl-8f5b34a5"><p class="cl-8f5b02ea"><span class="cl-8f50418e">3,109</span></p></td><td class="cl-8f5b34a5"><p class="cl-8f5b02ea"><span class="cl-8f50418e">5,776</span></p></td><td class="cl-8f5b34a5"><p class="cl-8f5b02ea"><span class="cl-8f50418e">185,166</span></p></td><td class="cl-8f5b34a5"><p class="cl-8f5b02ea"><span class="cl-8f50418e">95.00162283</span></p></td><td class="cl-8f5b34a5"><p class="cl-8f5b02ea"><span class="cl-8f50418e">3,067.9983772</span></p></td><td class="cl-8f5b34a5"><p class="cl-8f5b02ea"><span class="cl-8f50418e">5,734.998</span></p></td><td class="cl-8f5b34ae"><p class="cl-8f5b02ea"><span class="cl-8f50418e">185,207.0</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-8f5b34b8"><p class="cl-8f5b02cc"><span class="cl-8f50418e">abdomen</span></p></td><td class="cl-8f5b34c2"><p class="cl-8f5b02ea"><span class="cl-8f50418e">5,830</span></p></td><td class="cl-8f5b34c2"><p class="cl-8f5b02ea"><span class="cl-8f50418e">188,275</span></p></td><td class="cl-8f5b34c2"><p class="cl-8f5b02ea"><span class="cl-8f50418e">194,105</span></p></td><td class="cl-8f5b34c2"><p class="cl-8f5b02ea"><span class="cl-8f50418e">3</span></p></td><td class="cl-8f5b34c2"><p class="cl-8f5b02ea"><span class="cl-8f50418e">194,102</span></p></td><td class="cl-8f5b34c2"><p class="cl-8f5b02ea"><span class="cl-8f50418e">0</span></p></td><td class="cl-8f5b34c2"><p class="cl-8f5b02ea"><span class="cl-8f50418e">3</span></p></td><td class="cl-8f5b34c2"><p class="cl-8f5b02ea"><span class="cl-8f50418e">5,830</span></p></td><td class="cl-8f5b34c2"><p class="cl-8f5b02ea"><span class="cl-8f50418e">188,272</span></p></td><td class="cl-8f5b34c2"><p class="cl-8f5b02ea"><span class="cl-8f50418e">0.09010587</span></p></td><td class="cl-8f5b34c2"><p class="cl-8f5b02ea"><span class="cl-8f50418e">2.9098941</span></p></td><td class="cl-8f5b34c2"><p class="cl-8f5b02ea"><span class="cl-8f50418e">5,829.910</span></p></td><td class="cl-8f5b34cc"><p class="cl-8f5b02ea"><span class="cl-8f50418e">188,272.1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-8f5b34a4"><p class="cl-8f5b02cc"><span class="cl-8f50418e">aberrant</span></p></td><td class="cl-8f5b34a5"><p class="cl-8f5b02ea"><span class="cl-8f50418e">5,830</span></p></td><td class="cl-8f5b34a5"><p class="cl-8f5b02ea"><span class="cl-8f50418e">188,275</span></p></td><td class="cl-8f5b34a5"><p class="cl-8f5b02ea"><span class="cl-8f50418e">194,105</span></p></td><td class="cl-8f5b34a5"><p class="cl-8f5b02ea"><span class="cl-8f50418e">7</span></p></td><td class="cl-8f5b34a5"><p class="cl-8f5b02ea"><span class="cl-8f50418e">194,098</span></p></td><td class="cl-8f5b34a5"><p class="cl-8f5b02ea"><span class="cl-8f50418e">0</span></p></td><td class="cl-8f5b34a5"><p class="cl-8f5b02ea"><span class="cl-8f50418e">7</span></p></td><td class="cl-8f5b34a5"><p class="cl-8f5b02ea"><span class="cl-8f50418e">5,830</span></p></td><td class="cl-8f5b34a5"><p class="cl-8f5b02ea"><span class="cl-8f50418e">188,268</span></p></td><td class="cl-8f5b34a5"><p class="cl-8f5b02ea"><span class="cl-8f50418e">0.21024703</span></p></td><td class="cl-8f5b34a5"><p class="cl-8f5b02ea"><span class="cl-8f50418e">6.7897530</span></p></td><td class="cl-8f5b34a5"><p class="cl-8f5b02ea"><span class="cl-8f50418e">5,829.790</span></p></td><td class="cl-8f5b34ae"><p class="cl-8f5b02ea"><span class="cl-8f50418e">188,268.2</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-8f5b34b8"><p class="cl-8f5b02cc"><span class="cl-8f50418e">aberration</span></p></td><td class="cl-8f5b34c2"><p class="cl-8f5b02ea"><span class="cl-8f50418e">5,830</span></p></td><td class="cl-8f5b34c2"><p class="cl-8f5b02ea"><span class="cl-8f50418e">188,275</span></p></td><td class="cl-8f5b34c2"><p class="cl-8f5b02ea"><span class="cl-8f50418e">194,105</span></p></td><td class="cl-8f5b34c2"><p class="cl-8f5b02ea"><span class="cl-8f50418e">2</span></p></td><td class="cl-8f5b34c2"><p class="cl-8f5b02ea"><span class="cl-8f50418e">194,103</span></p></td><td class="cl-8f5b34c2"><p class="cl-8f5b02ea"><span class="cl-8f50418e">0</span></p></td><td class="cl-8f5b34c2"><p class="cl-8f5b02ea"><span class="cl-8f50418e">2</span></p></td><td class="cl-8f5b34c2"><p class="cl-8f5b02ea"><span class="cl-8f50418e">5,830</span></p></td><td class="cl-8f5b34c2"><p class="cl-8f5b02ea"><span class="cl-8f50418e">188,273</span></p></td><td class="cl-8f5b34c2"><p class="cl-8f5b02ea"><span class="cl-8f50418e">0.06007058</span></p></td><td class="cl-8f5b34c2"><p class="cl-8f5b02ea"><span class="cl-8f50418e">1.9399294</span></p></td><td class="cl-8f5b34c2"><p class="cl-8f5b02ea"><span class="cl-8f50418e">5,829.940</span></p></td><td class="cl-8f5b34cc"><p class="cl-8f5b02ea"><span class="cl-8f50418e">188,273.1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-8f5b34a4"><p class="cl-8f5b02cc"><span class="cl-8f50418e">abhorrent</span></p></td><td class="cl-8f5b34a5"><p class="cl-8f5b02ea"><span class="cl-8f50418e">5,830</span></p></td><td class="cl-8f5b34a5"><p class="cl-8f5b02ea"><span class="cl-8f50418e">188,275</span></p></td><td class="cl-8f5b34a5"><p class="cl-8f5b02ea"><span class="cl-8f50418e">194,105</span></p></td><td class="cl-8f5b34a5"><p class="cl-8f5b02ea"><span class="cl-8f50418e">1</span></p></td><td class="cl-8f5b34a5"><p class="cl-8f5b02ea"><span class="cl-8f50418e">194,104</span></p></td><td class="cl-8f5b34a5"><p class="cl-8f5b02ea"><span class="cl-8f50418e">0</span></p></td><td class="cl-8f5b34a5"><p class="cl-8f5b02ea"><span class="cl-8f50418e">1</span></p></td><td class="cl-8f5b34a5"><p class="cl-8f5b02ea"><span class="cl-8f50418e">5,830</span></p></td><td class="cl-8f5b34a5"><p class="cl-8f5b02ea"><span class="cl-8f50418e">188,274</span></p></td><td class="cl-8f5b34a5"><p class="cl-8f5b02ea"><span class="cl-8f50418e">0.03003529</span></p></td><td class="cl-8f5b34a5"><p class="cl-8f5b02ea"><span class="cl-8f50418e">0.9699647</span></p></td><td class="cl-8f5b34a5"><p class="cl-8f5b02ea"><span class="cl-8f50418e">5,829.970</span></p></td><td class="cl-8f5b34ae"><p class="cl-8f5b02ea"><span class="cl-8f50418e">188,274.0</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-8f5b34b8"><p class="cl-8f5b02cc"><span class="cl-8f50418e">abilities</span></p></td><td class="cl-8f5b34c2"><p class="cl-8f5b02ea"><span class="cl-8f50418e">5,830</span></p></td><td class="cl-8f5b34c2"><p class="cl-8f5b02ea"><span class="cl-8f50418e">188,275</span></p></td><td class="cl-8f5b34c2"><p class="cl-8f5b02ea"><span class="cl-8f50418e">194,105</span></p></td><td class="cl-8f5b34c2"><p class="cl-8f5b02ea"><span class="cl-8f50418e">1</span></p></td><td class="cl-8f5b34c2"><p class="cl-8f5b02ea"><span class="cl-8f50418e">194,104</span></p></td><td class="cl-8f5b34c2"><p class="cl-8f5b02ea"><span class="cl-8f50418e">0</span></p></td><td class="cl-8f5b34c2"><p class="cl-8f5b02ea"><span class="cl-8f50418e">1</span></p></td><td class="cl-8f5b34c2"><p class="cl-8f5b02ea"><span class="cl-8f50418e">5,830</span></p></td><td class="cl-8f5b34c2"><p class="cl-8f5b02ea"><span class="cl-8f50418e">188,274</span></p></td><td class="cl-8f5b34c2"><p class="cl-8f5b02ea"><span class="cl-8f50418e">0.03003529</span></p></td><td class="cl-8f5b34c2"><p class="cl-8f5b02ea"><span class="cl-8f50418e">0.9699647</span></p></td><td class="cl-8f5b34c2"><p class="cl-8f5b02ea"><span class="cl-8f50418e">5,829.970</span></p></td><td class="cl-8f5b34cc"><p class="cl-8f5b02ea"><span class="cl-8f50418e">188,274.0</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-8f5b34a4"><p class="cl-8f5b02cc"><span class="cl-8f50418e">ability</span></p></td><td class="cl-8f5b34a5"><p class="cl-8f5b02ea"><span class="cl-8f50418e">5,830</span></p></td><td class="cl-8f5b34a5"><p class="cl-8f5b02ea"><span class="cl-8f50418e">188,275</span></p></td><td class="cl-8f5b34a5"><p class="cl-8f5b02ea"><span class="cl-8f50418e">194,105</span></p></td><td class="cl-8f5b34a5"><p class="cl-8f5b02ea"><span class="cl-8f50418e">3</span></p></td><td class="cl-8f5b34a5"><p class="cl-8f5b02ea"><span class="cl-8f50418e">194,102</span></p></td><td class="cl-8f5b34a5"><p class="cl-8f5b02ea"><span class="cl-8f50418e">0</span></p></td><td class="cl-8f5b34a5"><p class="cl-8f5b02ea"><span class="cl-8f50418e">3</span></p></td><td class="cl-8f5b34a5"><p class="cl-8f5b02ea"><span class="cl-8f50418e">5,830</span></p></td><td class="cl-8f5b34a5"><p class="cl-8f5b02ea"><span class="cl-8f50418e">188,272</span></p></td><td class="cl-8f5b34a5"><p class="cl-8f5b02ea"><span class="cl-8f50418e">0.09010587</span></p></td><td class="cl-8f5b34a5"><p class="cl-8f5b02ea"><span class="cl-8f50418e">2.9098941</span></p></td><td class="cl-8f5b34a5"><p class="cl-8f5b02ea"><span class="cl-8f50418e">5,829.910</span></p></td><td class="cl-8f5b34ae"><p class="cl-8f5b02ea"><span class="cl-8f50418e">188,272.1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-8f5b34b8"><p class="cl-8f5b02cc"><span class="cl-8f50418e">abjectly</span></p></td><td class="cl-8f5b34c2"><p class="cl-8f5b02ea"><span class="cl-8f50418e">5,830</span></p></td><td class="cl-8f5b34c2"><p class="cl-8f5b02ea"><span class="cl-8f50418e">188,275</span></p></td><td class="cl-8f5b34c2"><p class="cl-8f5b02ea"><span class="cl-8f50418e">194,105</span></p></td><td class="cl-8f5b34c2"><p class="cl-8f5b02ea"><span class="cl-8f50418e">1</span></p></td><td class="cl-8f5b34c2"><p class="cl-8f5b02ea"><span class="cl-8f50418e">194,104</span></p></td><td class="cl-8f5b34c2"><p class="cl-8f5b02ea"><span class="cl-8f50418e">0</span></p></td><td class="cl-8f5b34c2"><p class="cl-8f5b02ea"><span class="cl-8f50418e">1</span></p></td><td class="cl-8f5b34c2"><p class="cl-8f5b02ea"><span class="cl-8f50418e">5,830</span></p></td><td class="cl-8f5b34c2"><p class="cl-8f5b02ea"><span class="cl-8f50418e">188,274</span></p></td><td class="cl-8f5b34c2"><p class="cl-8f5b02ea"><span class="cl-8f50418e">0.03003529</span></p></td><td class="cl-8f5b34c2"><p class="cl-8f5b02ea"><span class="cl-8f50418e">0.9699647</span></p></td><td class="cl-8f5b34c2"><p class="cl-8f5b02ea"><span class="cl-8f50418e">5,829.970</span></p></td><td class="cl-8f5b34cc"><p class="cl-8f5b02ea"><span class="cl-8f50418e">188,274.0</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-8f5b34a4"><p class="cl-8f5b02cc"><span class="cl-8f50418e">able</span></p></td><td class="cl-8f5b34a5"><p class="cl-8f5b02ea"><span class="cl-8f50418e">5,830</span></p></td><td class="cl-8f5b34a5"><p class="cl-8f5b02ea"><span class="cl-8f50418e">188,275</span></p></td><td class="cl-8f5b34a5"><p class="cl-8f5b02ea"><span class="cl-8f50418e">194,105</span></p></td><td class="cl-8f5b34a5"><p class="cl-8f5b02ea"><span class="cl-8f50418e">54</span></p></td><td class="cl-8f5b34a5"><p class="cl-8f5b02ea"><span class="cl-8f50418e">194,051</span></p></td><td class="cl-8f5b34a5"><p class="cl-8f5b02ea"><span class="cl-8f50418e">2</span></p></td><td class="cl-8f5b34a5"><p class="cl-8f5b02ea"><span class="cl-8f50418e">52</span></p></td><td class="cl-8f5b34a5"><p class="cl-8f5b02ea"><span class="cl-8f50418e">5,828</span></p></td><td class="cl-8f5b34a5"><p class="cl-8f5b02ea"><span class="cl-8f50418e">188,223</span></p></td><td class="cl-8f5b34a5"><p class="cl-8f5b02ea"><span class="cl-8f50418e">1.62190567</span></p></td><td class="cl-8f5b34a5"><p class="cl-8f5b02ea"><span class="cl-8f50418e">52.3780943</span></p></td><td class="cl-8f5b34a5"><p class="cl-8f5b02ea"><span class="cl-8f50418e">5,828.378</span></p></td><td class="cl-8f5b34ae"><p class="cl-8f5b02ea"><span class="cl-8f50418e">188,222.6</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-8f5b34cd"><p class="cl-8f5b02cc"><span class="cl-8f50418e">ably</span></p></td><td class="cl-8f5b34d6"><p class="cl-8f5b02ea"><span class="cl-8f50418e">5,830</span></p></td><td class="cl-8f5b34d6"><p class="cl-8f5b02ea"><span class="cl-8f50418e">188,275</span></p></td><td class="cl-8f5b34d6"><p class="cl-8f5b02ea"><span class="cl-8f50418e">194,105</span></p></td><td class="cl-8f5b34d6"><p class="cl-8f5b02ea"><span class="cl-8f50418e">3</span></p></td><td class="cl-8f5b34d6"><p class="cl-8f5b02ea"><span class="cl-8f50418e">194,102</span></p></td><td class="cl-8f5b34d6"><p class="cl-8f5b02ea"><span class="cl-8f50418e">0</span></p></td><td class="cl-8f5b34d6"><p class="cl-8f5b02ea"><span class="cl-8f50418e">3</span></p></td><td class="cl-8f5b34d6"><p class="cl-8f5b02ea"><span class="cl-8f50418e">5,830</span></p></td><td class="cl-8f5b34d6"><p class="cl-8f5b02ea"><span class="cl-8f50418e">188,272</span></p></td><td class="cl-8f5b34d6"><p class="cl-8f5b02ea"><span class="cl-8f50418e">0.09010587</span></p></td><td class="cl-8f5b34d6"><p class="cl-8f5b02ea"><span class="cl-8f50418e">2.9098941</span></p></td><td class="cl-8f5b34d6"><p class="cl-8f5b02ea"><span class="cl-8f50418e">5,829.910</span></p></td><td class="cl-8f5b34e0"><p class="cl-8f5b02ea"><span class="cl-8f50418e">188,272.1</span></p></td></tr></tbody></table></div>
<p>To determine which terms collocate significantly and with what
association strength, we use the following information (that is provided
by the table above):</p>
<ul>
<li><p>O11 = Number of times word<sub>x</sub> occurs in
<code>kwic</code></p></li>
<li><p>O12 = Number of times word<sub>x</sub> occurs in
<code>corpus</code> (without <code>kwic</code>)</p></li>
<li><p>O21 = Number of times other words occur in
<code>kwic</code></p></li>
<li><p>O22 = Number of times other words occur in
<code>corpus</code></p></li>
</ul>
<p>Example:</p>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="center">kwic</th>
<th align="right">corpus</th>
<th></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><strong>token</strong></td>
<td align="center">O<sub>11</sub></td>
<td align="right">O<sub>12</sub></td>
<td>= R<sub>1</sub></td>
</tr>
<tr class="even">
<td align="left"><strong>other tokens</strong></td>
<td align="center">O<sub>21</sub></td>
<td align="right">O<sub>22</sub></td>
<td>= R<sub>2</sub></td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="center">= C<sub>1</sub></td>
<td align="right">= C<sub>2</sub></td>
<td>= N</td>
</tr>
</tbody>
</table>
<pre class="r"><code>stats_tb %&gt;%
    # work row-wise
    dplyr::rowwise() %&gt;%
    # calculate fishers&#39; exact test
    dplyr::mutate(p = as.vector(unlist(fisher.test(matrix(c(O11, O12, O21, O22), 
                                                        ncol = 2, byrow = T))[1]))) %&gt;%

    # extract x2 statistics
    dplyr::mutate(X2 = (O11-E11)^2/E11 + (O12-E12)^2/E12 + (O21-E21)^2/E21 + (O22-E22)^2/E22) %&gt;%
    # extract expected frequency
    dplyr::mutate(Exp = E11) %&gt;%

    # extract association measures
    dplyr::mutate(phi = sqrt((X2 / N)),
                Dice = (2 * O11) / (R1 + C1),
                MI = log2(O11 / E11),
                t.score = (O11 - E11) / sqrt(O11),
                z.score = (O11 - E11) / sqrt(E11),
                PMI = log2( (O11 / N) / ((O11+O12) / N) * 
                              ((O11+O21) / N) ),
                DeltaP12 = (O11 / (O11 + O12)) - (O21 / (O21 + O22)),
                DeltaP21 =  (O11 / (O11 + O21)) - (O21 / (O12 + O22)),
                DP = (O11 / R1) - (O21 / R2),
                OddsRatio = log(((O11 + 0.5) * (O22 + 0.5))  / ( (O12 + 0.5) * (O21 + 0.5) )),
                # calculate LL aka G2
                G2 = 2 * (O11 * log(O11 / E11) + O12 * log(O12 / E12) + O21 * log(O21 / E21) + O22 * log(O22 / E22))) %&gt;%

    # simplify significance
    dplyr::mutate(Significance = dplyr::case_when(p &lt;= .001 ~ &quot;p&lt;.001&quot;,
                                                p &lt;= .01 ~ &quot;p&lt;.01&quot;,
                                                p &lt;= .05 ~ &quot;p&lt;.05&quot;, 
                                                TRUE ~ &quot;n.s.&quot;)) %&gt;%
    # round p-value

    dplyr::mutate(p = round(p, 5)) %&gt;%
    # filter out non significant results
    dplyr::filter(Significance != &quot;n.s.&quot;,
                # filter out instances where the w1 and w2 repel each other
                E11 &lt; O11) %&gt;%
    # arrange by phi (association measure)
    dplyr::arrange(-phi) %&gt;%
    # remove superfluous columns
    dplyr::select(-any_of(c(&quot;TermCoocFreq&quot;, &quot;AllFreq&quot;, &quot;NRows&quot;, &quot;E12&quot;, &quot;E21&quot;, 
                            &quot;E22&quot;, &quot;O12&quot;, &quot;O21&quot;, &quot;O22&quot;, &quot;R1&quot;, &quot;R2&quot;, &quot;C1&quot;, &quot;C2&quot;, &quot;Exp&quot;))) -&gt; assoc_tb2</code></pre>
<div class="tabwid"><style>.cl-93befbca{table-layout:auto;width:50%;}.cl-93afbeb2{font-family:'Arial';font-size:12pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-93afbec6{font-family:'Arial';font-size:12pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-93b4abf2{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-93b4abfc{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-93b4d276{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-93b4d280{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-93b4d281{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-93b4d28a{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-93b4d28b{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-93b4d294{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-93b4d295{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-93b4d296{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-93b4d29e{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-93b4d29f{background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-93b4d2a0{background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-93b4d2a8{background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing='true' class='cl-93befbca'><caption style="display:table-caption;margin:0pt;text-align:center;border-bottom: 0.00pt solid transparent;border-top: 0.00pt solid transparent;border-left: 0.00pt solid transparent;border-right: 0.00pt solid transparent;padding-top:3pt;padding-bottom:3pt;padding-left:3pt;padding-right:3pt;line-height: 1;background-color:transparent;"><span>First 10 rows of the association statistic table</span></caption><thead><tr style="overflow-wrap:break-word;"><th class="cl-93b4d276"><p class="cl-93b4abf2"><span class="cl-93afbeb2">token</span></p></th><th class="cl-93b4d280"><p class="cl-93b4abfc"><span class="cl-93afbeb2">N</span></p></th><th class="cl-93b4d280"><p class="cl-93b4abfc"><span class="cl-93afbeb2">O11</span></p></th><th class="cl-93b4d280"><p class="cl-93b4abfc"><span class="cl-93afbeb2">E11</span></p></th><th class="cl-93b4d280"><p class="cl-93b4abfc"><span class="cl-93afbeb2">p</span></p></th><th class="cl-93b4d280"><p class="cl-93b4abfc"><span class="cl-93afbeb2">X2</span></p></th><th class="cl-93b4d280"><p class="cl-93b4abfc"><span class="cl-93afbeb2">phi</span></p></th><th class="cl-93b4d280"><p class="cl-93b4abfc"><span class="cl-93afbeb2">Dice</span></p></th><th class="cl-93b4d280"><p class="cl-93b4abfc"><span class="cl-93afbeb2">MI</span></p></th><th class="cl-93b4d280"><p class="cl-93b4abfc"><span class="cl-93afbeb2">t.score</span></p></th><th class="cl-93b4d280"><p class="cl-93b4abfc"><span class="cl-93afbeb2">z.score</span></p></th><th class="cl-93b4d280"><p class="cl-93b4abfc"><span class="cl-93afbeb2">PMI</span></p></th><th class="cl-93b4d280"><p class="cl-93b4abfc"><span class="cl-93afbeb2">DeltaP12</span></p></th><th class="cl-93b4d280"><p class="cl-93b4abfc"><span class="cl-93afbeb2">DeltaP21</span></p></th><th class="cl-93b4d280"><p class="cl-93b4abfc"><span class="cl-93afbeb2">DP</span></p></th><th class="cl-93b4d280"><p class="cl-93b4abfc"><span class="cl-93afbeb2">OddsRatio</span></p></th><th class="cl-93b4d280"><p class="cl-93b4abfc"><span class="cl-93afbeb2">G2</span></p></th><th class="cl-93b4d281"><p class="cl-93b4abf2"><span class="cl-93afbeb2">Significance</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-93b4d28a"><p class="cl-93b4abf2"><span class="cl-93afbec6">selection</span></p></td><td class="cl-93b4d28b"><p class="cl-93b4abfc"><span class="cl-93afbec6">194,105</span></p></td><td class="cl-93b4d28b"><p class="cl-93b4abfc"><span class="cl-93afbec6">540</span></p></td><td class="cl-93b4d28b"><p class="cl-93b4abfc"><span class="cl-93afbec6">16.2190567</span></p></td><td class="cl-93b4d28b"><p class="cl-93b4abfc"><span class="cl-93afbec6">0</span></p></td><td class="cl-93b4d28b"><p class="cl-93b4abfc"><span class="cl-93afbec6">17,487.5010</span></p></td><td class="cl-93b4d28b"><p class="cl-93b4abfc"><span class="cl-93afbec6">0.30015495</span></p></td><td class="cl-93b4d28b"><p class="cl-93b4abfc"><span class="cl-93afbec6">0.169544741</span></p></td><td class="cl-93b4d28b"><p class="cl-93b4abfc"><span class="cl-93afbec6">5.057198</span></p></td><td class="cl-93b4d28b"><p class="cl-93b4abfc"><span class="cl-93afbec6">22.539943</span></p></td><td class="cl-93b4d28b"><p class="cl-93b4abfc"><span class="cl-93afbec6">130.05795</span></p></td><td class="cl-93b4d28b"><p class="cl-93b4abfc"><span class="cl-93afbec6">-5.057198</span></p></td><td class="cl-93b4d28b"><p class="cl-93b4abfc"><span class="cl-93afbec6">0.97267068</span></p></td><td class="cl-93b4d28b"><p class="cl-93b4abfc"><span class="cl-93afbec6">0.064527159</span></p></td><td class="cl-93b4d28b"><p class="cl-93b4abfc"><span class="cl-93afbec6">0.97267068</span></p></td><td class="cl-93b4d28b"><p class="cl-93b4abfc"><span class="cl-93afbec6">10.557635</span></p></td><td class="cl-93b4d28b"><p class="cl-93b4abfc"><span class="cl-93afbec6"></span></p></td><td class="cl-93b4d294"><p class="cl-93b4abf2"><span class="cl-93afbec6">p&lt;.001</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-93b4d295"><p class="cl-93b4abf2"><span class="cl-93afbec6">natural</span></p></td><td class="cl-93b4d296"><p class="cl-93b4abfc"><span class="cl-93afbec6">194,105</span></p></td><td class="cl-93b4d296"><p class="cl-93b4abfc"><span class="cl-93afbec6">407</span></p></td><td class="cl-93b4d296"><p class="cl-93b4abfc"><span class="cl-93afbec6">15.6183509</span></p></td><td class="cl-93b4d296"><p class="cl-93b4abfc"><span class="cl-93afbec6">0</span></p></td><td class="cl-93b4d296"><p class="cl-93b4abfc"><span class="cl-93afbec6">10,138.5262</span></p></td><td class="cl-93b4d296"><p class="cl-93b4abfc"><span class="cl-93afbec6">0.22854359</span></p></td><td class="cl-93b4d296"><p class="cl-93b4abfc"><span class="cl-93afbec6">0.128188976</span></p></td><td class="cl-93b4d296"><p class="cl-93b4abfc"><span class="cl-93afbec6">4.703715</span></p></td><td class="cl-93b4d296"><p class="cl-93b4abfc"><span class="cl-93afbec6">19.400068</span></p></td><td class="cl-93b4d296"><p class="cl-93b4abfc"><span class="cl-93afbec6">99.03367</span></p></td><td class="cl-93b4d296"><p class="cl-93b4abfc"><span class="cl-93afbec6">-5.410680</span></p></td><td class="cl-93b4d296"><p class="cl-93b4abfc"><span class="cl-93afbec6">0.75467877</span></p></td><td class="cl-93b4d296"><p class="cl-93b4abfc"><span class="cl-93afbec6">0.041007709</span></p></td><td class="cl-93b4d296"><p class="cl-93b4abfc"><span class="cl-93afbec6">0.75467877</span></p></td><td class="cl-93b4d296"><p class="cl-93b4abfc"><span class="cl-93afbec6">4.824803</span></p></td><td class="cl-93b4d296"><p class="cl-93b4abfc"><span class="cl-93afbec6">2,343.62679</span></p></td><td class="cl-93b4d29e"><p class="cl-93b4abf2"><span class="cl-93afbec6">p&lt;.001</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-93b4d28a"><p class="cl-93b4abf2"><span class="cl-93afbec6">through</span></p></td><td class="cl-93b4d28b"><p class="cl-93b4abfc"><span class="cl-93afbec6">194,105</span></p></td><td class="cl-93b4d28b"><p class="cl-93b4abfc"><span class="cl-93afbec6">104</span></p></td><td class="cl-93b4d28b"><p class="cl-93b4abfc"><span class="cl-93afbec6">7.5088225</span></p></td><td class="cl-93b4d28b"><p class="cl-93b4abfc"><span class="cl-93afbec6">0</span></p></td><td class="cl-93b4d28b"><p class="cl-93b4abfc"><span class="cl-93afbec6">1,279.9917</span></p></td><td class="cl-93b4d28b"><p class="cl-93b4abfc"><span class="cl-93afbec6">0.08120546</span></p></td><td class="cl-93b4d28b"><p class="cl-93b4abfc"><span class="cl-93afbec6">0.034210526</span></p></td><td class="cl-93b4d28b"><p class="cl-93b4abfc"><span class="cl-93afbec6">3.791853</span></p></td><td class="cl-93b4d28b"><p class="cl-93b4abfc"><span class="cl-93afbec6">9.461738</span></p></td><td class="cl-93b4d28b"><p class="cl-93b4abfc"><span class="cl-93afbec6">35.21289</span></p></td><td class="cl-93b4d28b"><p class="cl-93b4abfc"><span class="cl-93afbec6">-6.322542</span></p></td><td class="cl-93b4d28b"><p class="cl-93b4abfc"><span class="cl-93afbec6">0.38646246</span></p></td><td class="cl-93b4d28b"><p class="cl-93b4abfc"><span class="cl-93afbec6">-0.012574195</span></p></td><td class="cl-93b4d28b"><p class="cl-93b4abfc"><span class="cl-93afbec6">0.38646246</span></p></td><td class="cl-93b4d28b"><p class="cl-93b4abfc"><span class="cl-93afbec6">3.154188</span></p></td><td class="cl-93b4d28b"><p class="cl-93b4abfc"><span class="cl-93afbec6">400.19768</span></p></td><td class="cl-93b4d294"><p class="cl-93b4abf2"><span class="cl-93afbec6">p&lt;.001</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-93b4d295"><p class="cl-93b4abf2"><span class="cl-93afbec6">theory</span></p></td><td class="cl-93b4d296"><p class="cl-93b4abfc"><span class="cl-93afbec6">194,105</span></p></td><td class="cl-93b4d296"><p class="cl-93b4abfc"><span class="cl-93afbec6">54</span></p></td><td class="cl-93b4d296"><p class="cl-93b4abfc"><span class="cl-93afbec6">4.8056464</span></p></td><td class="cl-93b4d296"><p class="cl-93b4abfc"><span class="cl-93afbec6">0</span></p></td><td class="cl-93b4d296"><p class="cl-93b4abfc"><span class="cl-93afbec6">519.6141</span></p></td><td class="cl-93b4d296"><p class="cl-93b4abfc"><span class="cl-93afbec6">0.05173948</span></p></td><td class="cl-93b4d296"><p class="cl-93b4abfc"><span class="cl-93afbec6">0.018030050</span></p></td><td class="cl-93b4d296"><p class="cl-93b4abfc"><span class="cl-93afbec6">3.490157</span></p></td><td class="cl-93b4d296"><p class="cl-93b4abfc"><span class="cl-93afbec6">6.694504</span></p></td><td class="cl-93b4d296"><p class="cl-93b4abfc"><span class="cl-93afbec6">22.44085</span></p></td><td class="cl-93b4d296"><p class="cl-93b4abfc"><span class="cl-93afbec6">-6.624238</span></p></td><td class="cl-93b4d296"><p class="cl-93b4abfc"><span class="cl-93afbec6">0.30771836</span></p></td><td class="cl-93b4d296"><p class="cl-93b4abfc"><span class="cl-93afbec6">-0.021416093</span></p></td><td class="cl-93b4d296"><p class="cl-93b4abfc"><span class="cl-93afbec6">0.30771836</span></p></td><td class="cl-93b4d296"><p class="cl-93b4abfc"><span class="cl-93afbec6">2.813601</span></p></td><td class="cl-93b4d296"><p class="cl-93b4abfc"><span class="cl-93afbec6">180.87958</span></p></td><td class="cl-93b4d29e"><p class="cl-93b4abf2"><span class="cl-93afbec6">p&lt;.001</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-93b4d28a"><p class="cl-93b4abf2"><span class="cl-93afbec6">unconscious</span></p></td><td class="cl-93b4d28b"><p class="cl-93b4abfc"><span class="cl-93afbec6">194,105</span></p></td><td class="cl-93b4d28b"><p class="cl-93b4abfc"><span class="cl-93afbec6">16</span></p></td><td class="cl-93b4d28b"><p class="cl-93b4abfc"><span class="cl-93afbec6">0.5105999</span></p></td><td class="cl-93b4d28b"><p class="cl-93b4abfc"><span class="cl-93afbec6">0</span></p></td><td class="cl-93b4d28b"><p class="cl-93b4abfc"><span class="cl-93afbec6">484.4741</span></p></td><td class="cl-93b4d28b"><p class="cl-93b4abfc"><span class="cl-93afbec6">0.04995937</span></p></td><td class="cl-93b4d28b"><p class="cl-93b4abfc"><span class="cl-93afbec6">0.005472892</span></p></td><td class="cl-93b4d28b"><p class="cl-93b4abfc"><span class="cl-93afbec6">4.969735</span></p></td><td class="cl-93b4d28b"><p class="cl-93b4abfc"><span class="cl-93afbec6">3.872350</span></p></td><td class="cl-93b4d28b"><p class="cl-93b4abfc"><span class="cl-93afbec6">21.67675</span></p></td><td class="cl-93b4d28b"><p class="cl-93b4abfc"><span class="cl-93afbec6">-5.144660</span></p></td><td class="cl-93b4d28b"><p class="cl-93b4abfc"><span class="cl-93afbec6">0.91122099</span></p></td><td class="cl-93b4d28b"><p class="cl-93b4abfc"><span class="cl-93afbec6">-0.028135936</span></p></td><td class="cl-93b4d28b"><p class="cl-93b4abfc"><span class="cl-93afbec6">0.91122099</span></p></td><td class="cl-93b4d28b"><p class="cl-93b4abfc"><span class="cl-93afbec6">5.875441</span></p></td><td class="cl-93b4d28b"><p class="cl-93b4abfc"><span class="cl-93afbec6">104.66928</span></p></td><td class="cl-93b4d294"><p class="cl-93b4abf2"><span class="cl-93afbec6">p&lt;.001</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-93b4d295"><p class="cl-93b4abf2"><span class="cl-93afbec6">methodical</span></p></td><td class="cl-93b4d296"><p class="cl-93b4abfc"><span class="cl-93afbec6">194,105</span></p></td><td class="cl-93b4d296"><p class="cl-93b4abfc"><span class="cl-93afbec6">10</span></p></td><td class="cl-93b4d296"><p class="cl-93b4abfc"><span class="cl-93afbec6">0.3003529</span></p></td><td class="cl-93b4d296"><p class="cl-93b4abfc"><span class="cl-93afbec6">0</span></p></td><td class="cl-93b4d296"><p class="cl-93b4abfc"><span class="cl-93afbec6">322.9583</span></p></td><td class="cl-93b4d296"><p class="cl-93b4abfc"><span class="cl-93afbec6">0.04079011</span></p></td><td class="cl-93b4d296"><p class="cl-93b4abfc"><span class="cl-93afbec6">0.003424658</span></p></td><td class="cl-93b4d296"><p class="cl-93b4abfc"><span class="cl-93afbec6">5.057198</span></p></td><td class="cl-93b4d296"><p class="cl-93b4abfc"><span class="cl-93afbec6">3.067298</span></p></td><td class="cl-93b4d296"><p class="cl-93b4abfc"><span class="cl-93afbec6">17.69864</span></p></td><td class="cl-93b4d296"><p class="cl-93b4abfc"><span class="cl-93afbec6">-5.057198</span></p></td><td class="cl-93b4d296"><p class="cl-93b4abfc"><span class="cl-93afbec6">0.97001468</span></p></td><td class="cl-93b4d296"><p class="cl-93b4abfc"><span class="cl-93afbec6">-0.029196964</span></p></td><td class="cl-93b4d296"><p class="cl-93b4abfc"><span class="cl-93afbec6">0.97001468</span></p></td><td class="cl-93b4d296"><p class="cl-93b4abfc"><span class="cl-93afbec6">6.521043</span></p></td><td class="cl-93b4d296"><p class="cl-93b4abfc"><span class="cl-93afbec6"></span></p></td><td class="cl-93b4d29e"><p class="cl-93b4abf2"><span class="cl-93afbec6">p&lt;.001</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-93b4d28a"><p class="cl-93b4abf2"><span class="cl-93afbec6">acts</span></p></td><td class="cl-93b4d28b"><p class="cl-93b4abfc"><span class="cl-93afbec6">194,105</span></p></td><td class="cl-93b4d28b"><p class="cl-93b4abfc"><span class="cl-93afbec6">18</span></p></td><td class="cl-93b4d28b"><p class="cl-93b4abfc"><span class="cl-93afbec6">0.9310940</span></p></td><td class="cl-93b4d28b"><p class="cl-93b4abfc"><span class="cl-93afbec6">0</span></p></td><td class="cl-93b4d28b"><p class="cl-93b4abfc"><span class="cl-93afbec6">322.6497</span></p></td><td class="cl-93b4d28b"><p class="cl-93b4abfc"><span class="cl-93afbec6">0.04077062</span></p></td><td class="cl-93b4d28b"><p class="cl-93b4abfc"><span class="cl-93afbec6">0.006142297</span></p></td><td class="cl-93b4d28b"><p class="cl-93b4abfc"><span class="cl-93afbec6">4.272926</span></p></td><td class="cl-93b4d28b"><p class="cl-93b4abfc"><span class="cl-93afbec6">4.023180</span></p></td><td class="cl-93b4d28b"><p class="cl-93b4abfc"><span class="cl-93afbec6">17.68923</span></p></td><td class="cl-93b4d28b"><p class="cl-93b4abfc"><span class="cl-93afbec6">-5.841469</span></p></td><td class="cl-93b4d28b"><p class="cl-93b4abfc"><span class="cl-93afbec6">0.55069782</span></p></td><td class="cl-93b4d28b"><p class="cl-93b4abfc"><span class="cl-93afbec6">-0.027782260</span></p></td><td class="cl-93b4d28b"><p class="cl-93b4abfc"><span class="cl-93afbec6">0.55069782</span></p></td><td class="cl-93b4d28b"><p class="cl-93b4abfc"><span class="cl-93afbec6">3.792908</span></p></td><td class="cl-93b4d28b"><p class="cl-93b4abfc"><span class="cl-93afbec6">84.87308</span></p></td><td class="cl-93b4d294"><p class="cl-93b4abf2"><span class="cl-93afbec6">p&lt;.001</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-93b4d295"><p class="cl-93b4abf2"><span class="cl-93afbec6">sexual</span></p></td><td class="cl-93b4d296"><p class="cl-93b4abfc"><span class="cl-93afbec6">194,105</span></p></td><td class="cl-93b4d296"><p class="cl-93b4abfc"><span class="cl-93afbec6">20</span></p></td><td class="cl-93b4d296"><p class="cl-93b4abfc"><span class="cl-93afbec6">1.5918704</span></p></td><td class="cl-93b4d296"><p class="cl-93b4abfc"><span class="cl-93afbec6">0</span></p></td><td class="cl-93b4d296"><p class="cl-93b4abfc"><span class="cl-93afbec6">219.5201</span></p></td><td class="cl-93b4d296"><p class="cl-93b4abfc"><span class="cl-93afbec6">0.03362937</span></p></td><td class="cl-93b4d296"><p class="cl-93b4abfc"><span class="cl-93afbec6">0.006799252</span></p></td><td class="cl-93b4d296"><p class="cl-93b4abfc"><span class="cl-93afbec6">3.651205</span></p></td><td class="cl-93b4d296"><p class="cl-93b4abfc"><span class="cl-93afbec6">4.116183</span></p></td><td class="cl-93b4d296"><p class="cl-93b4abfc"><span class="cl-93afbec6">14.59002</span></p></td><td class="cl-93b4d296"><p class="cl-93b4abfc"><span class="cl-93afbec6">-6.463190</span></p></td><td class="cl-93b4d296"><p class="cl-93b4abfc"><span class="cl-93afbec6">0.34741806</span></p></td><td class="cl-93b4d296"><p class="cl-93b4abfc"><span class="cl-93afbec6">-0.027428584</span></p></td><td class="cl-93b4d296"><p class="cl-93b4abfc"><span class="cl-93afbec6">0.34741806</span></p></td><td class="cl-93b4d296"><p class="cl-93b4abfc"><span class="cl-93afbec6">2.986944</span></p></td><td class="cl-93b4d296"><p class="cl-93b4abfc"><span class="cl-93afbec6">72.03585</span></p></td><td class="cl-93b4d29e"><p class="cl-93b4abf2"><span class="cl-93afbec6">p&lt;.001</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-93b4d28a"><p class="cl-93b4abf2"><span class="cl-93afbec6">accumulated</span></p></td><td class="cl-93b4d28b"><p class="cl-93b4abfc"><span class="cl-93afbec6">194,105</span></p></td><td class="cl-93b4d28b"><p class="cl-93b4abfc"><span class="cl-93afbec6">16</span></p></td><td class="cl-93b4d28b"><p class="cl-93b4abfc"><span class="cl-93afbec6">1.0512352</span></p></td><td class="cl-93b4d28b"><p class="cl-93b4abfc"><span class="cl-93afbec6">0</span></p></td><td class="cl-93b4d28b"><p class="cl-93b4abfc"><span class="cl-93afbec6">219.1963</span></p></td><td class="cl-93b4d28b"><p class="cl-93b4abfc"><span class="cl-93afbec6">0.03360456</span></p></td><td class="cl-93b4d28b"><p class="cl-93b4abfc"><span class="cl-93afbec6">0.005456095</span></p></td><td class="cl-93b4d28b"><p class="cl-93b4abfc"><span class="cl-93afbec6">3.927915</span></p></td><td class="cl-93b4d28b"><p class="cl-93b4abfc"><span class="cl-93afbec6">3.737191</span></p></td><td class="cl-93b4d28b"><p class="cl-93b4abfc"><span class="cl-93afbec6">14.57993</span></p></td><td class="cl-93b4d28b"><p class="cl-93b4abfc"><span class="cl-93afbec6">-6.186481</span></p></td><td class="cl-93b4d28b"><p class="cl-93b4abfc"><span class="cl-93afbec6">0.42718459</span></p></td><td class="cl-93b4d28b"><p class="cl-93b4abfc"><span class="cl-93afbec6">-0.028135936</span></p></td><td class="cl-93b4d28b"><p class="cl-93b4abfc"><span class="cl-93afbec6">0.42718459</span></p></td><td class="cl-93b4d28b"><p class="cl-93b4abfc"><span class="cl-93afbec6">3.310397</span></p></td><td class="cl-93b4d28b"><p class="cl-93b4abfc"><span class="cl-93afbec6">65.10778</span></p></td><td class="cl-93b4d294"><p class="cl-93b4abf2"><span class="cl-93afbec6">p&lt;.001</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-93b4d29f"><p class="cl-93b4abf2"><span class="cl-93afbec6">by</span></p></td><td class="cl-93b4d2a0"><p class="cl-93b4abfc"><span class="cl-93afbec6">194,105</span></p></td><td class="cl-93b4d2a0"><p class="cl-93b4abfc"><span class="cl-93afbec6">137</span></p></td><td class="cl-93b4d2a0"><p class="cl-93b4abfc"><span class="cl-93afbec6">50.1889699</span></p></td><td class="cl-93b4d2a0"><p class="cl-93b4abfc"><span class="cl-93afbec6">0</span></p></td><td class="cl-93b4d2a0"><p class="cl-93b4abfc"><span class="cl-93afbec6">156.1495</span></p></td><td class="cl-93b4d2a0"><p class="cl-93b4abfc"><span class="cl-93afbec6">0.02836298</span></p></td><td class="cl-93b4d2a0"><p class="cl-93b4abfc"><span class="cl-93afbec6">0.036528463</span></p></td><td class="cl-93b4d2a0"><p class="cl-93b4abfc"><span class="cl-93afbec6">1.448734</span></p></td><td class="cl-93b4d2a0"><p class="cl-93b4abfc"><span class="cl-93afbec6">7.416767</span></p></td><td class="cl-93b4d2a0"><p class="cl-93b4abfc"><span class="cl-93afbec6">12.25380</span></p></td><td class="cl-93b4d2a0"><p class="cl-93b4abfc"><span class="cl-93afbec6">-8.665662</span></p></td><td class="cl-93b4d2a0"><p class="cl-93b4abfc"><span class="cl-93afbec6">0.05240267</span></p></td><td class="cl-93b4d2a0"><p class="cl-93b4abfc"><span class="cl-93afbec6">-0.006738542</span></p></td><td class="cl-93b4d2a0"><p class="cl-93b4abfc"><span class="cl-93afbec6">0.05240267</span></p></td><td class="cl-93b4d2a0"><p class="cl-93b4abfc"><span class="cl-93afbec6">1.078064</span></p></td><td class="cl-93b4d2a0"><p class="cl-93b4abfc"><span class="cl-93afbec6">107.61056</span></p></td><td class="cl-93b4d2a8"><p class="cl-93b4abf2"><span class="cl-93afbec6">p&lt;.001</span></p></td></tr></tbody></table></div>
</div>
</div>
<div id="visualising-collocations" class="section level2 unnumbered">
<h2 class="unnumbered">Visualising collocations</h2>
<div id="dotplots" class="section level3 unnumbered">
<h3 class="unnumbered">Dotplots</h3>
<p>We can now visualize the association strengths in a dotplot as shown
in the code chunk below.</p>
<pre class="r"><code># sort the coocStatz data frame in descending order based on the &#39;phi&#39; column
assoc_tb2 %&gt;%
  dplyr::arrange(-phi) %&gt;%
  # select the top 20 rows after sorting
  head(20) %&gt;%
  # create a ggplot with &#39;token&#39; on the x-axis (reordered by &#39;phi&#39;) and &#39;phi&#39; on the y-axis
  ggplot(aes(x = reorder(token, phi, mean), y = phi)) +
  # add a scatter plot with points representing the &#39;phi&#39; values
  geom_point() +
  # flip the coordinates to have horizontal points
  coord_flip() +
  # set the theme to a basic white and black theme
  theme_bw() +
  # set the x-axis label to &quot;Token&quot; and y-axis label to &quot;Association strength (phi)&quot;
  labs(x = &quot;Token&quot;, y = &quot;Association strength (phi)&quot;)</code></pre>
<p><img src="coll_files/figure-html/unnamed-chunk-22-1.png" width="672" /></p>
</div>
<div id="barplots" class="section level3 unnumbered">
<h3 class="unnumbered">Barplots</h3>
<p>Another option sis to visualize the association strengths in a
barplot as shown in the code chunk below.</p>
<pre class="r"><code># sort the coocStatz data frame in descending order based on the &#39;phi&#39; column
assoc_tb2 %&gt;%
  dplyr::arrange(-phi) %&gt;%
  # select the top 20 rows after sorting
  head(20) %&gt;%
  # create a ggplot with &#39;token&#39; on the x-axis (reordered by &#39;phi&#39;) and &#39;phi&#39; on the y-axis
  ggplot(aes(x = reorder(token, phi, mean), y = phi, label = phi)) +
  # add a bar plot using the &#39;phi&#39; values
  geom_bar(stat = &quot;identity&quot;) +
  # add text labels above the bars with rounded &#39;phi&#39; values
  geom_text(aes(y = phi - 0.005, label = round(phi, 3)), color = &quot;white&quot;, size = 3) + 
  # flip the coordinates to have horizontal bars
  coord_flip() +
  # set the theme to a basic white and black theme
  theme_bw() +
  # set the x-axis label to &quot;Token&quot; and y-axis label to &quot;Association strength (phi)&quot;
  labs(x = &quot;Token&quot;, y = &quot;Association strength (phi)&quot;)</code></pre>
<p><img src="coll_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
</div>
<div id="dendrograms" class="section level3 unnumbered">
<h3 class="unnumbered">Dendrograms</h3>
<p>Another method for visualizing collocations are dendrograms
(tree-diagrams) which show how similarity to indicate groupings based on
numeric values (e.g., association strength).</p>
<p>We start by extracting the tokens that we want to show (the top 20
collocates of <em>alice</em>).</p>
<pre class="r"><code># sort the coocStatz data frame in descending order based on the &#39;phi&#39; column
top20colls &lt;- assoc_tb2 %&gt;%
  dplyr::arrange(-phi) %&gt;%
  # select the top 20 rows after sorting
  head(20) %&gt;%
  # extract the &#39;token&#39; column 
  dplyr::pull(token)
# inspect the top 20 tokens with the highest &#39;phi&#39; values
top20colls</code></pre>
<pre><code>##  [1] &quot;selection&quot;    &quot;natural&quot;      &quot;through&quot;      &quot;theory&quot;       &quot;unconscious&quot; 
##  [6] &quot;methodical&quot;   &quot;acts&quot;         &quot;sexual&quot;       &quot;accumulated&quot;  &quot;by&quot;          
## [11] &quot;power&quot;        &quot;man&quot;          &quot;action&quot;       &quot;principle&quot;    &quot;accumulative&quot;
## [16] &quot;rigorous&quot;     &quot;survival&quot;     &quot;effects&quot;      &quot;process&quot;      &quot;aided&quot;</code></pre>
<p>We then need to generate a feature co-occurrence matrix from a
document-feature matrix based on the cleaned, lower case sentences of
our text.</p>
<pre class="r"><code># tokenize the &#39;sentences&#39; data using quanteda package
keyword_fcm &lt;- sentences %&gt;%
  quanteda::tokens() %&gt;%
  # create a document-feature matrix (dfm) from the tokens
  quanteda::dfm() %&gt;%
  # select features based on &#39;top20colls&#39; and the term &quot;selection&quot; pattern
  quanteda::dfm_select(pattern = c(top20colls, &quot;selection&quot;)) %&gt;%
  # Create a symmetric feature co-occurrence matrix (fcm) 
  quanteda::fcm(tri = FALSE)
# inspect the first 6 rows and 6 columns of the resulting fcm
keyword_fcm[1:6, 1:6]</code></pre>
<pre><code>## Feature co-occurrence matrix of: 6 by 6 features.
##          features
## features   by natural aided effects power man
##   by      461     282    25      37    54  81
##   natural 282      49     9      28    38  18
##   aided    25       9     0       1     1   0
##   effects  37      28     1       3     1   5
##   power    54      38     1       1     9  15
##   man      81      18     0       5    15  10</code></pre>
<p>Then we generate the dendrogram based on a distance matrix generated
from the feature co-occurrence matrix.</p>
<pre class="r"><code># create a hierarchical clustering object using the distance matrix of the fcm as data
hclust(dist(keyword_fcm),     
       # use ward.D as linkage method
       method=&quot;ward.D2&quot;) %&gt;% 
  # generate visualization (dendrogram)
  ggdendrogram() +              
  # add title
  ggtitle(&quot;20 most strongly collocating terms of &#39;selection&#39;&quot;)  </code></pre>
<p><img src="coll_files/figure-html/unnamed-chunk-26-1.png" width="672" /></p>
</div>
<div id="network-graphs" class="section level3 unnumbered">
<h3 class="unnumbered">Network Graphs</h3>
<p><a href="https://ladal.edu.au/net.html">Network graphs</a>, or
networks for short, are a powerful and versatile visual representation
used to depict relationships or connections among various elements.
Network graphs typically consist of nodes, representing individual
entities, and edges, indicating the connections or interactions between
these entities. Nodes can represent diverse entities such as words
(collocates), interlocutors, objects, or concepts, while edges convey
the relationships or associations between them.</p>
<p>Here we generate a basic network graph of the collocates of our
keyword based on the fcm.</p>
<pre class="r"><code># create a network plot using the fcm
quanteda.textplots::textplot_network(keyword_fcm,
                                     # set the transparency of edges to 0.8 for visibility
                                     edge_alpha = 0.8,
                                     # set the color of edges to gray
                                     edge_color = &quot;gray&quot;,
                                     # set the size of edges to 2 for better visibility
                                     edge_size = 2,
                                     # adjust the size of vertex labels 
                                     # based on the logarithm of row sums of the fcm
                                     vertex_labelsize = log(rowSums(keyword_fcm)))</code></pre>
<p><img src="coll_files/figure-html/unnamed-chunk-27-1.png" width="672" /></p>
</div>
<div id="biplots" class="section level3 unnumbered">
<h3 class="unnumbered">Biplots</h3>
<p>An alternative way to display co-occurrence patterns are bi-plots
which are used to display the results of a <a
href="https://ladal.edu.au/clust.html#2_Correspondence_Analysis">Correspondence
Analysis</a>. Bi-plots are useful, in particular, when one is not
interested in one particular keyterm and its collocations but in the
overall similarity of many terms. Semantic similarity in this case
refers to a shared semantic and this distributional profile. As such,
words can be deemed semantically similar if they have a similar
co-occurrence profile - i.e. they co-occur with the same elements.
Biplots can be used to visualize collocations because collocates
co-occur and thus share semantic properties which renders then more
similar to each other compared with other terms.</p>
<pre class="r"><code># perform correspondence analysis
res.ca &lt;- CA(as.matrix(keyword_fcm), graph = FALSE)
# plot results
fviz_ca_row(res.ca, repel = TRUE, col.row = &quot;gray20&quot;)</code></pre>
<p><img src="coll_files/figure-html/unnamed-chunk-28-1.png" width="672" /></p>
</div>
</div>
</div>
<div id="citation-session-info" class="section level1 unnumbered">
<h1 class="unnumbered">Citation &amp; Session Info</h1>
<p>Schweinberger, Martin. 2024. <em>Analyzing Co-Occurrences, N-grams,
and Collocations in R</em>. Brisbane: The University of Queensland. url:
<a href="https://ladal.edu.au/coll.html"
class="uri">https://ladal.edu.au/coll.html</a> (Version 2024.03.07).</p>
<pre><code>@manual{schweinberger`2023coll,
  author = {Schweinberger, Martin},
  title = {Analyzing Co-Occurrences, N-grams, and Collocations in R},
  note = {https://ladal.edu.au/coll.html},
  year = {2024},
  organization = {The University of Queensland, Australia. School of Languages and Cultures},
  address = {Brisbane},
  edition = {2024.03.07}
}</code></pre>
<pre class="r"><code>sessionInfo()</code></pre>
<pre><code>## R version 4.3.2 (2023-10-31 ucrt)
## Platform: x86_64-w64-mingw32/x64 (64-bit)
## Running under: Windows 11 x64 (build 22621)
## 
## Matrix products: default
## 
## 
## locale:
## [1] LC_COLLATE=English_Australia.utf8  LC_CTYPE=English_Australia.utf8   
## [3] LC_MONETARY=English_Australia.utf8 LC_NUMERIC=C                      
## [5] LC_TIME=English_Australia.utf8    
## 
## time zone: Australia/Brisbane
## tzcode source: internal
## 
## attached base packages:
## [1] stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
##  [1] sna_2.7-2                 statnet.common_4.9.0     
##  [3] tm_0.7-11                 NLP_0.2-1                
##  [5] stringr_1.5.1             dplyr_1.1.4              
##  [7] quanteda.textplots_0.94.4 quanteda.textstats_0.96.4
##  [9] quanteda_3.3.1            Matrix_1.6-5             
## [11] network_1.18.2            igraph_2.0.2             
## [13] ggdendro_0.2.0            GGally_2.2.1             
## [15] flextable_0.9.4           factoextra_1.0.7         
## [17] ggplot2_3.5.0             FactoMineR_2.10          
## 
## loaded via a namespace (and not attached):
##   [1] RColorBrewer_1.1-3      rstudioapi_0.15.0       jsonlite_1.8.8         
##   [4] magrittr_2.0.3          TH.data_1.1-2           estimability_1.5       
##   [7] farver_2.1.1            rmarkdown_2.25          ragg_1.2.7             
##  [10] vctrs_0.6.5             askpass_1.2.0           rstatix_0.7.2          
##  [13] htmltools_0.5.7         curl_5.2.0              broom_1.0.5            
##  [16] janeaustenr_1.0.0       sass_0.4.8              bslib_0.6.1            
##  [19] htmlwidgets_1.6.4       tokenizers_0.3.0        plyr_1.8.9             
##  [22] sandwich_3.1-0          emmeans_1.10.0          zoo_1.8-12             
##  [25] cachem_1.0.8            uuid_1.2-0              mime_0.12              
##  [28] lifecycle_1.0.4         pkgconfig_2.0.3         R6_2.5.1               
##  [31] fastmap_1.1.1           shiny_1.8.0             digest_0.6.34          
##  [34] tidytext_0.4.1          colorspace_2.1-0        textshaping_0.3.7      
##  [37] SnowballC_0.7.1         ggpubr_0.6.0            labeling_0.4.3         
##  [40] fansi_1.0.6             abind_1.4-5             compiler_4.3.2         
##  [43] fontquiver_0.2.1        withr_3.0.0             backports_1.4.1        
##  [46] carData_3.0-5           ggstats_0.5.1           highr_0.10             
##  [49] ggsignif_0.6.4          MASS_7.3-60             openssl_2.1.1          
##  [52] scatterplot3d_0.3-44    gfonts_0.2.0            flashClust_1.01-2      
##  [55] tools_4.3.2             stopwords_2.3           zip_2.3.1              
##  [58] httpuv_1.6.14           glue_1.7.0              promises_1.2.1         
##  [61] grid_4.3.2              cluster_2.1.4           generics_0.1.3         
##  [64] gtable_0.3.4            tidyr_1.3.1             data.table_1.15.2      
##  [67] xml2_1.3.6              car_3.1-2               utf8_1.2.4             
##  [70] ggrepel_0.9.5           pillar_1.9.0            nsyllable_1.0.1        
##  [73] later_1.3.2             splines_4.3.2           lattice_0.21-9         
##  [76] klippy_0.0.0.9500       survival_3.5-7          tidyselect_1.2.0       
##  [79] fontLiberation_0.1.0    knitr_1.45              fontBitstreamVera_0.1.1
##  [82] crul_1.4.0              xfun_0.42               DT_0.32                
##  [85] stringi_1.8.3           yaml_2.3.8              evaluate_0.23          
##  [88] codetools_0.2-19        httpcode_0.3.0          officer_0.6.5          
##  [91] gdtools_0.3.6           tibble_3.2.1            multcompView_0.1-9     
##  [94] cli_3.6.2               RcppParallel_5.1.7      xtable_1.8-4           
##  [97] systemfonts_1.0.5       munsell_0.5.0           jquerylib_0.1.4        
## [100] Rcpp_1.0.12             coda_0.19-4.1           parallel_4.3.2         
## [103] leaps_3.1               ellipsis_0.3.2          assertthat_0.2.1       
## [106] mvtnorm_1.2-4           slam_0.1-50             scales_1.3.0           
## [109] purrr_1.0.2             crayon_1.5.2            rlang_1.1.3            
## [112] fastmatch_1.1-4         multcomp_1.4-25</code></pre>
<hr />
<p><a href="#Introduction">Back to top</a></p>
<p><a href="https://ladal.edu.au">Back to LADAL home</a></p>
<hr />
</div>
<div id="references" class="section level1 unnumbered">
<h1 class="unnumbered">References</h1>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-quanteda" class="csl-entry">
Benoit, Kenneth, Kohei Watanabe, Haiyan Wang, Paul Nulty, Adam Obeng,
Stefan Müller, and Akitaka Matsuo. 2018. <span>“Quanteda: An r Package
for the Quantitative Analysis of Textual Data.”</span> <em>Journal of
Open Source Software</em> 3 (30): 774. <a
href="https://doi.org/10.21105/joss.00774">https://doi.org/10.21105/joss.00774</a>.
</div>
<div id="ref-gries201350" class="csl-entry">
Gries, Stefan Th. 2013. <span>“50-Something Years of Work on
Collocations: What Is or Should Be Next….”</span> <em>International
Journal of Corpus Linguistics</em> 18 (1): 137–66.
</div>
<div id="ref-gries2022some" class="csl-entry">
———. 2022. <span>“What Do (Some of) Our Association Measures Measure
(Most)? Association?”</span> <em>Journal of Second Language Studies</em>
5 (1): 1–33.
</div>
<div id="ref-pedersen1998dependent" class="csl-entry">
Pedersen, Ted. 1998. <span>“Dependent Bigram Identification.”</span>
<em>AAAI/IAAI</em> 1197.
</div>
<div id="ref-WN17" class="csl-entry">
Wiedemann, Gregor, and Andreas Niekler. 2017. <span>“Hands-on:
<span>A</span> Five Day Text Mining Course for Humanists and Social
Scientists in <span>R</span>.”</span> In <em>Proceedings of the Workshop
on Teaching <span>NLP</span> for Digital Humanities
(<span>Teach4DH</span>), Berlin, Germany, September 12, 2017.</em>,
57–65. <a
href="http://ceur-ws.org/Vol-1918/wiedemann.pdf">http://ceur-ws.org/Vol-1918/wiedemann.pdf</a>.
</div>
</div>
</div>
<div class="footnotes footnotes-end-of-document">
<hr />
<ol>
<li id="fn1"><p>If you want to render the R Notebook on your machine,
i.e. knitting the document to html or a pdf, you need to make sure that
you have R and RStudio installed and you also need to download the <a
href="https://slcladal.github.io/content/bibliography.bib"><strong>bibliography
file</strong></a> and store it in the same folder where you store the
Rmd file.<a href="#fnref1" class="footnote-back">↩︎</a></p></li>
</ol>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
