{
  "hash": "f0ea376353d298dd22fd061e80164675",
  "result": {
    "markdown": "---\ntitle: \"How to test if including a random effect is warranted?\"\nauthor: \"Martin Schweinberger\"\ndate: \"2022-08-31\"\n---\n\n\n# Introduction{-}\n\nThis approach is proposed by  @galwey2007introduction[213-214] but it has been contested and may not be conceptually sound (see this discussion on [StackOverflow](https://stats.stackexchange.com/questions/56150/how-can-i-test-whether-a-random-effect-is-significant)) and it is not included in the second edition of the book [see @galwey2014introduction].\n\n# Generate data{-}\n\nCreate a constant and use it as a random effect, then create two models: one model with the constant as a random effect and another model with variable as random effect. then use `anova` to compare the models (see below).\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(101)\ndataset <- expand.grid(id = factor(seq_len(10)), \n                       fac1 = factor(c(\"A\", \"B\"), levels = c(\"A\", \"B\")), \n                       trial = seq_len(10))\ndataset$value <- rnorm(nrow(dataset), sd = 0.5) +\n      with(dataset, rnorm(length(levels(id)), sd = 0.5)[id] +\n      ifelse(fac1 == \"B\", 1.0, 0)) + rnorm(1,.5)\ndataset$idconst <- factor(rep(1, each = length(dataset$value)))\n# inspect data\nhead(dataset)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  id fac1 trial    value idconst\n1  1    A     1 1.791537       1\n2  2    A     1 1.621164       1\n3  3    A     1 1.910855       1\n4  4    A     1 1.748506       1\n5  5    A     1 2.796918       1\n6  6    A     1 3.070813       1\n```\n:::\n:::\n\n\n# Generate and compare models{-}\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(lme4)\nfm0 <- lmer(value~fac1+(1|id), \n            data = dataset, \n            REML = FALSE)\nfm1 <- lmer(value~fac1+(1|idconst), \n            data = dataset, \n            control=lmerControl(check.nlev.gtr.1=\"ignore\"), \n            REML = FALSE)\n# compare models\nanova(fm1,fm0)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nData: dataset\nModels:\nfm1: value ~ fac1 + (1 | idconst)\nfm0: value ~ fac1 + (1 | id)\n    npar    AIC    BIC  logLik deviance  Chisq Df Pr(>Chisq)\nfm1    4 369.42 382.62 -180.71   361.42                     \nfm0    4 309.74 322.94 -150.87   301.74 59.682  0           \n```\n:::\n:::\n\n\nAccording to the model comparison, the random effect should be included as the fm0 model has the lower AIC as well as BIC.\n\n# References{-}\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}